<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Vue3学习</title>
      <link href="/2024/01/28/Vue3%E5%AD%A6%E4%B9%A0(%E6%96%B0)/"/>
      <url>/2024/01/28/Vue3%E5%AD%A6%E4%B9%A0(%E6%96%B0)/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Vue3简介"><a href="#1-Vue3简介" class="headerlink" title="1. Vue3简介"></a>1. Vue3简介</h1><ul><li><p>2020年9月18日，<code>Vue.js</code>发布版<code>3.0</code>版本，代号：<code>One Piece</code>（n</p></li><li><p>经历了：<a href="https://github.com/vuejs/core/commits/main">4800+次提交</a>、<a href="https://github.com/vuejs/rfcs/tree/master/active-rfcs">40+个RFC</a>、<a href="https://github.com/vuejs/vue-next/pulls?q=is:pr+is:merged+-author:app/dependabot-preview+">600+次PR</a>、<a href="https://github.com/vuejs/core/graphs/contributors">300+贡献者</a></p></li><li><p>官方发版地址：<a href="https://github.com/vuejs/core/releases/tag/v3.0.0">Release v3.0.0 One Piece · vuejs&#x2F;core</a></p></li><li><p>截止2023年10月，最新的公开版本为：<code>3.3.4</code></p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1695089947298-161c1b47-eb86-42fb-b1f8-d6a4fcab8ee2.png" alt="image.png" style="zoom:30%;" /></li></ul><h2 id="1-1-【性能的提升】"><a href="#1-1-【性能的提升】" class="headerlink" title="1.1. 【性能的提升】"></a>1.1. 【性能的提升】</h2><ul><li><p>打包大小减少<code>41%</code>。</p></li><li><p>初次渲染快<code>55%</code>, 更新渲染快<code>133%</code>。</p></li><li><p>内存减少<code>54%</code>。</p></li></ul><h2 id="1-2-【-源码的升级】"><a href="#1-2-【-源码的升级】" class="headerlink" title="1.2.【 源码的升级】"></a>1.2.【 源码的升级】</h2><ul><li><p>使用<code>Proxy</code>代替<code>defineProperty</code>实现响应式。</p></li><li><p>重写虚拟<code>DOM</code>的实现和<code>Tree-Shaking</code>。</p></li></ul><h2 id="1-3-【拥抱TypeScript】"><a href="#1-3-【拥抱TypeScript】" class="headerlink" title="1.3. 【拥抱TypeScript】"></a>1.3. 【拥抱TypeScript】</h2><ul><li><code>Vue3</code>可以更好的支持<code>TypeScript</code>。</li></ul><h2 id="1-4-【新的特性】"><a href="#1-4-【新的特性】" class="headerlink" title="1.4. 【新的特性】"></a>1.4. 【新的特性】</h2><ol><li><p><code>Composition API</code>（组合<code>API</code>）：</p><ul><li><p><code>setup</code></p></li><li><p><code>ref</code>与<code>reactive</code></p></li><li><p><code>computed</code>与<code>watch</code></p><p>……</p></li></ul></li><li><p>新的内置组件：</p><ul><li><p><code>Fragment</code></p></li><li><p><code>Teleport</code></p></li><li><p><code>Suspense</code></p><p>……</p></li></ul></li><li><p>其他改变：</p><ul><li><p>新的生命周期钩子</p></li><li><p><code>data</code> 选项应始终被声明为一个函数</p></li><li><p>移除<code>keyCode</code>支持作为<code> v-on</code> 的修饰符</p><p>……</p></li></ul></li></ol><h1 id="2-创建Vue3工程"><a href="#2-创建Vue3工程" class="headerlink" title="2. 创建Vue3工程"></a>2. 创建Vue3工程</h1><h2 id="2-1-【基于-vue-cli-创建】"><a href="#2-1-【基于-vue-cli-创建】" class="headerlink" title="2.1. 【基于 vue-cli 创建】"></a>2.1. 【基于 vue-cli 创建】</h2><p>点击查看<a href="https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create">官方文档</a></p><blockquote><p>备注：目前<code>vue-cli</code>已处于维护模式，官方推荐基于 <code>Vite</code> 创建项目。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 查看@vue/cli版本，确保@vue/cli版本在4.5.0以上</span></span><br><span class="line">vue <span class="literal">--version</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装或者升级你的@vue/cli </span></span><br><span class="line">npm install <span class="literal">-g</span> @vue/<span class="built_in">cli</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 执行创建命令</span></span><br><span class="line">vue create vue_test</span><br><span class="line"></span><br><span class="line"><span class="comment">##  随后选择3.x</span></span><br><span class="line"><span class="comment">##  Choose a version of Vue.js that you want to start the project with (Use arrow keys)</span></span><br><span class="line"><span class="comment">##  &gt; 3.x</span></span><br><span class="line"><span class="comment">##    2.x</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 启动</span></span><br><span class="line"><span class="built_in">cd</span> vue_test</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure><hr><h2 id="2-2-【基于-vite-创建】-推荐"><a href="#2-2-【基于-vite-创建】-推荐" class="headerlink" title="2.2. 【基于 vite 创建】(推荐)"></a>2.2. 【基于 vite 创建】(推荐)</h2><p><code>vite</code> 是新一代前端构建工具，官网地址：<a href="https://vitejs.cn/">https://vitejs.cn</a>，<code>vite</code>的优势如下：</p><ul><li>轻量快速的热重载（<code>HMR</code>），能实现极速的服务启动。</li><li>对 <code>TypeScript</code>、<code>JSX</code>、<code>CSS</code> 等支持开箱即用。</li><li>真正的按需编译，不再等待整个应用编译完成。</li><li><code>webpack</code>构建 与 <code>vite</code>构建对比图如下：<br><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1683167182037-71c78210-8217-4e7d-9a83-e463035efbbe.png" alt="webpack构建" title="webpack构建" style="zoom:20%;box-shadow:0 0 10px black" /><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1683167204081-582dc237-72bc-499e-9589-2cdfd452e62f.png" alt="vite构建" title="vite构建" style="zoom: 20%;box-shadow:0 0 10px black" /></li></ul><ul><li>具体操作如下（点击查看<a href="https://cn.vuejs.org/guide/quick-start.html#creating-a-vue-application">官方文档</a>）</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 1.创建命令</span></span><br><span class="line">npm create vue@latest</span><br><span class="line"></span><br><span class="line"><span class="comment">## 2.具体配置</span></span><br><span class="line"><span class="comment">## 配置项目名称</span></span><br><span class="line">√ Project name: vue3_test</span><br><span class="line"><span class="comment">## 是否添加TypeScript支持</span></span><br><span class="line">√ Add TypeScript?  Yes</span><br><span class="line"><span class="comment">## 是否添加JSX支持</span></span><br><span class="line">√ Add JSX Support?  No</span><br><span class="line"><span class="comment">## 是否添加路由环境</span></span><br><span class="line">√ Add Vue Router <span class="keyword">for</span> Single Page Application development?  No</span><br><span class="line"><span class="comment">## 是否添加pinia环境</span></span><br><span class="line">√ Add Pinia <span class="keyword">for</span> state management?  No</span><br><span class="line"><span class="comment">## 是否添加单元测试</span></span><br><span class="line">√ Add Vitest <span class="keyword">for</span> Unit Testing?  No</span><br><span class="line"><span class="comment">## 是否添加端到端测试方案</span></span><br><span class="line">√ Add an <span class="keyword">End</span><span class="literal">-to-End</span> Testing Solution? » No</span><br><span class="line"><span class="comment">## 是否添加ESLint语法检查</span></span><br><span class="line">√ Add ESLint <span class="keyword">for</span> code quality?  Yes</span><br><span class="line"><span class="comment">## 是否添加Prettiert代码格式化</span></span><br><span class="line">√ Add Prettier <span class="keyword">for</span> code formatting?  No</span><br></pre></td></tr></table></figure><p>自己动手编写一个App组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">    &lt;h1&gt;你好啊！&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name:&#x27;App&#x27; //组件名</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  .app &#123;</span><br><span class="line">    background-color: #ddd;</span><br><span class="line">    box-shadow: 0 0 10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line">    padding: 20px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>安装官方推荐的<code>vscode</code>插件：</p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/volar.png" alt="Snipaste_2023-10-08_20-46-34" style="zoom:50%;" /> <img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/image-20231218085906380.png" alt="image-20231218085906380" style="zoom:42%;" /> <p>总结：</p><ul><li><code>Vite</code> 项目中，<code>index.html</code> 是项目的入口文件，在项目最外层。</li><li>加载<code>index.html</code>后，<code>Vite</code> 解析 <code>&lt;script type=&quot;module&quot; src=&quot;xxx&quot;&gt;</code> 指向的<code>JavaScript</code>。</li><li><code>Vue3</code>**中是通过 **<code>createApp</code> 函数创建一个应用实例。</li></ul><h2 id="2-3-【一个简单的效果】"><a href="#2-3-【一个简单的效果】" class="headerlink" title="2.3. 【一个简单的效果】"></a>2.3. 【一个简单的效果】</h2><p><code>Vue3</code>向下兼容<code>Vue2</code>语法，且<code>Vue3</code>中的模板中可以没有根标签</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123;age&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;年龄+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;showTel&quot;&gt;点我查看联系方式&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name:&#x27;App&#x27;,</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        name:&#x27;张三&#x27;,</span><br><span class="line">        age:18,</span><br><span class="line">        tel:&#x27;13888888888&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">      changeName()&#123;</span><br><span class="line">        this.name = &#x27;zhang-san&#x27;</span><br><span class="line">      &#125;,</span><br><span class="line">      changeAge()&#123;</span><br><span class="line">        this.age += 1</span><br><span class="line">      &#125;,</span><br><span class="line">      showTel()&#123;</span><br><span class="line">        alert(this.tel)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="3-Vue3核心语法"><a href="#3-Vue3核心语法" class="headerlink" title="3. Vue3核心语法"></a>3. Vue3核心语法</h1><h2 id="3-1-【OptionsAPI-与-CompositionAPI】"><a href="#3-1-【OptionsAPI-与-CompositionAPI】" class="headerlink" title="3.1.  【OptionsAPI 与 CompositionAPI】"></a>3.1.  【OptionsAPI 与 CompositionAPI】</h2><ul><li><code>Vue2</code>的<code>API</code>设计是<code>Options</code>（配置）风格的。</li><li><code>Vue3</code>的<code>API</code>设计是<code>Composition</code>（组合）风格的。</li></ul><h3 id="Options-API-的弊端"><a href="#Options-API-的弊端" class="headerlink" title="Options API 的弊端"></a>Options API 的弊端</h3><p><code>Options</code>类型的 <code>API</code>，数据、方法、计算属性等，是分散在：<code>data</code>、<code>methods</code>、<code>computed</code>中的，若想新增或者修改一个需求，就需要分别修改：<code>data</code>、<code>methods</code>、<code>computed</code>，不便于维护和复用。</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1696662197101-55d2b251-f6e5-47f4-b3f1-d8531bbf9279.gif" alt="1.gif" style="zoom:70%;border-radius:20px" /><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1696662200734-1bad8249-d7a2-423e-a3c3-ab4c110628be.gif" alt="2.gif" style="zoom:70%;border-radius:20px" /></p><h3 id="Composition-API-的优势"><a href="#Composition-API-的优势" class="headerlink" title="Composition API 的优势"></a>Composition API 的优势</h3><p>可以用函数的方式，更加优雅的组织代码，让相关功能的代码更加有序的组织在一起。</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1696662249851-db6403a1-acb5-481a-88e0-e1e34d2ef53a.gif" alt="3.gif" style="height:300px;border-radius:10px"  /><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1696662256560-7239b9f9-a770-43c1-9386-6cc12ef1e9c0.gif" alt="4.gif" style="height:300px;border-radius:10px"  /></p><blockquote><p>说明：以上四张动图原创作者：大帅老猿</p></blockquote><h2 id="3-2-【拉开序幕的-setup】"><a href="#3-2-【拉开序幕的-setup】" class="headerlink" title="3.2. 【拉开序幕的 setup】"></a>3.2. 【拉开序幕的 setup】</h2><h3 id="setup-概述"><a href="#setup-概述" class="headerlink" title="setup 概述"></a>setup 概述</h3><p><code>setup</code>是<code>Vue3</code>中一个新的配置项，值是一个函数，它是 <code>Composition API</code> <strong>“表演的舞台</strong>_<strong>”</strong>_，组件中所用到的：数据、方法、计算属性、监视……等等，均配置在<code>setup</code>中。</p><p>特点如下：</p><ul><li><code>setup</code>函数返回的对象中的内容，可直接在模板中使用。</li><li><code>setup</code>中访问<code>this</code>是<code>undefined</code>。</li><li><code>setup</code>函数会在<code>beforeCreate</code>之前调用，它是“领先”所有钩子执行的。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123;age&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;年龄+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;showTel&quot;&gt;点我查看联系方式&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name:&#x27;Person&#x27;,</span><br><span class="line">    setup()&#123;</span><br><span class="line">      // 数据，原来写在data中（注意：此时的name、age、tel数据都不是响应式数据）</span><br><span class="line">      let name = &#x27;张三&#x27;</span><br><span class="line">      let age = 18</span><br><span class="line">      let tel = &#x27;13888888888&#x27;</span><br><span class="line"></span><br><span class="line">      // 方法，原来写在methods中</span><br><span class="line">      function changeName()&#123;</span><br><span class="line">        name = &#x27;zhang-san&#x27; //注意：此时这么修改name页面是不变化的</span><br><span class="line">        console.log(name)</span><br><span class="line">      &#125;</span><br><span class="line">      function changeAge()&#123;</span><br><span class="line">        age += 1 //注意：此时这么修改age页面是不变化的</span><br><span class="line">        console.log(age)</span><br><span class="line">      &#125;</span><br><span class="line">      function showTel()&#123;</span><br><span class="line">        alert(tel)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // 返回一个对象，对象中的内容，模板中可以直接使用</span><br><span class="line">      return &#123;name,age,tel,changeName,changeAge,showTel&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="setup-的返回值"><a href="#setup-的返回值" class="headerlink" title="setup 的返回值"></a>setup 的返回值</h3><ul><li>若返回一个<strong>对象</strong>：则对象中的：属性、方法等，在模板中均可以直接使用<strong>（重点关注）。</strong></li><li>若返回一个<strong>函数</strong>：则可以自定义渲染内容，代码如下：</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">()=&gt;</span> <span class="string">&#x27;你好啊！&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="setup-与-Options-API-的关系"><a href="#setup-与-Options-API-的关系" class="headerlink" title="setup 与 Options API 的关系"></a>setup 与 Options API 的关系</h3><ul><li><code>Vue2</code> 的配置（<code>data</code>、<code>methos</code>……）中<strong>可以访问到</strong> <code>setup</code>中的属性、方法。</li><li>但在<code>setup</code>中<strong>不能访问到</strong><code>Vue2</code>的配置（<code>data</code>、<code>methos</code>……）。</li><li>如果与<code>Vue2</code>冲突，则<code>setup</code>优先。</li></ul><h3 id="setup-语法糖"><a href="#setup-语法糖" class="headerlink" title="setup 语法糖"></a>setup 语法糖</h3><p><code>setup</code>函数有一个语法糖，这个语法糖，可以让我们把<code>setup</code>独立出去，代码如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123;age&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changAge&quot;&gt;年龄+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;showTel&quot;&gt;点我查看联系方式&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name:&#x27;Person&#x27;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 下面的写法是setup语法糖 --&gt;</span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">  console.log(this) //undefined</span><br><span class="line">  </span><br><span class="line">  // 数据（注意：此时的name、age、tel都不是响应式数据）</span><br><span class="line">  let name = &#x27;张三&#x27;</span><br><span class="line">  let age = 18</span><br><span class="line">  let tel = &#x27;13888888888&#x27;</span><br><span class="line"></span><br><span class="line">  // 方法</span><br><span class="line">  function changName()&#123;</span><br><span class="line">    name = &#x27;李四&#x27;//注意：此时这么修改name页面是不变化的</span><br><span class="line">  &#125;</span><br><span class="line">  function changAge()&#123;</span><br><span class="line">    console.log(age)</span><br><span class="line">    age += 1 //注意：此时这么修改age页面是不变化的</span><br><span class="line">  &#125;</span><br><span class="line">  function showTel()&#123;</span><br><span class="line">    alert(tel)</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>扩展：上述代码，还需要编写一个不写<code>setup</code>的<code>script</code>标签，去指定组件名字，比较麻烦，我们可以借助<code>vite</code>中的插件简化</p><ol><li>第一步：<code>npm i vite-plugin-vue-setup-extend -D</code></li><li>第二步：<code>vite.config.ts</code></li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueSetupExtend</span> <span class="keyword">from</span> <span class="string">&#x27;vite-plugin-vue-setup-extend&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [ <span class="title class_">VueSetupExtend</span>() ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="3"><li>第三步：<code>&lt;script setup lang=&quot;ts&quot; name=&quot;Person&quot;&gt;</code></li></ol><h2 id="3-3-【ref-创建：基本类型的响应式数据】"><a href="#3-3-【ref-创建：基本类型的响应式数据】" class="headerlink" title="3.3. 【ref 创建：基本类型的响应式数据】"></a>3.3. 【ref 创建：基本类型的响应式数据】</h2><ul><li><strong>作用：</strong>定义响应式变量。</li><li><strong>语法：</strong><code>let xxx = ref(初始值)</code>。</li><li><strong>返回值：</strong>一个<code>RefImpl</code>的实例对象，简称<code>ref对象</code>或<code>ref</code>，<code>ref</code>对象的<code>value</code><strong>属性是响应式的</strong>。</li><li><strong>注意点：</strong><ul><li><code>JS</code>中操作数据需要：<code>xxx.value</code>，但模板中不需要<code>.value</code>，直接使用即可。</li><li>对于<code>let name = ref(&#39;张三&#39;)</code>来说，<code>name</code>不是响应式的，<code>name.value</code>是响应式的。</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123;age&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;年龄+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;showTel&quot;&gt;点我查看联系方式&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;ref&#125; from &#x27;vue&#x27;</span><br><span class="line">  // name和age是一个RefImpl的实例对象，简称ref对象，它们的value属性是响应式的。</span><br><span class="line">  let name = ref(&#x27;张三&#x27;)</span><br><span class="line">  let age = ref(18)</span><br><span class="line">  // tel就是一个普通的字符串，不是响应式的</span><br><span class="line">  let tel = &#x27;13888888888&#x27;</span><br><span class="line"></span><br><span class="line">  function changeName()&#123;</span><br><span class="line">    // JS中操作ref对象时候需要.value</span><br><span class="line">    name.value = &#x27;李四&#x27;</span><br><span class="line">    console.log(name.value)</span><br><span class="line"></span><br><span class="line">    // 注意：name不是响应式的，name.value是响应式的，所以如下代码并不会引起页面的更新。</span><br><span class="line">    // name = ref(&#x27;zhang-san&#x27;)</span><br><span class="line">  &#125;</span><br><span class="line">  function changeAge()&#123;</span><br><span class="line">    // JS中操作ref对象时候需要.value</span><br><span class="line">    age.value += 1 </span><br><span class="line">    console.log(age.value)</span><br><span class="line">  &#125;</span><br><span class="line">  function showTel()&#123;</span><br><span class="line">    alert(tel)</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="3-4-【reactive-创建：对象类型的响应式数据】"><a href="#3-4-【reactive-创建：对象类型的响应式数据】" class="headerlink" title="3.4. 【reactive 创建：对象类型的响应式数据】"></a>3.4. 【reactive 创建：对象类型的响应式数据】</h2><ul><li><strong>作用：</strong>定义一个<strong>响应式对象</strong>（基本类型不要用它，要用<code>ref</code>，否则报错）</li><li><strong>语法：</strong><code>let 响应式对象= reactive(源对象)</code>。</li><li><strong>返回值：</strong>一个<code>Proxy</code>的实例对象，简称：响应式对象。</li><li><strong>注意点：</strong><code>reactive</code>定义的响应式数据是“深层次”的。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h2&gt;汽车信息：一台&#123;&#123; car.brand &#125;&#125;汽车，价值&#123;&#123; car.price &#125;&#125;万&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;游戏列表：&lt;/h2&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;g in games&quot; :key=&quot;g.id&quot;&gt;&#123;&#123; g.name &#125;&#125;&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;h2&gt;测试：&#123;&#123;obj.a.b.c.d&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeCarPrice&quot;&gt;修改汽车价格&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeFirstGame&quot;&gt;修改第一游戏&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;test&quot;&gt;测试&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">import &#123; reactive &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 数据</span><br><span class="line">let car = reactive(&#123; brand: &#x27;奔驰&#x27;, price: 100 &#125;)</span><br><span class="line">let games = reactive([</span><br><span class="line">  &#123; id: &#x27;ahsgdyfa01&#x27;, name: &#x27;英雄联盟&#x27; &#125;,</span><br><span class="line">  &#123; id: &#x27;ahsgdyfa02&#x27;, name: &#x27;王者荣耀&#x27; &#125;,</span><br><span class="line">  &#123; id: &#x27;ahsgdyfa03&#x27;, name: &#x27;原神&#x27; &#125;</span><br><span class="line">])</span><br><span class="line">let obj = reactive(&#123;</span><br><span class="line">  a:&#123;</span><br><span class="line">    b:&#123;</span><br><span class="line">      c:&#123;</span><br><span class="line">        d:666</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">function changeCarPrice() &#123;</span><br><span class="line">  car.price += 10</span><br><span class="line">&#125;</span><br><span class="line">function changeFirstGame() &#123;</span><br><span class="line">  games[0].name = &#x27;流星蝴蝶剑&#x27;</span><br><span class="line">&#125;</span><br><span class="line">function test()&#123;</span><br><span class="line">  obj.a.b.c.d = 999</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="3-5-【ref-创建：对象类型的响应式数据】"><a href="#3-5-【ref-创建：对象类型的响应式数据】" class="headerlink" title="3.5. 【ref 创建：对象类型的响应式数据】"></a>3.5. 【ref 创建：对象类型的响应式数据】</h2><ul><li>其实<code>ref</code>接收的数据可以是：<strong>基本类型</strong>、<strong>对象类型</strong>。</li><li>若<code>ref</code>接收的是对象类型，内部其实也是调用了<code>reactive</code>函数。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h2&gt;汽车信息：一台&#123;&#123; car.brand &#125;&#125;汽车，价值&#123;&#123; car.price &#125;&#125;万&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;游戏列表：&lt;/h2&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;g in games&quot; :key=&quot;g.id&quot;&gt;&#123;&#123; g.name &#125;&#125;&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;h2&gt;测试：&#123;&#123;obj.a.b.c.d&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeCarPrice&quot;&gt;修改汽车价格&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeFirstGame&quot;&gt;修改第一游戏&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;test&quot;&gt;测试&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 数据</span><br><span class="line">let car = ref(&#123; brand: &#x27;奔驰&#x27;, price: 100 &#125;)</span><br><span class="line">let games = ref([</span><br><span class="line">  &#123; id: &#x27;ahsgdyfa01&#x27;, name: &#x27;英雄联盟&#x27; &#125;,</span><br><span class="line">  &#123; id: &#x27;ahsgdyfa02&#x27;, name: &#x27;王者荣耀&#x27; &#125;,</span><br><span class="line">  &#123; id: &#x27;ahsgdyfa03&#x27;, name: &#x27;原神&#x27; &#125;</span><br><span class="line">])</span><br><span class="line">let obj = ref(&#123;</span><br><span class="line">  a:&#123;</span><br><span class="line">    b:&#123;</span><br><span class="line">      c:&#123;</span><br><span class="line">        d:666</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">console.log(car)</span><br><span class="line"></span><br><span class="line">function changeCarPrice() &#123;</span><br><span class="line">  car.value.price += 10</span><br><span class="line">&#125;</span><br><span class="line">function changeFirstGame() &#123;</span><br><span class="line">  games.value[0].name = &#x27;流星蝴蝶剑&#x27;</span><br><span class="line">&#125;</span><br><span class="line">function test()&#123;</span><br><span class="line">  obj.value.a.b.c.d = 999</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="3-6-【ref-对比-reactive】"><a href="#3-6-【ref-对比-reactive】" class="headerlink" title="3.6. 【ref 对比 reactive】"></a>3.6. 【ref 对比 reactive】</h2><p>宏观角度看：</p><blockquote><ol><li><p><code>ref</code>用来定义：<strong>基本类型数据</strong>、<strong>对象类型数据</strong>；</p></li><li><p><code>reactive</code>用来定义：<strong>对象类型数据</strong>。</p></li></ol></blockquote><ul><li>区别：</li></ul><blockquote><ol><li><p><code>ref</code>创建的变量必须使用<code>.value</code>（可以使用<code>volar</code>插件自动添加<code>.value</code>）。</p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/自动补充value.png" alt="自动补充value" style="zoom:50%;border-radius:20px" /> </li><li><p><code>reactive</code>重新分配一个新对象，会<strong>失去</strong>响应式（可以使用<code>Object.assign</code>去整体替换）。</p></li></ol></blockquote><ul><li>使用原则：</li></ul><blockquote><ol><li>若需要一个基本类型的响应式数据，必须使用<code>ref</code>。</li><li>若需要一个响应式对象，层级不深，<code>ref</code>、<code>reactive</code>都可以。</li><li>若需要一个响应式对象，且层级较深，推荐使用<code>reactive</code>。</li></ol></blockquote><h2 id="3-7-【toRefs-与-toRef】"><a href="#3-7-【toRefs-与-toRef】" class="headerlink" title="3.7. 【toRefs 与 toRef】"></a>3.7. 【toRefs 与 toRef】</h2><ul><li>作用：将一个响应式对象中的每一个属性，转换为<code>ref</code>对象。</li><li>备注：<code>toRefs</code>与<code>toRef</code>功能一致，但<code>toRefs</code>可以批量转换。</li><li>语法如下：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123;person.name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123;person.age&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;性别：&#123;&#123;person.gender&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;修改年龄&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeGender&quot;&gt;修改性别&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;ref,reactive,toRefs,toRef&#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">  // 数据</span><br><span class="line">  let person = reactive(&#123;name:&#x27;张三&#x27;, age:18, gender:&#x27;男&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">  // 通过toRefs将person对象中的n个属性批量取出，且依然保持响应式的能力</span><br><span class="line">  let &#123;name,gender&#125; =  toRefs(person)</span><br><span class="line"></span><br><span class="line">  // 通过toRef将person对象中的gender属性取出，且依然保持响应式的能力</span><br><span class="line">  let age = toRef(person,&#x27;age&#x27;)</span><br><span class="line"></span><br><span class="line">  // 方法</span><br><span class="line">  function changeName()&#123;</span><br><span class="line">    name.value += &#x27;~&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeAge()&#123;</span><br><span class="line">    age.value += 1</span><br><span class="line">  &#125;</span><br><span class="line">  function changeGender()&#123;</span><br><span class="line">    gender.value = &#x27;女&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="3-8-【computed】"><a href="#3-8-【computed】" class="headerlink" title="3.8. 【computed】"></a>3.8. 【computed】</h2><p>作用：根据已有数据计算出新数据（和<code>Vue2</code>中的<code>computed</code>作用一致）。</p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/computed.gif" style="zoom:20%;" />  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    姓：&lt;input type=&quot;text&quot; v-model=&quot;firstName&quot;&gt; &lt;br&gt;</span><br><span class="line">    名：&lt;input type=&quot;text&quot; v-model=&quot;lastName&quot;&gt; &lt;br&gt;</span><br><span class="line">    全名：&lt;span&gt;&#123;&#123;fullName&#125;&#125;&lt;/span&gt; &lt;br&gt;</span><br><span class="line">    &lt;button @click=&quot;changeFullName&quot;&gt;全名改为：li-si&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;App&quot;&gt;</span><br><span class="line">  import &#123;ref,computed&#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">  let firstName = ref(&#x27;zhang&#x27;)</span><br><span class="line">  let lastName = ref(&#x27;san&#x27;)</span><br><span class="line"></span><br><span class="line">  // 计算属性——只读取，不修改</span><br><span class="line">  /* let fullName = computed(()=&gt;&#123;</span><br><span class="line">    return firstName.value + &#x27;-&#x27; + lastName.value</span><br><span class="line">  &#125;) */</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  // 计算属性——既读取又修改</span><br><span class="line">  let fullName = computed(&#123;</span><br><span class="line">    // 读取</span><br><span class="line">    get()&#123;</span><br><span class="line">      return firstName.value + &#x27;-&#x27; + lastName.value</span><br><span class="line">    &#125;,</span><br><span class="line">    // 修改</span><br><span class="line">    set(val)&#123;</span><br><span class="line">      console.log(&#x27;有人修改了fullName&#x27;,val)</span><br><span class="line">      firstName.value = val.split(&#x27;-&#x27;)[0]</span><br><span class="line">      lastName.value = val.split(&#x27;-&#x27;)[1]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  function changeFullName()&#123;</span><br><span class="line">    fullName.value = &#x27;li-si&#x27;</span><br><span class="line">  &#125; </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="3-9-【watch】"><a href="#3-9-【watch】" class="headerlink" title="3.9.【watch】"></a>3.9.【watch】</h2><ul><li>作用：监视数据的变化（和<code>Vue2</code>中的<code>watch</code>作用一致）</li><li>特点：<code>Vue3</code>中的<code>watch</code>只能监视以下<strong>四种数据</strong>：</li></ul><blockquote><ol><li><code>ref</code>定义的数据。</li><li><code>reactive</code>定义的数据。</li><li>函数返回一个值（<code>getter</code>函数）。</li><li>一个包含上述内容的数组。</li></ol></blockquote><p>我们在<code>Vue3</code>中使用<code>watch</code>的时候，通常会遇到以下几种情况：</p><h3 id="情况一"><a href="#情况一" class="headerlink" title="* 情况一"></a>* 情况一</h3><p>监视<code>ref</code>定义的【基本类型】数据：直接写数据名即可，监视的是其<code>value</code>值的改变。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h1&gt;情况一：监视【ref】定义的【基本类型】数据&lt;/h1&gt;</span><br><span class="line">    &lt;h2&gt;当前求和为：&#123;&#123;sum&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeSum&quot;&gt;点我sum+1&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;ref,watch&#125; from &#x27;vue&#x27;</span><br><span class="line">  // 数据</span><br><span class="line">  let sum = ref(0)</span><br><span class="line">  // 方法</span><br><span class="line">  function changeSum()&#123;</span><br><span class="line">    sum.value += 1</span><br><span class="line">  &#125;</span><br><span class="line">  // 监视，情况一：监视【ref】定义的【基本类型】数据</span><br><span class="line">  const stopWatch = watch(sum,(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;sum变化了&#x27;,newValue,oldValue)</span><br><span class="line">    if(newValue &gt;= 10)&#123;</span><br><span class="line">      stopWatch()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="情况二"><a href="#情况二" class="headerlink" title="* 情况二"></a>* 情况二</h3><p>监视<code>ref</code>定义的【对象类型】数据：直接写数据名，监视的是对象的【地址值】，若想监视对象内部的数据，要手动开启深度监视。</p><blockquote><p>注意：</p><ul><li><p>若修改的是<code>ref</code>定义的对象中的属性，<code>newValue</code> 和 <code>oldValue</code> 都是新值，因为它们是同一个对象。</p></li><li><p>若修改整个<code>ref</code>定义的对象，<code>newValue</code> 是新值， <code>oldValue</code> 是旧值，因为不是同一个对象了。</p></li></ul></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h1&gt;情况二：监视【ref】定义的【对象类型】数据&lt;/h1&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123; person.name &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123; person.age &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;修改年龄&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changePerson&quot;&gt;修改整个人&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;ref,watch&#125; from &#x27;vue&#x27;</span><br><span class="line">  // 数据</span><br><span class="line">  let person = ref(&#123;</span><br><span class="line">    name:&#x27;张三&#x27;,</span><br><span class="line">    age:18</span><br><span class="line">  &#125;)</span><br><span class="line">  // 方法</span><br><span class="line">  function changeName()&#123;</span><br><span class="line">    person.value.name += &#x27;~&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeAge()&#123;</span><br><span class="line">    person.value.age += 1</span><br><span class="line">  &#125;</span><br><span class="line">  function changePerson()&#123;</span><br><span class="line">    person.value = &#123;name:&#x27;李四&#x27;,age:90&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  /* </span><br><span class="line">    监视，情况一：监视【ref】定义的【对象类型】数据，监视的是对象的地址值，若想监视对象内部属性的变化，需要手动开启深度监视</span><br><span class="line">    watch的第一个参数是：被监视的数据</span><br><span class="line">    watch的第二个参数是：监视的回调</span><br><span class="line">    watch的第三个参数是：配置对象（deep、immediate等等.....） </span><br><span class="line">  */</span><br><span class="line">  watch(person,(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;person变化了&#x27;,newValue,oldValue)</span><br><span class="line">  &#125;,&#123;deep:true&#125;)</span><br><span class="line">  </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="情况三"><a href="#情况三" class="headerlink" title="*  情况三"></a>*  情况三</h3><p>监视<code>reactive</code>定义的【对象类型】数据，且默认开启了深度监视。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h1&gt;情况三：监视【reactive】定义的【对象类型】数据&lt;/h1&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123; person.name &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123; person.age &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;修改年龄&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changePerson&quot;&gt;修改整个人&lt;/button&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;h2&gt;测试：&#123;&#123;obj.a.b.c&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;test&quot;&gt;修改obj.a.b.c&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;reactive,watch&#125; from &#x27;vue&#x27;</span><br><span class="line">  // 数据</span><br><span class="line">  let person = reactive(&#123;</span><br><span class="line">    name:&#x27;张三&#x27;,</span><br><span class="line">    age:18</span><br><span class="line">  &#125;)</span><br><span class="line">  let obj = reactive(&#123;</span><br><span class="line">    a:&#123;</span><br><span class="line">      b:&#123;</span><br><span class="line">        c:666</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  // 方法</span><br><span class="line">  function changeName()&#123;</span><br><span class="line">    person.name += &#x27;~&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeAge()&#123;</span><br><span class="line">    person.age += 1</span><br><span class="line">  &#125;</span><br><span class="line">  function changePerson()&#123;</span><br><span class="line">    Object.assign(person,&#123;name:&#x27;李四&#x27;,age:80&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  function test()&#123;</span><br><span class="line">    obj.a.b.c = 888</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 监视，情况三：监视【reactive】定义的【对象类型】数据，且默认是开启深度监视的</span><br><span class="line">  watch(person,(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;person变化了&#x27;,newValue,oldValue)</span><br><span class="line">  &#125;)</span><br><span class="line">  watch(obj,(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;Obj变化了&#x27;,newValue,oldValue)</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="情况四"><a href="#情况四" class="headerlink" title="* 情况四"></a>* 情况四</h3><p>监视<code>ref</code>或<code>reactive</code>定义的【对象类型】数据中的<strong>某个属性</strong>，注意点如下：</p><ol><li>若该属性值<strong>不是</strong>【对象类型】，需要写成函数形式。</li><li>若该属性值是<strong>依然</strong>是【对象类型】，可直接编，也可写成函数，建议写成函数。</li></ol><p>结论：监视的要是对象里的属性，那么最好写函数式，注意点：若是对象监视的是地址值，需要关注对象内部，需要手动开启深度监视。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h1&gt;情况四：监视【ref】或【reactive】定义的【对象类型】数据中的某个属性&lt;/h1&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123; person.name &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123; person.age &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;汽车：&#123;&#123; person.car.c1 &#125;&#125;、&#123;&#123; person.car.c2 &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;修改年龄&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeC1&quot;&gt;修改第一台车&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeC2&quot;&gt;修改第二台车&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeCar&quot;&gt;修改整个车&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;reactive,watch&#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">  // 数据</span><br><span class="line">  let person = reactive(&#123;</span><br><span class="line">    name:&#x27;张三&#x27;,</span><br><span class="line">    age:18,</span><br><span class="line">    car:&#123;</span><br><span class="line">      c1:&#x27;奔驰&#x27;,</span><br><span class="line">      c2:&#x27;宝马&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  // 方法</span><br><span class="line">  function changeName()&#123;</span><br><span class="line">    person.name += &#x27;~&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeAge()&#123;</span><br><span class="line">    person.age += 1</span><br><span class="line">  &#125;</span><br><span class="line">  function changeC1()&#123;</span><br><span class="line">    person.car.c1 = &#x27;奥迪&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeC2()&#123;</span><br><span class="line">    person.car.c2 = &#x27;大众&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeCar()&#123;</span><br><span class="line">    person.car = &#123;c1:&#x27;雅迪&#x27;,c2:&#x27;爱玛&#x27;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 监视，情况四：监视响应式对象中的某个属性，且该属性是基本类型的，要写成函数式</span><br><span class="line">  /* watch(()=&gt; person.name,(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;person.name变化了&#x27;,newValue,oldValue)</span><br><span class="line">  &#125;) */</span><br><span class="line"></span><br><span class="line">  // 监视，情况四：监视响应式对象中的某个属性，且该属性是对象类型的，可以直接写，也能写函数，更推荐写函数</span><br><span class="line">  watch(()=&gt;person.car,(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;person.car变化了&#x27;,newValue,oldValue)</span><br><span class="line">  &#125;,&#123;deep:true&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="情况五"><a href="#情况五" class="headerlink" title="* 情况五"></a>* 情况五</h3><p>监视上述的多个数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h1&gt;情况五：监视上述的多个数据&lt;/h1&gt;</span><br><span class="line">    &lt;h2&gt;姓名：&#123;&#123; person.name &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;年龄：&#123;&#123; person.age &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;汽车：&#123;&#123; person.car.c1 &#125;&#125;、&#123;&#123; person.car.c2 &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeName&quot;&gt;修改名字&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeAge&quot;&gt;修改年龄&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeC1&quot;&gt;修改第一台车&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeC2&quot;&gt;修改第二台车&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeCar&quot;&gt;修改整个车&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;reactive,watch&#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">  // 数据</span><br><span class="line">  let person = reactive(&#123;</span><br><span class="line">    name:&#x27;张三&#x27;,</span><br><span class="line">    age:18,</span><br><span class="line">    car:&#123;</span><br><span class="line">      c1:&#x27;奔驰&#x27;,</span><br><span class="line">      c2:&#x27;宝马&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  // 方法</span><br><span class="line">  function changeName()&#123;</span><br><span class="line">    person.name += &#x27;~&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeAge()&#123;</span><br><span class="line">    person.age += 1</span><br><span class="line">  &#125;</span><br><span class="line">  function changeC1()&#123;</span><br><span class="line">    person.car.c1 = &#x27;奥迪&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeC2()&#123;</span><br><span class="line">    person.car.c2 = &#x27;大众&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  function changeCar()&#123;</span><br><span class="line">    person.car = &#123;c1:&#x27;雅迪&#x27;,c2:&#x27;爱玛&#x27;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 监视，情况五：监视上述的多个数据</span><br><span class="line">  watch([()=&gt;person.name,person.car],(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;person.car变化了&#x27;,newValue,oldValue)</span><br><span class="line">  &#125;,&#123;deep:true&#125;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="3-10-【watchEffect】"><a href="#3-10-【watchEffect】" class="headerlink" title="3.10. 【watchEffect】"></a>3.10. 【watchEffect】</h2><ul><li><p>官网：立即运行一个函数，同时响应式地追踪其依赖，并在依赖更改时重新执行该函数。</p></li><li><p><code>watch</code>对比<code>watchEffect</code></p><blockquote><ol><li><p>都能监听响应式数据的变化，不同的是监听数据变化的方式不同</p></li><li><p><code>watch</code>：要明确指出监视的数据</p></li><li><p><code>watchEffect</code>：不用明确指出监视的数据（函数中用到哪些属性，那就监视哪些属性）。</p></li></ol></blockquote></li><li><p>示例代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h1&gt;需求：水温达到50℃，或水位达到20cm，则联系服务器&lt;/h1&gt;</span><br><span class="line">    &lt;h2 id=&quot;demo&quot;&gt;水温：&#123;&#123;temp&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;水位：&#123;&#123;height&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changePrice&quot;&gt;水温+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;changeSum&quot;&gt;水位+10&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;ref,watch,watchEffect&#125; from &#x27;vue&#x27;</span><br><span class="line">  // 数据</span><br><span class="line">  let temp = ref(0)</span><br><span class="line">  let height = ref(0)</span><br><span class="line"></span><br><span class="line">  // 方法</span><br><span class="line">  function changePrice()&#123;</span><br><span class="line">    temp.value += 10</span><br><span class="line">  &#125;</span><br><span class="line">  function changeSum()&#123;</span><br><span class="line">    height.value += 1</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 用watch实现，需要明确的指出要监视：temp、height</span><br><span class="line">  watch([temp,height],(value)=&gt;&#123;</span><br><span class="line">    // 从value中获取最新的temp值、height值</span><br><span class="line">    const [newTemp,newHeight] = value</span><br><span class="line">    // 室温达到50℃，或水位达到20cm，立刻联系服务器</span><br><span class="line">    if(newTemp &gt;= 50 || newHeight &gt;= 20)&#123;</span><br><span class="line">      console.log(&#x27;联系服务器&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  // 用watchEffect实现，不用</span><br><span class="line">  const stopWtach = watchEffect(()=&gt;&#123;</span><br><span class="line">    // 室温达到50℃，或水位达到20cm，立刻联系服务器</span><br><span class="line">    if(temp.value &gt;= 50 || height.value &gt;= 20)&#123;</span><br><span class="line">      console.log(document.getElementById(&#x27;demo&#x27;)?.innerText)</span><br><span class="line">      console.log(&#x27;联系服务器&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">    // 水温达到100，或水位达到50，取消监视</span><br><span class="line">    if(temp.value === 100 || height.value === 50)&#123;</span><br><span class="line">      console.log(&#x27;清理了&#x27;)</span><br><span class="line">      stopWtach()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-11-【标签的-ref-属性】"><a href="#3-11-【标签的-ref-属性】" class="headerlink" title="3.11. 【标签的 ref 属性】"></a>3.11. 【标签的 ref 属性】</h2><p>作用：用于注册模板引用。</p><blockquote><ul><li><p>用在普通<code>DOM</code>标签上，获取的是<code>DOM</code>节点。</p></li><li><p>用在组件标签上，获取的是组件实例对象。</p></li></ul></blockquote><p>用在普通<code>DOM</code>标签上：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h1 ref=&quot;title1&quot;&gt;尚硅谷&lt;/h1&gt;</span><br><span class="line">    &lt;h2 ref=&quot;title2&quot;&gt;前端&lt;/h2&gt;</span><br><span class="line">    &lt;h3 ref=&quot;title3&quot;&gt;Vue&lt;/h3&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; ref=&quot;inpt&quot;&gt; &lt;br&gt;&lt;br&gt;</span><br><span class="line">    &lt;button @click=&quot;showLog&quot;&gt;点我打印内容&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;ref&#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">  let title1 = ref()</span><br><span class="line">  let title2 = ref()</span><br><span class="line">  let title3 = ref()</span><br><span class="line"></span><br><span class="line">  function showLog()&#123;</span><br><span class="line">    // 通过id获取元素</span><br><span class="line">    const t1 = document.getElementById(&#x27;title1&#x27;)</span><br><span class="line">    // 打印内容</span><br><span class="line">    console.log((t1 as HTMLElement).innerText)</span><br><span class="line">    console.log((&lt;HTMLElement&gt;t1).innerText)</span><br><span class="line">    console.log(t1?.innerText)</span><br><span class="line">    </span><br><span class="line">/************************************/</span><br><span class="line"></span><br><span class="line">    // 通过ref获取元素</span><br><span class="line">    console.log(title1.value)</span><br><span class="line">    console.log(title2.value)</span><br><span class="line">    console.log(title3.value)</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>用在组件标签上：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 父组件App.vue --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Person ref=&quot;ren&quot;/&gt;</span><br><span class="line">  &lt;button @click=&quot;test&quot;&gt;测试&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;App&quot;&gt;</span><br><span class="line">  import Person from &#x27;./components/Person.vue&#x27;</span><br><span class="line">  import &#123;ref&#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">  let ren = ref()</span><br><span class="line"></span><br><span class="line">  function test()&#123;</span><br><span class="line">    console.log(ren.value.name)</span><br><span class="line">    console.log(ren.value.age)</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!-- 子组件Person.vue中要使用defineExpose暴露内容 --&gt;</span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123;ref,defineExpose&#125; from &#x27;vue&#x27;</span><br><span class="line">// 数据</span><br><span class="line">  let name = ref(&#x27;张三&#x27;)</span><br><span class="line">  let age = ref(18)</span><br><span class="line">  /****************************/</span><br><span class="line">  /****************************/</span><br><span class="line">  // 使用defineExpose将组件中的数据交给外部</span><br><span class="line">  defineExpose(&#123;name,age&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="3-12-【props】"><a href="#3-12-【props】" class="headerlink" title="3.12. 【props】"></a>3.12. 【props】</h2><blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个接口，限制每个Person对象的格式</span></span><br><span class="line"><span class="keyword">export</span> interface <span class="title class_">PersonInter</span> &#123;</span><br><span class="line"><span class="attr">id</span>:string,</span><br><span class="line"><span class="attr">name</span>:string,</span><br><span class="line"> <span class="attr">age</span>:number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个自定义类型Persons</span></span><br><span class="line"><span class="keyword">export</span> type <span class="title class_">Persons</span> = <span class="title class_">Array</span>&lt;<span class="title class_">PersonInter</span>&gt;</span><br></pre></td></tr></table></figure><p><code>App.vue</code>中代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;Person :list=&quot;persons&quot;/&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;App&quot;&gt;</span><br><span class="line">import Person from &#x27;./components/Person.vue&#x27;</span><br><span class="line">import &#123;reactive&#125; from &#x27;vue&#x27;</span><br><span class="line"> import &#123;type Persons&#125; from &#x27;./types&#x27;</span><br><span class="line"></span><br><span class="line"> let persons = reactive&lt;Persons&gt;([</span><br><span class="line">  &#123;id:&#x27;e98219e12&#x27;,name:&#x27;张三&#x27;,age:18&#125;,</span><br><span class="line">   &#123;id:&#x27;e98219e13&#x27;,name:&#x27;李四&#x27;,age:19&#125;,</span><br><span class="line">    &#123;id:&#x27;e98219e14&#x27;,name:&#x27;王五&#x27;,age:20&#125;</span><br><span class="line">  ])</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>Person.vue</code>中代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;person&quot;&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;li v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">     &#123;&#123;item.name&#125;&#125;--&#123;&#123;item.age&#125;&#125;</span><br><span class="line">   &lt;/li&gt;</span><br><span class="line"> &lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">import &#123;defineProps&#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123;type PersonInter&#125; from &#x27;@/types&#x27;</span><br><span class="line"></span><br><span class="line">// 第一种写法：仅接收</span><br><span class="line">// const props = defineProps([&#x27;list&#x27;])</span><br><span class="line"></span><br><span class="line">// 第二种写法：接收+限制类型</span><br><span class="line">// defineProps&lt;&#123;list:Persons&#125;&gt;()</span><br><span class="line"></span><br><span class="line">// 第三种写法：接收+限制类型+指定默认值+限制必要性</span><br><span class="line">let props = withDefaults(defineProps&lt;&#123;list?:Persons&#125;&gt;(),&#123;</span><br><span class="line">  list:()=&gt;[&#123;id:&#x27;asdasg01&#x27;,name:&#x27;小猪佩奇&#x27;,age:18&#125;]</span><br><span class="line">&#125;)</span><br><span class="line">console.log(props)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></blockquote><h2 id="3-13-【生命周期】"><a href="#3-13-【生命周期】" class="headerlink" title="3.13. 【生命周期】"></a>3.13. 【生命周期】</h2><ul><li><p>概念：<code>Vue</code>组件实例在创建时要经历一系列的初始化步骤，在此过程中<code>Vue</code>会在合适的时机，调用特定的函数，从而让开发者有机会在特定阶段运行自己的代码，这些特定的函数统称为：生命周期钩子</p></li><li><p>规律：</p><blockquote><p>生命周期整体分为四个阶段，分别是：<strong>创建、挂载、更新、销毁</strong>，每个阶段都有两个钩子，一前一后。</p></blockquote></li><li><p><code>Vue2</code>的生命周期</p><blockquote><p>创建阶段：<code>beforeCreate</code>、<code>created</code></p><p>挂载阶段：<code>beforeMount</code>、<code>mounted</code></p><p>更新阶段：<code>beforeUpdate</code>、<code>updated</code></p><p>销毁阶段：<code>beforeDestroy</code>、<code>destroyed</code></p></blockquote></li><li><p><code>Vue3</code>的生命周期</p><blockquote><p>创建阶段：<code>setup</code></p><p>挂载阶段：<code>onBeforeMount</code>、<code>onMounted</code></p><p>更新阶段：<code>onBeforeUpdate</code>、<code>onUpdated</code></p><p>卸载阶段：<code>onBeforeUnmount</code>、<code>onUnmounted</code></p></blockquote></li><li><p>常用的钩子：<code>onMounted</code>(挂载完毕)、<code>onUpdated</code>(更新完毕)、<code>onBeforeUnmount</code>(卸载之前)</p></li><li><p>示例代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">    &lt;h2&gt;当前求和为：&#123;&#123; sum &#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;button @click=&quot;changeSum&quot;&gt;点我sum+1&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- vue3写法 --&gt;</span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">  import &#123; </span><br><span class="line">    ref, </span><br><span class="line">    onBeforeMount, </span><br><span class="line">    onMounted, </span><br><span class="line">    onBeforeUpdate, </span><br><span class="line">    onUpdated, </span><br><span class="line">    onBeforeUnmount, </span><br><span class="line">    onUnmounted </span><br><span class="line">  &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">  // 数据</span><br><span class="line">  let sum = ref(0)</span><br><span class="line">  // 方法</span><br><span class="line">  function changeSum() &#123;</span><br><span class="line">    sum.value += 1</span><br><span class="line">  &#125;</span><br><span class="line">  console.log(&#x27;setup&#x27;)</span><br><span class="line">  // 生命周期钩子</span><br><span class="line">  onBeforeMount(()=&gt;&#123;</span><br><span class="line">    console.log(&#x27;挂载之前&#x27;)</span><br><span class="line">  &#125;)</span><br><span class="line">  onMounted(()=&gt;&#123;</span><br><span class="line">    console.log(&#x27;挂载完毕&#x27;)</span><br><span class="line">  &#125;)</span><br><span class="line">  onBeforeUpdate(()=&gt;&#123;</span><br><span class="line">    console.log(&#x27;更新之前&#x27;)</span><br><span class="line">  &#125;)</span><br><span class="line">  onUpdated(()=&gt;&#123;</span><br><span class="line">    console.log(&#x27;更新完毕&#x27;)</span><br><span class="line">  &#125;)</span><br><span class="line">  onBeforeUnmount(()=&gt;&#123;</span><br><span class="line">    console.log(&#x27;卸载之前&#x27;)</span><br><span class="line">  &#125;)</span><br><span class="line">  onUnmounted(()=&gt;&#123;</span><br><span class="line">    console.log(&#x27;卸载完毕&#x27;)</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-14-【自定义hook】"><a href="#3-14-【自定义hook】" class="headerlink" title="3.14. 【自定义hook】"></a>3.14. 【自定义hook】</h2><ul><li><p>什么是<code>hook</code>？—— 本质是一个函数，把<code>setup</code>函数中使用的<code>Composition API</code>进行了封装，类似于<code>vue2.x</code>中的<code>mixin</code>。</p></li><li><p>自定义<code>hook</code>的优势：复用代码, 让<code>setup</code>中的逻辑更清楚易懂。</p></li></ul><p>示例代码：</p><ul><li><p><code>useSum.ts</code>中内容如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;ref,onMounted&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    sum.<span class="property">value</span> += <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">decrement</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    sum.<span class="property">value</span> -= <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">increment</span>()</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//向外部暴露数据</span></span><br><span class="line">  <span class="keyword">return</span> &#123;sum,increment,decrement&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>useDog.ts</code>中内容如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;reactive,onMounted&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios,&#123;<span class="title class_">AxiosError</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> dogList = reactive&lt;string[]&gt;([])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getDog</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 发请求</span></span><br><span class="line">      <span class="keyword">let</span> &#123;data&#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://dog.ceo/api/breed/pembroke/images/random&#x27;</span>)</span><br><span class="line">      <span class="comment">// 维护数据</span></span><br><span class="line">      dogList.<span class="title function_">push</span>(data.<span class="property">message</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="comment">// 处理错误</span></span><br><span class="line">      <span class="keyword">const</span> err = &lt;<span class="title class_">AxiosError</span>&gt;error</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 挂载钩子</span></span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">getDog</span>()</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//向外部暴露数据</span></span><br><span class="line">  <span class="keyword">return</span> &#123;dogList,getDog&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>组件中具体使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;当前求和为：&#123;&#123;sum&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;button @click=&quot;increment&quot;&gt;点我+1&lt;/button&gt;</span><br><span class="line">  &lt;button @click=&quot;decrement&quot;&gt;点我-1&lt;/button&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;img v-for=&quot;(u,index) in dogList.urlList&quot; :key=&quot;index&quot; :src=&quot;(u as string)&quot;&gt; </span><br><span class="line">  &lt;span v-show=&quot;dogList.isLoading&quot;&gt;加载中......&lt;/span&gt;&lt;br&gt;</span><br><span class="line">  &lt;button @click=&quot;getDog&quot;&gt;再来一只狗&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">  import &#123;defineComponent&#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">  export default defineComponent(&#123;</span><br><span class="line">    name:&#x27;App&#x27;,</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">  import useSum from &#x27;./hooks/useSum&#x27;</span><br><span class="line">  import useDog from &#x27;./hooks/useDog&#x27;</span><br><span class="line"></span><br><span class="line">  let &#123;sum,increment,decrement&#125; = useSum()</span><br><span class="line">  let &#123;dogList,getDog&#125; = useDog()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ul><hr><h1 id="4-路由"><a href="#4-路由" class="headerlink" title="4. 路由"></a>4. 路由</h1><h2 id="4-1-【对路由的理解】"><a href="#4-1-【对路由的理解】" class="headerlink" title="4.1. 【对路由的理解】"></a>4.1. 【对路由的理解】</h2><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/image-20231018144351536.png" alt="image-20231018144351536" style="zoom:20%;border-radius:40px" /> <h2 id="4-2-【基本切换效果】"><a href="#4-2-【基本切换效果】" class="headerlink" title="4.2. 【基本切换效果】"></a>4.2. 【基本切换效果】</h2><ul><li><p><code>Vue3</code>中要使用<code>vue-router</code>的最新版本，目前是<code>4</code>版本。</p></li><li><p>路由配置文件代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter,createWebHistory&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/pages/Home.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">News</span> <span class="keyword">from</span> <span class="string">&#x27;@/pages/News.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&#x27;@/pages/About.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line"><span class="attr">history</span>:<span class="title function_">createWebHistory</span>(),</span><br><span class="line"><span class="attr">routes</span>:[</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line"><span class="attr">component</span>:<span class="title class_">Home</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">path</span>:<span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line"><span class="attr">component</span>:<span class="title class_">About</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure></li></ul><ul><li><p><code>main.ts</code>代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router/index&#x27;</span></span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure></li></ul><ul><li><p><code>App.vue</code>代码如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">    &lt;h2 class=&quot;title&quot;&gt;Vue路由测试&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 导航区 --&gt;</span><br><span class="line">    &lt;div class=&quot;navigate&quot;&gt;</span><br><span class="line">      &lt;RouterLink to=&quot;/home&quot; active-class=&quot;active&quot;&gt;首页&lt;/RouterLink&gt;</span><br><span class="line">      &lt;RouterLink to=&quot;/news&quot; active-class=&quot;active&quot;&gt;新闻&lt;/RouterLink&gt;</span><br><span class="line">      &lt;RouterLink to=&quot;/about&quot; active-class=&quot;active&quot;&gt;关于&lt;/RouterLink&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 展示区 --&gt;</span><br><span class="line">    &lt;div class=&quot;main-content&quot;&gt;</span><br><span class="line">      &lt;RouterView&gt;&lt;/RouterView&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;App&quot;&gt;</span><br><span class="line">  import &#123;RouterLink,RouterView&#125; from &#x27;vue-router&#x27;  </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ul><h2 id="4-3-【两个注意点】"><a href="#4-3-【两个注意点】" class="headerlink" title="4.3. 【两个注意点】"></a>4.3. 【两个注意点】</h2><blockquote><ol><li><p>路由组件通常存放在<code>pages</code> 或 <code>views</code>文件夹，一般组件通常存放在<code>components</code>文件夹。</p></li><li><p>通过点击导航，视觉效果上“消失” 了的路由组件，默认是被<strong>卸载</strong>掉的，需要的时候再去<strong>挂载</strong>。</p></li></ol></blockquote><h2 id="4-4-【路由器工作模式】"><a href="#4-4-【路由器工作模式】" class="headerlink" title="4.4.【路由器工作模式】"></a>4.4.【路由器工作模式】</h2><ol><li><p><code>history</code>模式</p><blockquote><p>优点：<code>URL</code>更加美观，不带有<code>#</code>，更接近传统的网站<code>URL</code>。</p><p>缺点：后期项目上线，需要服务端配合处理路径问题，否则刷新会有<code>404</code>错误。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line"><span class="attr">history</span>:<span class="title function_">createWebHistory</span>(), <span class="comment">//history模式</span></span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></blockquote></li><li><p><code>hash</code>模式</p><blockquote><p>优点：兼容性更好，因为不需要服务器端处理路径。</p><p>缺点：<code>URL</code>带有<code>#</code>不太美观，且在<code>SEO</code>优化方面相对较差。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line"><span class="attr">history</span>:<span class="title function_">createWebHashHistory</span>(), <span class="comment">//hash模式</span></span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></blockquote></li></ol><h2 id="4-5-【to的两种写法】"><a href="#4-5-【to的两种写法】" class="headerlink" title="4.5. 【to的两种写法】"></a>4.5. 【to的两种写法】</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 第一种：to的字符串写法 --&gt;</span><br><span class="line">&lt;router-link active-class=&quot;active&quot; to=&quot;/home&quot;&gt;主页&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 第二种：to的对象写法 --&gt;</span><br><span class="line">&lt;router-link active-class=&quot;active&quot; :to=&quot;&#123;path:&#x27;/home&#x27;&#125;&quot;&gt;Home&lt;/router-link&gt;</span><br></pre></td></tr></table></figure><h2 id="4-6-【命名路由】"><a href="#4-6-【命名路由】" class="headerlink" title="4.6. 【命名路由】"></a>4.6. 【命名路由】</h2><p>作用：可以简化路由跳转及传参（后面就讲）。</p><p>给路由规则命名：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">routes</span>:[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;zhuye&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>:<span class="title class_">Home</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;xinwen&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&#x27;/news&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>:<span class="title class_">News</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;guanyu&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>:<span class="title class_">About</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>跳转路由：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--简化前：需要写完整的路径（to的字符串写法） --&gt;</span><br><span class="line">&lt;router-link to=&quot;/news/detail&quot;&gt;跳转&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--简化后：直接通过名字跳转（to的对象写法配合name属性） --&gt;</span><br><span class="line">&lt;router-link :to=&quot;&#123;name:&#x27;guanyu&#x27;&#125;&quot;&gt;跳转&lt;/router-link&gt;</span><br></pre></td></tr></table></figure><h2 id="4-7-【嵌套路由】"><a href="#4-7-【嵌套路由】" class="headerlink" title="4.7. 【嵌套路由】"></a>4.7. 【嵌套路由】</h2><ol><li><p>编写<code>News</code>的子路由：<code>Detail.vue</code></p></li><li><p>配置路由规则，使用<code>children</code>配置项：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>:<span class="title function_">createWebHistory</span>(),</span><br><span class="line"><span class="attr">routes</span>:[</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">name</span>:<span class="string">&#x27;zhuye&#x27;</span>,</span><br><span class="line"><span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line"><span class="attr">component</span>:<span class="title class_">Home</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">name</span>:<span class="string">&#x27;xinwen&#x27;</span>,</span><br><span class="line"><span class="attr">path</span>:<span class="string">&#x27;/news&#x27;</span>,</span><br><span class="line"><span class="attr">component</span>:<span class="title class_">News</span>,</span><br><span class="line"><span class="attr">children</span>:[</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">name</span>:<span class="string">&#x27;xiang&#x27;</span>,</span><br><span class="line"><span class="attr">path</span>:<span class="string">&#x27;detail&#x27;</span>,</span><br><span class="line"><span class="attr">component</span>:<span class="title class_">Detail</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">name</span>:<span class="string">&#x27;guanyu&#x27;</span>,</span><br><span class="line"><span class="attr">path</span>:<span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line"><span class="attr">component</span>:<span class="title class_">About</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure></li><li><p>跳转路由（记得要加完整路径）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link to=&quot;/news/detail&quot;&gt;xxxx&lt;/router-link&gt;</span><br><span class="line">&lt;!-- 或 --&gt;</span><br><span class="line">&lt;router-link :to=&quot;&#123;path:&#x27;/news/detail&#x27;&#125;&quot;&gt;xxxx&lt;/router-link&gt;</span><br></pre></td></tr></table></figure></li><li><p>记得去<code>Home</code>组件中预留一个<code>&lt;router-view&gt;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;news&quot;&gt;</span><br><span class="line">    &lt;nav class=&quot;news-list&quot;&gt;</span><br><span class="line">      &lt;RouterLink v-for=&quot;news in newsList&quot; :key=&quot;news.id&quot; :to=&quot;&#123;path:&#x27;/news/detail&#x27;&#125;&quot;&gt;</span><br><span class="line">        &#123;&#123;news.name&#125;&#125;</span><br><span class="line">      &lt;/RouterLink&gt;</span><br><span class="line">    &lt;/nav&gt;</span><br><span class="line">    &lt;div class=&quot;news-detail&quot;&gt;</span><br><span class="line">      &lt;RouterView/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></li></ol><h2 id="4-8-【路由传参】"><a href="#4-8-【路由传参】" class="headerlink" title="4.8. 【路由传参】"></a>4.8. 【路由传参】</h2><h3 id="query参数"><a href="#query参数" class="headerlink" title="query参数"></a>query参数</h3><ol><li><p>传递参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 跳转并携带query参数（to的字符串写法） --&gt;</span><br><span class="line">&lt;router-link to=&quot;/news/detail?a=1&amp;b=2&amp;content=欢迎你&quot;&gt;</span><br><span class="line">跳转</span><br><span class="line">&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 跳转并携带query参数（to的对象写法） --&gt;</span><br><span class="line">&lt;RouterLink </span><br><span class="line">  :to=&quot;&#123;</span><br><span class="line">    //name:&#x27;xiang&#x27;, //用name也可以跳转</span><br><span class="line">    path:&#x27;/news/detail&#x27;,</span><br><span class="line">    query:&#123;</span><br><span class="line">      id:news.id,</span><br><span class="line">      title:news.title,</span><br><span class="line">      content:news.content</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;&quot;</span><br><span class="line">&gt;</span><br><span class="line">  &#123;&#123;news.title&#125;&#125;</span><br><span class="line">&lt;/RouterLink&gt;</span><br></pre></td></tr></table></figure></li><li><p>接收参数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useRoute&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span><br><span class="line"><span class="comment">// 打印query参数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(route.<span class="property">query</span>)</span><br></pre></td></tr></table></figure></li></ol><h3 id="params参数"><a href="#params参数" class="headerlink" title="params参数"></a>params参数</h3><ol><li><p>传递参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 跳转并携带params参数（to的字符串写法） --&gt;</span><br><span class="line">&lt;RouterLink :to=&quot;`/news/detail/001/新闻001/内容001`&quot;&gt;&#123;&#123;news.title&#125;&#125;&lt;/RouterLink&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 跳转并携带params参数（to的对象写法） --&gt;</span><br><span class="line">&lt;RouterLink </span><br><span class="line">  :to=&quot;&#123;</span><br><span class="line">    name:&#x27;xiang&#x27;, //用name跳转</span><br><span class="line">    params:&#123;</span><br><span class="line">      id:news.id,</span><br><span class="line">      title:news.title,</span><br><span class="line">      content:news.title</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;&quot;</span><br><span class="line">&gt;</span><br><span class="line">  &#123;&#123;news.title&#125;&#125;</span><br><span class="line">&lt;/RouterLink&gt;</span><br></pre></td></tr></table></figure></li><li><p>接收参数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useRoute&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span><br><span class="line"><span class="comment">// 打印params参数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(route.<span class="property">params</span>)</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>备注1：传递<code>params</code>参数时，若使用<code>to</code>的对象写法，必须使用<code>name</code>配置项，不能用<code>path</code>。</p><p>备注2：传递<code>params</code>参数时，需要提前在规则中占位。</p></blockquote><h2 id="4-9-【路由的props配置】"><a href="#4-9-【路由的props配置】" class="headerlink" title="4.9. 【路由的props配置】"></a>4.9. 【路由的props配置】</h2><p>作用：让路由组件更方便的收到参数（可以将路由参数作为<code>props</code>传给组件）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">name</span>:<span class="string">&#x27;xiang&#x27;</span>,</span><br><span class="line"><span class="attr">path</span>:<span class="string">&#x27;detail/:id/:title/:content&#x27;</span>,</span><br><span class="line"><span class="attr">component</span>:<span class="title class_">Detail</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// props的对象写法，作用：把对象中的每一组key-value作为props传给Detail组件</span></span><br><span class="line">  <span class="comment">// props:&#123;a:1,b:2,c:3&#125;, </span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// props的布尔值写法，作用：把收到了每一组params参数，作为props传给Detail组件</span></span><br><span class="line">  <span class="comment">// props:true</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// props的函数写法，作用：把返回的对象中每一组key-value作为props传给Detail组件</span></span><br><span class="line">  <span class="title function_">props</span>(<span class="params">route</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> route.<span class="property">query</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-10-【-replace属性】"><a href="#4-10-【-replace属性】" class="headerlink" title="4.10. 【 replace属性】"></a>4.10. 【 replace属性】</h2><ol><li><p>作用：控制路由跳转时操作浏览器历史记录的模式。</p></li><li><p>浏览器的历史记录有两种写入方式：分别为<code>push</code>和<code>replace</code>：</p><ul><li><code>push</code>是追加历史记录（默认值）。</li><li><code>replace</code>是替换当前记录。</li></ul></li><li><p>开启<code>replace</code>模式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;RouterLink replace .......&gt;News&lt;/RouterLink&gt;</span><br></pre></td></tr></table></figure></li></ol><h2 id="4-11-【编程式导航】"><a href="#4-11-【编程式导航】" class="headerlink" title="4.11. 【编程式导航】"></a>4.11. 【编程式导航】</h2><p>路由组件的两个重要的属性：<code>$route</code>和<code>$router</code>变成了两个<code>hooks</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useRoute,useRouter&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(route.<span class="property">query</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(route.<span class="property">parmas</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(router.<span class="property">push</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(router.<span class="property">replace</span>)</span><br></pre></td></tr></table></figure><h2 id="4-12-【重定向】"><a href="#4-12-【重定向】" class="headerlink" title="4.12. 【重定向】"></a>4.12. 【重定向】</h2><ol><li><p>作用：将特定的路径，重新定向到已有路由。</p></li><li><p>具体编码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">redirect</span>:<span class="string">&#x27;/about&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="5-pinia"><a href="#5-pinia" class="headerlink" title="5. pinia"></a>5. pinia</h1><h2 id="5-1【准备一个效果】"><a href="#5-1【准备一个效果】" class="headerlink" title="5.1【准备一个效果】"></a>5.1【准备一个效果】</h2><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/pinia_example.gif" alt="pinia_example" style="zoom:30%;border:3px solid" /> <h2 id="5-2【搭建-pinia-环境】"><a href="#5-2【搭建-pinia-环境】" class="headerlink" title="5.2【搭建 pinia 环境】"></a>5.2【搭建 pinia 环境】</h2><p>第一步：<code>npm install pinia</code></p><p>第二步：操作<code>src/main.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 引入createPinia，用于创建pinia */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 创建pinia */</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 使用插件 */</span>&#123;&#125;</span><br><span class="line">app.<span class="title function_">use</span>(pinia)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><p>此时开发者工具中已经有了<code>pinia</code>选项</p><img src="https://cdn.nlark.com/yuque/0/2023/png/35780599/1684309952481-c67f67f9-d1a3-4d69-8bd6-2b381e003f31.png" style="zoom:80%;border:1px solid black;border-radius:10px" /><h2 id="5-3【存储-读取数据】"><a href="#5-3【存储-读取数据】" class="headerlink" title="5.3【存储+读取数据】"></a>5.3【存储+读取数据】</h2><ol><li><p><code>Store</code>是一个保存：<strong>状态</strong>、<strong>业务逻辑</strong> 的实体，每个组件都可以<strong>读取</strong>、<strong>写入</strong>它。</p></li><li><p>它有三个概念：<code>state</code>、<code>getter</code>、<code>action</code>，相当于组件中的： <code>data</code>、 <code>computed</code> 和 <code>methods</code>。</p></li><li><p>具体编码：<code>src/store/count.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入defineStore用于创建store</span></span><br><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义并暴露一个store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCountStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;count&#x27;</span>,&#123;</span><br><span class="line">  <span class="comment">// 动作</span></span><br><span class="line">  <span class="attr">actions</span>:&#123;&#125;,</span><br><span class="line">  <span class="comment">// 状态</span></span><br><span class="line">  <span class="title function_">state</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">sum</span>:<span class="number">6</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 计算</span></span><br><span class="line">  <span class="attr">getters</span>:&#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>具体编码：<code>src/store/talk.ts</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入defineStore用于创建store</span></span><br><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义并暴露一个store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTalkStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;talk&#x27;</span>,&#123;</span><br><span class="line">  <span class="comment">// 动作</span></span><br><span class="line">  <span class="attr">actions</span>:&#123;&#125;,</span><br><span class="line">  <span class="comment">// 状态</span></span><br><span class="line">  <span class="title function_">state</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">talkList</span>:[</span><br><span class="line">        &#123;<span class="attr">id</span>:<span class="string">&#x27;yuysada01&#x27;</span>,<span class="attr">content</span>:<span class="string">&#x27;你今天有点怪，哪里怪？怪好看的！&#x27;</span>&#125;,</span><br><span class="line">     &#123;<span class="attr">id</span>:<span class="string">&#x27;yuysada02&#x27;</span>,<span class="attr">content</span>:<span class="string">&#x27;草莓、蓝莓、蔓越莓，你想我了没？&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">id</span>:<span class="string">&#x27;yuysada03&#x27;</span>,<span class="attr">content</span>:<span class="string">&#x27;心里给你留了一块地，我的死心塌地&#x27;</span>&#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 计算</span></span><br><span class="line">  <span class="attr">getters</span>:&#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>组件中使用<code>state</code>中的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;当前求和为：&#123;&#123; sumStore.sum &#125;&#125;&lt;/h2&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Count&quot;&gt;</span><br><span class="line">  // 引入对应的useXxxxxStore</span><br><span class="line">  import &#123;useSumStore&#125; from &#x27;@/store/sum&#x27;</span><br><span class="line">  </span><br><span class="line">  // 调用useXxxxxStore得到对应的store</span><br><span class="line">  const sumStore = useSumStore()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li v-for=&quot;talk in talkStore.talkList&quot; :key=&quot;talk.id&quot;&gt;</span><br><span class="line">      &#123;&#123; talk.content &#125;&#125;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Count&quot;&gt;</span><br><span class="line">  import axios from &#x27;axios&#x27;</span><br><span class="line">  import &#123;useTalkStore&#125; from &#x27;@/store/talk&#x27;</span><br><span class="line"></span><br><span class="line">  const talkStore = useTalkStore()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ol><h2 id="5-4-【修改数据】-三种方式"><a href="#5-4-【修改数据】-三种方式" class="headerlink" title="5.4.【修改数据】(三种方式)"></a>5.4.【修改数据】(三种方式)</h2><ol><li><p>第一种修改方式，直接修改</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">countStore.<span class="property">sum</span> = <span class="number">666</span></span><br></pre></td></tr></table></figure></li><li><p>第二种修改方式：批量修改</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">countStore.$patch(&#123;</span><br><span class="line">  <span class="attr">sum</span>:<span class="number">999</span>,</span><br><span class="line">  <span class="attr">school</span>:<span class="string">&#x27;atguigu&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>第三种修改方式：借助<code>action</code>修改（<code>action</code>中可以编写一些业务逻辑）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCountStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;count&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">/*************/</span></span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="comment">//加</span></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">value:number</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">sum</span> &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="comment">//操作countStore中的sum</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sum</span> += value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//减</span></span><br><span class="line">    <span class="title function_">decrement</span>(<span class="params">value:number</span>)&#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">sum</span> &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sum</span> -= value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/*************/</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>组件中调用<code>action</code>即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用countStore</span></span><br><span class="line"><span class="keyword">const</span> countStore = <span class="title function_">useCountStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用对应action</span></span><br><span class="line">countStore.<span class="title function_">incrementOdd</span>(n.<span class="property">value</span>)</span><br></pre></td></tr></table></figure></li></ol><h2 id="5-5-【storeToRefs】"><a href="#5-5-【storeToRefs】" class="headerlink" title="5.5.【storeToRefs】"></a>5.5.【storeToRefs】</h2><ul><li>借助<code>storeToRefs</code>将<code>store</code>中的数据转为<code>ref</code>对象，方便在模板中使用。</li><li>注意：<code>pinia</code>提供的<code>storeToRefs</code>只会将数据做转换，而<code>Vue</code>的<code>toRefs</code>会转换<code>store</code>中数据。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;count&quot;&gt;</span><br><span class="line">&lt;h2&gt;当前求和为：&#123;&#123;sum&#125;&#125;&lt;/h2&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Count&quot;&gt;</span><br><span class="line">  import &#123; useCountStore &#125; from &#x27;@/store/count&#x27;</span><br><span class="line">  /* 引入storeToRefs */</span><br><span class="line">  import &#123; storeToRefs &#125; from &#x27;pinia&#x27;</span><br><span class="line"></span><br><span class="line">/* 得到countStore */</span><br><span class="line">  const countStore = useCountStore()</span><br><span class="line">  /* 使用storeToRefs转换countStore，随后解构 */</span><br><span class="line">  const &#123;sum&#125; = storeToRefs(countStore)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="5-6-【getters】"><a href="#5-6-【getters】" class="headerlink" title="5.6.【getters】"></a>5.6.【getters】</h2><ol><li><p>概念：当<code>state</code>中的数据，需要经过处理后再使用时，可以使用<code>getters</code>配置。</p></li><li><p>追加<code>getters</code>配置。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入defineStore用于创建store</span></span><br><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义并暴露一个store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCountStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;count&#x27;</span>,&#123;</span><br><span class="line">  <span class="comment">// 动作</span></span><br><span class="line">  <span class="attr">actions</span>:&#123;</span><br><span class="line">    <span class="comment">/************/</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 状态</span></span><br><span class="line">  <span class="title function_">state</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">sum</span>:<span class="number">1</span>,</span><br><span class="line">      <span class="attr">school</span>:<span class="string">&#x27;atguigu&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 计算</span></span><br><span class="line">  <span class="attr">getters</span>:&#123;</span><br><span class="line">    <span class="attr">bigSum</span>:(state):<span class="function"><span class="params">number</span> =&gt;</span> state.<span class="property">sum</span> *<span class="number">10</span>,</span><br><span class="line">    <span class="title function_">upperSchool</span>():string&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>. school.<span class="title function_">toUpperCase</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>组件中读取数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;increment,decrement&#125; = countStore</span><br><span class="line"><span class="keyword">let</span> &#123;sum,school,bigSum,upperSchool&#125; = <span class="title function_">storeToRefs</span>(countStore)</span><br></pre></td></tr></table></figure></li></ol><h2 id="5-7-【-subscribe】"><a href="#5-7-【-subscribe】" class="headerlink" title="5.7.【$subscribe】"></a>5.7.【$subscribe】</h2><p>通过 store 的 <code>$subscribe()</code> 方法侦听 <code>state</code> 及其变化</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">talkStore.$subscribe(<span class="function">(<span class="params">mutate,state</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;LoveTalk&#x27;</span>,mutate,state)</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;talk&#x27;</span>,<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(talkList.<span class="property">value</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="5-8-【store组合式写法】"><a href="#5-8-【store组合式写法】" class="headerlink" title="5.8. 【store组合式写法】"></a>5.8. 【store组合式写法】</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;nanoid&#125; <span class="keyword">from</span> <span class="string">&#x27;nanoid&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;reactive&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTalkStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;talk&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="comment">// talkList就是state</span></span><br><span class="line">  <span class="keyword">const</span> talkList = <span class="title function_">reactive</span>(</span><br><span class="line">    <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;talkList&#x27;</span>) <span class="keyword">as</span> <span class="built_in">string</span>) || []</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getATalk函数相当于action</span></span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getATalk</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 发请求，下面这行的写法是：连续解构赋值+重命名</span></span><br><span class="line">    <span class="keyword">let</span> &#123;<span class="attr">data</span>:&#123;<span class="attr">content</span>:title&#125;&#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://api.uomg.com/api/rand.qinghua?format=json&#x27;</span>)</span><br><span class="line">    <span class="comment">// 把请求回来的字符串，包装成一个对象</span></span><br><span class="line">    <span class="keyword">let</span> obj = &#123;<span class="attr">id</span>:<span class="title function_">nanoid</span>(),title&#125;</span><br><span class="line">    <span class="comment">// 放到数组中</span></span><br><span class="line">    talkList.<span class="title function_">unshift</span>(obj)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;talkList,getATalk&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="6-组件通信"><a href="#6-组件通信" class="headerlink" title="6. 组件通信"></a>6. 组件通信</h1><p><strong><code>Vue3</code>组件通信和<code>Vue2</code>的区别：</strong></p><ul><li>移出事件总线，使用<code>mitt</code>代替。</li></ul><ul><li><code>vuex</code>换成了<code>pinia</code>。</li><li>把<code>.sync</code>优化到了<code>v-model</code>里面了。</li><li>把<code>$listeners</code>所有的东西，合并到<code>$attrs</code>中了。</li><li><code>$children</code>被砍掉了。</li></ul><p><strong>常见搭配形式：</strong></p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/image-20231119185900990.png" alt="image-20231119185900990" style="zoom:60%;" /> <h2 id="6-1-【props】"><a href="#6-1-【props】" class="headerlink" title="6.1. 【props】"></a>6.1. 【props】</h2><p>概述：<code>props</code>是使用频率最高的一种通信方式，常用与 ：<strong>父 ↔ 子</strong>。</p><ul><li>若 <strong>父传子</strong>：属性值是<strong>非函数</strong>。</li><li>若 <strong>子传父</strong>：属性值是<strong>函数</strong>。</li></ul><p>父组件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;father&quot;&gt;</span><br><span class="line">    &lt;h3&gt;父组件，&lt;/h3&gt;</span><br><span class="line">&lt;h4&gt;我的车：&#123;&#123; car &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;h4&gt;儿子给的玩具：&#123;&#123; toy &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;Child :car=&quot;car&quot; :getToy=&quot;getToy&quot;/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Father&quot;&gt;</span><br><span class="line">import Child from &#x27;./Child.vue&#x27;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">// 数据</span><br><span class="line">const car = ref(&#x27;奔驰&#x27;)</span><br><span class="line">const toy = ref()</span><br><span class="line">// 方法</span><br><span class="line">function getToy(value:string)&#123;</span><br><span class="line">toy.value = value</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>子组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;child&quot;&gt;</span><br><span class="line">    &lt;h3&gt;子组件&lt;/h3&gt;</span><br><span class="line">&lt;h4&gt;我的玩具：&#123;&#123; toy &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;h4&gt;父给我的车：&#123;&#123; car &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;button @click=&quot;getToy(toy)&quot;&gt;玩具给父亲&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Child&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">const toy = ref(&#x27;奥特曼&#x27;)</span><br><span class="line"></span><br><span class="line">defineProps([&#x27;car&#x27;,&#x27;getToy&#x27;])</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="6-2-【自定义事件】"><a href="#6-2-【自定义事件】" class="headerlink" title="6.2. 【自定义事件】"></a>6.2. 【自定义事件】</h2><ol><li>概述：自定义事件常用于：<strong>子 &#x3D;&gt; 父。</strong></li><li>注意区分好：原生事件、自定义事件。</li></ol><ul><li>原生事件：<ul><li>事件名是特定的（<code>click</code>、<code>mosueenter</code>等等）</li><li>事件对象<code>$event</code>: 是包含事件相关信息的对象（<code>pageX</code>、<code>pageY</code>、<code>target</code>、<code>keyCode</code>）</li></ul></li><li>自定义事件：<ul><li>事件名是任意名称</li><li><strong style="color:red">事件对象<code>$event</code>: 是调用<code>emit</code>时所提供的数据，可以是任意类型！！！</strong ></li></ul></li></ul><ol start="3"><li><p>示例：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在父组件中，给子组件绑定自定义事件：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Child</span> @<span class="attr">send-toy</span>=<span class="string">&quot;toy = $event&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--注意区分原生事件与自定义事件中的$event--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;toy = $event&quot;</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//子组件中，触发事件：</span></span><br><span class="line"><span class="variable language_">this</span>.$emit(<span class="string">&#x27;send-toy&#x27;</span>, 具体数据)</span><br></pre></td></tr></table></figure></li></ol><h2 id="6-3-【mitt】"><a href="#6-3-【mitt】" class="headerlink" title="6.3. 【mitt】"></a>6.3. 【mitt】</h2><p>概述：与消息订阅与发布（<code>pubsub</code>）功能类似，可以实现任意组件间通信。</p><p>安装<code>mitt</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mitt</span><br></pre></td></tr></table></figure><p>新建文件：<code>src\utils\emitter.ts</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入mitt </span></span><br><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&quot;mitt&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建emitter</span></span><br><span class="line"><span class="keyword">const</span> emitter = <span class="title function_">mitt</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  // 绑定事件</span></span><br><span class="line"><span class="comment">  emitter.on(&#x27;abc&#x27;,(value)=&gt;&#123;</span></span><br><span class="line"><span class="comment">    console.log(&#x27;abc事件被触发&#x27;,value)</span></span><br><span class="line"><span class="comment">  &#125;)</span></span><br><span class="line"><span class="comment">  emitter.on(&#x27;xyz&#x27;,(value)=&gt;&#123;</span></span><br><span class="line"><span class="comment">    console.log(&#x27;xyz事件被触发&#x27;,value)</span></span><br><span class="line"><span class="comment">  &#125;)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  setInterval(() =&gt; &#123;</span></span><br><span class="line"><span class="comment">    // 触发事件</span></span><br><span class="line"><span class="comment">    emitter.emit(&#x27;abc&#x27;,666)</span></span><br><span class="line"><span class="comment">    emitter.emit(&#x27;xyz&#x27;,777)</span></span><br><span class="line"><span class="comment">  &#125;, 1000);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  setTimeout(() =&gt; &#123;</span></span><br><span class="line"><span class="comment">    // 清理事件</span></span><br><span class="line"><span class="comment">    emitter.all.clear()</span></span><br><span class="line"><span class="comment">  &#125;, 3000); </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建并暴露mitt</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> emitter</span><br></pre></td></tr></table></figure><p>接收数据的组件中：绑定事件、同时在销毁前解绑事件：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">&quot;@/utils/emitter&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; onUnmounted &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绑定事件</span></span><br><span class="line">emitter.<span class="title function_">on</span>(<span class="string">&#x27;send-toy&#x27;</span>,<span class="function">(<span class="params">value</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;send-toy事件被触发&#x27;</span>,value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">onUnmounted</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="comment">// 解绑事件</span></span><br><span class="line">  emitter.<span class="title function_">off</span>(<span class="string">&#x27;send-toy&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>【第三步】：提供数据的组件，在合适的时候触发事件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">&quot;@/utils/emitter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendToy</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">// 触发事件</span></span><br><span class="line">  emitter.<span class="title function_">emit</span>(<span class="string">&#x27;send-toy&#x27;</span>,toy.<span class="property">value</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>注意这个重要的内置关系，总线依赖着这个内置关系</strong></p><h2 id="6-4-【v-model】"><a href="#6-4-【v-model】" class="headerlink" title="6.4.【v-model】"></a>6.4.【v-model】</h2><ol><li><p>概述：实现 <strong>父↔子</strong> 之间相互通信。</p></li><li><p>前序知识 —— <code>v-model</code>的本质</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用v-model指令 --&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; v-model=&quot;userName&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- v-model的本质是下面这行代码 --&gt;</span><br><span class="line">&lt;input </span><br><span class="line">  type=&quot;text&quot; </span><br><span class="line">  :value=&quot;userName&quot; </span><br><span class="line">  @input=&quot;userName =(&lt;HTMLInputElement&gt;$event.target).value&quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></li><li><p>组件标签上的<code>v-model</code>的本质：<code>:moldeValue</code> ＋ <code>update:modelValue</code>事件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 组件标签上使用v-model指令 --&gt;</span><br><span class="line">&lt;AtguiguInput v-model=&quot;userName&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 组件标签上v-model的本质 --&gt;</span><br><span class="line">&lt;AtguiguInput :modelValue=&quot;userName&quot; @update:model-value=&quot;userName = $event&quot;/&gt;</span><br></pre></td></tr></table></figure><p><code>AtguiguInput</code>组件中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;!--将接收的value值赋给input元素的value属性，目的是：为了呈现数据 --&gt;</span><br><span class="line">&lt;!--给input元素绑定原生input事件，触发input事件时，进而触发update:model-value事件--&gt;</span><br><span class="line">    &lt;input </span><br><span class="line">       type=&quot;text&quot; </span><br><span class="line">       :value=&quot;modelValue&quot; </span><br><span class="line">       @input=&quot;emit(&#x27;update:model-value&#x27;,$event.target.value)&quot;</span><br><span class="line">    &gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;AtguiguInput&quot;&gt;</span><br><span class="line">  // 接收props</span><br><span class="line">  defineProps([&#x27;modelValue&#x27;])</span><br><span class="line">  // 声明事件</span><br><span class="line">  const emit = defineEmits([&#x27;update:model-value&#x27;])</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li><li><p>也可以更换<code>value</code>，例如改成<code>abc</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 也可以更换value，例如改成abc--&gt;</span><br><span class="line">&lt;AtguiguInput v-model:abc=&quot;userName&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 上面代码的本质如下 --&gt;</span><br><span class="line">&lt;AtguiguInput :abc=&quot;userName&quot; @update:abc=&quot;userName = $event&quot;/&gt;</span><br></pre></td></tr></table></figure><p><code>AtguiguInput</code>组件中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">    &lt;input </span><br><span class="line">       type=&quot;text&quot; </span><br><span class="line">       :value=&quot;abc&quot; </span><br><span class="line">       @input=&quot;emit(&#x27;update:abc&#x27;,$event.target.value)&quot;</span><br><span class="line">    &gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;AtguiguInput&quot;&gt;</span><br><span class="line">  // 接收props</span><br><span class="line">  defineProps([&#x27;abc&#x27;])</span><br><span class="line">  // 声明事件</span><br><span class="line">  const emit = defineEmits([&#x27;update:abc&#x27;])</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li><li><p>如果<code>value</code>可以更换，那么就可以在组件标签上多次使用<code>v-model</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;AtguiguInput v-model:abc=&quot;userName&quot; v-model:xyz=&quot;password&quot;/&gt;</span><br></pre></td></tr></table></figure></li></ol><h2 id="6-5-【-attrs-】"><a href="#6-5-【-attrs-】" class="headerlink" title="6.5.【$attrs 】"></a>6.5.【$attrs 】</h2><ol><li><p>概述：<code>$attrs</code>用于实现<strong>当前组件的父组件</strong>，向<strong>当前组件的子组件</strong>通信（<strong>祖→孙</strong>）。</p></li><li><p>具体说明：<code>$attrs</code>是一个对象，包含所有父组件传入的标签属性。</p><blockquote><p> 注意：<code>$attrs</code>会自动排除<code>props</code>中声明的属性(可以认为声明过的 <code>props</code> 被子组件自己“消费”了)</p></blockquote></li></ol><p>父组件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;father&quot;&gt;</span><br><span class="line">    &lt;h3&gt;父组件&lt;/h3&gt;</span><br><span class="line">&lt;Child :a=&quot;a&quot; :b=&quot;b&quot; :c=&quot;c&quot; :d=&quot;d&quot; v-bind=&quot;&#123;x:100,y:200&#125;&quot; :updateA=&quot;updateA&quot;/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Father&quot;&gt;</span><br><span class="line">import Child from &#x27;./Child.vue&#x27;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">let a = ref(1)</span><br><span class="line">let b = ref(2)</span><br><span class="line">let c = ref(3)</span><br><span class="line">let d = ref(4)</span><br><span class="line"></span><br><span class="line">function updateA(value)&#123;</span><br><span class="line">a.value = value</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>子组件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;child&quot;&gt;</span><br><span class="line">&lt;h3&gt;子组件&lt;/h3&gt;</span><br><span class="line">&lt;GrandChild v-bind=&quot;$attrs&quot;/&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Child&quot;&gt;</span><br><span class="line">import GrandChild from &#x27;./GrandChild.vue&#x27;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>孙组件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;grand-child&quot;&gt;</span><br><span class="line">&lt;h3&gt;孙组件&lt;/h3&gt;</span><br><span class="line">&lt;h4&gt;a：&#123;&#123; a &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;h4&gt;b：&#123;&#123; b &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;h4&gt;c：&#123;&#123; c &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;h4&gt;d：&#123;&#123; d &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;h4&gt;x：&#123;&#123; x &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;h4&gt;y：&#123;&#123; y &#125;&#125;&lt;/h4&gt;</span><br><span class="line">&lt;button @click=&quot;updateA(666)&quot;&gt;点我更新A&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;GrandChild&quot;&gt;</span><br><span class="line">defineProps([&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;updateA&#x27;])</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="6-6-【-refs、-parent】"><a href="#6-6-【-refs、-parent】" class="headerlink" title="6.6. 【$refs、$parent】"></a>6.6. 【$refs、$parent】</h2><ol><li><p>概述：</p><ul><li><code>$refs</code>用于 ：<strong>父→子。</strong></li><li><code>$parent</code>用于：<strong>子→父。</strong></li></ul></li><li><p>原理如下：</p><table><thead><tr><th>属性</th><th>说明</th></tr></thead><tbody><tr><td><code>$refs</code></td><td>值为对象，包含所有被<code>ref</code>属性标识的<code>DOM</code>元素或组件实例。</td></tr><tr><td><code>$parent</code></td><td>值为对象，当前组件的父组件实例对象。</td></tr></tbody></table></li></ol><h2 id="6-7-【provide、inject】"><a href="#6-7-【provide、inject】" class="headerlink" title="6.7. 【provide、inject】"></a>6.7. 【provide、inject】</h2><ol><li><p>概述：实现<strong>祖孙组件</strong>直接通信</p></li><li><p>具体使用：</p><ul><li>在祖先组件中通过<code>provide</code>配置向后代组件提供数据</li><li>在后代组件中通过<code>inject</code>配置来声明接收数据</li></ul></li><li><p>具体编码：</p><p>【第一步】父组件中，使用<code>provide</code>提供数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;father&quot;&gt;</span><br><span class="line">    &lt;h3&gt;父组件&lt;/h3&gt;</span><br><span class="line">    &lt;h4&gt;资产：&#123;&#123; money &#125;&#125;&lt;/h4&gt;</span><br><span class="line">    &lt;h4&gt;汽车：&#123;&#123; car &#125;&#125;&lt;/h4&gt;</span><br><span class="line">    &lt;button @click=&quot;money += 1&quot;&gt;资产+1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;car.price += 1&quot;&gt;汽车价格+1&lt;/button&gt;</span><br><span class="line">    &lt;Child/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;Father&quot;&gt;</span><br><span class="line">  import Child from &#x27;./Child.vue&#x27;</span><br><span class="line">  import &#123; ref,reactive,provide &#125; from &quot;vue&quot;;</span><br><span class="line">  // 数据</span><br><span class="line">  let money = ref(100)</span><br><span class="line">  let car = reactive(&#123;</span><br><span class="line">    brand:&#x27;奔驰&#x27;,</span><br><span class="line">    price:100</span><br><span class="line">  &#125;)</span><br><span class="line">  // 用于更新money的方法</span><br><span class="line">  function updateMoney(value:number)&#123;</span><br><span class="line">    money.value += value</span><br><span class="line">  &#125;</span><br><span class="line">  // 提供数据</span><br><span class="line">  provide(&#x27;moneyContext&#x27;,&#123;money,updateMoney&#125;)</span><br><span class="line">  provide(&#x27;car&#x27;,car)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>注意：子组件中不用编写任何东西，是不受到任何打扰的</p></blockquote><p>【第二步】孙组件中使用<code>inject</code>配置项接受数据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;grand-child&quot;&gt;</span><br><span class="line">    &lt;h3&gt;我是孙组件&lt;/h3&gt;</span><br><span class="line">    &lt;h4&gt;资产：&#123;&#123; money &#125;&#125;&lt;/h4&gt;</span><br><span class="line">    &lt;h4&gt;汽车：&#123;&#123; car &#125;&#125;&lt;/h4&gt;</span><br><span class="line">    &lt;button @click=&quot;updateMoney(6)&quot;&gt;点我&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; name=&quot;GrandChild&quot;&gt;</span><br><span class="line">  import &#123; inject &#125; from &#x27;vue&#x27;;</span><br><span class="line">  // 注入数据</span><br><span class="line"> let &#123;money,updateMoney&#125; = inject(&#x27;moneyContext&#x27;,&#123;money:0,updateMoney:(x:number)=&gt;&#123;&#125;&#125;)</span><br><span class="line">  let car = inject(&#x27;car&#x27;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ol><h2 id="6-8-【pinia】"><a href="#6-8-【pinia】" class="headerlink" title="6.8. 【pinia】"></a>6.8. 【pinia】</h2><p>参考之前<code>pinia</code>部分的讲解</p><h2 id="6-9-【slot】"><a href="#6-9-【slot】" class="headerlink" title="6.9. 【slot】"></a>6.9. 【slot】</h2><h3 id="1-默认插槽"><a href="#1-默认插槽" class="headerlink" title="1. 默认插槽"></a>1. 默认插槽</h3><p><img src="http://49.232.112.44/images/default_slot.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">父组件中：</span><br><span class="line">        &lt;Category title=&quot;今日热门游戏&quot;&gt;</span><br><span class="line">          &lt;ul&gt;</span><br><span class="line">            &lt;li v-for=&quot;g in games&quot; :key=&quot;g.id&quot;&gt;&#123;&#123; g.name &#125;&#125;&lt;/li&gt;</span><br><span class="line">          &lt;/ul&gt;</span><br><span class="line">        &lt;/Category&gt;</span><br><span class="line">子组件中：</span><br><span class="line">        &lt;template&gt;</span><br><span class="line">          &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">            &lt;h3&gt;&#123;&#123; title &#125;&#125;&lt;/h3&gt;</span><br><span class="line">            &lt;!-- 默认插槽 --&gt;</span><br><span class="line">            &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/template&gt;</span><br></pre></td></tr></table></figure><h3 id="2-具名插槽"><a href="#2-具名插槽" class="headerlink" title="2. 具名插槽"></a>2. 具名插槽</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">父组件中：</span><br><span class="line">        &lt;Category title=&quot;今日热门游戏&quot;&gt;</span><br><span class="line">          &lt;template v-slot:s1&gt;</span><br><span class="line">            &lt;ul&gt;</span><br><span class="line">              &lt;li v-for=&quot;g in games&quot; :key=&quot;g.id&quot;&gt;&#123;&#123; g.name &#125;&#125;&lt;/li&gt;</span><br><span class="line">            &lt;/ul&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">          &lt;template #s2&gt;</span><br><span class="line">            &lt;a href=&quot;&quot;&gt;更多&lt;/a&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/Category&gt;</span><br><span class="line">子组件中：</span><br><span class="line">        &lt;template&gt;</span><br><span class="line">          &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">            &lt;h3&gt;&#123;&#123; title &#125;&#125;&lt;/h3&gt;</span><br><span class="line">            &lt;slot name=&quot;s1&quot;&gt;&lt;/slot&gt;</span><br><span class="line">            &lt;slot name=&quot;s2&quot;&gt;&lt;/slot&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/template&gt;</span><br></pre></td></tr></table></figure><h3 id="3-作用域插槽"><a href="#3-作用域插槽" class="headerlink" title="3. 作用域插槽"></a>3. 作用域插槽</h3><ol><li><p>理解：<span style="color:red">数据在组件的自身，但根据数据生成的结构需要组件的使用者来决定。</span>（新闻数据在<code>News</code>组件中，但使用数据所遍历出来的结构由<code>App</code>组件决定）</p></li><li><p>具体编码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">父组件中：</span><br><span class="line">      &lt;Game v-slot=&quot;params&quot;&gt;</span><br><span class="line">      &lt;!-- &lt;Game v-slot:default=&quot;params&quot;&gt; --&gt;</span><br><span class="line">      &lt;!-- &lt;Game #default=&quot;params&quot;&gt; --&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &lt;li v-for=&quot;g in params.games&quot; :key=&quot;g.id&quot;&gt;&#123;&#123; g.name &#125;&#125;&lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/Game&gt;</span><br><span class="line"></span><br><span class="line">子组件中：</span><br><span class="line">      &lt;template&gt;</span><br><span class="line">        &lt;div class=&quot;category&quot;&gt;</span><br><span class="line">          &lt;h2&gt;今日游戏榜单&lt;/h2&gt;</span><br><span class="line">          &lt;slot :games=&quot;games&quot; a=&quot;哈哈&quot;&gt;&lt;/slot&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">      &lt;script setup lang=&quot;ts&quot; name=&quot;Category&quot;&gt;</span><br><span class="line">        import &#123;reactive&#125; from &#x27;vue&#x27;</span><br><span class="line">        let games = reactive([</span><br><span class="line">          &#123;id:&#x27;asgdytsa01&#x27;,name:&#x27;英雄联盟&#x27;&#125;,</span><br><span class="line">          &#123;id:&#x27;asgdytsa02&#x27;,name:&#x27;王者荣耀&#x27;&#125;,</span><br><span class="line">          &#123;id:&#x27;asgdytsa03&#x27;,name:&#x27;红色警戒&#x27;&#125;,</span><br><span class="line">          &#123;id:&#x27;asgdytsa04&#x27;,name:&#x27;斗罗大陆&#x27;&#125;</span><br><span class="line">        ])</span><br><span class="line">      &lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ol><h1 id="7-其它-API"><a href="#7-其它-API" class="headerlink" title="7. 其它 API"></a>7. 其它 API</h1><h2 id="7-1-【shallowRef-与-shallowReactive-】"><a href="#7-1-【shallowRef-与-shallowReactive-】" class="headerlink" title="7.1.【shallowRef 与 shallowReactive 】"></a>7.1.【shallowRef 与 shallowReactive 】</h2><h3 id="shallowRef"><a href="#shallowRef" class="headerlink" title="shallowRef"></a><code>shallowRef</code></h3><ol><li><p>作用：创建一个响应式数据，但只对顶层属性进行响应式处理。</p></li><li><p>用法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myVar = <span class="title function_">shallowRef</span>(initialValue);</span><br></pre></td></tr></table></figure></li><li><p>特点：只跟踪引用值的变化，不关心值内部的属性变化。</p></li></ol><h3 id="shallowReactive"><a href="#shallowReactive" class="headerlink" title="shallowReactive"></a><code>shallowReactive</code></h3><ol><li><p>作用：创建一个浅层响应式对象，只会使对象的最顶层属性变成响应式的，对象内部的嵌套属性则不会变成响应式的</p></li><li><p>用法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myObj = <span class="title function_">shallowReactive</span>(&#123; ... &#125;);</span><br></pre></td></tr></table></figure></li><li><p>特点：对象的顶层属性是响应式的，但嵌套对象的属性不是。</p></li></ol><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>通过使用 <a href="https://cn.vuejs.org/api/reactivity-advanced.html#shallowref"><code>shallowRef()</code></a> 和 <a href="https://cn.vuejs.org/api/reactivity-advanced.html#shallowreactive"><code>shallowReactive()</code></a> 来绕开深度响应。浅层式 <code>API</code> 创建的状态只在其顶层是响应式的，对所有深层的对象不会做任何处理，避免了对每一个内部属性做响应式所带来的性能成本，这使得属性的访问变得更快，可提升性能。</p></blockquote><h2 id="7-2-【readonly-与-shallowReadonly】"><a href="#7-2-【readonly-与-shallowReadonly】" class="headerlink" title="7.2.【readonly 与 shallowReadonly】"></a>7.2.【readonly 与 shallowReadonly】</h2><h3 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a><strong><code>readonly</code></strong></h3><ol><li><p>作用：用于创建一个对象的深只读副本。</p></li><li><p>用法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> original = <span class="title function_">reactive</span>(&#123; ... &#125;);</span><br><span class="line"><span class="keyword">const</span> readOnlyCopy = <span class="title function_">readonly</span>(original);</span><br></pre></td></tr></table></figure></li><li><p>特点：</p><ul><li>对象的所有嵌套属性都将变为只读。</li><li>任何尝试修改这个对象的操作都会被阻止（在开发模式下，还会在控制台中发出警告）。</li></ul></li><li><p>应用场景：</p><ul><li>创建不可变的状态快照。</li><li>保护全局状态或配置不被修改。</li></ul></li></ol><h3 id="shallowReadonly"><a href="#shallowReadonly" class="headerlink" title="shallowReadonly"></a><strong><code>shallowReadonly</code></strong></h3><ol><li><p>作用：与 <code>readonly</code> 类似，但只作用于对象的顶层属性。</p></li><li><p>用法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> original = <span class="title function_">reactive</span>(&#123; ... &#125;);</span><br><span class="line"><span class="keyword">const</span> shallowReadOnlyCopy = <span class="title function_">shallowReadonly</span>(original);</span><br></pre></td></tr></table></figure></li><li><p>特点：</p><ul><li><p>只将对象的顶层属性设置为只读，对象内部的嵌套属性仍然是可变的。</p></li><li><p>适用于只需保护对象顶层属性的场景。</p></li></ul></li></ol><h2 id="7-3-【toRaw-与-markRaw】"><a href="#7-3-【toRaw-与-markRaw】" class="headerlink" title="7.3.【toRaw 与 markRaw】"></a>7.3.【toRaw 与 markRaw】</h2><h3 id="toRaw"><a href="#toRaw" class="headerlink" title="toRaw"></a><code>toRaw</code></h3><ol><li><p>作用：用于获取一个响应式对象的原始对象， <code>toRaw</code> 返回的对象不再是响应式的，不会触发视图更新。</p><blockquote><p>官网描述：这是一个可以用于临时读取而不引起代理访问&#x2F;跟踪开销，或是写入而不触发更改的特殊方法。不建议保存对原始对象的持久引用，请谨慎使用。</p></blockquote><blockquote><p>何时使用？ —— 在需要将响应式对象传递给非 <code>Vue</code> 的库或外部系统时，使用 <code>toRaw</code> 可以确保它们收到的是普通对象</p></blockquote></li><li><p>具体编码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive,toRaw,markRaw,isReactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* toRaw */</span></span><br><span class="line"><span class="comment">// 响应式对象</span></span><br><span class="line"><span class="keyword">let</span> person = <span class="title function_">reactive</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;tony&#x27;</span>,<span class="attr">age</span>:<span class="number">18</span>&#125;)</span><br><span class="line"><span class="comment">// 原始对象</span></span><br><span class="line"><span class="keyword">let</span> rawPerson = <span class="title function_">toRaw</span>(person)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* markRaw */</span></span><br><span class="line"><span class="keyword">let</span> citysd = <span class="title function_">markRaw</span>([</span><br><span class="line">  &#123;<span class="attr">id</span>:<span class="string">&#x27;asdda01&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;北京&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">id</span>:<span class="string">&#x27;asdda02&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;上海&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">id</span>:<span class="string">&#x27;asdda03&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;天津&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">id</span>:<span class="string">&#x27;asdda04&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;重庆&#x27;</span>&#125;</span><br><span class="line">])</span><br><span class="line"><span class="comment">// 根据原始对象citys去创建响应式对象citys2 —— 创建失败，因为citys被markRaw标记了</span></span><br><span class="line"><span class="keyword">let</span> citys2 = <span class="title function_">reactive</span>(citys)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(person))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(rawPerson))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(citys))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(citys2))</span><br></pre></td></tr></table></figure></li></ol><h3 id="markRaw"><a href="#markRaw" class="headerlink" title="markRaw"></a><code>markRaw</code></h3><ol><li><p>作用：标记一个对象，使其<strong>永远不会</strong>变成响应式的。</p><blockquote><p>例如使用<code>mockjs</code>时，为了防止误把<code>mockjs</code>变为响应式对象，可以使用 <code>markRaw</code> 去标记<code>mockjs</code></p></blockquote></li><li><p>编码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* markRaw */</span></span><br><span class="line"><span class="keyword">let</span> citys = <span class="title function_">markRaw</span>([</span><br><span class="line">  &#123;<span class="attr">id</span>:<span class="string">&#x27;asdda01&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;北京&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">id</span>:<span class="string">&#x27;asdda02&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;上海&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">id</span>:<span class="string">&#x27;asdda03&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;天津&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">id</span>:<span class="string">&#x27;asdda04&#x27;</span>,<span class="attr">name</span>:<span class="string">&#x27;重庆&#x27;</span>&#125;</span><br><span class="line">])</span><br><span class="line"><span class="comment">// 根据原始对象citys去创建响应式对象citys2 —— 创建失败，因为citys被markRaw标记了</span></span><br><span class="line"><span class="keyword">let</span> citys2 = <span class="title function_">reactive</span>(citys)</span><br></pre></td></tr></table></figure></li></ol><h2 id="7-4-【customRef】"><a href="#7-4-【customRef】" class="headerlink" title="7.4.【customRef】"></a>7.4.【customRef】</h2><p>作用：创建一个自定义的<code>ref</code>，并对其依赖项跟踪和更新触发进行逻辑控制。</p><p>实现防抖效果（<code>useSumRef.ts</code>）：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;customRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span>(<span class="params">initValue:<span class="built_in">string</span>,delay:<span class="built_in">number</span></span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> msg = <span class="title function_">customRef</span>(<span class="function">(<span class="params">track,trigger</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">timer</span>:<span class="built_in">number</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title function_">get</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">track</span>() <span class="comment">// 告诉Vue数据msg很重要，要对msg持续关注，一旦变化就更新</span></span><br><span class="line">        <span class="keyword">return</span> initValue</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">set</span>(<span class="params">value</span>)&#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">        timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          initValue = value</span><br><span class="line">          <span class="title function_">trigger</span>() <span class="comment">//通知Vue数据msg变化了</span></span><br><span class="line">        &#125;, delay);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;) </span><br><span class="line">  <span class="keyword">return</span> &#123;msg&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>组件中使用：</p><h1 id="8-Vue3新组件"><a href="#8-Vue3新组件" class="headerlink" title="8. Vue3新组件"></a>8. Vue3新组件</h1><h2 id="8-1-【Teleport】"><a href="#8-1-【Teleport】" class="headerlink" title="8.1. 【Teleport】"></a>8.1. 【Teleport】</h2><ul><li>什么是Teleport？—— Teleport 是一种能够将我们的<strong>组件html结构</strong>移动到指定位置的技术。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&#x27;body&#x27;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal&quot;</span> <span class="attr">v-show</span>=<span class="string">&quot;isShow&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>我是一个弹窗<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是弹窗中的一些内容<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;isShow = false&quot;</span>&gt;</span>关闭弹窗<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">teleport</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="8-2-【Suspense】"><a href="#8-2-【Suspense】" class="headerlink" title="8.2. 【Suspense】"></a>8.2. 【Suspense】</h2><ul><li>等待异步组件时渲染一些额外内容，让应用有更好的用户体验 </li><li>使用步骤： <ul><li>异步引入组件</li><li>使用<code>Suspense</code>包裹组件，并配置好<code>default</code> 与 <code>fallback</code></li></ul></li></ul><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineAsyncComponent,<span class="title class_">Suspense</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Child</span> = <span class="title function_">defineAsyncComponent</span>(<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&#x27;./Child.vue&#x27;</span>))</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">        &lt;h3&gt;我是App组件&lt;/h3&gt;</span><br><span class="line">        &lt;Suspense&gt;</span><br><span class="line">          &lt;template v-slot:default&gt;</span><br><span class="line">            &lt;Child/&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">          &lt;template v-slot:fallback&gt;</span><br><span class="line">            &lt;h3&gt;加载中.......&lt;/h3&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/Suspense&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h2 id="8-3-【全局API转移到应用对象】"><a href="#8-3-【全局API转移到应用对象】" class="headerlink" title="8.3.【全局API转移到应用对象】"></a>8.3.【全局API转移到应用对象】</h2><ul><li><code>app.component</code></li><li><code>app.config</code></li><li><code>app.directive</code></li><li><code>app.mount</code></li><li><code>app.unmount</code></li><li><code>app.use</code></li></ul><h2 id="8-4-【其他】"><a href="#8-4-【其他】" class="headerlink" title="8.4.【其他】"></a>8.4.【其他】</h2><ul><li><p>过渡类名 <code>v-enter</code> 修改为 <code>v-enter-from</code>、过渡类名 <code>v-leave</code> 修改为 <code>v-leave-from</code>。</p></li><li><p><code>keyCode</code> 作为 <code>v-on</code> 修饰符的支持。</p></li><li><p><code>v-model</code> 指令在组件上的使用已经被重新设计，替换掉了 <code>v-bind.sync。</code></p></li><li><p><code>v-if</code> 和 <code>v-for</code> 在同一个元素身上使用时的优先级发生了变化。</p></li><li><p>移除了<code>$on</code>、<code>$off</code> 和 <code>$once</code> 实例方法。</p></li><li><p>移除了过滤器 <code>filter</code>。</p></li><li><p>移除了<code>$children</code> 实例 <code>propert</code>。</p><p>……</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>视频素材</title>
      <link href="/2023/12/15/%E8%A7%86%E9%A2%91%E7%B4%A0%E6%9D%90/"/>
      <url>/2023/12/15/%E8%A7%86%E9%A2%91%E7%B4%A0%E6%9D%90/</url>
      
        <content type="html"><![CDATA[<h2 id="1、免费视频"><a href="#1、免费视频" class="headerlink" title="1、免费视频"></a>1、免费视频</h2><table><thead><tr><th align="left">▼ <strong>高清视频</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://pixabay.com/zh/videos/">Pixabay</a></td><td align="left">免登录、CC0版权、无下载限制、支持中文。</td></tr><tr><td align="left">🌐 <a href="https://www.pexels.com/zh-cn/videos/">Pexels</a></td><td align="left">免登录、CC0版权、无下载限制、支持中文。</td></tr><tr><td align="left">🌐 <a href="https://coverr.co/">Coverr</a></td><td align="left">免登录、CC0版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://mixkit.co/free-stock-video/">Mixkit</a></td><td align="left">免登录、CC0版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.vidsplay.com/">Vidsplay</a></td><td align="left">免登录、CC0版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://isorepublic.com/videos/">ISO Republic</a></td><td align="left">免登录、CC0版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.videezy.com/">Videezy</a></td><td align="left">免登录、CC0版权、无下载限制、免费使用需要署名。</td></tr><tr><td align="left">🌐 <a href="https://www.videvo.net/">Videvo</a></td><td align="left">免登录、CC0版权、无下载限制、免费使用需要署名。</td></tr><tr><td align="left">🌐 <a href="https://www.freepik.com/videos">Freepik</a></td><td align="left">免登录、CC0版权、无下载限制、免费使用需要署名。</td></tr><tr><td align="left">▼ <strong>小众视频</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.motionplaces.com/">Motion Places</a></td><td align="left">免登录、CC0 版权、无下载限制、小众视频、多为延时摄影。</td></tr><tr><td align="left">🌐 <a href="https://mazwai.com/">Mazwai</a></td><td align="left">免登录、CC0 版权、无下载限制、小众视频、多为电影风格。</td></tr><tr><td align="left">🌐 <a href="https://dareful.com/">Dareful</a></td><td align="left">免登录、CC0 版权、无下载限制、小众视频、多为自然景色。</td></tr><tr><td align="left">🌐 <a href="https://focastock.com/videos/">FOCA</a></td><td align="left">免登录、CC0 版权、无下载限制、小众视频、多为自然景色。</td></tr><tr><td align="left">🌐 <a href="https://freenaturestock.com/videos/">Nature Stock</a></td><td align="left">免登录、CC0 版权、无下载限制、小众视频、多为自然景色。</td></tr><tr><td align="left">▼ <strong>聚合搜索</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.6huo.com/footages">预告片世界</a></td><td align="left">免登录、CC0版权、无下载限制、聚合搜索引擎。</td></tr><tr><td align="left">🌐 <a href="https://video.librestock.com/">Librestock</a></td><td align="left">免登录、CC0版权、无下载限制、聚合搜索引擎。</td></tr><tr><td align="left">🌐 <a href="https://www.free-video-footage.com/">FVF</a></td><td align="left">免登录、CC0版权、无下载限制、聚合搜索引擎。</td></tr></tbody></table><h2 id="2、视频素材"><a href="#2、视频素材" class="headerlink" title="2、视频素材"></a>2、视频素材</h2><table><thead><tr><th align="left">▼ <strong>视频素材</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://www.aigei.com/">爱给网</a></td><td align="left">国内知名的视频素材网站，下载要铜币，每日免费送 20 铜币。</td></tr><tr><td align="left">🌐 <a href="https://www.heycan.com/home">黑罐头</a></td><td align="left">抖音旗下素材平台，UGC 平台，免费下载。</td></tr><tr><td align="left">🌐 <a href="https://cool.bilibili.com/square/video">素材酷平台</a></td><td align="left">B 站旗下素材平台，UGC 平台，免费下载。</td></tr><tr><td align="left">🌐 <a href="https://sucai.zhiyu.art/">知鱼素材</a></td><td align="left">国内视频素材库，<strong>“共享协议”</strong>的素材可免费商用、免费用户每天 1 次下载。</td></tr><tr><td align="left">🌐 <a href="https://shipin520.com/">潮点视频</a></td><td align="left">国内视频素材库，免费用户每天 1 次下载。</td></tr><tr><td align="left">🌐 <a href="https://al.jybest.ltd/%E8%BD%AF%E4%BB%B6/Windows/4000%E4%B8%AA%E7%BB%BF%E5%B9%95%E8%A7%86%E9%A2%91%E7%B4%A0%E6%9D%9027G">绿幕视频27G</a></td><td align="left">网上找到的 4000个绿幕视频素材 27G，支持预览和下载。</td></tr><tr><td align="left">🌐 <a href="https://cutestockfootage.com/">Cute Footage</a></td><td align="left">免登录、CC0版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.productioncrate.com/">ProductionCrate</a></td><td align="left">要登录、付费网站的免费内容，每日 4 次免费下载。</td></tr><tr><td align="left">🌐 <a href="https://www.monzoom.com/">Monzoom</a></td><td align="left">要登录、CC0版权、免费使用需要署名。</td></tr></tbody></table><h2 id="3、视频后期"><a href="#3、视频后期" class="headerlink" title="3、视频后期"></a>3、视频后期</h2><table><thead><tr><th align="left">▼ <strong>特效模版</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://mixkit.co/free-video-templates/">Mixkit</a></td><td align="left">免登录、CC0版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.lookae.com/">LookAE</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://www.newcger.com/">NewCGer</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://c4dsky.com/">书生影视</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://www.mfcpx.com/">FCPX资源站</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="http://www.cgdream.com.cn/">CG模型网</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://www.cgown.com/">CG资源网</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="http://www.cgahz.com/">CG爱好者网</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://www.cgufo.com/">CGUFO</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://www.aepond.com/">AEPON</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://prmuban.com/">PR模板网</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://www.gfxcamp.com/">GFXCamp</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="http://www.lovelifemrle.com/">爱生活的乐先生</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr><tr><td align="left">🌐 <a href="https://videocopilot.net.cn/">Video-Copilot</a></td><td align="left">免登录、提供网盘下载，商用需谨慎。</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
            <tag> 视频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字体导航</title>
      <link href="/2023/12/15/%E5%AD%97%E4%BD%93%E5%AF%BC%E8%88%AA/"/>
      <url>/2023/12/15/%E5%AD%97%E4%BD%93%E5%AF%BC%E8%88%AA/</url>
      
        <content type="html"><![CDATA[<h2 id="1、中文字体"><a href="#1、中文字体" class="headerlink" title="1、中文字体"></a>1、中文字体</h2><table><thead><tr><th align="left">▼ <strong>免费商用</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://wordshub.github.io/free-font/">字集</a></td><td align="left">免费商用字体库，大概是 2020 年最全的免费可商用字体库。👍</td></tr><tr><td align="left">🌐 <a href="https://www.maoken.com/all-fonts-imgs">猫啃网</a></td><td align="left">免费商用字体库，有 <a href="https://www.maoken.com/all-fonts-imgs">图文版</a>、<a href="https://www.maoken.com/preview">预览版</a>、<a href="https://www.maoken.com/all-fonts">表格版</a> 等多种方法，并提供下载。</td></tr><tr><td align="left">🌐 <a href="https://ziyouziti.com/">自由字体</a></td><td align="left">免费商用字体库，附有字体使用样版，确保是商用免费字体，不会有版权纠纷。</td></tr><tr><td align="left"><a href="https://www.potatofield.cn/fontlibrary">🌐 洋芋田</a></td><td align="left">免费商用字体库，收录了 140+ 字体，确保是商用免费字体，不会有版权纠纷。</td></tr><tr><td align="left">🌐 <a href="https://www.freechinesefont.com/">CN Fonts</a></td><td align="left">免费商用字体库，收录了 180+ 字体，确保是商用免费字体，不会有版权纠纷。</td></tr><tr><td align="left">🌐 <a href="https://www.100font.com/">100font</a></td><td align="left">免费商用字体库，专门收录免费商用字体，通过网盘下载。</td></tr><tr><td align="left">🌐 <a href="https://www.shejidt.com/fonts">SHEJIDT</a></td><td align="left">免费商用字体库，专门收录免费商用字体，通过网盘下载。</td></tr><tr><td align="left">🌐 <a href="https://51font.17font.com/">51Font</a></td><td align="left">免费商用字体库，专门收录免费商用字体，通过网盘下载。</td></tr><tr><td align="left">🌐 <a href="https://pan.baidu.com/share/init?surl=ALdMdP2fX_WEQjTDutZkAw">900免费字体</a></td><td align="left">免费商用字体库，网友整理的免费商用字体集合，通过网盘下载，提取码：52pj</td></tr><tr><td align="left">▼ <strong>字体资讯</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.thetype.com/">The Type</a></td><td align="left">字体资讯网站。</td></tr><tr><td align="left">🌐 <a href="https://www.zhaozi.cn/">找字网</a></td><td align="left">字体资讯网站。</td></tr><tr><td align="left">🌐 <a href="https://www.fontke.com/">字客网</a></td><td align="left">字体资讯网站。</td></tr><tr><td align="left">🌐 <a href="https://izihun.com/">字魂网</a></td><td align="left">字体资讯网站。</td></tr><tr><td align="left">🌐 <a href="http://www.ziticq.com/">字体传奇</a></td><td align="left">字体资讯网站。</td></tr><tr><td align="left">🌐 <a href="https://www.fonts.net.cn/">字体天下</a></td><td align="left">字体资讯网站。</td></tr><tr><td align="left">▼ <strong>英文字体</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.fontspace.com/">FontSpace</a></td><td align="left">在线英文字体库，提供各种各样风格的字体，字体下载旁边会有版权标注。</td></tr><tr><td align="left">🌐 <a href="https://www.1001fonts.com/">1001 Fonts</a></td><td align="left">在线英文字体库，提供各种各样风格的字体，字体下载旁边会有版权标注。</td></tr><tr><td align="left">🌐 <a href="https://www.fontshare.com/">Fontshare</a></td><td align="left">在线英文字体库，提供各种各样风格的字体，字体下载旁边会有版权标注。</td></tr><tr><td align="left"></td><td align="left"></td></tr></tbody></table><h2 id="2、英文字体"><a href="#2、英文字体" class="headerlink" title="2、英文字体"></a>2、英文字体</h2><table><thead><tr><th align="left">▼ <strong>免费商用</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://wordmark.it/">Wordmark</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left">🌐 <a href="https://www.fontspace.com/">FontSpace</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left">🌐 <a href="https://www.dafont.com/themes.php">Dafont</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left"><a href="https://www.azfonts.net/">🌐 AZfonts</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left"><a href="https://fontesk.com/">🌐 Fontesk</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left">🌐 <a href="https://www.fontshare.com/">FontShare</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left">🌐 <a href="https://www.1001fonts.com/">1001 Fonts</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left">🌐 <a href="https://www.1001freefonts.com/">1001FreeFonts</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left">🌐 <a href="https://www.actionfonts.com/">Action Fonts</a></td><td align="left">在线英文字体库，下载按钮旁边会有版权标注。</td></tr><tr><td align="left">▼ <strong>字体资讯</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left"><a href="https://www.typewolf.com/">🌐 TypeWolf</a></td><td align="left">英文字体资讯网站。</td></tr><tr><td align="left">🌐 <a href="https://www.fonts.com/">Fonts.com</a></td><td align="left">英文字体资讯网站，大多数为付费字体。</td></tr><tr><td align="left">🌐 <a href="https://fontdiner.com/">FontDiner</a></td><td align="left">英文字体资讯网站，大多数为复古字体。</td></tr><tr><td align="left"><a href="https://blambot.com/">🌐 Blambot</a></td><td align="left">英文字体资讯网站，大多数为漫画字体。</td></tr></tbody></table><h2 id="3、字体工具"><a href="#3、字体工具" class="headerlink" title="3、字体工具"></a>3、字体工具</h2><table><thead><tr><th align="left">▼ <strong>字体查询</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://fonts.safe.360.cn/">360查字体</a></td><td align="left">字体版权查询，由 360 公司推出。</td></tr><tr><td align="left">🌐 <a href="https://www.likefont.com/">识字体网</a></td><td align="left">中文字体识别，支持中、英、日韩、等文字。</td></tr><tr><td align="left">🌐 <a href="https://fonts.adobe.com/">Adobe Fonts</a></td><td align="left">中文字体识别，Adobe 公司出品。</td></tr><tr><td align="left">🌐 <a href="https://www.myfonts.com/pages/whatthefont">WhatTheFont!</a></td><td align="left">英文字体识别，上付图片识别。</td></tr><tr><td align="left">🌐 <a href="https://www.whatfontis.com/">WhatFontIs</a></td><td align="left">英文字体识别，上付图片识别。</td></tr><tr><td align="left">🌐 <a href="https://www.fontsquirrel.com/matcherator">Identify Fonts</a></td><td align="left">英文字体识别，上付图片识别。</td></tr><tr><td align="left">🌐 <a href="http://www.identifont.com/index.html">IdentiFont</a></td><td align="left">英文字体识别，通过字体描述来识别字体。</td></tr><tr><td align="left">▼ <strong>手写字体</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://shouxie.laoxiezi.com/">老鞋子</a></td><td align="left">手写字体生成器，手写字体在线生成器。</td></tr><tr><td align="left">📥 <a href="https://www.beautifulcarrot.com/">萝卜工坊</a></td><td align="left">手写字体生成器，模拟手写字体软件，一键生成手写文稿。</td></tr><tr><td align="left">📥 <a href="https://www.iamzlt.com/?p=602">手写模拟器</a></td><td align="left">手写字体生成器，模拟手写字体软件，一键生成手写文稿。</td></tr><tr><td align="left">🌐 <a href="https://www.calligrapher.ai/">Calligrapher</a></td><td align="left">手写字体生成器，可以将英文变成手写体，并有动画效果，并提供 SVG 下载。</td></tr><tr><td align="left">🌐 <a href="https://www.an2.net/">田字格字帖</a></td><td align="left">田字格帖生成器，免费的在线田字格字帖生成器，支持笔顺，小学生练字神器。</td></tr><tr><td align="left">▼ <strong>书法字体</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left"><a href="http://www.shufami.com/">🌐 书法迷</a></td><td align="left">书法字体生成器，在线生成器。</td></tr><tr><td align="left">🌐 <a href="https://www.diyiziti.com/">第一字体</a></td><td align="left">书法字体生成器，在线生成器。</td></tr><tr><td align="left"><a href="http://g.shufaziti.com/">🌐 光明书法</a></td><td align="left">书法字体生成器，横幅集字工具。</td></tr><tr><td align="left"><a href="http://shufa.4a40.com/">🌐 书法集字</a></td><td align="left">书法字体生成器，书法字典在线查询。</td></tr><tr><td align="left"><a href="http://www.395.net.cn/">🌐 395工具</a></td><td align="left">书法字体生成器，有各式各样的在线工具。</td></tr><tr><td align="left">🌐 <a href="https://www.moage.cn/shufa">古风家书</a></td><td align="left">书法字体生成器，古风家书生成器。</td></tr><tr><td align="left">▼ <strong>印章字体</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.gaitubao.com/yinzhang">改图宝</a></td><td align="left">电子印章生成器，免费且专业。</td></tr><tr><td align="left">🌐 <a href="https://www.mofans.net/yinzhang/">墨芳印章</a></td><td align="left">电子印章生成器，免费且专业。</td></tr><tr><td align="left">🌐 <a href="http://redmi.work/">395印章</a></td><td align="left">电子印章生成器，免费且专业。</td></tr><tr><td align="left">▼ <strong>系统字体</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">📥 <a href="https://fontforge.org/en-US/">FontForge</a></td><td align="left">字体编辑器，用来创建新的字体，支持中文，且免费开源。</td></tr><tr><td align="left">📥 <a href="https://www.mactype.net/">MacType</a></td><td align="left">字体渲染工具，可以使系统文字显示更加清晰、更有立体感。</td></tr></tbody></table><h2 id="4、字体特效"><a href="#4、字体特效" class="headerlink" title="4、字体特效"></a>4、字体特效</h2><table><thead><tr><th align="left">▼ <strong>在线工具</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://www.logosc.cn/text/">标小智</a></td><td align="left">生成特效字体，一键生成各种特效的字体，并提供下载。</td></tr><tr><td align="left">🌐 <a href="https://vaufonts.com/">VAU Fonts</a></td><td align="left">生成特效字体，一键生成各种特效的字体，在“<strong>Preset</strong>”里可以切换效果。</td></tr><tr><td align="left">🌐 <a href="https://andyh0913.github.io/FrenchFries-Font-Converter/">麦当劳字体</a></td><td align="left">生成特效字体，生成麦当劳薯条字体，并提供下载。</td></tr><tr><td align="left">🌐 <a href="https://textanim.com/">TEXTANIM</a></td><td align="left">生成动效字体，生成 GIF 动效字体，效果相对比较复古。</td></tr><tr><td align="left">🌐 <a href="https://llamafont.com/">Llama Font</a></td><td align="left">生成特效字体，生成草泥马（羊驼）字体。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>本地工具</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">📥 <a href="https://aaa-logo.com/">AAA Logo</a></td><td align="left">免费，1000+ 现成 Logo 模版一键生成，只支持 Windows。<a href="https://www.aaa-logo.com/download.php">🪟</a></td></tr><tr><td align="left">📥 <a href="https://apps.apple.com/cn/app/art-text-4-text-effects-app/id1499327230?mt=12">Art Text 4</a></td><td align="left">专业图形设计工具，可以一键生成惊艳的文本和图形，只支持 Mac。<a href="https://two.onefileserver.top/macxz/10293/art_text_4_4.3.0.dmg">🍎</a></td></tr></tbody></table><h2 id="5、字体版权"><a href="#5、字体版权" class="headerlink" title="5、字体版权"></a>5、字体版权</h2><p>无论你是做什么工作的，字体版权，你一定要搞清楚。因为，<strong>他们是真的告！</strong></p><p>那我们要如何避免字体侵权呢？</p><p>我们可以用排除法。</p><p><strong>1、系统自带的“微软雅黑”和“苹方黑体”不可商用。</strong></p><p>理论上 Windows 和 Mac 自带的字体，也不是可商用的，只是他们是出自“大公司”，没时间告你罢了。</p><p><strong>2、如果你不打算花钱买字体，凡是国内大公司的字体品牌，都不要用。</strong></p><p>因为国内公怀寄律师函的方法可太简单了，甚至可以在公众号评论区留言，国外公司至少还找个法人代表。</p><p><strong>3、如果你不打算花钱买字体，那些传统字体品牌，一律不要用。</strong></p><p>几乎你能叫得出名字的字体品牌，比如 方正、华康、汉仪、华文、华光、蒙纳、文悦、汉鼎、文鼎 等等。</p><p>这些字体就像高压电线一样的，千万别碰。（也少量字体可免费商用，但不好看）</p><p>如果你安装过这此字体，赶紧从你的电脑上删除，不要给自己埋雷。</p><p>他们是真的告！</p><p><strong>4、只用你确定是可免费商用的字体。</strong></p><p>可免费商用的字体很多，我们没必要下载所有的字体。</p><p>新建一个文件夹，把那些经过确定是可以“<strong>免费商用的字体</strong>”，才放到这个文件夹。</p><p>记得还要保存一张“<strong>字体截图</strong>”，方便识别。</p>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
            <tag> 字体 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>音乐素材</title>
      <link href="/2023/12/15/%E9%9F%B3%E4%B9%90%E7%B4%A0%E6%9D%90/"/>
      <url>/2023/12/15/%E9%9F%B3%E4%B9%90%E7%B4%A0%E6%9D%90/</url>
      
        <content type="html"><![CDATA[<h2 id="1、音效素材"><a href="#1、音效素材" class="headerlink" title="1、音效素材"></a>1、音效素材</h2><table><thead><tr><th align="left">▼ <strong>国内网站</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://www.aigei.com/sound">爱给网</a></td><td align="left"><strong>要登陆</strong>、CC0 版权、支持中文、<strong>下载需付费</strong>。</td></tr><tr><td align="left">🌐 <a href="https://www.tosound.com/">淘声网</a></td><td align="left">免登陆、CC0 版权、支持中文、聚合搜索引擎。</td></tr><tr><td align="left">🌐 <a href="https://www.ear0.com/">耳聆网</a></td><td align="left"><strong>要登陆</strong>、CC0 版权、支持中文。</td></tr><tr><td align="left">🌐 <a href="https://sc.chinaz.com/yinxiao/">站长素材</a></td><td align="left">免登陆、<strong>版权不明，商用需谨慎</strong>。</td></tr><tr><td align="left">▼ <strong>国外网站</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://pixabay.com/sound-effects/">Pixabay</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://mixkit.co/free-sound-effects/">Mixkit</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.findsounds.com/typesChinese.html">FindSounds</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.soundeffectsplus.com/">SoundEffects+</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.soundgator.com/">SoundGator</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://taira-komori.jpn.org/freesoundcn.html">小森平</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.videvo.net/royalty-free-sound-effects/">Videvo</a></td><td align="left">免登陆、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://freesound.org/">Freesound</a></td><td align="left"><strong>要登陆</strong>、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://soundbible.com/">SoundBible</a></td><td align="left">免登陆、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://orangefreesounds.com/">OrangeSounds</a></td><td align="left">免登陆、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://www.soundjay.com/">SoundJay</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="https://www.pacdv.com/sounds/">PacDV</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="https://www.partnersinrhyme.com/pir/PIRsfx.shtml">PartnersInRhyme</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="https://www.mediacollege.com/downloads/sound-effects/">Media College</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr></tbody></table><h2 id="2、音效合集"><a href="#2、音效合集" class="headerlink" title="2、音效合集"></a>2、音效合集</h2><table><thead><tr><th align="left">▼ <strong>音效合集</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://99sounds.org/">99Sounds</a></td><td align="left">免登陆、CC0 版权、提供合集下载，欧洲的音效工作室。</td></tr><tr><td align="left">🌐 <a href="https://gamesounds.xyz/">GameSounds</a></td><td align="left">免登陆、CC0 版权、提供合集下载，可直接下载多个免版权音效资源。</td></tr><tr><td align="left">🌐 <a href="https://www.adobe.com/products/audition/offers/AdobeAuditionDLCSFX.html">Adobe Sound</a></td><td align="left">免登陆、CC0 版权、提供合集下载，Adobe 公司出品。[打包下载]</td></tr><tr><td align="left">🌐 <a href="https://www.blackmagicdesign.com/cn/support/">DaVinci Sound</a></td><td align="left">免登陆、CC0 版权、提供合集下载，DaVinci 公司出品。[打包下载]</td></tr><tr><td align="left">🌐 <a href="https://sound-effects.bbcrewind.co.uk/">BBC Sound</a></td><td align="left">免登陆、<strong>商用需授权</strong>、提供合集下载，BBC 公司出品。[打包下载]</td></tr></tbody></table><h2 id="3、音乐素材"><a href="#3、音乐素材" class="headerlink" title="3、音乐素材"></a>3、音乐素材</h2><table><thead><tr><th align="left">▼ <strong>免费音乐</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://pixabay.com/zh/music/">Pixabay</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://coverr.co/free-stock-music">Coverr</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://mixkit.co/free-stock-music/">Mixkit</a></td><td align="left">免登陆、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://sampld.app/">Sampld</a></td><td align="left"><strong>要登录</strong>、CC0 版权、无下载限制。</td></tr><tr><td align="left">🌐 <a href="https://www.videvo.net/royalty-free-music/">Videvo</a></td><td align="left">免登陆、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://freesound.org/">Freesound</a></td><td align="left"><strong>要登录</strong>、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://ncs.io/music">NCS</a></td><td align="left">免登陆、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://freemusicarchive.org/home">FMA</a></td><td align="left"><strong>要登录</strong>、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://www.bensound.com/free-music-for-videos">BenSound</a></td><td align="left">免登录、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://www.purple-planet.com/">Purple Planet</a></td><td align="left">免登录、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://incompetech.com/music/royalty-free/music.html">incompetech</a></td><td align="left">免登录、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="http://dig.ccmixter.org/">dig.ccMixter</a></td><td align="left"><strong>要登录</strong>、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://www.fiftysounds.com/">FiftySounds</a></td><td align="left">免登录、CC0 版权、无下载限制、免费使用需署名。</td></tr><tr><td align="left">🌐 <a href="https://cctrax.com/">CCTrax</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="https://freepd.com/">FreePD</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="https://whatfunk.com/">WhatFunk</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="https://audionautix.com/">AudionautiX</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="https://www.partnersinrhyme.com/midi/Classical/index.shtml">PartnersInRhyme</a></td><td align="left"><strong>要登录</strong>、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="https://www.fesliyanstudios.com/">Fesliyan Studios</a></td><td align="left">免登陆、CC0 版权、无下载限制、但无搜索框。</td></tr><tr><td align="left">🌐 <a href="http://dust-sounds.com/">Dust-Sounds</a></td><td align="left">免登陆、CC0 版权、无下载限制、日本网站。</td></tr><tr><td align="left">🌐 <a href="https://amachamusic.chagasi.com/">甘茶の音楽工房</a></td><td align="left">免登陆、CC0 版权、无下载限制、日本网站。</td></tr></tbody></table><h2 id="4、专用音乐"><a href="#4、专用音乐" class="headerlink" title="4、专用音乐"></a>4、专用音乐</h2><table><thead><tr><th align="left">▼ <strong>U2B 音乐</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://www.youtube.com/user/NoCopyrightSounds">NCS</a></td><td align="left">U2B 平台使用免费、需要署名。</td></tr><tr><td align="left">🌐 <a href="https://www.youtube.com/c/FreeMusicAudioLibraryNow/videos">FMAL</a></td><td align="left">U2B 平台使用免费、需要署名。</td></tr><tr><td align="left">🌐 <a href="https://www.youtube.com/@AlrotaMusic/videos">Alrota Music</a></td><td align="left">U2B 平台使用免费、需要署名。</td></tr><tr><td align="left">🌐 <a href="https://www.youtube.com/@MusicCityOfficial2017/videos">Music City</a></td><td align="left">U2B 平台使用免费、需要署名。</td></tr><tr><td align="left">🌐 <a href="https://www.youtube.com/c/audiolibrary-channel/videos">Audio Library</a></td><td align="left">U2B 平台使用免费、需要署名。</td></tr><tr><td align="left">▼ <strong>专用音乐</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://musopen.org/music/">Musopen</a></td><td align="left">古典音乐、要登录、CC0 版权。</td></tr><tr><td align="left">🌐 <a href="https://sonniss.com/gameaudiogdc">GameAudioGDC</a></td><td align="left">游戏音乐、免登陆、CC0 版权。</td></tr><tr><td align="left">🌐 <a href="https://opengameart.org/">OpenGameArt</a></td><td align="left">游戏音乐、要登录、CC0 版权。</td></tr><tr><td align="left">🌐 <a href="https://downloads.khinsider.com/">VGM</a></td><td align="left">游戏音乐、要登录、CC0 版权。</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
            <tag> 音乐 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>游戏导航</title>
      <link href="/2023/12/15/%E6%B8%B8%E6%88%8F%E5%AF%BC%E8%88%AA/"/>
      <url>/2023/12/15/%E6%B8%B8%E6%88%8F%E5%AF%BC%E8%88%AA/</url>
      
        <content type="html"><![CDATA[<h2 id="1、小游戏"><a href="#1、小游戏" class="headerlink" title="1、小游戏"></a>1、小游戏</h2><table><thead><tr><th align="left">▼ <strong>打发时间</strong></th><th align="left">—</th><th align="left">—</th><th align="left">—</th></tr></thead><tbody><tr><td align="left"><a href="http://magickeyboard.io/">魔术键盘</a></td><td align="left"><a href="https://eelslap.com/">海带鱼拍脸</a></td><td align="left"><a href="https://tikolu.net/spot-the-difference/menu">指出不一样</a></td><td align="left"><a href="https://vole.wtf/happy-birthday/">各式各样生日歌</a></td></tr><tr><td align="left"><a href="https://humanclock.com/">人类时钟</a></td><td align="left"><a href="https://www.slapkirk.com/play#spockmode">在线扇耳光</a></td><td align="left"><a href="https://qake.se/fw/index.html">在线放烟花</a></td><td align="left"><a href="https://theuselessweb.com/">无聊网站传送门</a></td></tr><tr><td align="left"><a href="https://seoi.net/penint/">画线为雕</a></td><td align="left"><a href="https://webapp.magicposer.com/">魔法人型师</a></td><td align="left"><a href="https://yesno.wtf/">Yes Or No?</a></td><td align="left"><a href="https://weirdorconfusing.com/">亚马逊雷人商品</a></td></tr><tr><td align="left"><a href="https://thisissand.com/">堆沙子游戏</a></td><td align="left"><a href="http://www.koalastothemax.com/">无限二分法</a></td><td align="left"><a href="https://pointerpointer.com/">鼠标指针在哪？</a></td><td align="left"><a href="https://www.twinsornot.com/">真不是双胞胎？</a></td></tr><tr><td align="left">▼ <strong>休闲解压</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://ac.yunyoujun.cn/#/">便携小空调</a></td><td align="left"><a href="https://tv.hzfe.org/">童年小电视</a></td><td align="left"><a href="https://driveandlisten.herokuapp.com/">全球自驾游体验</a></td><td align="left"><a href="https://www.pixelthoughts.co/">深呼吸放松 60 秒</a></td></tr><tr><td align="left"><a href="https://fan.elpsy.cn/">清凉小风扇</a></td><td align="left"><a href="http://www.megamonalisa.com/">蒙娜丽莎展馆</a></td><td align="left"><a href="https://9-eyes.com/">有趣谷歌街景图</a></td><td align="left"><a href="https://works.yangerxiao.com/breathe-relaxer/">静心呼吸 感受平静</a></td></tr><tr><td align="left"><a href="https://goldfishies.com/">在线养金鱼</a></td><td align="left"><a href="https://www.petside.com/infinite-cat/">猫的无限循环</a></td><td align="left"><a href="https://homeless-toys.netlify.app/#/">无家可归的玩偶</a></td><td align="left"></td></tr><tr><td align="left"><a href="https://alexanderperrin.com.au/paper/shorttrip/">短暂的旅行</a></td><td align="left"><a href="https://www.window-swap.com/Window">全球窗户共享</a></td><td align="left"><a href="http://www.donothingfor2minutes.com/">2 分钟什么也不干</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>学会思考</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://dccxi.com/trust/">信任的进化</a></td><td align="left"><a href="https://www.arealme.com/cn">各种各样的自我测试</a></td><td align="left"><a href="https://thechoiceisyours.whatisthematrix.com/cn/">选择你相信的现实</a></td><td align="left"><a href="https://neal.fun/life-checklist/">人生清单检查表</a></td></tr><tr><td align="left"><a href="https://ncase.me/crowds/zh-CN.html">群体的智慧与愚蠢</a></td><td align="left"><a href="http://www.20q.net/">20个问题猜你想什么</a></td><td align="left"><a href="https://www.getbadnews.com/#intro">假新闻是怎样炼成的</a></td><td align="left"><a href="https://www.futureme.org/">写给未来的自己 1</a></td></tr><tr><td align="left"><a href="https://cn.puzzle-nonograms.com/">经典逻辑推理游戏</a></td><td align="left"><a href="https://stylishsite.github.io/">贾斯纳的猫</a></td><td align="left"><a href="https://ncase.me/remember/zh.html">如何记忆任何东西</a></td><td align="left"><a href="https://www.hi2future.com/">写给未来的自己 2</a></td></tr><tr><td align="left"><a href="http://www.iqsuperman.net/">IQ 测试题</a></td><td align="left"><a href="https://types.yuzeli.com/survey">心理健康测试</a></td><td align="left"><a href="https://neal.fun/paper/">一张纸折N次的厚度</a></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.piixemto.com/zh/">心理学测试</a></td><td align="left"><a href="https://z-lyen.github.io/anxiety/">和焦虑一起冒险！</a></td><td align="left"><a href="https://www.did-you-knows.com/">DidYouKnow 冷知识</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>身体测试</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="http://www.ultrasonic-ringtones.com/">听觉测试</a></td><td align="left"><a href="https://michaelbach.de/ot/index.html">眼睛的幻觉</a></td><td align="left"><a href="https://enchroma.com/pages/color-blindness-test">色盲色弱测试</a></td><td align="left"><a href="http://illusionoftheyear.com/">全球视觉错觉收集</a></td></tr><tr><td align="left"><a href="https://checkboxrace.com/">点击选择框</a></td><td align="left"><a href="http://mp3ornot.com/">音质区别测试</a></td><td align="left"><a href="https://www.qijishow.com/Brand/cool/index.html">带你体验扭曲幻觉</a></td><td align="left"><a href="https://humanbenchmark.com/">记忆力反应力测试</a></td></tr><tr><td align="left">▼ <strong>生活技能</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://yong.dgod.net/webim/index.html">在线输入法</a></td><td align="left"><a href="https://api.ihint.me/shuang/">双拼指法练习</a></td><td align="left"><a href="https://qwerty.kaiyi.cool/">英语指法练习 1</a></td><td align="left"><a href="https://vultr.youmu.moe/quiz/">中国行政区划测试</a></td></tr><tr><td align="left"><a href="https://www.type.fun/">轻松学打字</a></td><td align="left"><a href="http://www.chaiwubi.com/bmcx/">五笔编码查询</a></td><td align="left"><a href="https://www.typelit.io/">英语指法练习 2</a></td><td align="left"><a href="https://www.foldnfly.com/#/1-1-1-1-1-1-1-1-2">教你如何拆纸飞机</a></td></tr><tr><td align="left"><a href="https://www.typingclub.com/da-zi">键盘指法练习</a></td><td align="left"><a href="https://werneror.github.io/FingerMemory/">五笔指法练习</a></td><td align="left"><a href="https://www.keybr.com/">英语指法练习 3</a></td><td align="left"><a href="https://www.animatedknots.com/">教你如何绳子打结</a></td></tr></tbody></table><h2 id="2、在线游戏"><a href="#2、在线游戏" class="headerlink" title="2、在线游戏"></a>2、在线游戏</h2><table><thead><tr><th align="left">▼ <strong>游戏网站</strong></th><th align="left">—</th><th align="left">—</th><th align="left">—</th></tr></thead><tbody><tr><td align="left"><a href="https://www.4399.com/">4399</a></td><td align="left"><a href="https://poki.cn/">Poki</a></td><td align="left"><a href="https://neal.fun/">Neal.Fun</a></td><td align="left"><a href="https://www.bestgames.com/">Best Games</a></td></tr><tr><td align="left"><a href="https://www.17173.com/">17173</a></td><td align="left"><a href="https://frvr.com/">FRVR</a></td><td align="left"><a href="https://zh.y8.com/">Y8 Games</a></td><td align="left"><a href="https://www.crazygames.com/">Crazy Games</a></td></tr><tr><td align="left">▼ <strong>在线游戏</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://game.hullqin.cn/">线下聚会游戏</a></td><td align="left"><a href="https://flash.zczc.cz/">Flash 保存计划</a></td><td align="left"><a href="https://nes.heheda.top/">红白机游戏盒</a></td><td align="left"><a href="https://likexia.gitee.io/game/index.html#/">Git 游戏</a></td></tr><tr><td align="left"><a href="https://dos.lol/">在线 DOS 游戏</a></td><td align="left"><a href="https://game.haiyong.site/">100个摸鱼小游戏</a></td><td align="left"><a href="https://zaixianwan.app/">老游戏在线玩</a></td><td align="left"><a href="https://g8hh.com.cn/#/">锅巴汉化</a></td></tr><tr><td align="left"><a href="https://www.yikm.net/">小霸王，其乐无穷</a></td><td align="left"><a href="https://famicn.com/index.html">中文家用游戏博物馆</a></td><td align="left"><a href="http://www.gbarom.cn/">掌机迷</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>动作游戏</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.4399.com/flash/145201_2.htm">拳皇97</a></td><td align="left"><a href="https://pvz.heheda.top/">植物大战僵尸</a></td><td align="left"><a href="http://oos.moxiecode.com/js_webgl/ping_pong/">3D 乒乓球</a></td><td align="left"><a href="http://www.sinuousgame.com/">鼠标躲避球游戏</a></td></tr><tr><td align="left"><a href="https://krunker.io/?game=SV:umt2g">在线 CS</a></td><td align="left"><a href="https://classic.minecraft.net/?join=XeFyaTfaMDn-1-Px">我的世界</a></td><td align="left"><a href="https://www.linerider.com/">轨道滑行者</a></td><td align="left"><a href="https://www.foddy.net/Athletics.html">QWOP 跑步游戏</a></td></tr><tr><td align="left"><a href="https://bruno-simon.com/">在线开车</a></td><td align="left"><a href="https://fn.heheda.top/">水果忍者</a></td><td align="left"><a href="http://canvasrider.com/">轨道滑行者 2</a></td><td align="left"><a href="https://img.youquhome.com/wp-ziyuan/nanren20.htm">是男人坚持20秒</a></td></tr><tr><td align="left"><a href="https://game.chronodivide.com/">红色警戒 2</a></td><td align="left"><a href="https://squid-game.io/">鱿鱼游戏</a></td><td align="left"><a href="https://tusenpo.github.io/FlappyFrog/">Excited 的小鸟 ▲</a></td><td align="left"><a href="https://edition.cnn.com/interactive/2021/03/cnnix-steership/">苏伊士运河模拟器</a></td></tr><tr><td align="left"><a href="https://playcsol.com/">反恐精英 1.6</a></td><td align="left"><a href="http://www.heyzxz.me/pcol/">斯诺克</a></td><td align="left"><a href="https://www.geo-fs.com/">在线飞行模拟器</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>棋牌游戏</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://playtictactoe.org/">井字棋</a></td><td align="left"><a href="https://huazhechen.gitee.io/cuber/">三阶魔方 1</a></td><td align="left"><a href="https://knots.netlify.app/">环形结拼图</a></td><td align="left"><a href="https://yorg.io/">塔防生存游戏</a></td></tr><tr><td align="left"><a href="https://lichess.org/">国际象棋</a></td><td align="left"><a href="https://iamthecu.be/">三阶魔方 2</a></td><td align="left"><a href="https://kirilllive.github.io/Fifteen_puzzle_maker/">滑动拼图</a></td><td align="left"><a href="https://printablecreative.com/">益智游戏图生成器</a></td></tr><tr><td align="left"><a href="https://lines.frvr.com/">连线游戏</a></td><td align="left"><a href="https://blocks.ovh/">七巧板</a></td><td align="left"><a href="https://slices.ovh/">益智切图</a></td><td align="left"></td></tr><tr><td align="left"><a href="http://farter.cn/tetr.js/">俄罗斯方块 1</a></td><td align="left"><a href="https://ruyihe.com/sxx">疯狂数星星</a></td><td align="left"><a href="https://maze.toys/mazes/mini/">迷宫游戏</a></td><td align="left"></td></tr><tr><td align="left"><a href="https://chvin.github.io/react-tetris/">俄罗斯方块 2</a></td><td align="left"><a href="http://www.jigzone.com/">拼图游戏</a></td><td align="left"><a href="https://www.webhek.com/post/draw-a-stickman/">请画一个小人</a></td><td align="left"></td></tr></tbody></table><h2 id="3、PC-游戏"><a href="#3、PC-游戏" class="headerlink" title="3、PC 游戏"></a>3、PC 游戏</h2><table><thead><tr><th align="left">▼ <strong>门户网站</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://www.3dmgame.com/">3DM游戏网</a></td><td align="left">游戏门户网站，曾经是国内游戏资源最多的网站。</td></tr><tr><td align="left">🌐 <a href="https://www.gamersky.com/">游民星空</a></td><td align="left">游戏门户网站，大型单机游戏门户网站，提供特色资讯和下载。</td></tr><tr><td align="left">🌐 <a href="https://down.ali213.net/">游侠网</a></td><td align="left">游戏门户网站，单机游戏下载基地。</td></tr><tr><td align="left">🌐 <a href="https://www.vgter.com/">上游世界</a></td><td align="left">游戏门户网站，提供精品 PC、Switch、PS4 等游戏。</td></tr><tr><td align="left">🌐 <a href="https://www.mhhf.com/">灵动游戏</a></td><td align="left">游戏门户网站，提供精品 PC、Switch、PS4 等游戏。</td></tr><tr><td align="left">🌐 <a href="https://www.taptap.cn/">TapTap</a></td><td align="left">游戏门户网站，多为手机游戏。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>博客网站</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.zzzzz688.com/">游戏天堂</a></td><td align="left">游戏博客网站，全球游戏下载基地，</td></tr><tr><td align="left">🌐 <a href="https://steamzg.com/">小叽资源</a></td><td align="left">游戏博客网站，可免费下载。</td></tr><tr><td align="left">🌐 <a href="https://www.jiligamefun.com/">叽哩叽哩游戏</a></td><td align="left">游戏博客网站，多为 ACG 游戏.<a href="https://mp.weixin.qq.com/s/vKpSKCMICy0cBp7OACnMPw">验证码</a>。</td></tr><tr><td align="left">🌐 <a href="https://www.xyg688.com/">小妖怪分享</a></td><td align="left">游戏博客网站，兴趣使然的资源搬运博客。</td></tr><tr><td align="left">🌐 <a href="https://kims3.xyz/">kims资源站</a></td><td align="left">游戏博客网站，免费电脑游戏下载站，提供高速下载。</td></tr><tr><td align="left">🌐 <a href="https://www.switch618.com/">Switch618</a></td><td align="left">游戏博客网站，免费，但要登陆。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>Stream 游戏</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://store.steampowered.com/">Steam</a></td><td align="left">游戏门户网站，目前最大 PC 游戏平台。</td></tr><tr><td align="left">🌐 <a href="https://steamunlocked.net/">SteamUnlocked</a></td><td align="left">Steam 资源游戏网站，有很多大作破解。</td></tr><tr><td align="left">🌐 <a href="https://www.s-sgames.com/">SGAMES</a></td><td align="left">专注于精品游戏，各类可联机精品资源。</td></tr><tr><td align="left">🌐 <a href="https://gamestarfield.com/">GameStarfield</a></td><td align="left">Steam 资源游戏网站，有很多大作破解。</td></tr><tr><td align="left">🌐 <a href="https://www.curseforge.com/">CurseForge</a></td><td align="left">全球最大的游戏 MOD 模组资源下载站。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>游戏网盘</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="http://gbtgame.ysepan.com/">GBT乐赏游戏空间</a></td><td align="left">游戏资源网盘。PC 游戏为主，收藏多为精品游戏。</td></tr><tr><td align="left">🌐 <a href="http://flysheep.ysepan.com/">flysheep 避难所</a></td><td align="left">游戏资源网盘。Steam、epic、VR、单机、Switch 游戏等。<a href="https://www.flysheep6.com/">独立网站</a></td></tr><tr><td align="left">🌐 <a href="http://821730880.ysepan.com/">萌新单机之家</a></td><td align="left">游戏资源网盘。</td></tr><tr><td align="left">🌐 <a href="https://docs.qq.com/document/DT2xBeVJvaHNQUHht">50TB游戏合集</a></td><td align="left">游戏资源网盘。<a href="https://www.lanzouw.com/iYp4j067mbtg">Excel 下载</a>。</td></tr><tr><td align="left">🌐 <a href="https://github.com/michelpereira/awesome-open-source-games">开源游戏合集</a></td><td align="left">开源游戏合集。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>游戏磁力</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.1377x.to/">1377x</a></td><td align="left">游戏种子搜索引擎，综合资源站。</td></tr><tr><td align="left">🌐 <a href="https://bt4gprx.com/">BT4G ▲</a></td><td align="left">游戏种子搜索引擎，综合资源站。</td></tr><tr><td align="left">🌐 <a href="https://torrentgalaxy.to/">TorrentGalaxy</a></td><td align="left">游戏种子搜索引擎，综合资源站。</td></tr><tr><td align="left">🌐 <a href="https://www.limetorrents.lol/">LimeTorrents</a></td><td align="left">游戏种子搜索引擎，综合资源站。</td></tr><tr><td align="left">🌐 <a href="https://rutracker.org/forum/index.php">RuTracker.org</a></td><td align="left">游戏种子搜索引擎，综合资源站。</td></tr><tr><td align="left">🌐 <a href="https://pcgamestorrents.com/">PCGamesTorrent</a></td><td align="left">游戏种子磁力网站。</td></tr><tr><td align="left">🌐 <a href="https://www.gamestorrents.fm/home/">GamesTorrents</a></td><td align="left">游戏种子磁力网站。</td></tr><tr><td align="left">🌐 <a href="https://cpygames.com/">CPY GAMES</a></td><td align="left">游戏种子磁力网站。</td></tr><tr><td align="left">🌐 <a href="https://crotorrents.com/">CroTorrents</a></td><td align="left">游戏种子磁力网站。</td></tr><tr><td align="left">🌐 <a href="https://igg-games.com/">IGGGAMES</a></td><td align="left">游戏种子磁力网站。</td></tr><tr><td align="left">🌐 <a href="https://fitgirl-repacks.site/">FitGirl Repacks</a></td><td align="left">游戏种子磁力网站。</td></tr><tr><td align="left">🌐 <a href="https://repack-games.com/">Repack-Games</a></td><td align="left">游戏种子磁力网站。</td></tr><tr><td align="left">🌐 <a href="https://rutracker.org/forum/index.php">RuTracker</a></td><td align="left">游戏种子磁力网站，俄语。</td></tr><tr><td align="left">🌐 <a href="https://thebyrut.org/">Byrut</a></td><td align="left">游戏种子磁力网站，俄语。</td></tr></tbody></table><h2 id="4、Mac-游戏"><a href="#4、Mac-游戏" class="headerlink" title="4、Mac 游戏"></a>4、Mac 游戏</h2><table><thead><tr><th align="left">▼ <strong>Mac 游戏</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">📥 <a href="https://www.lanzouw.com/i726k0z4j4pi">Mac 游戏集合</a></td><td align="left">某游戏网站流出 300+ 款 Mac 平台热门游戏，提供网盘下载。</td></tr><tr><td align="left">📥 <a href="https://playcover.io/">PlayCover</a></td><td align="left">在 Mac（Arm芯片） 上运行 iOS 应用，比如“<strong>原神</strong>”等游戏。</td></tr><tr><td align="left">📥 <a href="https://getwhisky.app/zh-Hans/">Whisky</a></td><td align="left">在 Mac（Arm芯片） 上运行 Windows 应用，比如“<strong>原神</strong>”等游戏。</td></tr><tr><td align="left">🌐 <a href="https://decrypt.day/">Decrypt Day</a></td><td align="left">IPA 脱壳应用下载，海外网站，速度可能较慢。</td></tr><tr><td align="left">🌐 <a href="https://ipa.store/">iPA Store</a></td><td align="left">IPA 脱壳应用下载，需要注册载，每天 2 个免费下载次数。</td></tr></tbody></table><h2 id="5、游戏工具"><a href="#5、游戏工具" class="headerlink" title="5、游戏工具"></a>5、游戏工具</h2><table><thead><tr><th align="left">▼ <strong>游戏工具</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">📜 <a href="https://greasyfork.org/zh-CN/scripts/437233">防沉迷终结者</a></td><td align="left">去除国内 17173、4399 等游戏网站的登录需求。</td></tr><tr><td align="left">📥 <a href="https://browser.360.cn/eex/index.html">360 极速浏览器X</a></td><td align="left">目前还支持 Flash 的浏览器，推荐<a href="https://www.123pan.com/s/7bzA-pQpOd">奶酪版本</a>，而且还有 <a href="https://browser.360.cn/ee/mac/index.html">Mac 版本</a>。</td></tr><tr><td align="left">📥 <a href="https://pcstory.net/">蘑菇游戏下载器</a></td><td align="left">下载器，网吧 36T 游戏全部到你口袋里，点击下载完成后直接开玩。</td></tr><tr><td align="left">📥 <a href="https://steampp.net/">Watt Toolkit</a></td><td align="left">加速器，支持 Win、Mac、Linux 多平台。</td></tr><tr><td align="left">📥 <a href="https://uu.163.com/">UU加速器</a></td><td align="left">加速器，网易出品，免费，不止快，还很稳。</td></tr><tr><td align="left">📥 <a href="https://www.wemod.com/zh">WeMod</a></td><td align="left">修改器，PC 游戏作弊、修改器和 Mod 尽在一款应用中。</td></tr><tr><td align="left">📥 <a href="https://blog.csdn.net/vbcom/article/details/7245186">DirectX Repair</a></td><td align="left">检测并修复系统的 DirectX 状态，玩大型游戏必备。</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
            <tag> 游戏 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis笔记</title>
      <link href="/2023/11/13/mybatis/"/>
      <url>/2023/11/13/mybatis/</url>
      
        <content type="html"><![CDATA[<h2 id="一、MyBatis"><a href="#一、MyBatis" class="headerlink" title="一、MyBatis"></a>一、MyBatis</h2><h3 id="1-MyBatis："><a href="#1-MyBatis：" class="headerlink" title="1.MyBatis："></a>1.MyBatis：</h3><p>MyBatis：是一个半自动映射的框架。这里所谓的“半自动”是相对于Hibernate全表映射而言的，MyBatis需要手动匹配提供POJO、SQL和映射关系，而Hibernate只需提供POJO和映射关系即可。<br>与Hibernate相比，虽然使用MyBatis手动编写SQL要比使用Hibernate的工作量大，但MyBatis可以配置动态SQL并优化SQL，可以通过配置决定SQL的映射规则，它还支持存储过程等。对于一些复杂的和需要优化性能的项目来说，显然使用MyBatis更加合适。</p><p>MyBatis框架是当前主流的Java持久层（数据访问层DAO）框架之一，它与Hibernate一样，也是一种ORM（Object&#x2F;Relation Mapping，即对象关系映射）框架。所谓的ORM就是一种为了解决面向对象与关系型数据库中数据类型不匹配的技术，它通过描述Java对象与数据库表之间的映射关系，自动将Java应用程序中的对象持久化到关系型数据库的表中。</p><h3 id="2-MyBatis核心组件："><a href="#2-MyBatis核心组件：" class="headerlink" title="2.MyBatis核心组件："></a>2.MyBatis核心组件：</h3><p>SqlSessionFactoryBuilder（构造器）: 根据XML配置（推荐方式）或者代码来生成SqlSessionFactory（工厂接口）对象, 创建完成后该对象就不需要了，所以只需要使用一次，后面无需保存。</p><p>SqlSessionFactory：依靠工厂来创建SqlSession（会话）对象；该对象是线程安全的，所以整个应用只需要保存一个。</p><p>SqlSession：类似于一个JDBC的Connection对象。是一个既可以发送SQL去执行并返回结果，也可以获取Mapper的接口。</p><p>SQL Mapper：是MyBatis新设计的组件，是由一个Java接口和XML文件（或注解）构成的，需要给出对应的SQL和映射规则。负责发送SQL去执行，并返回结果。通过namespace.id调用Mapper中定义的SQL。</p><h3 id="3-MyBatis框架的工作执行流程如下："><a href="#3-MyBatis框架的工作执行流程如下：" class="headerlink" title="3. MyBatis框架的工作执行流程如下："></a>3. MyBatis框架的工作执行流程如下：</h3><p>（1）读取MyBatis配置文件mybatis-config.xml。<br>（2）加载映射文件Mapper.xml。<br>（3）构建会话工厂。<br>（4）创建SqlSession对象。<br>（5）使用Executor接口来操作数据库。<br>（6）使用MappedStatement类型的参数对映射信息进行封装。<br>（7）输入参数映射。<br>（8）输出结果映射。</p><h3 id="4-元素"><a href="#4-元素" class="headerlink" title="4. &lt;sql&gt;元素"></a>4. <code>&lt;sql&gt;</code>元素</h3><p><code>&lt;sql&gt;</code>元素的作用就是定义可重用的SQL代码片段。使用时，先通过<code>&lt;sql&gt;</code>元素定义重用的代码片段，然后在需要使用的地方使用<code>&lt;include&gt;</code>元素的refid属性引用了自定义的代码片段。</p><h3 id="5-MyBatis核心对象SqlSessionFactory的获取方式："><a href="#5-MyBatis核心对象SqlSessionFactory的获取方式：" class="headerlink" title="5.MyBatis核心对象SqlSessionFactory的获取方式："></a>5.MyBatis核心对象SqlSessionFactory的获取方式：</h3><p>SqlSessionFactory对象的实例可以通过SqlSessionFactoryBuilder对象来构建，而SqlSessionFactoryBuilder则可以通过XML配置文件或一个预先定义好的Configuration实例构建出SqlSessionFactory的实例，通过XML配置文件构建出的SqlSessionFactory实例，其实现代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取配置文件</span></span><br><span class="line"><span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;配置文件位置&quot;</span>);</span><br><span class="line"><span class="comment">// 根据配置文件构建SqlSessionFactory</span></span><br><span class="line"><span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> </span><br><span class="line"><span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(inputStream);</span><br></pre></td></tr></table></figure><p><strong>MyBatis使用过程：</strong><br>使用SqlSessionFactoryBuilder创建SqlSessionFactory对象;</p><p>然后通过SqlSessionFactory创建SqlSession对象;</p><p>通过SqlSession对象完成基本操作（执行SQL）。</p><p>关闭SqlSession。</p><h3 id="6-元素"><a href="#6-元素" class="headerlink" title="6. &lt;mapper&gt;元素"></a>6. <code>&lt;mapper&gt;</code>元素</h3><p>在映射文件中，<code>&lt;mapper&gt;</code>元素是映射文件的根元素，其他元素都是它的子元素。这些子元素及其作用如下所示：<br><code>&lt;select&gt;</code>：用于映射查询语句，可自定义参数，返回结果集等。<br><code>&lt;insert&gt;</code>：用于映射插入语句，执行后返回一个整数，代表插入的条数。<br><code>&lt;update&gt;</code>：用于映射更新语句，执行后返回一个整数，代表更新的条数。<br><code>&lt;delete&gt;</code>：用于映射删除语句，执行后返回一个整数，代表删除的条数。<br><code>&lt;sql&gt;</code>：用于定义一部分SQL，然后可被其他语句引用此SQL。<br><code>&lt;cache&gt;</code>：用于给定命名空间的缓存配置。<br><code>&lt;cache-ref&gt;</code>：用于其他命名空间缓存配置的引用。<br><code>&lt;resultMap&gt;</code>：用于描述如何从数据库结果集中来加载对象。</p><p>当数据表中的列和需要返回的对象的属性不完全一致， MyBatis是不会自动赋值的。此时，就可以使用<code>&lt;resultMap&gt;</code>元素进行处理。<code>&lt;resultMap&gt;</code>元素的子元素<code>&lt;id&gt;</code>用于表示哪个列是主键，而<code>&lt;result&gt;</code>元素用于表示POJO和数据表中普通列的映射关系。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;custResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Customer&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;custId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cust_id&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-mybatis中映射文件include标签应用"><a href="#7-mybatis中映射文件include标签应用" class="headerlink" title="7. mybatis中映射文件include标签应用"></a>7. mybatis中映射文件include标签应用</h3><p>MyBaits映射文件中使用<code>&lt;include&gt;</code>元素的 refid 属性可以引用自定义的代码片段，其属性值为自定义代码片段的id。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;custColumns&quot;</span>&gt;</span> </span><br><span class="line">cust_id custId,name,age </span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;sqlCustList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Customer&quot;</span>&gt;</span></span><br><span class="line">select</span><br><span class="line"><span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;custColumns&quot;</span>/&gt;</span>   </span><br><span class="line">from customer c</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-MyBatis映射文件中元素"><a href="#8-MyBatis映射文件中元素" class="headerlink" title="8. MyBatis映射文件中&lt;mapper&gt;元素"></a>8. MyBatis映射文件中<code>&lt;mapper&gt;</code>元素</h3><p>MyBatis映射文件中<code>&lt;mapper&gt;</code>元素是配置文件的根元素，它包含一个namespace属性，该属性为这个<code>&lt;mapper&gt;</code>指定了唯一的命名空间。在Mybatis映射文件中，每个操作都有一个id属性表示操作的唯一标识。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;customer&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;customerList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Customer&quot;</span>&gt;</span></span><br><span class="line">         select * from customer</span><br><span class="line">     <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-MyBatis映射文件中元素"><a href="#9-MyBatis映射文件中元素" class="headerlink" title="9. MyBatis映射文件中&lt;insert&gt;元素"></a>9. MyBatis映射文件中<code>&lt;insert&gt;</code>元素</h3><p>MyBatis映射文件中<code>&lt;insert&gt;</code>元素用于映射插入语句，在执行完元素中定义的SQL语句后，与<code>&lt;update&gt;</code>和<code>&lt;delete&gt;</code>元素在执行完之后一样，也会返回一个表示影响记录条数的整数。<code>&lt;insert&gt;</code>元素的属性与<code>&lt;select&gt;</code>元素的属性不同，可以使用keyProperty属性指定哪个是主键字段，使用useGeneratedKeys属性定义主键是否使用数据库内置策略生成，从而实现对于表中自增编号主键列的主键回填和自定义功能。</p><h3 id="10-根据MyBatis的映射文件编写Mapper接口过程中涉及的关键问题如下："><a href="#10-根据MyBatis的映射文件编写Mapper接口过程中涉及的关键问题如下：" class="headerlink" title="10.根据MyBatis的映射文件编写Mapper接口过程中涉及的关键问题如下："></a>10.根据MyBatis的映射文件编写Mapper接口过程中涉及的关键问题如下：</h3><p>通常一个映射文件对应一个Mapper接口，映射文件中的namespace与接口的全限定名一致。</p><p>映射文件中每个操作id对应Mapper接口的一个方法，方法名与映射文件中操作的id相同，参数类型和返回值类型与操作中的parameterType和resultType相同</p><p>SQL调用的时候通过接口调用，而不用再指出操作的id</p><h3 id="11-MyBatis配置XML文件结构如下"><a href="#11-MyBatis配置XML文件结构如下" class="headerlink" title="11.MyBatis配置XML文件结构如下"></a>11.MyBatis配置XML文件结构如下</h3><p>mybatis-config.xml作为MyBatis的全局配置文件，配置了MyBatis的运行环境等信息。<br>MyBatis配置XML文件结构如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">configuration</span>&gt;</span><span class="comment">&lt;!-- 配置--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">properties</span>/&gt;</span><span class="comment">&lt;!-- 属性--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">settings</span>/&gt;</span><span class="comment">&lt;!--设置--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">typeAliases</span>/&gt;</span><span class="comment">&lt;!-- 类型命名--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">typeHandlers</span>/&gt;</span> <span class="comment">&lt;!--类型处理器--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">objectFactory</span>/&gt;</span>  &lt;!– 对象工厂 --&gt;</span><br><span class="line">     <span class="tag">&lt;<span class="name">plugings</span>/&gt;</span>  <span class="comment">&lt;!--插件 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">environments</span>&gt;</span> <span class="comment">&lt;!--配置环境--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">environment</span>&gt;</span> <span class="comment">&lt;!--环境变量--&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">transactionManager</span>/&gt;</span><span class="comment">&lt;!--事务管理器--&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">dataSource</span>/&gt;</span> <span class="comment">&lt;!--数据源--&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">databaseIdProvider</span>/&gt;</span><span class="comment">&lt;!--数据库厂商标识--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">mappers</span>/&gt;</span> <span class="comment">&lt;!--映射器--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这些层次是不能够颠倒顺序的，如果颠倒顺序，MyBatis在解析XML文件的时候就会出现异常。例如：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">     <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;entity.Customer&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;Customer&quot;</span> /&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;entity.Course&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;Course&quot;</span> /&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;entity.QuickManual&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;QuickManual&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line">                 <span class="comment">&lt;!-- ?useUnicode=true&amp;amp;characterEncoding=utf8为了支持中文数据的写入 --&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/test?useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span> /&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mapper/CustomerMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mapper/CourseMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mapper/QuickManualMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringMVC笔记</title>
      <link href="/2023/11/13/SpringMVC/"/>
      <url>/2023/11/13/SpringMVC/</url>
      
        <content type="html"><![CDATA[<h2 id="一、Spring框架"><a href="#一、Spring框架" class="headerlink" title="一、Spring框架"></a>一、Spring框架</h2><h3 id="1-典型的Web层框架包括："><a href="#1-典型的Web层框架包括：" class="headerlink" title="1.典型的Web层框架包括："></a>1.典型的Web层框架包括：</h3><p>Struts1<br>Web work<br>Struts2<br>Spring MVC</p><p>Spring MVC是Spring提供的一个实现了Web MVC设计模式的轻量级Web框架。采用工厂模式。它与Struts2框架一样，都属于MVC框架，但其使用和性能等方面比Struts2更加优异。SpringMVC项目中必须添加的JAR包包括：4个核心JAR包、commons-logging的JAR以及两个web相关的JAR（spring-web和spring-webmvc的JAR包）。</p><h3 id="2-Spring-MVC的特点。"><a href="#2-Spring-MVC的特点。" class="headerlink" title="2.Spring MVC的特点。"></a>2.Spring MVC的特点。</h3><p>（1） 是Spring框架的一部分，可以方便的利用Spring所提供的其他功能。<br>（2） 灵活性强，易于与其他框架集成。<br>（3） 提供了一个前端控制器DispatcherServlet，使开发人员无需额外开发控制器对象。<br>（4） 可自动绑定用户输入，并能正确的转换数据类型。<br>（5） 内置了常见的校验器，可以校验用户输入。如果校验不能通过，那么就会重定向到输入表单。<br>（6） 支持国际化。可以根据用户区域显示多国语言。</p><h3 id="3-Spring-MVC主要有如下优点："><a href="#3-Spring-MVC主要有如下优点：" class="headerlink" title="3.Spring MVC主要有如下优点："></a>3.Spring MVC主要有如下优点：</h3><p>（1）是Spring框架的一部分，可以方便的利用Spring所提供的其他功能。<br>（2）灵活性强，易于与其他框架集成。<br>（3）提供了一个前端控制器DispatcherServlet，使开发人员无需额外开发控制器对象。<br>（4）可自动绑定用户输入，并能正确的转换数据类型。<br>（5）内置了常见的校验器，可以校验用户输入。如果校验不能通过，那么就会重定向到输入表单。<br>（6）支持国际化。可以根据用户区域显示多国语言。<br>（7）支持多种视图技术。它支持JSP、Velocity和FreeMarker等视图技术。<br>（8）使用基于XML的配置文件，在编辑后，不需要重新编译应用程序。</p><h3 id="4-Spring-MVC框架的工作流程如下："><a href="#4-Spring-MVC框架的工作流程如下：" class="headerlink" title="4.Spring MVC框架的工作流程如下："></a>4.Spring MVC框架的工作流程如下：</h3><p>（1）用户通过浏览器向服务器发送请求，请求会被Spring MVC的前端控制器DispatcherServlet所拦截。<br>（2）DispatcherServlet拦截到请求后，会调用HandlerMapping处理器映射器。<br>（3）处理器映射器根据请求URL找到具体的处理器，生成处理器对象及处理器拦截器（如果有则生成）一并返回给DispatcherServlet 。<br>（4）DispatcherServlet会通过返回信息选择合适的HandlerAdapter（处理器适配器）。<br>（5）HandlerAdapter会调用并执行Handler（处理器），这里的处理器指的就是程序中编写的Controller类，也被称之为后端控制器。<br>（6）Controller执行完成后，会返回一个ModelAndView对象，该对象中会包含视图名或包含模型和视图名。<br>（7）HandlerAdapter将ModelAndView对象返回给DispatcherServlet 。<br>（8）DispatcherServlet会根据ModelAndView对象选择一个合适的ViewReslover（视图解析器）。<br>（9）ViewReslover解析后，会向DispatcherServlet中返回具体的View（视图）。<br>（10）DispatcherServlet对View进行渲染（即将模型数据填充至视图中）。<br>（11）视图渲染结果会返回给客户端浏览器显示。</p><h3 id="5-在web-xml中，配置Spring-MVC的前端控制器DispatcherServlet"><a href="#5-在web-xml中，配置Spring-MVC的前端控制器DispatcherServlet" class="headerlink" title="5.在web.xml中，配置Spring MVC的前端控制器DispatcherServlet"></a>5.在web.xml中，配置Spring MVC的前端控制器DispatcherServlet</h3><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231113230308.png"></p><p>如果没有通过<init-param>元素配置，应用程序会默认到WEB-INF目录下寻找如下方式命名的配置文件：servletName-servlet.xml。servletName指的是部署在web.xml文件中的DispatcherServlet的名称，而-servlet.xml是配置文件名的固定写法，如在WEB-INF下查找springmvc-servlet.xml文件。</p><h3 id="6-控制器方法的返回值类型"><a href="#6-控制器方法的返回值类型" class="headerlink" title="6.控制器方法的返回值类型"></a>6.控制器方法的返回值类型</h3><p>ModelAndView类型中可以添加Model数据，并指定视图；String类型的返回值可以跳转视图，但不能携带数据；而void类型主要在异步请求时使用，它只返回数据，而不会跳转视图。</p><h3 id="7-Controller注解在使用时可分为如下两步："><a href="#7-Controller注解在使用时可分为如下两步：" class="headerlink" title="7.@Controller注解在使用时可分为如下两步："></a>7.@Controller注解在使用时可分为如下两步：</h3><p>（1）在相应的类上标注@Controller注解。<br>（2）在Spring MVC的配置文件中添加相应的扫描配置信息。首先需要在配置文件中引入context名称空间的配置，然后使用<code>&lt;context:component-scan&gt;</code>元素指定需要扫描的类包。</p><h3 id="8-SpringMVC框架下请求处理方法的参数类型："><a href="#8-SpringMVC框架下请求处理方法的参数类型：" class="headerlink" title="8.SpringMVC框架下请求处理方法的参数类型："></a>8.SpringMVC框架下请求处理方法的参数类型：</h3><p>基于SpringMVC框架下请求处理方法的参数类型主要有：HttpServletRequest、HttpServletResponse、HttpSession、Model、HttpMethod等；<br>基于SpringMVC框架下请求处理方法的返回类型主要有：ModelAndView、Map、String、void、HttpEntity&lt;?&gt;、View等。</p><h3 id="9-SpringMVC中获取输入值的方式主要有："><a href="#9-SpringMVC中获取输入值的方式主要有：" class="headerlink" title="9.SpringMVC中获取输入值的方式主要有："></a>9.SpringMVC中获取输入值的方式主要有：</h3><p>在action的方法中写与请求参数同名的变量</p><p>在action的方法的参数中使用HttpServletRequest、HttpServletResponse、HttpSession、Model、HttpMethod等对象</p><p>在方法的参数中使用@RequestParam注解</p><p>界面上的输入信息是某个自定义对象的信息，在接收的时候直接封装为该自定义对象</p><p>把请求参数放到请求路径中，即采用RESTful风格。</p><h3 id="10-SpringMVC中对用户的响应方式主要有："><a href="#10-SpringMVC中对用户的响应方式主要有：" class="headerlink" title="10.SpringMVC中对用户的响应方式主要有："></a>10.SpringMVC中对用户的响应方式主要有：</h3><p>返回ModelAndView对象，如new ModelAndView(“studentList”,model)，第一个参数表示视图，第二参数表示视图中需要的数据。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/studentUpdateView.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">updateView</span><span class="params">(String id)</span>&#123;</span><br><span class="line"><span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> studentService.findById(id);</span><br><span class="line">Map&lt;String,Object&gt; model = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String,Object&gt;();</span><br><span class="line">model.put(<span class="string">&quot;student&quot;</span>,student);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>(<span class="string">&quot;studentUpdate&quot;</span>,model);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>控制层的方法返回值类型为String，在方法中返回表示输出界面的字符串，与ModelAndView中的第一个参数相同</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;studentAddView.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">addView</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;studentAdd&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​使用String表示要返回的视图，使用Model表示要返回的数据。在请求方法的参数中定义Model对象，在请求方法体中把数据存储到Model对象中响应给前端页面。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/studentList.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">studentList</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">List&lt;Student&gt; students = studentService.getStudents();</span><br><span class="line">model.addAttribute(<span class="string">&quot;students&quot;</span>,students);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;studentList&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​返回JSON数据。</p><h3 id="11-RequestParam注解"><a href="#11-RequestParam注解" class="headerlink" title="11.@RequestParam注解"></a>11.@RequestParam注解</h3><p>@RequestParam注解主要用于对请求中的参数进行定义，多用于在请求参数名与方法形参名不一致时的参数间接绑定。在使用时可以指定他的4个属性，具体如下：<br>（1）value：name属性的别名，这里指参数的名字，即入参的请求参数名字，如果只使用vaule属性，则可以省略value属性名。<br>（2）name：用于指定请求头绑定的名称。<br>（3）required ：用于指定参数是否必须，默认是true，表示请求中一定要有相应的参数。<br>（4）defaultValue：默认值，表示如果请求中没有同名参数时的默认值。</p><h3 id="12-在使用包装POJO类型数据绑定时"><a href="#12-在使用包装POJO类型数据绑定时" class="headerlink" title="12.在使用包装POJO类型数据绑定时"></a>12.在使用包装POJO类型数据绑定时</h3><p>在使用包装POJO类型数据绑定时，前端请求的参数名编写必须符合以下两种情况：<br>（1）如果查询条件参数是包装类的直接基本属性，则参数名直接用对应的属性名；<br>（2）如果查询条件参数是包装类中POJO的子属性，则参数名必须为“对象.属性”，其中“对象”要和包装POJO中的对象属性名称一致，“属性”要和包装POJO中的对象子属性一致。</p><h3 id="13-JSON数据交互时，主要使用的两个注解-RequestBody和-ResponseBody"><a href="#13-JSON数据交互时，主要使用的两个注解-RequestBody和-ResponseBody" class="headerlink" title="13.JSON数据交互时，主要使用的两个注解@RequestBody和@ResponseBody"></a>13.JSON数据交互时，主要使用的两个注解@RequestBody和@ResponseBody</h3><p>JSON数据交互时，主要使用了两个注解@RequestBody和@ResponseBody。其中@RequestBody用于将请求体中的数据绑定到方法的形参中，在使用时标准在在方法的形参上。@ResponseBody用于直接返回return对象。Jackson用到的开源包的有 jackson-annoations-2.8.8.jar、 jackson-core-2.8.8.jar、jackson-databind-2.8.8.jar。</p><h3 id="14-JSON对象的数组结构"><a href="#14-JSON对象的数组结构" class="headerlink" title="14.JSON对象的数组结构"></a>14.JSON对象的数组结构</h3><p>JSON对象的数组结构以 “[” 开始，以 “]” 结束，对象结构以 “{” 开始，以 “}”结束，JSON对象数据结构的中间部分由键值对（key：value）以英文 “,” 分隔的值的列表组成。关键字（key）必须为String类型，值（value）可以是String、Number、Object、Array等数据类型。</p><h3 id="15-RESTful"><a href="#15-RESTful" class="headerlink" title="15.RESTful"></a>15.RESTful</h3><p>RESTful也称之为REST，是英文“Representational State Transfer”的简称。RESTful风格在HTTP请求中，使用put、delete、post和get方式分别对应添加、删除、修改和查询的操作。</p><h3 id="16-PathVariable-“id”-注解"><a href="#16-PathVariable-“id”-注解" class="headerlink" title="16.@PathVariable(“id”)注解"></a>16.@PathVariable(“id”)注解</h3><p>@PathVariable(“id”)注解用于接收并绑定请求参数，它可以将URL请求中的变量映射到请求方法的形参上。<br>如果请求路径中的参数名方法形参名称一样，则@PathVariable后面的 “ (“id”) ” 可以省略。</p><h3 id="17-Spring-MVC的文件上传"><a href="#17-Spring-MVC的文件上传" class="headerlink" title="17.Spring MVC的文件上传"></a>17.Spring MVC的文件上传</h3><p>Spring MVC的文件上传是通过MultipartResolver对象实现的。</p><p>文件上传表单需要满足的3个条件如下：<br>（1） form表单的method属性设置为post；<br>（2） form表单的enctype属性设置为multipart&#x2F;form-data；<br>（3） 提供的文件上传输入框。</p>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring笔记</title>
      <link href="/2023/11/13/Spring%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/11/13/Spring%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="一、Spring框架"><a href="#一、Spring框架" class="headerlink" title="一、Spring框架"></a>一、Spring框架</h2><h3 id="1-三层体系架构"><a href="#1-三层体系架构" class="headerlink" title="1.三层体系架构"></a>1.三层体系架构</h3><p>在实际开发中，通常服务器端在采用分层方式进行架构。<br>三层体系架构，分别为：<br>表示层(Web层，包括控制层，使用SpringMVC框架)、<br>业务逻辑层(Service，使用Spring框架)、<br>持久层(数据访问层，Dao，使用Mybatis框架)。<br>Spring对每一层都提供了技术支持。</p><h3 id="2-Spring的核心"><a href="#2-Spring的核心" class="headerlink" title="2.Spring的核心"></a>2.Spring的核心</h3><p>Spring的核心是控制反转（IoC： Inverse of Control ）和面向切面编程（AOP： Aspect Oriented Programming ）。<br>在使用Spring框架之后，对象的实例不再由调用者来创建，而是由Spring容器来创建，Spring容器会负责控制程序之间的关系，而不是由调用者的程序代码直接控制。</p><p>IoC的全称是Inversion of Control，中文名称为控制反转。控制反转就是指在使用Spring框架之后，对象的实例不再由调用者来创建，而是由Spring容器来创建，Spring容器会负责控制程序之间的关系，而不是由调用者的程序代码直接控制。这样，控制权由应用代码转移到了Spring容器，控制权发生了反转。</p><p>DI的全称是Dependency Injection，中文称之为依赖注入。它与控制反转（IoC）的含义相同，只不过这两个称呼是从两个角度描述的同一个概念。从Spring容器的角度来看，Spring容器负责将被依赖对象赋值给调用者的成员变量，这相当于为调用者注入了它依赖的实例，这就是Spring的依赖注入。</p><h3 id="3-Spring-的Bean中主要的装配方式"><a href="#3-Spring-的Bean中主要的装配方式" class="headerlink" title="3.Spring 的Bean中主要的装配方式"></a>3.Spring 的Bean中主要的装配方式</h3><p>Spring 的Bean中主要包含三种装配方式，分别为基于XML的装配，基于Annotation的装配和自动装配，这三种装配方式的用法如下：</p><h4 id="（1）基于XML的装配："><a href="#（1）基于XML的装配：" class="headerlink" title="（1）基于XML的装配："></a>（1）基于XML的装配：</h4><p>Spring提供了2种基于XML的装配方式：设值注入（Setter Injection）和构造注入（Constructor Injection）。<br>一种是属性setter方法注入（或设值注入），另一种是构造方法注入。属性setter方法注入是指IoC容器使用setter方法来注入被依赖的实例。通过调用无参构造器或无参静态工厂方法实例化Bean后，调用该Bean的setter方法，即可实现基于setter方法的依赖注入。属性setter方法注入的必备条件如下：</p><p>Bean类必须有一个无参构造方法</p><p>Bean类必须为属性提供setter方法</p><p>在配置文件中，使用<code>&lt;property&gt;</code>元素来为每个属性注入值</p><p>设置注入中的Bean类必须提供一个默认的无参构造方法，同时必须为需要注入的属性提供对应的setter方法。使用设值注入时，在Spring配置文件中，需要使用<code>&lt;bean&gt;</code>元素的子元素<code>&lt;property&gt;</code>来为每个属性注入值。使用构造注入时，在配置文件里，需要使用<code>&lt;bean&gt;</code>元素的子元素<code>&lt;constructor-arg&gt;</code>来定义构造方法的参数，可以使用其value属性（或子元素）来设置该参数的值。<br>构造方法注入是指IoC容器使用构造方法来注入被依赖的实例。基于构造方法的依赖注入通过调用带参数的构造方法来实现，每个参数代表着一个依赖。要求必须满足如下条件：</p><p>Bean类必须提供有参构造方法</p><p>配置文件中，使用<code>&lt;constructor-arg&gt;</code>元素来为参数注入值</p><h4 id="（2）基于Annotation的装配："><a href="#（2）基于Annotation的装配：" class="headerlink" title="（2）基于Annotation的装配："></a>（2）基于Annotation的装配：</h4><p>使用基于Annotation的装配时，首先需要使用@Repository、@Service与@Controller分别对实现类进行标注，然后用@Autowired或@Resource注解对注入的Bean的属性进行标注，最后在Spring的配置文件中，通过<code>&lt;context:annotation-config /&gt;</code>来开启注解处理器，或使用<code>&lt;context:component-scan base-package=&quot;Bean所在的包路径&quot;/&gt;</code>的配置方式即可实现Annotation的装配。</p><p>@Controller通常作用在控制层，用于将控制层的类标识为Spring中的Bean。</p><p>@Service通常作用在业务层，用于将业务层的类标识为Spring中的Bean。</p><p>@Repository通常作用在数据持久层（或数据访问层，DAO层），用于将数据持久层的类标识为Spring中的Bean。</p><p>@Autowired或@Resource注解对注入的Bean的属性进行标注，用于将实例化后对象注入到Bean的属性中，实现依赖注入。</p><h4 id="（3）自动装配："><a href="#（3）自动装配：" class="headerlink" title="（3）自动装配："></a>（3）自动装配：</h4><p>在<code>&lt;bean&gt;</code>元素中使用 autowire属性，并将其属性值设置为 byName或者 byType即可实现自动装配。</p><h3 id="4-Spring框架的优点如下："><a href="#4-Spring框架的优点如下：" class="headerlink" title="4.Spring框架的优点如下："></a>4.Spring框架的优点如下：</h3><p>（1）非侵入式设计：Spring是一种非侵入式（non-invasive）框架，它可以使应用程序代码对框架的依赖最小化。<br>（2）方便解耦、简化开发：Spring就是一个大工厂，可以将所有对象的创建和依赖关系的维护工作都交给Spring容器管理，大大的降低了组件之间的耦合性。<br>（3）支持AOP：Spring提供了对AOP的支持，它允许将一些通用任务，如安全、事务、日志等进行集中式处理，从而提高了程序的复用性。<br>（4）支持声明式事务处理：只需要通过配置就可以完成对事务的管理，而无需手动编程。<br>（5）方便程序的测试：Spring提供了对Junit4的支持，可以通过注解方便的测试Spring程序。<br>（6）方便集成各种优秀框架：Spring不排斥各种优秀的开源框架，其内部提供了对各种优秀框架（如：Struts、Hibernate、MyBatis、Quartz等）的直接支持。<br>（7）降低了Java EE API的使用难度：Spring对Java EE开发中非常难用的一些API（如：JDBC、JavaMail等），都提供了封装，使这些API应用难度大大降低。</p><h3 id="5-Spring框架包："><a href="#5-Spring框架包：" class="headerlink" title="5.Spring框架包："></a>5.Spring框架包：</h3><p>Spring开发所需的jar包分为两个部分： Spring框架4个核心基础包和一个第三方依赖包。</p><p>spring-core-4.3.6.RELEASE.jar<br>包含Spring框架的核心工具类，Spring其它组件都要用到这个包里的类。</p><p>spring-beans-4.3.6.RELEASE.jar<br>所有应用都要用到的JAR包，它包含访问配置文件、创建和管理Bean以及进行控制反转或者依赖注入操作相关的所有类。</p><p>spring-context-4.3.6.RELEASE.jar<br>提供了在基础IoC功能上的扩展服务，还提供了许多企业级服务的支持</p><p>spring-expression-4.3.6.RELEASE.jar<br>定义了Spring的表达式语言。</p><p>在使用Spring开发时，除了要使用自带的JAR包外，Spring的核心容器还需要依赖一个第三方包commons.logging的JAR包。</p><h3 id="6-ApplicationContext容器"><a href="#6-ApplicationContext容器" class="headerlink" title="6.ApplicationContext容器"></a>6.ApplicationContext容器</h3><p>通常在Java项目中，通常会通过ClassPathXmlApplicationContext类来实例化ApplicationContext容器的方式，而在Web项目中，ApplicationContext容器的实例化工作会交由Web服务器来完成。</p><h3 id="7-SpringIOC应用示例核心代码："><a href="#7-SpringIOC应用示例核心代码：" class="headerlink" title="7.SpringIOC应用示例核心代码："></a>7.SpringIOC应用示例核心代码：</h3><p>main方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> </span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) context.getBean(<span class="string">&quot;userService&quot;</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">user.setId(<span class="string">&quot;11111&quot;</span>);</span><br><span class="line">user.setName(<span class="string">&quot;zhangsan22222&quot;</span>);</span><br><span class="line">userService.addUser(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>applicationContext.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置bean,配置后该类由spring管理--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;spring.ioc.service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--依赖注入,配置当前类中相应的属性--&gt;</span>  </span><br><span class="line">    <span class="comment">&lt;!-- &lt;property&gt;标签中的name就是UserService类中的userDao属性名，ref指下面&lt;bean name=&quot;userDao&quot;...&gt;，这样其实是spring将UserDaoImp对象实例化并且调用UserService的setUserDao方法将UserDao注入 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoImp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">&lt;!—配置bean ，,配置后该类由spring管理--&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoImp&quot;</span> <span class="attr">class</span>=<span class="string">&quot;spring.ioc.dao.imp.UserDaoImp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>UserService.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"><span class="keyword">public</span> UserDao userDao;</span><br><span class="line"><span class="keyword">public</span> UserDao <span class="title function_">getUserDao</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userDao;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">(User user)</span>&#123;</span><br><span class="line">userDao.addUser(user);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UserDaoImp.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImp</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">(User user)</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;添加了一个用户，姓名是&quot;</span></span><br><span class="line">        +user.getName()+user.getId());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="二、SpringJDBCTemplate"><a href="#二、SpringJDBCTemplate" class="headerlink" title="二、SpringJDBCTemplate"></a>二、SpringJDBCTemplate</h2><h3 id="1-在Spring的配置文件中配置JDBC"><a href="#1-在Spring的配置文件中配置JDBC" class="headerlink" title="1.在Spring的配置文件中配置JDBC"></a>1.在Spring的配置文件中配置JDBC</h3><p>在Spring的配置文件中配置JDBC时，需要定义了三个Bean，分别是dataSource、jdbcTemplate和需要注入类的Bean。在定义jdbcTemplate时，需要将dataSource注入到jdbcTemplate中，而其他需要使用jdbcTemplate的Bean，也需要将jdbcTemplate注入到该Bean中，这样配置完成后，Spring JDBC就可以使用了。</p><h3 id="2-JdbcTemplate类"><a href="#2-JdbcTemplate类" class="headerlink" title="2.JdbcTemplate类"></a>2.JdbcTemplate类</h3><p>Spring框架提供了JdbcTemplate类，该类是Spring框架数据抽象层的基础。JdbcTemplate类是Spring JDBC的核心类。JdbcTemplate的直接父类是抽象类JdbcAccessor，实现了接口JdbcOperations。<br>在JdbcTemplate类中，提供了大量的更新和查询数据库的方法，使用这些方法来操作数据库，其常用的方法包括execute()、update()和query()。<br>其中execute()方法能够完成执行SQL语句的功能，update()方法可以完成插入、更新和删除数据的操作，query()方法可以用来处理各种对数据库表的查询操作。</p><h3 id="3-dataSource配置"><a href="#3-dataSource配置" class="headerlink" title="3.dataSource配置"></a>3.dataSource配置</h3><p>dataSource配置，即JDBC连接数据库时需要4个基本属性，包括有driverClassName、url、username和password。</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231113223834.png"></p><h3 id="4-Spring-为JDBC提供了三个模板类供选择："><a href="#4-Spring-为JDBC提供了三个模板类供选择：" class="headerlink" title="4.Spring 为JDBC提供了三个模板类供选择："></a>4.Spring 为JDBC提供了三个模板类供选择：</h3><p>JdbcTemplate：最基本的Spring JDBC模板，支持简单的JDBC数据访问功能及基于索引参数的查询。使用占位符（？）绑定参数。</p><p>NamedParameterJdbcTemplate：该模板查询时可以将值以命名参数（：参数名）的形式绑定到SQL中，而不是使用简单的索引参数。</p><p>SimpleJdbcTemplate：该模板利用Java5的一些特性如自动装箱、泛型以及可变参数列表来简化JDBC模板的使用。</p><h3 id="5-SpringJDBCTemplate应用示例核心代码："><a href="#5-SpringJDBCTemplate应用示例核心代码：" class="headerlink" title="5.SpringJDBCTemplate应用示例核心代码："></a>5.SpringJDBCTemplate应用示例核心代码：</h3><p>Main方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span>&#123;</span><br><span class="line">    <span class="type">Test</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line">    <span class="type">UserAction</span> <span class="variable">userAction</span> <span class="operator">=</span> test.getController();</span><br><span class="line">    test.testAdd(userAction);</span><br><span class="line"><span class="comment">//    test.testFindNumbers(userAction);</span></span><br><span class="line"><span class="comment">//    test.testFindNameById(userAction);</span></span><br><span class="line"><span class="comment">//    test.testFindUser(userAction);</span></span><br><span class="line"><span class="comment">//    test.testFindAll(userAction);</span></span><br><span class="line"><span class="comment">//    test.testFindMapUser(userAction);</span></span><br><span class="line"><span class="comment">//    test.testFindMapAll(userAction);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> UserAction <span class="title function_">getController</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> </span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;config/applicationContext.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserAction</span> <span class="variable">userAction</span> <span class="operator">=</span> (UserAction) context.getBean(<span class="string">&quot;userAction&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> userAction;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAdd</span><span class="params">(UserAction userAction)</span>&#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span>  <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setId(<span class="number">7</span>);</span><br><span class="line">    user.setName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">20</span>);</span><br><span class="line">    userAction.add(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindNumbers</span><span class="params">(UserAction userAction)</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">numbers</span> <span class="operator">=</span> userAction.findNumbers();</span><br><span class="line">    System.out.println(<span class="string">&quot;findNumbers方法的查询结果：&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;共有&quot;</span>+numbers+<span class="string">&quot;个用户！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindNameById</span><span class="params">(UserAction userAction)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> userAction.findNameById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;findNameById方法的查询结果：&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;学号为1的学生的姓名为：&quot;</span>+name);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindUser</span><span class="params">(UserAction userAction)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;findUser方法的查询结果：&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span>  <span class="operator">=</span> userAction.findById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;id：&quot;</span>+user.getId()</span><br><span class="line">    +<span class="string">&quot;,name:&quot;</span>+user.getName()</span><br><span class="line">    +<span class="string">&quot;,age:&quot;</span>+user.getAge());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindAll</span><span class="params">(UserAction userAction)</span>&#123;</span><br><span class="line">    List&lt;User&gt; users  = userAction.findAll();</span><br><span class="line">    System.out.println(<span class="string">&quot;findAll方法的查询结果：&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(User user:users)&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;id：&quot;</span>+user.getId()</span><br><span class="line">    +<span class="string">&quot;,name:&quot;</span>+user.getName()</span><br><span class="line">    +<span class="string">&quot;,age:&quot;</span>+user.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindMapUser</span><span class="params">(UserAction userAction)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;findMapUser方法的查询结果：&quot;</span>);</span><br><span class="line">    Map&lt;String,Object&gt; user  = userAction.findMapById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;id：&quot;</span>+user.get(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">    +<span class="string">&quot;,name:&quot;</span>+user.get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    +<span class="string">&quot;,age:&quot;</span>+user.get(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindMapAll</span><span class="params">(UserAction userAction)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;findMapAll方法的查询结果：&quot;</span>);</span><br><span class="line">    List&lt;Map&lt;String,Object&gt;&gt; users  = userAction.findAllMap();</span><br><span class="line">    <span class="keyword">for</span>(Map&lt;String,Object&gt; user:users)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;id：&quot;</span>+user.get(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">        +<span class="string">&quot;,name:&quot;</span>+user.get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">        +<span class="string">&quot;,age:&quot;</span>+user.get(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>applicationContext.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userAction&quot;</span> <span class="attr">class</span>=<span class="string">&quot;action.UserAction&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userService&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;service.UserService&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource1&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/spring&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dao.UserDao&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;jdbcTemplate1&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;npjt&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;namedParameterJdbcTemplate&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource1&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- NamedParameterJdbcTemplate配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;namedParameterJdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;jdbcTemplate1&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>UserAction.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserAction</span> &#123;</span><br><span class="line"><span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> UserService <span class="title function_">getUserService</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userService;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserService</span><span class="params">(UserService userService)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.userService = userService;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(User user)</span> &#123;</span><br><span class="line">userService.add(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">findNameById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userService.findNameById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findNumbers</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userService.findNumbers();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userService.findAll();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">findById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userService.findById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">findMapById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userService.findMapById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">findAllMap</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userService.findAllMap();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UserService.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> UserDao <span class="title function_">getUserDao</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userDao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(User user)</span> &#123;</span><br><span class="line">userDao.add(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">findNameById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userDao.findNameById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findNumbers</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userDao.findNumbers();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userDao.findAll();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">findById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userDao.findById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">findMapById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userDao.findMapById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">findAllMap</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userDao.findAllMap();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UserDao.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"><span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">private</span> NamedParameterJdbcTemplate npjt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> JdbcTemplate <span class="title function_">getJdbcTemplate</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setJdbcTemplate</span><span class="params">(JdbcTemplate jdbcTemplate)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.jdbcTemplate = jdbcTemplate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> NamedParameterJdbcTemplate <span class="title function_">getNpjt</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> npjt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNpjt</span><span class="params">(NamedParameterJdbcTemplate npjt)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.npjt = npjt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(User user)</span>&#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into CUSTOMERS values(?,?,?)&quot;</span>;</span><br><span class="line">jdbcTemplate.update(sql,</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;user.getId(),user.getName(),user.getAge()&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*NamedParameterJdbcTemplate使用：Map传参*/</span></span><br><span class="line">String sql1=<span class="string">&quot;insert into CUSTOMERS (id,name,age) values (:id,:name,:age)&quot;</span>;</span><br><span class="line">Map&lt;String,Object&gt; paramMap=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String,Object&gt;();</span><br><span class="line">paramMap.put(<span class="string">&quot;id&quot;</span>, <span class="number">1</span>);</span><br><span class="line">paramMap.put(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;20&quot;</span>);</span><br><span class="line">paramMap.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;npjt&quot;</span>);</span><br><span class="line">paramMap.put(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;女&quot;</span>);</span><br><span class="line">npjt.update(sql1, paramMap);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*NamedParameterJdbcTemplate使用：实体类（User）传参*/</span></span><br><span class="line">SqlParameterSource paramSource=<span class="keyword">new</span> <span class="title class_">BeanPropertySqlParameterSource</span>(user);</span><br><span class="line">npjt.update(sql1, paramSource);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">findNameById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT NAME FROM CUSTOMERS WHERE id = ?&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> (String) jdbcTemplate.queryForObject(sql, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; id &#125;, String.class);</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findNumbers</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT COUNT(*) FROM CUSTOMERS&quot;</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> jdbcTemplate.queryForObject(sql,Integer.class);</span><br><span class="line"><span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM CUSTOMERS&quot;</span>;</span><br><span class="line"><span class="comment">//List&lt;Customer&gt; customers = jdbcTemplate.query(sql, new BeanPropertyRowMapper(Customer.class));</span></span><br><span class="line">List&lt;User&gt; customers = jdbcTemplate.query(sql, <span class="keyword">new</span> <span class="title class_">CustomerRowMapper</span>());</span><br><span class="line"><span class="keyword">return</span> customers;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">findById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM CUSTOMERS WHERE id = ?&quot;</span>;</span><br><span class="line"><span class="type">User</span> <span class="variable">customer</span> <span class="operator">=</span> (User) jdbcTemplate.queryForObject(sql,</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; id &#125;,<span class="keyword">new</span> <span class="title class_">CustomerRowMapper</span>());</span><br><span class="line"><span class="keyword">return</span> customer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">findMapById</span><span class="params">(<span class="type">int</span> id)</span>&#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM CUSTOMERS WHERE id = ?&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> jdbcTemplate.queryForMap(sql,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;id&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String,Object&gt;&gt; <span class="title function_">findAllMap</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM CUSTOMERS&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> jdbcTemplate.queryForList(sql);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="三、SpringAOP和事务控制"><a href="#三、SpringAOP和事务控制" class="headerlink" title="三、SpringAOP和事务控制"></a>三、SpringAOP和事务控制</h2><h3 id="1-AOP-Aspect-Oriented-Programming-面向切面编程-："><a href="#1-AOP-Aspect-Oriented-Programming-面向切面编程-：" class="headerlink" title="1.AOP(Aspect-Oriented Programming,面向切面编程)："></a>1.AOP(Aspect-Oriented Programming,面向切面编程)：</h3><p>是Spring用到的核心技术之一，是对传统 OOP(Object-Oriented Programming,面向对象编程)的补充。</p><p>AOP在程序开发中主要用来解决一些系统层面上的问题，比如日志，事务，权限等。</p><p>AOP的主要编程对象是切面(aspect)，采用AOP，可以对分散在各处且与对象核心功能无关的一些功能行为代码（横切代码）进行封装，使其成为一个可重用的模块，这个模块被命名为“切面”（Aspect），切面将那些与业务无关，却被业务模块共同调用的逻辑提取并封装起来，减少了系统中的重复代码，降低了模块间的耦合度，同时提高了系统的可维护性。</p><h3 id="2-AOP框架：Spring-AOP和AspectJ。"><a href="#2-AOP框架：Spring-AOP和AspectJ。" class="headerlink" title="2.AOP框架：Spring AOP和AspectJ。"></a>2.AOP框架：Spring AOP和AspectJ。</h3><p>目前流行的AOP框架有两个：Spring AOP和AspectJ</p><p>Spring AOP代理可以是JDK动态代理，也可是CGLIB代理。Spring默认使用JDK动态代理，在需要代理类而不是代理接口的时候，Spring会自动切换为使用CGLIB代理，不过现在的项目都是面向接口编程，所以JDK动态代理相对来说用的还是多一些。</p><p>新版本的Spring框架，建议使用AspectJ来开发AOP。 使用AspectJ实现AOP有两种方式：一种是基于XML的声明式AspectJ，另一种是基于注解的声明式AspectJ。</p><h3 id="3-AspectJ框架中注解"><a href="#3-AspectJ框架中注解" class="headerlink" title="3.AspectJ框架中注解"></a>3.AspectJ框架中注解</h3><p>AspectJ框架中注解@Pointcut用于定义切入点表达式，在使用时还需定义一个包含名字和任意参数的方法签名来表示切入点名称。</p><h3 id="4-Spring的配置文件中的元素"><a href="#4-Spring的配置文件中的元素" class="headerlink" title="4.Spring的配置文件中的&lt;beans&gt;元素"></a>4.Spring的配置文件中的<code>&lt;beans&gt;</code>元素</h3><p>在Spring的配置文件中的<code>&lt;beans&gt;</code>元素下可以包含多个<code>&lt;aop:config&gt;</code>元素，一个<code>&lt;aop:config&gt;</code>元素中又可以包含属性和子元素，其子元素包括<code>&lt;aop:pointcut&gt;</code>、<code>&lt;aop:advisor&gt;</code>和<code>&lt;aop:aspect&gt;</code>。</p><p>配置切面使用的是<code>&lt;aop:aspect&gt;</code>元素，<code>&lt;aop:aspect&gt;</code>子元素的pointcut-ref属性用于指定一个已经存在的切入点名称。</p><h3 id="5-AOP术语中Advice"><a href="#5-AOP术语中Advice" class="headerlink" title="5.AOP术语中Advice"></a>5.AOP术语中Advice</h3><p>AOP术语中Advice表示AOP框架在特定的切入点执行的通知&#x2F;增强处理，即在定义好的切入点处所要执行的程序代码。</p><h3 id="6-Spring的声明式事务管理的两种实现方式"><a href="#6-Spring的声明式事务管理的两种实现方式" class="headerlink" title="6.Spring的声明式事务管理的两种实现方式"></a>6.Spring的声明式事务管理的两种实现方式</h3><p>Spring的声明式事务管理可以通过两种方式来实现，一种是基于XML的方式，另一种是基于注解（Annotation）的方式。</p><p>Spring2.0以后，在基于XML文件的方式中，提供了tx命名空间来配置事务，tx命名空间下提供了<a href="tx:advice">tx:advice</a>元素来配置事务的通知（增强处理）。</p><h2 id="四、Spring整合Mybatis"><a href="#四、Spring整合Mybatis" class="headerlink" title="四、Spring整合Mybatis"></a>四、Spring整合Mybatis</h2><h3 id="6-1-Spring整合Mybatis思路分析"><a href="#6-1-Spring整合Mybatis思路分析" class="headerlink" title="6.1 Spring整合Mybatis思路分析"></a>6.1 Spring整合Mybatis思路分析</h3><h4 id="6-1-1-环境准备"><a href="#6-1-1-环境准备" class="headerlink" title="6.1.1 环境准备"></a>6.1.1 环境准备</h4><p>在准备环境的过程中，我们也来回顾下Mybatis开发的相关内容:</p><h5 id="步骤1-准备数据库表"><a href="#步骤1-准备数据库表" class="headerlink" title="步骤1:准备数据库表"></a>步骤1:准备数据库表</h5><p>Mybatis是来操作数据库表，所以先创建一个数据库及表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database spring_db <span class="type">character</span> <span class="keyword">set</span> utf8;</span><br><span class="line">use spring_db;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tbl_account(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">35</span>),</span><br><span class="line">    money <span class="keyword">double</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h5 id="步骤2-创建项目导入jar包"><a href="#步骤2-创建项目导入jar包" class="headerlink" title="步骤2:创建项目导入jar包"></a>步骤2:创建项目导入jar包</h5><p>项目的pom.xml添加相关依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="步骤3-根据表创建模型类"><a href="#步骤3-根据表创建模型类" class="headerlink" title="步骤3:根据表创建模型类"></a>步骤3:根据表创建模型类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"><span class="comment">//setter...getter...toString...方法略    </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="步骤4-创建Dao接口"><a href="#步骤4-创建Dao接口" class="headerlink" title="步骤4:创建Dao接口"></a>步骤4:创建Dao接口</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into tbl_account(name,money)values(#&#123;name&#125;,#&#123;money&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from tbl_account where id = #&#123;id&#125; &quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;update tbl_account set name = #&#123;name&#125; , money = #&#123;money&#125; where id = #&#123;id&#125; &quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from tbl_account&quot;)</span></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from tbl_account where id = #&#123;id&#125; &quot;)</span></span><br><span class="line">    Account <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="步骤5-创建Service接口和实现类"><a href="#步骤5-创建Service接口和实现类" class="headerlink" title="步骤5:创建Service接口和实现类"></a>步骤5:创建Service接口和实现类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Account <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        accountDao.save(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span>&#123;</span><br><span class="line">        accountDao.update(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        accountDao.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Account <span class="title function_">findById</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.findById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="步骤6-添加jdbc-properties文件"><a href="#步骤6-添加jdbc-properties文件" class="headerlink" title="步骤6:添加jdbc.properties文件"></a>步骤6:添加jdbc.properties文件</h5><p>resources目录下添加，用于配置数据库连接四要素</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/spring_db?useSSL=false</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure><p>useSSL:关闭MySQL的SSL连接</p><h5 id="步骤7-添加Mybatis核心配置文件"><a href="#步骤7-添加Mybatis核心配置文件" class="headerlink" title="步骤7:添加Mybatis核心配置文件"></a>步骤7:添加Mybatis核心配置文件</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--读取外部properties配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--别名扫描的包路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.itheima.domain&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--数据源--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--映射文件扫描包路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.itheima.dao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="步骤8-编写应用程序"><a href="#步骤8-编写应用程序" class="headerlink" title="步骤8:编写应用程序"></a>步骤8:编写应用程序</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 1. 创建SqlSessionFactoryBuilder对象</span></span><br><span class="line">        <span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line">        <span class="comment">// 2. 加载SqlMapConfig.xml配置文件</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml.bak&quot;</span>);</span><br><span class="line">        <span class="comment">// 3. 创建SqlSessionFactory对象</span></span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(inputStream);</span><br><span class="line">        <span class="comment">// 4. 获取SqlSession</span></span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession();</span><br><span class="line">        <span class="comment">// 5. 执行SqlSession对象执行查询，获取结果User</span></span><br><span class="line">        <span class="type">AccountDao</span> <span class="variable">accountDao</span> <span class="operator">=</span> sqlSession.getMapper(AccountDao.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">Account</span> <span class="variable">ac</span> <span class="operator">=</span> accountDao.findById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(ac);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 6. 释放资源</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="步骤9-运行程序"><a href="#步骤9-运行程序" class="headerlink" title="步骤9:运行程序"></a>步骤9:运行程序</h5><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1630136904087.png" alt="1630136904087"></p><h4 id="6-1-2-整合思路分析"><a href="#6-1-2-整合思路分析" class="headerlink" title="6.1.2 整合思路分析"></a>6.1.2 整合思路分析</h4><p>Mybatis的基础环境我们已经准备好了，接下来就得分析下在上述的内容中，哪些对象可以交给Spring来管理?</p><ul><li><p>Mybatis程序核心对象分析</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1630137189480.png" alt="1630137189480"></p><p>从图中可以获取到，真正需要交给Spring管理的是&#x3D;&#x3D;SqlSessionFactory&#x3D;&#x3D;</p></li><li><p>整合Mybatis，就是将Mybatis用到的内容交给Spring管理，分析下配置文件</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1630137388717.png" alt="1630137388717"></p><p><strong>说明:</strong></p><ul><li>第一行读取外部properties配置文件，Spring有提供具体的解决方案<code>@PropertySource</code>,需要交给Spring</li><li>第二行起别名包扫描，为SqlSessionFactory服务的，需要交给Spring</li><li>第三行主要用于做连接池，Spring之前我们已经整合了Druid连接池，这块也需要交给Spring</li><li>前面三行一起都是为了创建SqlSession对象用的，那么用Spring管理SqlSession对象吗?回忆下SqlSession是由SqlSessionFactory创建出来的，所以只需要将SqlSessionFactory交给Spring管理即可。</li><li>第四行是Mapper接口和映射文件[如果使用注解就没有该映射文件]，这个是在获取到SqlSession以后执行具体操作的时候用，所以它和SqlSessionFactory创建的时机都不在同一个时间，可能需要单独管理。</li></ul></li></ul><h3 id="6-2-Spring整合Mybatis"><a href="#6-2-Spring整合Mybatis" class="headerlink" title="6.2 Spring整合Mybatis"></a>6.2 Spring整合Mybatis</h3><p>前面我们已经分析了Spring与Mybatis的整合，大体需要做两件事，</p><p>第一件事是:Spring要管理MyBatis中的SqlSessionFactory</p><p>第二件事是:Spring要管理Mapper接口的扫描</p><p>具体该如何实现，具体的步骤为:</p><h4 id="步骤1-项目中导入整合需要的jar包"><a href="#步骤1-项目中导入整合需要的jar包" class="headerlink" title="步骤1:项目中导入整合需要的jar包"></a>步骤1:项目中导入整合需要的jar包</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Spring操作数据库需要该jar包--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">Spring与Mybatis整合的jar包</span></span><br><span class="line"><span class="comment">这个jar包mybatis在前面，是Mybatis提供的</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="步骤2-创建Spring的主配置类"><a href="#步骤2-创建Spring的主配置类" class="headerlink" title="步骤2:创建Spring的主配置类"></a>步骤2:创建Spring的主配置类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配置类注解</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//包扫描，主要扫描的是项目中的AccountServiceImpl类</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="步骤3-创建数据源的配置类"><a href="#步骤3-创建数据源的配置类" class="headerlink" title="步骤3:创建数据源的配置类"></a>步骤3:创建数据源的配置类</h4><p>在配置类中完成数据源的创建</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.driver&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(driver);</span><br><span class="line">        ds.setUrl(url);</span><br><span class="line">        ds.setUsername(userName);</span><br><span class="line">        ds.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="步骤4-主配置类中读properties并引入数据源配置类"><a href="#步骤4-主配置类中读properties并引入数据源配置类" class="headerlink" title="步骤4:主配置类中读properties并引入数据源配置类"></a>步骤4:主配置类中读properties并引入数据源配置类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(JdbcConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="步骤5-创建Mybatis配置类并配置SqlSessionFactory"><a href="#步骤5-创建Mybatis配置类并配置SqlSessionFactory" class="headerlink" title="步骤5:创建Mybatis配置类并配置SqlSessionFactory"></a>步骤5:创建Mybatis配置类并配置SqlSessionFactory</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisConfig</span> &#123;</span><br><span class="line">    <span class="comment">//定义bean，SqlSessionFactoryBean，用于产生SqlSessionFactory对象</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SqlSessionFactoryBean <span class="title function_">sqlSessionFactory</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">        <span class="type">SqlSessionFactoryBean</span> <span class="variable">ssfb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBean</span>();</span><br><span class="line">        <span class="comment">//设置模型类的别名扫描</span></span><br><span class="line">        ssfb.setTypeAliasesPackage(<span class="string">&quot;com.itheima.domain&quot;</span>);</span><br><span class="line">        <span class="comment">//设置数据源</span></span><br><span class="line">        ssfb.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> ssfb;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义bean，返回MapperScannerConfigurer对象</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MapperScannerConfigurer <span class="title function_">mapperScannerConfigurer</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">MapperScannerConfigurer</span> <span class="variable">msc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapperScannerConfigurer</span>();</span><br><span class="line">        msc.setBasePackage(<span class="string">&quot;com.itheima.dao&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> msc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>说明:</strong></p><ul><li><p>使用SqlSessionFactoryBean封装SqlSessionFactory需要的环境信息</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1630138835057.png" alt="1630138835057"></p><ul><li>SqlSessionFactoryBean是前面我们讲解FactoryBean的一个子类，在该类中将SqlSessionFactory的创建进行了封装，简化对象的创建，我们只需要将其需要的内容设置即可。</li><li>方法中有一个参数为dataSource,当前Spring容器中已经创建了Druid数据源，类型刚好是DataSource类型，此时在初始化SqlSessionFactoryBean这个对象的时候，发现需要使用DataSource对象，而容器中刚好有这么一个对象，就自动加载了DruidDataSource对象。</li></ul></li><li><p>使用MapperScannerConfigurer加载Dao接口，创建代理对象保存到IOC容器中</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1630138916939.png" alt="1630138916939"></p><ul><li>这个MapperScannerConfigurer对象也是MyBatis提供的专用于整合的jar包中的类，用来处理原始配置文件中的mappers相关配置，加载数据层的Mapper接口类</li><li>MapperScannerConfigurer有一个核心属性basePackage，就是用来设置所扫描的包路径</li></ul></li></ul><h4 id="步骤6-主配置类中引入Mybatis配置类"><a href="#步骤6-主配置类中引入Mybatis配置类" class="headerlink" title="步骤6:主配置类中引入Mybatis配置类"></a>步骤6:主配置类中引入Mybatis配置类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class,MybatisConfig.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="步骤7-编写运行类"><a href="#步骤7-编写运行类" class="headerlink" title="步骤7:编写运行类"></a>步骤7:编写运行类</h4><p>在运行类中，从IOC容器中获取Service对象，调用方法获取结果</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> ctx.getBean(AccountService.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">Account</span> <span class="variable">ac</span> <span class="operator">=</span> accountService.findById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(ac);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="步骤8-运行程序"><a href="#步骤8-运行程序" class="headerlink" title="步骤8:运行程序"></a>步骤8:运行程序</h4><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/1630139036627.png" alt="1630139036627"></p><p>支持Spring与Mybatis的整合就已经完成了，其中主要用到的两个类分别是:</p><ul><li>&#x3D;&#x3D;SqlSessionFactoryBean&#x3D;&#x3D;</li><li>&#x3D;&#x3D;MapperScannerConfigurer&#x3D;&#x3D;</li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>后端开发常用代码</title>
      <link href="/2023/11/05/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E5%9D%97/"/>
      <url>/2023/11/05/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<h2 id="Java实现跨域方式"><a href="#Java实现跨域方式" class="headerlink" title="Java实现跨域方式"></a>Java实现跨域方式</h2><p>一、什么是跨域？为什么会出现跨域</p><ul><li><p>定义</p><ul><li>跨域（CORS）是指不同域名之间相互访问。跨域，指的是浏览器不能执行其他网站的脚本，它是由浏览器的同源策略所造成的，是浏览器对于JavaScript所定义的安全限制策略。<br>当一个请求url的协议、域名、端口三者之间任意一个与当前页面url不同即为跨域。</li></ul></li><li><p>原因</p><ul><li>在前后端分离的模式下，前后端的域名是不一致的，此时就会发生跨域访问问题。在请求的过程中我们要想回去数据一般都是post&#x2F;get请求，所以…<a href="https://so.csdn.net/so/search?q=%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98&spm=1001.2101.3001.7020">跨域问题</a>出现。</li><li>跨域问题来源于JavaScript的同源策略，即只有 协议+主机名+端口号(如存在)相同，则允许相互访问。也就是说JavaScript只能访问和操作自己域下的资源，不能访问和操作其他域下的资源。跨域问题是针对JS和ajax的，html本身没有跨域问题，比如a标签、script标签、甚至form标签（可以直接跨域发送数据并接收数据）等</li></ul></li><li><p>什么情况会跨域</p><ul><li>同一协议， 如http或https</li><li>同一IP地址, 如127.0.0.1</li><li>同一端口, 如8080<br>以上三个条件中有一个条件不同就会产生跨域问题。</li></ul></li></ul><h3 id="跨域之CorsFilter"><a href="#跨域之CorsFilter" class="headerlink" title="跨域之CorsFilter"></a>跨域之CorsFilter</h3><p><code>CorsFilter</code> 是 Spring 框架提供的一个用于处理<a href="https://so.csdn.net/so/search?q=%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82&spm=1001.2101.3001.7020">跨域请求</a>的过滤器。在开发中，我们常常需要处理前端发来的跨域请求，<code>CorsFilter</code> 就可以帮助我们实现这一功能。</p><p><code>CorsFilter</code> 主要用于设置跨域请求的响应头，以允许跨域请求能够被成功处理。具体来说，<code>CorsFilter</code> 可以设置以下响应头：</p><ul><li>Access-Control-Allow-Origin：允许访问的源地址；</li><li>Access-Control-Allow-Methods：允许访问的请求方法；</li><li>Access-Control-Allow-Headers：允许访问的请求头；</li><li>Access-Control-Allow-Credentials：是否允许发送 Cookie 等身份凭证；</li><li>Access-Control-Max-Age：缓存预检请求的时间。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.cors.CorsConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.cors.UrlBasedCorsConfigurationSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.CorsFilter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CorsConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CorsFilter <span class="title function_">corsFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">UrlBasedCorsConfigurationSource</span> <span class="variable">source</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UrlBasedCorsConfigurationSource</span>();</span><br><span class="line">        <span class="type">CorsConfiguration</span> <span class="variable">corsConfiguration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorsConfiguration</span>();</span><br><span class="line">        corsConfiguration.addAllowedOrigin(<span class="string">&quot;*&quot;</span>); <span class="comment">// 1 设置访问源地址</span></span><br><span class="line">        corsConfiguration.addAllowedHeader(<span class="string">&quot;*&quot;</span>); <span class="comment">// 2 设置访问源请求头</span></span><br><span class="line">        corsConfiguration.addAllowedMethod(<span class="string">&quot;*&quot;</span>); <span class="comment">// 3 设置访问源请求方法</span></span><br><span class="line">        source.registerCorsConfiguration(<span class="string">&quot;/**&quot;</span>, corsConfiguration); <span class="comment">// 4 对接口配置跨域设置</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CorsFilter</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="Java实现Result"><a href="#Java实现Result" class="headerlink" title="Java实现Result"></a>Java实现Result</h2><p>Result: Result类的编写方式，最主要的功能就是为了向前端发送数据的时候能够更高效快捷：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springmvc.demo.commen.vo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span> <span class="comment">//无参构造</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span> <span class="comment">//全参构造</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">success</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(<span class="number">200</span>,<span class="string">&quot;success&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">success</span><span class="params">(T data)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(<span class="number">200</span>,<span class="string">&quot;success&quot;</span>,data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">success</span><span class="params">(T data,String message)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(<span class="number">200</span>,message,data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">success</span><span class="params">(String message)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(<span class="number">200</span>,message,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">fail</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(<span class="number">201</span>,<span class="string">&quot;success&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">fail</span><span class="params">(Integer code)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(code,<span class="string">&quot;success&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">fail</span><span class="params">(Integer code,String message)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(code,message,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">fail</span><span class="params">(String message)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(<span class="number">201</span>,message,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="实现自动填装创建时间和更新时间-工具类"><a href="#实现自动填装创建时间和更新时间-工具类" class="headerlink" title="实现自动填装创建时间和更新时间(工具类)"></a>实现自动填装创建时间和更新时间(工具类)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springmvc.demo.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.reflection.MetaObject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span> <span class="comment">//日志</span></span><br><span class="line"><span class="meta">@Component</span><span class="comment">//以组件的形式把这个处理器注册到IOC容器中</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title class_">MetaObjectHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//插入时启动  第三个参数 LocalDateTime 一定要和 createTime成员变量的值的类型一致，不然是null 如果是date就都设置date</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;start insert fill ....&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;createTime&quot;</span>, LocalDateTime.class, LocalDateTime.now()); <span class="comment">// 起始版本 3.3.0(推荐使用)</span></span><br><span class="line">        <span class="built_in">this</span>.strictUpdateFill(metaObject, <span class="string">&quot;updateTime&quot;</span>, LocalDateTime.class, LocalDateTime.now()); <span class="comment">// 起始版本 3.3.0(推荐)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//更新时候启动</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;start update fill ....&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.strictUpdateFill(metaObject, <span class="string">&quot;updateTime&quot;</span>, LocalDateTime.class, LocalDateTime.now()); <span class="comment">// 起始版本 3.3.0(推荐)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在实体类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springmvc.demo.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.*;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> owc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023-11-03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(&quot;o_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="meta">@TableId(value = &quot;userId&quot;, type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT ,value = &quot;create_time&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE ,value = &quot;update_time&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="application-yml"><a href="#application-yml" class="headerlink" title="application.yml"></a>application.yml</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 应用服务 WEB 访问端口</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8888</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">123qwe</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/test1?characterEncoding=UTF-8&amp;useSSL=false&amp;useUnicode=true</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com.ouwen:</span> <span class="string">info</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">table-prefix:</span> <span class="string">o_</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">auto</span></span><br></pre></td></tr></table></figure><h2 id="mybatis-config-xml"><a href="#mybatis-config-xml" class="headerlink" title="mybatis-config.xml"></a>mybatis-config.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--setttings:控制mybatis全局配置行为--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--设置mybatis输出日志--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 开启驼峰命名转换 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--环境配置：数据库的连接信息--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--default：中配置的值需要和某个environment配置的id相同，</span></span><br><span class="line"><span class="comment">        通知mybatis使用具体哪一个数据库的连接信息，即具体访问对应的数据库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--environment:一个数据库信息的配置，环境--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--id属性：一个唯一值，自定义，表示环境的名称--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--transactionManager属性：mybatis的事务类型--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--dataSoure属性：代表数据源，连接数据库--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--type属性:JDBC 表示使用的是使用连接池的数据源--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--配置驱动--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--配置连接数据库的url字符串--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--配置连接数据库的用户名--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--配置连接数据库的密码--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123qwe&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--sql映射文件标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--reource：从类路径开始的路径信息：target/clasess(类路径)--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mapper/**.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="CodeGenerator"><a href="#CodeGenerator" class="headerlink" title="CodeGenerator"></a>CodeGenerator</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springmvc.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.FastAutoGenerator;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.OutputFile;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.DbColumnType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Types;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CodeGenerator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql:///test1&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123qwe&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">moduleName</span> <span class="operator">=</span> <span class="string">&quot;demo&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">mapperLocation</span> <span class="operator">=</span> <span class="string">&quot;C:\\Users\\DIO\\Desktop\\大学\\大三上\\面向对象\\Spring MVC\\demo\\src\\main\\resources\\mapper\\&quot;</span> + moduleName;</span><br><span class="line">        <span class="type">String</span> <span class="variable">tables</span> <span class="operator">=</span> <span class="string">&quot;o_user&quot;</span>;</span><br><span class="line">        FastAutoGenerator.create(url, username, password)</span><br><span class="line">                .globalConfig(builder -&gt; &#123;</span><br><span class="line">                    builder.author(<span class="string">&quot;owc&quot;</span>) <span class="comment">// 设置作者</span></span><br><span class="line">                            <span class="comment">//.enableSwagger() // 开启 swagger 模式</span></span><br><span class="line">                            <span class="comment">//.fileOverride() // 覆盖已生成文件</span></span><br><span class="line">                            .outputDir(<span class="string">&quot;C:\\Users\\DIO\\Desktop\\大学\\大三上\\面向对象\\Spring MVC\\demo\\src\\main\\java&quot;</span>); <span class="comment">// 指定输出目录</span></span><br><span class="line">                &#125;)</span><br><span class="line">                .dataSourceConfig(builder -&gt; builder.typeConvertHandler((globalConfig, typeRegistry, metaInfo) -&gt; &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">typeCode</span> <span class="operator">=</span> metaInfo.getJdbcType().TYPE_CODE;</span><br><span class="line">                    <span class="keyword">if</span> (typeCode == Types.SMALLINT) &#123;</span><br><span class="line">                        <span class="comment">// 自定义类型转换</span></span><br><span class="line">                        <span class="keyword">return</span> DbColumnType.INTEGER;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> typeRegistry.getColumnType(metaInfo);</span><br><span class="line"></span><br><span class="line">                &#125;))</span><br><span class="line">                .packageConfig(builder -&gt; &#123;</span><br><span class="line">                    builder.parent(<span class="string">&quot;com.springmvc&quot;</span>) <span class="comment">// 设置父包名</span></span><br><span class="line">                            .moduleName(moduleName) <span class="comment">// 设置父包模块名</span></span><br><span class="line">                            .pathInfo(Collections.singletonMap(OutputFile.xml, mapperLocation)); <span class="comment">// 设置mapperXml生成路径</span></span><br><span class="line">                &#125;)</span><br><span class="line">                .strategyConfig(builder -&gt; &#123;</span><br><span class="line">                    builder.addInclude(tables) <span class="comment">// 设置需要生成的表名</span></span><br><span class="line">                            .addTablePrefix(<span class="string">&quot;o_&quot;</span>); <span class="comment">// 设置过滤表前缀</span></span><br><span class="line">                &#125;)</span><br><span class="line">                .templateEngine(<span class="keyword">new</span> <span class="title class_">FreemarkerTemplateEngine</span>()) <span class="comment">// 使用Freemarker引擎模板，默认的是Velocity引擎模板</span></span><br><span class="line">                .execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.3.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 德鲁伊 连接池 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatisplus--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 添加 模板引擎 依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.velocity<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>velocity-engine-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.microsoft.sqlserver<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mssql-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.31<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- springboot测试类 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mybatis </tag>
            
            <tag> SpringBoot </tag>
            
            <tag> SpringMVC </tag>
            
            <tag> MybatisPlus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot笔记</title>
      <link href="/2023/11/05/SpringBoot%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/11/05/SpringBoot%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="Spring-Boot使用slf4j进行日志记录"><a href="#Spring-Boot使用slf4j进行日志记录" class="headerlink" title="Spring Boot使用slf4j进行日志记录"></a>Spring Boot使用slf4j进行日志记录</h2><p>在开发中，我们经常使用 System.out.println() 来打印一些信息，但是这样不好，因为大量的使用 System.out 会增加资源的消耗。我们实际项目中使用的是 slf4j 的 logback 来输出日志，效率挺高的，Spring Boot 提供了一套日志系统，logback 是最优的选择。</p><p><strong>1.简介</strong><br>官网：<a href="https://www.slf4j.org/manual.html">https://www.slf4j.org/manual.html</a><br>(1)简单日记门面(simple logging Facade for Java)SLF4J是为各种loging APIs提供一个简单统一的接口。</p><p>(2)slf4j并不是一种具体的日志系统，而是一个用户日志系统的facade。</p><p>(3)在部署时，选择不同的日志系统包，即可自动转换到不同的日志系统上。<br>如：选择JDK自带的日志系统，则只需要将slf4j-api-XXX.jar和slf4j-jdkXXX.jar放置到classpath中即可，若想换成log4j的日志系统，仅需要用slf4j-log4jXXx.jar替换slf4j-jdkXXX.jar即可</p><p>(4)slf4j和log4j比较:<br>①log4j看成是一个完整的日志库；而slf4j是一个日志库的规范接口,可以根据不同的日志包使用不同的日志库。<br>②日志中需要传入参数时，log4j一般是使用字符串进行拼接的方式;<br>slf4j使用占位符，比字符串拼接更加高效。如logger.error(“sql为 {} “,sql)。</p><p>(5)slf4j日志级别<br>Slf4j日志级别,级别由低到高，设置的级别约低，打印的日志越多<br>①trace: 一般不会使用，在日志里边也不会打印出来，最低的一个日志级别。<br>②debug: 一般放于程序的某个关键点的地方，用于打印一个变量值或者一个方法返回的信息之类的信息<br>③info 一般处理业务逻辑的时候使用，就跟 system.err打印一样，用于说明此处是干什么的。<br>④warn：警告，不会影响程序的运行，但是值得注意。<br>⑤error： 用户程序报错，必须解决的时候使用此级别打印日志。</p><h3 id="2-使用教程"><a href="#2-使用教程" class="headerlink" title="2.使用教程"></a>2.使用教程</h3><p>官网上最新稳定版是1.7.32，前阵子log4j出重大漏洞了，这里我们配合logback（log4j的改良版，性能更好）使用。<br><strong>(1)在pom.xml引入依赖</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--slf4j依赖--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.32<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- logback 依赖 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>(2)在springBoot项目中添加一段controller代码</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.springtest.controller;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VisualController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(VisualController.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value=&quot;/test&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="string">&quot;fucking good&quot;</span>;</span><br><span class="line">        logger.info(<span class="string">&quot;slf4j print info msg:&#123;&#125;&quot;</span>,msg);</span><br><span class="line">        logger.debug(<span class="string">&quot;slf4j print debug msg:&#123;&#125;&quot;</span>,msg);</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里通过<a href="http://localhost:8080/test%E8%AE%BF%E9%97%AE%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%E5%A6%82%E4%B8%8B%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0info%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%86%EF%BC%8Cdebug%E6%B2%A1%E6%9C%89%EF%BC%8C%E5%9B%A0%E4%B8%BAspringboot%E5%86%85%E9%83%A8%E9%9B%86%E6%88%90%E4%BA%86slf4j%EF%BC%8C%E9%BB%98%E8%AE%A4%E6%98%AFinfo%E7%BA%A7%E5%88%AB%EF%BC%9A">http://localhost:8080/test访问可以看到控制台输出如下，可以看到info的输出了，debug没有，因为springboot内部集成了slf4j，默认是info级别：</a></p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231105020845.png"></p><p><strong>(3)只在控制台打印，application.yml文件配置如下：</strong></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># slf4j日志配置</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="comment"># 配置级别</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">root:</span> <span class="string">info</span></span><br><span class="line">    <span class="comment">#分包配置级别，即不同的目录下可以使用不同的级别</span></span><br><span class="line">    <span class="attr">com.example.springtest.controller:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure><p>改完之后发现输出如下：</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231105021025.png"></p><p>在resource下新建logback.xml：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--info日志文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;INFO_FILE&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--日志文件相对路径和名称--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">file</span>&gt;</span>./apilogs/info/xxxx_-$&#123;HOSTNAME&#125;.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--根据日志文件的大小来滚动（即创建新的）日志文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>./apilogs/info/archive/xxxx_-$&#123;HOSTNAME&#125;-%d.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--只保留最近30天的日志--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--超过10MB便会滚动日志文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>10MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置日志的输出格式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%date %level [%thread] %logger&#123;10&#125; %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--异步处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ASYNC_INFO_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.AsyncAppender&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">queueSize</span>&gt;</span>512<span class="tag">&lt;/<span class="name">queueSize</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;INFO_FILE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--debug日志文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;DEBUG_FILE&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--日志文件相对路径和名称--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">file</span>&gt;</span>./apilogs/debug/xxxx_-$&#123;HOSTNAME&#125;.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--根据日志文件的大小来滚动（即创建新的）日志文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>./apilogs/debug/archive/xxxx_-$&#123;HOSTNAME&#125;-%d.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--只保留最近30天的日志--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--超过10MB便会滚动日志文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>10MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置日志的输出格式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%date %level [%thread] %logger&#123;10&#125; %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--异步处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ASYNC_DEBUG_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.AsyncAppender&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">queueSize</span>&gt;</span>512<span class="tag">&lt;/<span class="name">queueSize</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;DEBUG_FILE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--控制台输出--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--输出格式--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%date %level [%thread] %logger&#123;10&#125; [%file:%line] %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--异步处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ASYNC-STDOUT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.AsyncAppender&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">queueSize</span>&gt;</span>512<span class="tag">&lt;/<span class="name">queueSize</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--在info级别下，将包名所在org.springframework的日志全部打印到控制台--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--additivity被设置为&#x27;false&#x27;，这意味着日志事件不会传递给父级记录器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.springframework&quot;</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ASYNC-STDOUT&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--在debug级别下，会打印记录sql的相关日志，将包名为org.apache.ibatis下的日志输出到debug日志文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.ibatis&quot;</span> <span class="attr">level</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ASYNC_DEBUG_FILE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--所有业务相关的info日志，打印到控制台，并输出到info日志文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ASYNC-STDOUT&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ASYNC_INFO_FILE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以看到控制台和日志文件都成功输出了：</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231105021058.png"></p><h3 id="3-常见报错解决（持续更新）"><a href="#3-常见报错解决（持续更新）" class="headerlink" title="3.常见报错解决（持续更新）"></a>3.常见报错解决（持续更新）</h3><p>(1)yml配置报错如：<br>“Failed to bind properties under ‘logging.level’”<br>可能跟版本有关，参考yml配置上面的使用教程的第(3)步</p><p>(2)启动时报错：<br>“class path contains multiple slf4j bindings<br>found binding in …”<br>不要忽视这种警告，若有多个jar包类冲突，需要把加载jar包顺序调整，正确的那个，比如slf4j-log4j12jar包放在最上面。</p><hr><h2 id="Spring-Boot中的MVC支持"><a href="#Spring-Boot中的MVC支持" class="headerlink" title="Spring Boot中的MVC支持"></a>Spring Boot中的MVC支持</h2><p>Spring Boot 的 MVC 支持主要来介绍实际项目中最常用的几个注解，包括 <code>@RestController</code>、 <code>@RequestMapping</code>、<code>@PathVariable</code>、<code>@RequestParam</code> 以及 <code>@RequestBody</code>。</p><h3 id="1-RestController"><a href="#1-RestController" class="headerlink" title="1. @RestController"></a>1. @RestController</h3><p><code>@RestController</code> 是 Spring Boot 新增的一个注解，我们看一下该注解都包含了哪些东西。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RestController &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看出， <code>@RestController</code> 注解包含了原来的 <code>@Controller</code> 和 <code>@ResponseBody</code> 注解，使用过 Spring 的朋友对 <code>@Controller</code> 注解已经非常了解了，这里不再赘述， <code>@ResponseBody</code> 注解是将返回的数据结构转换为 Json 格式。所以 <code>@RestController</code> 可以看作是 <code>@Controller</code> 和 <code>@ResponseBody</code> 的结合体，相当于偷个懒，我们使用 <code>@RestController</code> 之后就不用再使用 <code>@Controller</code> 了。但是需要注意一个问题：如果是前后端分离，不用模板渲染的话，比如 Thymeleaf，这种情况下是可以直接使用<code>@RestController</code> 将数据以 json 格式传给前端，前端拿到之后解析；但如果不是前后端分离，需要使用模板来渲染的话，一般 Controller 中都会返回到具体的页面，那么此时就不能使用<code>@RestController</code>了，比如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;user&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其实是需要返回到 user.html 页面的，如果使用 <code>@RestController</code> 的话，会将 user 作为字符串返回的，所以这时候我们需要使用 <code>@Controller</code> 注解。这在下一节 Spring Boot 集成 Thymeleaf 模板引擎中会再说明。</p><h3 id="2-RequestMapping"><a href="#2-RequestMapping" class="headerlink" title="2. @RequestMapping"></a>2. @RequestMapping</h3><p><code>@RequestMapping</code> 是一个用来处理请求地址映射的注解，它可以用于类上，也可以用于方法上。在类的级别上的注解会将一个特定请求或者请求模式映射到一个控制器之上，表示类中的所有响应请求的方法都是以该地址作为父路径；在方法的级别表示进一步指定到处理方法的映射关系。</p><p>该注解有6个属性，一般在项目中比较常用的有三个属性：value、method 和 produces。</p><ul><li><p>value 属性：指定请求的实际地址，value 可以省略不写</p></li><li><p>method 属性：指定请求的类型，主要有 GET、PUT、POST、DELETE，默认为 GET</p></li><li><p>produces属性：指定返回内容类型，如 produces &#x3D; “application&#x2F;json; charset&#x3D;UTF-8”</p></li></ul><p><code>@RequestMapping</code> 注解比较简单，举个例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/test&quot;, produces = &quot;application/json; charset=UTF-8&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/get&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testGet</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个很简单，启动项目在浏览器中输入 <code>localhost:8080/test/get</code> 测试一下即可。</p><p>针对四种不同的请求方式，是有相应注解的，不用每次在 <code>@RequestMapping</code> 注解中加 method 属性来指定，上面的 GET 方式请求可以直接使用 <code>@GetMapping(&quot;/get&quot;)</code> 注解，效果一样。相应地，PUT 方式、POST 方式和 DELETE 方式对应的注解分别为 <code>@PutMapping</code>、<code>@PostMapping</code> 和 <code>DeleteMapping</code>。</p><h3 id="3-PathVariable"><a href="#3-PathVariable" class="headerlink" title="3. @PathVariable"></a>3. @PathVariable</h3><p><code>@PathVariable</code> 注解主要是用来获取 url 参数，Spring Boot 支持 restfull 风格的 url，比如一个 GET 请求携带一个参数 id 过来，我们将 id 作为参数接收，可以使用 <code>@PathVariable</code> 注解。如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testPathVariable</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;获取到的id为：&quot;</span> + id);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里需要注意一个问题，如果想要 url 中占位符中的 id 值直接赋值到参数 id 中，需要保证 url 中的参数和方法接收参数一致，否则就无法接收。如果不一致的话，其实也可以解决，需要用 <code>@PathVariable</code> 中的 value 属性来指定对应关系。如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/user/&#123;idd&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testPathVariable</span><span class="params">(<span class="meta">@PathVariable(value = &quot;idd&quot;)</span> Integer id)</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;获取到的id为：&quot;</span> + id);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于访问的 url，占位符的位置可以在任何位置，不一定非要在最后，比如这样也行：<code>/xxx/&#123;id&#125;/user</code>。另外，url 也支持多个占位符，方法参数使用同样数量的参数来接收，原理和一个参数是一样的，例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/user/&#123;idd&#125;/&#123;name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testPathVariable</span><span class="params">(<span class="meta">@PathVariable(value = &quot;idd&quot;)</span> Integer id, <span class="meta">@PathVariable</span> String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;获取到的id为：&quot;</span> + id);</span><br><span class="line">        System.out.println(<span class="string">&quot;获取到的name为：&quot;</span> + name);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>运行项目，在浏览器中请求 <code>localhost:8080/test/user/2/zhangsan</code> 可以看到控制台输出如下信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">获取到的id为：2</span><br><span class="line">获取到的name为：zhangsan</span><br></pre></td></tr></table></figure><p>所以支持多个参数的接收。同样地，如果 url 中的参数和方法中的参数名称不同的话，也需要使用 value 属性来绑定两个参数。</p><h3 id="4-RequestParam"><a href="#4-RequestParam" class="headerlink" title="4. @RequestParam"></a>4. @RequestParam</h3><p><code>@RequestParam</code> 注解顾名思义，也是获取请求参数的，上面我们介绍了 <code>@PathValiable</code> 注解也是获取请求参数的，那么 <code>@RequestParam</code> 和 <code>@PathVariable</code> 有什么不同呢？主要区别在于： <code>@PathValiable</code> 是从 url 模板中获取参数值， 即这种风格的 url：<code>http://localhost:8080/user/&#123;id&#125;</code> ；而 <code>@RequestParam</code> 是从 request 里面获取参数值，即这种风格的 url：<code>http://localhost:8080/user?id=1</code> 。我们使用该 url 带上参数 id 来测试一下如下代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestParam</span><span class="params">(<span class="meta">@RequestParam</span> Integer id)</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;获取到的id为：&quot;</span> + id);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以正常从控制台打印出 id 信息。同样地，url 上面的参数和方法的参数需要一致，如果不一致，也需要使用 value 属性来说明，比如 url 为：<code>http://localhost:8080/user?idd=1</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestParam</span><span class="params">(<span class="meta">@RequestParam(value = &quot;idd&quot;, required = false)</span> Integer id)</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;获取到的id为：&quot;</span> + id);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>除了 value 属性外，还有个两个属性比较常用：</p><ul><li><p>required 属性：true 表示该参数必须要传，否则就会报 404 错误，false 表示可有可无。</p></li><li><p>defaultValue 属性：默认值，表示如果请求中没有同名参数时的默认值。</p></li></ul><p>从 url 中可以看出，<code>@RequestParam</code> 注解用于 GET 请求上时，接收拼接在 url 中的参数。除此之外，该注解还可以用于 POST 请求，接收前端表单提交的参数，假如前端通过表单提交 username 和 password 两个参数，那我们可以使用 <code>@RequestParam</code> 来接收，用法和上面一样。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/form1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testForm</span><span class="params">(<span class="meta">@RequestParam</span> String username, <span class="meta">@RequestParam</span> String password)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;获取到的username为：&quot;</span> + username);</span><br><span class="line">        System.out.println(<span class="string">&quot;获取到的password为：&quot;</span> + password);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>我们使用 postman 来模拟一下表单提交，测试一下接口：</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231105021854.png"></p><p>那么问题来了，如果表单数据很多，我们不可能在后台方法中写上很多参数，每个参数还要 <code>@RequestParam</code> 注解。针对这种情况，我们需要封装一个实体类来接收这些参数，实体中的属性名和表单中的参数名一致即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="keyword">private</span> String username;</span><br><span class="line"><span class="keyword">private</span> String password;</span><br><span class="line"><span class="comment">// set get</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用实体接收的话，我们不能在前面加 <code>@RequestParam</code> 注解了，直接使用即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/form2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testForm</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;获取到的username为：&quot;</span> + user.getUsername());</span><br><span class="line">        System.out.println(<span class="string">&quot;获取到的password为：&quot;</span> + user.getPassword());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>使用 postman 再次测试一下表单提交，观察一下返回值和控制台打印出的日志即可。在实际项目中，一般都是封装一个实体类来接收表单数据，因为实际项目中表单数据一般都很多。</p><h3 id="5-RequestBody"><a href="#5-RequestBody" class="headerlink" title="5. @RequestBody"></a>5. @RequestBody</h3><p><code>@RequestBody</code> 注解用于接收前端传来的实体，接收参数也是对应的实体，比如前端通过 json 提交传来两个参数 username 和 password，此时我们需要在后端封装一个实体来接收。在传递的参数比较多的情况下，使用 <code>@RequestBody</code> 接收会非常方便。例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="keyword">private</span> String username;</span><br><span class="line"><span class="keyword">private</span> String password;</span><br><span class="line"><span class="comment">// set get</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestBody</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;获取到的username为：&quot;</span> + user.getUsername());</span><br><span class="line">System.out.println(<span class="string">&quot;获取到的password为：&quot;</span> + user.getPassword());</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们使用 postman 工具来测试一下效果，打开 postman，然后输入请求地址和参数，参数我们用 json 来模拟，如下图所有，调用之后返回 success。</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231105021959.png"></p><p>同时看一下后台控制台输出的日志：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">获取到的username为：倪升武</span><br><span class="line">获取到的password为：123456</span><br></pre></td></tr></table></figure><p>可以看出，<code>@RequestBody</code> 注解用于 POST 请求上，接收 json 实体参数。它和上面我们介绍的表单提交有点类似，只不过参数的格式不同，一个是 json 实体，一个是表单提交。在实际项目中根据具体场景和需要使用对应的注解即可。</p><h3 id="6-总结"><a href="#6-总结" class="headerlink" title="6. 总结"></a>6. 总结</h3><p>本节课主要讲解了 Spring Boot 中对 MVC 的支持，分析了 <code>@RestController</code>、 <code>@RequestMapping</code>、<code>@PathVariable</code>、 <code>@RequestParam</code> 和 <code>@RequestBody</code> 四个注解的使用方式，由于 <code>@RestController</code> 中集成了 <code>@ResponseBody</code> 所以对返回 json 的注解不再赘述。以上四个注解是使用频率很高的注解，在所有的实际项目中基本都会遇到，要熟练掌握。</p><hr><p>Spring Boot 中集成Redis</p>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>富文本组件(mavon-editor)</title>
      <link href="/2023/10/22/%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BB%84%E4%BB%B6/"/>
      <url>/2023/10/22/%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>mavon-editor是一款基于vue的markdown编辑器，可以用来做文本的编辑，比如是某种业务需要发送公告、个人博客等，都可以用到，操作也十分简单。</p><p>官方地址：<a href="http://www.mavoneditor.com/?spm=a2c6h.12873639.article-detail.9.aaad62afIvVZGC">http://www.mavoneditor.com/</a></p><p>github：<a href="https://github.com/hinesboy/mavonEditor">https://github.com/hinesboy/mavonEditor</a></p><h2 id="安装-mavon-editor"><a href="#安装-mavon-editor" class="headerlink" title="安装 mavon-editor"></a>安装 mavon-editor</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mavon-editor --save</span><br></pre></td></tr></table></figure><p>安装好了之后就需要进行注册</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 组件注册</span></span><br><span class="line"><span class="keyword">import</span> mavonEditor <span class="keyword">from</span> <span class="string">&quot;mavon-editor&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;mavon-editor/dist/css/index.css&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// eslint-disable-next-line vue/multi-word-component-names</span></span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;EditorComponent&quot;</span>,</span><br><span class="line"><span class="attr">components</span>: &#123; mavonEditor &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>安装、注册后就要来使用富文本编辑器这个组件，以下我将使用我之前在学习做后台管理系统来作为案例。</p><h2 id="使用-mavon-editor"><a href="#使用-mavon-editor" class="headerlink" title="使用 mavon-editor"></a>使用 mavon-editor</h2><p>首先，注册好了就能够直接使用标签进行引用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mavon-editor</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">save</span>=<span class="string">&quot;saveDoc&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">change</span>=<span class="string">&quot;updateDoc&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">ref</span>=<span class="string">&quot;editor&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">&quot;doc&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mavon-editor</span>&gt;</span></span><br></pre></td></tr></table></figure><p>整体的形成就如下图</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231022222049.png"></p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231022222121.png"></p><p>这是带有预览模式，在上面的工具栏部分是组件已经完成的功能，其中有些需要自己的实现，比如是图片的上传，这个组件也能够支持扩展，可以去扩展更多的便捷式功能，具体详情在官网上都有。</p><h2 id="图片上传"><a href="#图片上传" class="headerlink" title="图片上传"></a>图片上传</h2><p>接下来介绍图片上传功能，图片上传包括两种，一种是直接添加就到服务器上(这里采用阿里云OSS存储)，还有一种是每次添加图片都保存起来，然后一同上传到服务器，这样的作法是能够确保在不想要发布的时候，图片不会被上传到服务器中，但是最常见的还是直接上传的那种。</p><h3 id="单图上传"><a href="#单图上传" class="headerlink" title="单图上传"></a>单图上传</h3><p>就是放置图片的同时直接将图片上传到阿里云OSS</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mavon-editor</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">save</span>=<span class="string">&quot;saveDoc&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">change</span>=<span class="string">&quot;updateDoc&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">imgAdd</span>=<span class="string">&quot;$imgAdd&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">ref</span>=<span class="string">&quot;editor&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">&quot;doc&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mavon-editor</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在组件标签中引入@imagAdd事件，这是组件的时间绑定。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$imgAdd(pos, file)&#123; <span class="comment">//只要放上去就上传到oss</span></span><br><span class="line">  <span class="comment">//单图上传</span></span><br><span class="line">  <span class="comment">// 第一步.将图片上传到服务器.</span></span><br><span class="line">  <span class="keyword">let</span> imgData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">  imgData.<span class="title function_">append</span>(<span class="string">&#x27;file&#x27;</span>,file);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$axios</span>.<span class="title function_">post</span>(<span class="string">&quot;/files/image/upload&quot;</span>, imgData).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 第二步.将返回的url替换到文本原位置![...](0) -&gt; ![...](url)</span></span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * $vm 指为mavonEditor实例，可以通过如下两种方式获取</span></span><br><span class="line"><span class="comment">     * 1. 通过引入对象获取: `import &#123;mavonEditor&#125; from ...` 等方式引入后，`$vm`为`mavonEditor`</span></span><br><span class="line"><span class="comment">     * 2. 通过$refs获取: html声明ref : `&lt;mavon-editor ref=md &gt;&lt;/mavon-editor&gt;，`$vm`为 `this.$refs.md`</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">mdedit</span>.$img2Url(pos, res.<span class="property">data</span>.<span class="property">data</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>整体的逻辑就是将文件保存到服务器中，在将返回的url替换到文档的原位置，<code>this.$refs.mdedit.$img2Url(pos, res.data.data)</code>进行回显保存路径。默认大小样式为 min-height: 300px , min-width: 300px，并且是可自行覆盖。</p><p>结果如下</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231022222559.png"></p><h3 id="多图上传"><a href="#多图上传" class="headerlink" title="多图上传"></a>多图上传</h3><p>多图上传简单理解就是循环所有文件，一一上传保存，适合可以将不要的图片经行去除，就不会全部都上传。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mavon-editor</span> <span class="attr">ref</span>=<span class="string">&quot;mdedit&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;ruleForm.content&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 80vh&quot;</span> @<span class="attr">imgAdd</span>=<span class="string">&quot;$imgAdd&quot;</span> @<span class="attr">imgDel</span>=<span class="string">&quot;$imgDel&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mavon-editor</span>&gt;</span></span><br></pre></td></tr></table></figure><p>通过定义一个变量来存储文件，也需要删事件，图片删除之后就需要去除。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$imgAdd(pos, $file)&#123;</span><br><span class="line">  <span class="comment">// 缓存图片信息</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">img_file</span>[pos] = $file;</span><br><span class="line">&#125;,</span><br><span class="line">$imgDel(pos)&#123;</span><br><span class="line">  <span class="keyword">delete</span> <span class="variable language_">this</span>.<span class="property">img_file</span>[pos];</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>上传，也就是循环将保存好的图片一一上传保存，在回显替换到原来的位置。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">uploadimg</span>(<span class="params">$e</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> _img <span class="keyword">in</span> <span class="variable language_">this</span>.<span class="property">img_file</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> imgData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">        <span class="comment">// 第一步.将图片上传到服务器.</span></span><br><span class="line">        imgData.<span class="title function_">append</span>(<span class="string">&#x27;file&#x27;</span>, <span class="variable language_">this</span>.<span class="property">img_file</span>[_img]);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$axios</span>.<span class="title function_">post</span>(<span class="string">&quot;/files/image/upload&quot;</span>, imgData).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 例如：返回数据为 res = [[pos, url], [pos, url]...]</span></span><br><span class="line"><span class="comment">             * pos 为原图片标志（0）</span></span><br><span class="line"><span class="comment">             * url 为上传后图片的url地址</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">             <span class="comment">// 第二步.将返回的url替换到文本原位置![...](0) -&gt; ![...](url)</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">mdedit</span>.$img2Url(i, res.<span class="property">data</span>.<span class="property">data</span>);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>这里粘贴一个后端代码，本次是使用阿里云OSS存储，需要做一些配置，详情可以去看一下阿里云官网关于OSS这一块的内容。后端方法的各种逻辑也都加了注释，这里就不在赘述。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/image/upload&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">uploadImage</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">    <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> FileUtil.extName(originalFilename); <span class="comment">//文件类型</span></span><br><span class="line">    <span class="type">double</span> <span class="variable">size</span> <span class="operator">=</span> file.getSize(); <span class="comment">//文件大小</span></span><br><span class="line">    <span class="comment">//定义一个唯一文件识别码 ---</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> IdUtil.fastSimpleUUID();</span><br><span class="line">    <span class="type">String</span> <span class="variable">uploadFile</span> <span class="operator">=</span>  uuid + StrUtil.DOT + type;</span><br><span class="line">    <span class="comment">//获取文件的url</span></span><br><span class="line">    String url;</span><br><span class="line">    <span class="comment">//创建文件的MD5</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">md5</span> <span class="operator">=</span> SecureUtil.md5(file.getInputStream());</span><br><span class="line">    <span class="comment">//从数据库里查询是否存在相同的记录...通过文件的md5查询文件</span></span><br><span class="line">    <span class="type">Files</span> <span class="variable">dbFile</span> <span class="operator">=</span> filesService.getFileByMd5(md5);</span><br><span class="line">    <span class="keyword">if</span> (dbFile != <span class="literal">null</span>) &#123; <span class="comment">//存在</span></span><br><span class="line">        url = dbFile.getUrl();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">//不存在，就存到oss中，并获取路径</span></span><br><span class="line">        <span class="comment">//OSS上传</span></span><br><span class="line">        ossUtil.upload(file.getInputStream(), <span class="string">&quot;images/&quot;</span> + uploadFile); <span class="comment">//路径肯定有，故不需要判定，oss只能存一个名字相同的</span></span><br><span class="line">        url = ossUtil.getURL(<span class="string">&quot;images/&quot;</span> + uploadFile); <span class="comment">//返回url</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//存储到数据库 -- 还需设置是谁上传的，要传来参数，后面搞</span></span><br><span class="line">    <span class="type">Files</span> <span class="variable">saveFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Files</span>();</span><br><span class="line">    saveFile.setName(originalFilename);</span><br><span class="line">    saveFile.setType(type);</span><br><span class="line">    saveFile.setSize(size/<span class="number">1024</span>);<span class="comment">//这是b要装成k就除以1024</span></span><br><span class="line">    saveFile.setUrl(url);</span><br><span class="line">    saveFile.setMd5(md5);</span><br><span class="line">    saveFile.setCreateTime(LocalDateTime.now());</span><br><span class="line">    filesService.save(saveFile);</span><br><span class="line">    <span class="keyword">return</span> Result.succ(url);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OSSUtil: 参照阿里云官网</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OSSUtil</span> &#123;</span><br><span class="line">    <span class="comment">/*上传*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">upload</span><span class="params">(InputStream inputStream, String target)</span>&#123;</span><br><span class="line">        <span class="comment">// 创建OSSClient实例。</span></span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(Const.ENDPOINT, Const.ACCESS_KEYID, Const.ACCESSKEY_SECRET);</span><br><span class="line">        ossClient.putObject(Const.BUCKET_NAME, target, inputStream);</span><br><span class="line">        <span class="comment">// 关闭OSSClient。</span></span><br><span class="line">        ossClient.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*获取url*/</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getURL</span><span class="params">(String objectName)</span>&#123;</span><br><span class="line">        <span class="comment">// 创建OSSClient实例。</span></span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(Const.ENDPOINT, Const.ACCESS_KEYID, Const.ACCESSKEY_SECRET);</span><br><span class="line">        <span class="comment">// 设置URL过期时间为100天。</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time</span> <span class="operator">=</span> LocalDateTime.now().plusDays(<span class="number">100</span>);</span><br><span class="line">        <span class="type">Date</span> <span class="variable">expiration</span> <span class="operator">=</span> Date.from(time.atZone( ZoneId.systemDefault()).toInstant());</span><br><span class="line">        <span class="comment">// 生成以GET方法访问的签名URL，访客可以直接通过浏览器访问相关内容。</span></span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> ossClient.generatePresignedUrl(Const.BUCKET_NAME, objectName, expiration);</span><br><span class="line">        <span class="comment">// 关闭OSSClient。</span></span><br><span class="line">        ossClient.shutdown();</span><br><span class="line">        <span class="keyword">return</span> url.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>更多上传相关可以查看:<a href="https://github.com/hinesboy/mavonEditor/blob/master/doc/cn/upload-images.md">https://github.com/hinesboy/mavonEditor/blob/master/doc/cn/upload-images.md</a></p><h2 id="其他功能"><a href="#其他功能" class="headerlink" title="其他功能"></a>其他功能</h2><p>mavon-editor提供了许多的API，就包括语言选择、工具栏、工具栏背景等等。</p><h4 id="toolbars"><a href="#toolbars" class="headerlink" title="toolbars"></a>toolbars</h4><p>默认工具栏按钮全部开启, 传入自定义对象，可以选择启用部分按钮，功能如下</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  例如: &#123;</span></span><br><span class="line"><span class="comment">      bold: true, // 粗体</span></span><br><span class="line"><span class="comment">      italic: true,// 斜体</span></span><br><span class="line"><span class="comment">      header: true,// 标题</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  此时, 仅仅显示此三个功能键</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="attr">toolbars</span>: &#123;</span><br><span class="line">    <span class="attr">bold</span>: <span class="literal">true</span>, <span class="comment">// 粗体</span></span><br><span class="line">    <span class="attr">italic</span>: <span class="literal">true</span>, <span class="comment">// 斜体</span></span><br><span class="line">    <span class="attr">header</span>: <span class="literal">true</span>, <span class="comment">// 标题</span></span><br><span class="line">    <span class="attr">underline</span>: <span class="literal">true</span>, <span class="comment">// 下划线</span></span><br><span class="line">    <span class="attr">strikethrough</span>: <span class="literal">true</span>, <span class="comment">// 中划线</span></span><br><span class="line">    <span class="attr">mark</span>: <span class="literal">true</span>, <span class="comment">// 标记</span></span><br><span class="line">    <span class="attr">superscript</span>: <span class="literal">true</span>, <span class="comment">// 上角标</span></span><br><span class="line">    <span class="attr">subscript</span>: <span class="literal">true</span>, <span class="comment">// 下角标</span></span><br><span class="line">    <span class="attr">quote</span>: <span class="literal">true</span>, <span class="comment">// 引用</span></span><br><span class="line">    <span class="attr">ol</span>: <span class="literal">true</span>, <span class="comment">// 有序列表</span></span><br><span class="line">    <span class="attr">ul</span>: <span class="literal">true</span>, <span class="comment">// 无序列表</span></span><br><span class="line">    <span class="attr">link</span>: <span class="literal">true</span>, <span class="comment">// 链接</span></span><br><span class="line">    <span class="attr">imagelink</span>: <span class="literal">true</span>, <span class="comment">// 图片链接</span></span><br><span class="line">    <span class="attr">code</span>: <span class="literal">true</span>, <span class="comment">// code</span></span><br><span class="line">    <span class="attr">table</span>: <span class="literal">true</span>, <span class="comment">// 表格</span></span><br><span class="line">    <span class="attr">fullscreen</span>: <span class="literal">true</span>, <span class="comment">// 全屏编辑</span></span><br><span class="line">    <span class="attr">readmodel</span>: <span class="literal">true</span>, <span class="comment">// 沉浸式阅读</span></span><br><span class="line">    <span class="attr">htmlcode</span>: <span class="literal">true</span>, <span class="comment">// 展示html源码</span></span><br><span class="line">    <span class="attr">help</span>: <span class="literal">true</span>, <span class="comment">// 帮助</span></span><br><span class="line">    <span class="comment">/* 1.3.5 */</span></span><br><span class="line">    <span class="attr">undo</span>: <span class="literal">true</span>, <span class="comment">// 上一步</span></span><br><span class="line">    <span class="attr">redo</span>: <span class="literal">true</span>, <span class="comment">// 下一步</span></span><br><span class="line">    <span class="attr">trash</span>: <span class="literal">true</span>, <span class="comment">// 清空</span></span><br><span class="line">    <span class="attr">save</span>: <span class="literal">true</span>, <span class="comment">// 保存（触发events中的save事件）</span></span><br><span class="line">    <span class="comment">/* 1.4.2 */</span></span><br><span class="line">    <span class="attr">navigation</span>: <span class="literal">true</span>, <span class="comment">// 导航目录</span></span><br><span class="line">    <span class="comment">/* 2.1.8 */</span></span><br><span class="line">    <span class="attr">alignleft</span>: <span class="literal">true</span>, <span class="comment">// 左对齐</span></span><br><span class="line">    <span class="attr">aligncenter</span>: <span class="literal">true</span>, <span class="comment">// 居中</span></span><br><span class="line">    <span class="attr">alignright</span>: <span class="literal">true</span>, <span class="comment">// 右对齐</span></span><br><span class="line">    <span class="comment">/* 2.2.1 */</span></span><br><span class="line">    <span class="attr">subfield</span>: <span class="literal">true</span>, <span class="comment">// 单双栏模式</span></span><br><span class="line">    <span class="attr">preview</span>: <span class="literal">true</span>, <span class="comment">// 预览</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>并且还能通过自定义工具</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mavon-editor</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 左工具栏前加入自定义按钮 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">&quot;left-toolbar-before&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">&quot;$click(&#x27;test&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;op-icon fa fa-mavon-align-left&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">title</span>=<span class="string">&quot;自定义&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 左工具栏后加入自定义按钮  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">&quot;left-toolbar-after&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">&quot;$click(&#x27;test&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;op-icon fa fa-mavon-align-left&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">title</span>=<span class="string">&quot;自定义&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 右工具栏前加入自定义按钮  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">&quot;right-toolbar-before&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">&quot;$click(&#x27;test&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;op-icon fa fa-mavon-align-left&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">title</span>=<span class="string">&quot;自定义&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 右工具栏后加入自定义按钮  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">&quot;right-toolbar-after&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">&quot;$click(&#x27;test&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;op-icon fa fa-mavon-align-left&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">title</span>=<span class="string">&quot;自定义&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mavon-editor</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h3><p>组件也提供了许多的事件绑定，这里不加以赘述，官网都有。可以看一下下图</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/325740871671512526552-3b249f95-1437-4a15-8e72-2bc169574667.png"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue插件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sass详解</title>
      <link href="/2023/10/18/Sass%E8%AF%A6%E8%A7%A3/"/>
      <url>/2023/10/18/Sass%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h3 id="1-什么是Sass"><a href="#1-什么是Sass" class="headerlink" title="1. 什么是Sass?"></a>1. 什么是Sass?</h3><p>Sass(Syntactically Awesome Stylesheets)是一个 <a href="https://so.csdn.net/so/search?q=CSS&spm=1001.2101.3001.7020">CSS</a> 预处理器，是 CSS 扩展语言，可以帮助我们减少 CSS 重复的代码，节省开发时间。</p><h3 id="2-为什么使用Sass？"><a href="#2-为什么使用Sass？" class="headerlink" title="2. 为什么使用Sass？"></a>2. 为什么使用Sass？</h3><ol><li>它能够帮我们更快更高效的编写更好维护的 css；</li><li>Sass 引入合理的样式复用机制，可以节约很多时间来重复。</li></ol><p>Sass的好处当然不仅于此，当你使用之后便会发现其中的妙处。</p><h3 id="3-Sass语法"><a href="#3-Sass语法" class="headerlink" title="3. Sass语法"></a>3. Sass语法</h3><h5 id="3-1-变量"><a href="#3-1-变量" class="headerlink" title="3.1 变量"></a>3.1 变量</h5><blockquote><p>变量可以存储样式信息，以便后面使用。<br>比如一个样式在页面的多个地方使用，就可以先将该样式的值赋给一个变量，后面直接使用变量即可。</p></blockquote><p><strong>语法：</strong> $变量名：样式值；<br><strong>使用：</strong> $变量名；<br><strong>注意点</strong>：</p><ol><li>以$符号开头，后跟变量名</li><li>多个单词，变量名以-分割，如：$theme-color</li><li>变量写在#{}中以镶嵌入字符串</li></ol><p><strong>示例如下：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-class">.scss</span>文件  Sass后缀名为scss</span><br><span class="line">$dark: <span class="number">#000</span>;</span><br><span class="line">$side: left;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: $dark;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: $dark;</span><br><span class="line"><span class="attribute">border</span>-#&#123;$side&#125;-radius: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">border-left</span>-radius: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-2-嵌套"><a href="#3-2-嵌套" class="headerlink" title="3.2 嵌套"></a>3.2 嵌套</h5><h6 id="1-选择器嵌套"><a href="#1-选择器嵌套" class="headerlink" title="1. 选择器嵌套"></a>1. 选择器嵌套</h6><blockquote><p>子元素在父元素样式的一对大括号{}内 如：ul { li { } }</p></blockquote><p><strong>语法：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">爷爷 &#123;</span><br><span class="line">爸爸 &#123;</span><br><span class="line">儿子 &#123;</span><br><span class="line">孙子 &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>示例如下:</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-tag">html</span>结构</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;grandpa&quot;&gt;</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;father&quot;&gt;</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;son&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line"><span class="selector-class">.grandpa</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.father</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.son</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.grandpa</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.grandpa</span> <span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.grandpa</span> <span class="selector-class">.father</span> <span class="selector-class">.son</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h6 id="2-伪类嵌套"><a href="#2-伪类嵌套" class="headerlink" title="2. 伪类嵌套"></a>2. 伪类嵌套</h6><blockquote><p>从上面我们可以看出，选择器嵌套得出的css样式相当于后代选择器一样，中间都有一个空格分隔，那如果想给一个元素添加:hover要怎么做呢?</p></blockquote><p>&amp;符就是来解决这个问题的。<br><strong>语法:</strong> &amp;:hover { }<br><strong>示例如下：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-tag">html</span>结构</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;box&quot;&gt;</span><br><span class="line">&lt;<span class="selector-tag">a</span> href=&quot;javascript:;&quot;&gt;hello&lt;/<span class="selector-tag">a</span>&gt;</span><br><span class="line">&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line">// 这里我们希望鼠标悬停<span class="selector-tag">a</span>的文本颜色改变</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">&amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这里&amp;就表示直接调用父选择器，拿上边的例子你可以把&amp;理解为它是&amp;外面的所有父选择器，&amp; &#x3D;&gt; .box a。</p><h5 id="3-3-混合-mixin"><a href="#3-3-混合-mixin" class="headerlink" title="3.3 混合 mixin"></a>3.3 混合 mixin</h5><blockquote><p>mixin相当于已经定义好了一类样式，可以在任何地方重复的使用它，就跟js中的函数一样。</p></blockquote><p><strong>语法1-不含参数：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> name &#123;</span><br><span class="line">css样式</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>使用:</strong> @include name；<br><strong>示例如下:</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line">// 定义一个mixin</span><br><span class="line"><span class="keyword">@mixin</span> box-style &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 使用</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="keyword">@include</span> box-style;</span><br><span class="line">// 当然也可以继续在这里添加样式</span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>语法2-含参数:</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> name ($param1，$param2， ...) &#123;</span><br><span class="line">css样式</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>使用:</strong> @include name(样式1，样式2，…)；<br><strong>注意：</strong><br>定义的时候参数要以$符开头，和变量命名是一样的<br><strong>示例如下:</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line">$box-<span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">$box-<span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line"></span><br><span class="line">// 定义一个mixin</span><br><span class="line"><span class="keyword">@mixin</span> box ($<span class="attribute">width</span>, $<span class="attribute">height</span>) &#123;</span><br><span class="line"><span class="attribute">width</span>: $width;</span><br><span class="line"><span class="attribute">height</span>: $height;</span><br><span class="line">&#125;</span><br><span class="line">// 使用</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">// <span class="number">1</span>. 第一种用法, 直接将css样式写入</span><br><span class="line"><span class="keyword">@include</span> box(<span class="number">200px</span>, <span class="number">200px</span>);</span><br><span class="line"></span><br><span class="line">// <span class="number">2</span>. 第二种, 将定义好的变量写入</span><br><span class="line"><span class="keyword">@include</span> box($box-width, $box-height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-4-继承-extend"><a href="#3-4-继承-extend" class="headerlink" title="3.4 继承 extend"></a>3.4 继承 extend</h5><blockquote><p>如果一个元素的样式和另一个元素的样式完全一样，这个元素无需再写一遍重复的样式，只需要使用@extend 就可以把另一个元素的所有样式全部继承过来。</p></blockquote><p><strong>语法:</strong> @extend 元素选择器；<br><strong>示例如下：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// box2 继承 box1的样式</span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line"><span class="keyword">@extend</span> .box1;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.box1</span>, <span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>不过继承要慎用，被继承相关的元素的样式也会继承过去，您看下面的例子：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box1</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// box2 继承 box1的样式</span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line"><span class="keyword">@extend</span> .box1;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.box1</span>, <span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box1</span> <span class="selector-tag">div</span>, <span class="selector-class">.box2</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果不想与被继承元素的相关元素牵扯，还是注意选择器的书写。</p><h5 id="3-5-导入-import"><a href="#3-5-导入-import" class="headerlink" title="3.5 导入 import"></a>3.5 导入 import</h5><blockquote><p>如果一个页面需要使用其他页面的样式，sass可以导入其他的scss文件，scss会把他们编译成一个css文件。<br>这样在开发中可以把一个页面的样式分割成多个scss文件，然后在页面的scss文件中导入其他scss，可以实现css的模块化开发。</p></blockquote><p><strong>语法：</strong> @import “文件名”<br><strong>示例如下：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 这里假设同级目录下有一个box1<span class="selector-class">.scss</span></span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 在box2<span class="selector-class">.scss</span>文件里引入box1<span class="selector-class">.scss</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;box1&quot;</span></span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line">div &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-6-注释"><a href="#3-6-注释" class="headerlink" title="3.6 注释"></a>3.6 注释</h5><ol><li>单行注释： &#x2F; &#x2F; css文件里不会显示 压缩方式的css不会显示</li><li>多行注释： &#x2F;**&#x2F; css文件里会显示 压缩方式的css不会显示</li><li>强制注释：&#x2F;* ! *&#x2F; css文件里会显示 压缩方式的css会显示</li></ol><h5 id="3-7-数学运算"><a href="#3-7-数学运算" class="headerlink" title="3.7 数学运算"></a>3.7 数学运算</h5><blockquote><p>包含+、-、*、&#x2F;(加减乘除)</p></blockquote><p><strong>示例如下:</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">50px</span> + <span class="number">50px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100px</span> - <span class="number">50px</span>;</span><br><span class="line">// 这里不能两个都带单位，否则是<span class="number">100px</span>*px这种不合法的值</span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">10px</span> * <span class="number">10</span>; </span><br><span class="line">// css会将/认为是合法的，所以需要加括号</span><br><span class="line"><span class="attribute">padding-top</span>: (<span class="number">100px</span> / <span class="number">2</span>) ;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-8-if条件语句"><a href="#3-8-if条件语句" class="headerlink" title="3.8 if条件语句"></a>3.8 if条件语句</h5><blockquote><p>Sass可以根据条件判断给出特定的样式</p></blockquote><p><strong>语法:</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@if</span> 条件语句 &#123;</span><br><span class="line">&#125; @ else if 条件语句 &#123;</span><br><span class="line">&#125; <span class="keyword">@else</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>示例如下：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="keyword">@if</span> <span class="number">1</span>+<span class="number">1</span> == <span class="number">2</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: red;</span><br><span class="line">&#125; <span class="keyword">@else</span> if <span class="number">1</span>+<span class="number">1</span> == <span class="number">3</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: blud;</span><br><span class="line">&#125; <span class="keyword">@else</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-9-for循环"><a href="#3-9-for循环" class="headerlink" title="3.9 for循环"></a>3.9 for循环</h5><blockquote><p>Sass也支持for循环，有两种语法。</p></blockquote><p><strong>语法1：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@for $index from 开始值 through 结束值 &#123;</span><br><span class="line">&#125;</span><br><span class="line">从开始值开始，到结束值结束，包含结束值  index表示 1， 2，...结束值</span><br></pre></td></tr></table></figure><p><strong>示例如下:</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// <span class="selector-class">.scss</span>文件</span><br><span class="line"><span class="keyword">@for</span> $i from <span class="number">1</span> through <span class="number">5</span> &#123;</span><br><span class="line"><span class="selector-class">.col-</span>#&#123;$<span class="selector-tag">i</span>&#125; &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">50px</span> * $i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line">// 生成的css代码</span><br><span class="line"><span class="selector-class">.col-1</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.col-2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.col-3</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.col-4</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.col-5</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">250px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="3-10-each循环"><a href="#3-10-each循环" class="headerlink" title="3.10 each循环"></a>3.10 each循环</h5><blockquote><p>遍历一个列表，然后从列表中取出对应值。<br>像border: 1px solied red； 1px solid red 这种用空格隔开的复合属性便是列表。</p></blockquote><p><strong>语法：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@each</span> $index in $list &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>示例如下：</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .scss文件</span></span><br><span class="line"><span class="variable">$icons</span>: success fail warning;</span><br><span class="line"><span class="keyword">@each</span> <span class="variable">$i</span> in <span class="variable">$icons</span> &#123;</span><br><span class="line"><span class="selector-class">.icon-</span>#&#123;<span class="variable">$i</span>&#125; &#123;</span><br><span class="line"><span class="attribute">background-image</span>: <span class="built_in">url</span>(../images/icons/#&#123;<span class="variable">$i</span>&#125;<span class="selector-class">.png</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成的css代码</span></span><br><span class="line"><span class="selector-class">.icon-success</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(../images/icons/success.png);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.icon-error</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(../images/icons/error.png);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.icon-warning</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(../images/icons/warning.png);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-11-while循环"><a href="#3-11-while循环" class="headerlink" title="3.11 while循环"></a>3.11 while循环</h5><blockquote><p>只要条件为真，就执行语句体。</p></blockquote><p><strong>语法：</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@while</span> 条件 &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>示例如下：</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .scss文件</span></span><br><span class="line"><span class="variable">$index</span>: <span class="number">6</span>;</span><br><span class="line"><span class="keyword">@while</span> <span class="variable">$index</span>&gt; <span class="number">0</span> &#123;</span><br><span class="line">    <span class="selector-class">.box-</span>#&#123;<span class="variable">$index</span>&#125; &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">5px</span> * <span class="variable">$index</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$index</span>: <span class="variable">$index</span> - <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成的css代码</span></span><br><span class="line"><span class="selector-class">.box-6</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box-4</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box-2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-12-用户自定义函数"><a href="#3-12-用户自定义函数" class="headerlink" title="3.12 用户自定义函数"></a>3.12 用户自定义函数</h5><p><strong>语法：</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@function</span> name(<span class="variable">$param1</span>，<span class="variable">$param2</span>，...) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>示例如下：</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .scss文件</span></span><br><span class="line"><span class="variable">$index</span>: <span class="number">6</span>;</span><br><span class="line"><span class="keyword">@function</span> get-color(<span class="variable">$key</span>) &#123;</span><br><span class="line"><span class="keyword">@if</span> <span class="variable">$key</span> &gt; <span class="number">5</span> &#123;</span><br><span class="line"><span class="keyword">@return</span> <span class="number">#000</span>;</span><br><span class="line">&#125; <span class="keyword">@else</span> &#123;</span><br><span class="line"><span class="keyword">@return</span> <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">get-color</span>(<span class="variable">$index</span>);</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成的css代码</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
            <tag> sass </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mock使用方法</title>
      <link href="/2023/10/13/mock%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/2023/10/13/mock%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="如何在Vue项目中使用Mock模拟数据？"><a href="#如何在Vue项目中使用Mock模拟数据？" class="headerlink" title="如何在Vue项目中使用Mock模拟数据？"></a>如何在Vue项目中使用Mock模拟数据？</h1><blockquote><p>前言：</p><p>在项目开发流程中，在开发工作开始之前，一般会有一个接口文档产出的过程：也就是依据设计文档给出响应的接口细节，方便前端mock数据；那如何更好的使用Mock来模拟数据，是一个优秀的前端必须要掌握的技能（PS：避免成为背锅侠）！</p></blockquote><h2 id="1-什么是联调？"><a href="#1-什么是联调？" class="headerlink" title="1.什么是联调？"></a>1.什么是联调？</h2><blockquote><p><strong>首先，你要了解什么是联调？在开发中起什么作用？</strong></p></blockquote><p>现在的开发基本都是前后端分离的，当后端还没有提供接口的时候，前端需要的数据从哪里来呢，就只能自己造假数据写死了。当后端接口做好后，前端所需要的数据就需要替换成后端提供的数据了。这个时候就需要进行一个前后端的调试，我们会把<strong>这个过程叫做前后端接口联调</strong>。</p><blockquote><p><strong>场景：</strong></p></blockquote><p>在一般的开发场景中，后端负责写接口，前端负责调用接口。然而通常情况下，前端开发页面时，后端还未写好接口，前端可以先自己”模拟“接口，等到后端写好接口时，前端才能真正的去调用后端的接口。这时候需要验证调试内容，例如:接口中URL是否正确，以及前端传的参数和后端返回的数据是否正确等，这个验证数据和功能有没有误的过程就是联调。</p><blockquote><p><strong>作用：</strong></p></blockquote><p>前端界面的展示，需要服务端从数据库查找数据并通过接口返回给前端，联调的<strong>目的是测试前后端的数据格式 &#x2F; 数据流 &#x2F;参数值是否正确</strong>，保证接口能正常获取和返回正确的数据，支持对应产品功能的实现。</p><ul><li>联调是前后端一起见证靠谱的测试结果</li><li>给需求方提供一个正确的需求验证环境</li><li>尽早暴露前后端实现的问题</li></ul><h2 id="2-什么是Mock"><a href="#2-什么是Mock" class="headerlink" title="2.什么是Mock?"></a>2.什么是Mock?</h2><p>通常意义的mock指的就是mock server，模拟服务端返回的接口数据，用于前端开发，第三方接口联调。</p><p>简单来说就是使用mockjs用来模拟产生一些虚拟的数据，可以让前端在后端接口还没有开发出来时独立开发。我们可以使用真实的url，mockjs可以拦截ajax请求，返回设定好的数据。</p><p><img src="https://upload-images.jianshu.io/upload_images/28377699-080aa3ec7ee0b609.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>在这里插入图片描述</p><p><strong>场景：</strong></p><ul><li>前后端开发进度不一致，前端开发速度快于后端，需要一个假的接口用于模拟后端返回。</li><li>项目需要用到第三方接口，如果第三方接口未开发好，或者第三方接口没有测试环境，为了保证进度，所以需要模拟接口用于调试。</li></ul><h2 id="4-怎么使用Mock"><a href="#4-怎么使用Mock" class="headerlink" title="4.怎么使用Mock?"></a>4.怎么使用Mock?</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">官网地址：http:<span class="comment">//mockjs.com/</span></span><br></pre></td></tr></table></figure><h3 id="3-1-使用方式"><a href="#3-1-使用方式" class="headerlink" title="3.1 使用方式"></a>3.1 使用方式</h3><p>1）在vue-cli&#x2F;vite项目搭建后，安装axios和mockjs</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -S axios</span><br><span class="line">npm install -D mockjs</span><br></pre></td></tr></table></figure><ol><li>在util文件(通常情况下)配置axios和mock</li></ol><ul><li>axios配置，并在main.js中引入</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//http.js文件内容</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">res</span>=&gt;</span>res.<span class="property">data</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> axios</span><br></pre></td></tr></table></figure><ul><li>mock配置，并在main.js中执行</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可以在mock.js文件中模拟数据</span></span><br><span class="line"><span class="comment">//如果引入出现... 执行npm i --save-dev @types/mockjs </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入mockjs</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Mock</span> <span class="keyword">from</span> <span class="string">&#x27;mockjs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// mock方法--三个参数</span></span><br><span class="line">  <span class="comment">// 1. 拦截请求地址</span></span><br><span class="line">  <span class="comment">// 2. 请求方式</span></span><br><span class="line">  <span class="comment">// 3. 返回数据</span></span><br><span class="line">    <span class="comment">// 形式：1直接返回数据  2函数返回数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义全局数据</span></span><br><span class="line"><span class="keyword">let</span> arr =[]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义函数-生成数据</span></span><br><span class="line"><span class="comment">// 函数返回数据--方便进行增删改查</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createNews</span>=(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">  <span class="keyword">let</span> newlist = []</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i =<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    newlist.<span class="title function_">push</span>(&#123;</span><br><span class="line">      <span class="comment">// 生成的数据</span></span><br><span class="line">      <span class="attr">cname</span>:<span class="title class_">Mock</span>.<span class="property">Random</span>.<span class="title function_">cname</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newlist</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">arr = <span class="title function_">createNews</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义函数-处理新增数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleAddName</span> = (<span class="params">opt</span>)=&gt;&#123;</span><br><span class="line">  <span class="comment">// post传递过来的参数</span></span><br><span class="line">  <span class="comment">// console.log(opt.body) //json字符串 需要转成对象</span></span><br><span class="line">  <span class="keyword">let</span> &#123;keyWords&#125; = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(opt.<span class="property">body</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(keyWords)</span><br><span class="line">  arr.<span class="title function_">push</span>(&#123;<span class="attr">cname</span>:keyWords&#125;)</span><br><span class="line">  <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义函数-删除数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleDeleteName</span> =(<span class="params">opt</span>)=&gt;&#123;</span><br><span class="line">  <span class="comment">// 通过opt.url截取字符串传递过来的参数</span></span><br><span class="line">  <span class="comment">// console.log(opt.url)</span></span><br><span class="line">  <span class="keyword">let</span> index = opt.<span class="property">url</span>.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">  <span class="comment">// console.log(index)</span></span><br><span class="line">  arr.<span class="title function_">splice</span>(index,<span class="number">1</span>)</span><br><span class="line">  <span class="comment">// console.log(arr)</span></span><br><span class="line">  <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询接口--get</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">mock</span>(<span class="string">&#x27;/mock/news&#x27;</span>,<span class="string">&#x27;get&#x27;</span>,arr)</span><br><span class="line"><span class="comment">// 新增接口--post</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">mock</span>(<span class="string">&#x27;/mock/addNews&#x27;</span>,<span class="string">&#x27;post&#x27;</span>,handleAddName)</span><br><span class="line"><span class="comment">// 删除接口--delete(请求的查询参数拼接在请求路径中的，需要对路径进行处理，使用正则，只要是符合校验的进来进行操作)</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">mock</span>(<span class="regexp">/^\/mock\/deleteNews/</span>,<span class="string">&#x27;delete&#x27;</span>,handleDeleteName)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接返回数据</span></span><br><span class="line"><span class="comment">// Mock.mock(&#x27;/mock/news&#x27;,&#x27;put&#x27;,&#123;</span></span><br><span class="line"><span class="comment">// 属性 list 的值是一个数组，其中含有 1 到 10 个元素</span></span><br><span class="line"><span class="comment">//   &quot;list|10&quot;:[</span></span><br><span class="line"><span class="comment">//     &#123;</span></span><br><span class="line"><span class="comment">//       &quot;fname&quot;:&quot;@cfirst()&quot;,</span></span><br><span class="line"><span class="comment">//       &quot;lname&quot;:&quot;@clast()&quot;,</span></span><br><span class="line"><span class="comment">//       &quot;avatar&quot;:&quot;@image(&#x27;100x100&#x27;,&#x27;pink&#x27;,&#x27;#fff&#x27;,&#x27;png&#x27;,&#x27;Hello&#x27;)&quot;,</span></span><br><span class="line"><span class="comment">//       &quot;info&quot;:&quot;@cparagraph()&quot;,</span></span><br><span class="line"><span class="comment">//       &quot;age&quot;:&quot;@integer(0,100)&quot;,</span></span><br><span class="line"><span class="comment">//       &quot;address&quot;:&quot;@county(true)&quot;,</span></span><br><span class="line"><span class="comment">//       &quot;yzm&quot;:&quot;@string(&#x27;number&#x27;,6)&quot;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   ]</span></span><br><span class="line"><span class="comment">// &#125;)</span></span><br></pre></td></tr></table></figure><ul><li>main.js文件</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.js文件内容</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router/index.js&#x27;</span></span><br><span class="line"><span class="comment">//引入axios</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;./util/http.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行mockjs文件</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./util/mock.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//全局提供</span></span><br><span class="line">app.<span class="title function_">provide</span>(<span class="string">&#x27;$axios&#x27;</span>,axios)</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">.<span class="title function_">use</span>(router)</span><br><span class="line">.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li>模拟获取到的数据如下图(具体可根据官网提供的示例，按需使用)：</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/28377699-720630119b0e5c54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1138/format/webp" alt="img"></p><p>在这里插入图片描述</p><ol><li>调用接口请求数据，渲染数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Mock模拟数据<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line">  &lt;ul&gt;</span><br><span class="line">    &lt;li v-for=&quot;item,index in list&quot; :key=&quot;item&quot;&gt;</span><br><span class="line">      &lt;h4&gt;&#123;&#123;item.fname&#125;&#125;&lt;/h4&gt;</span><br><span class="line">      &lt;h4&gt;&#123;&#123;item.cname&#125;&#125;&lt;/h4&gt;</span><br><span class="line">      &lt;input type=&quot;button&quot; value=&quot;删除Name&quot; @click=&quot;deleteName(index)&quot;&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&quot;addNameInp&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;button&quot; value=&quot;新增Name&quot; @click=&quot;addNameBtn&quot;&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">// 引入</span><br><span class="line">import &#123;ref,reactive,toRefs,inject,onMounted&#125; from &#x27;vue&#x27;</span><br><span class="line">// 使用axios</span><br><span class="line">const $axios = inject(&#x27;$axios&#x27;)</span><br><span class="line">// 数据</span><br><span class="line">const data = reactive(&#123;</span><br><span class="line">  list:[]</span><br><span class="line">&#125;)</span><br><span class="line">// 解构list --使用toRefs变成响应式</span><br><span class="line">const &#123;list&#125; = toRefs(data)</span><br><span class="line">// 新增的名字的value</span><br><span class="line">const addNameInp = ref(&#x27;&#x27;)</span><br><span class="line">// 新增按钮</span><br><span class="line">const addNameBtn = async()=&gt;&#123;</span><br><span class="line">  // 请求数据</span><br><span class="line">  let res = await $axios.post(&#x27;/mock/addNews&#x27;,&#123;</span><br><span class="line">    keyWords:addNameInp.value</span><br><span class="line">  &#125;)</span><br><span class="line">  // 清空输入框</span><br><span class="line">  addNameInp.value=&#x27;&#x27;</span><br><span class="line">  data.list = res</span><br><span class="line">&#125;</span><br><span class="line">// 删除按钮</span><br><span class="line">const deleteName =async(index)=&gt;&#123;</span><br><span class="line">  let res = await $axios.delete(&#x27;/mock/deleteNews&#x27;,&#123;</span><br><span class="line">    params:&#123;</span><br><span class="line">      index:index</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  data.list=res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(async()=&gt;&#123;</span><br><span class="line">  // 请求数据</span><br><span class="line">  let res = await  $axios.get(&#x27;/mock/news&#x27;)</span><br><span class="line">  console.log(res)</span><br><span class="line">  // data.list  = res.list</span><br><span class="line">  data.list= res</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/28377699-749479bf0ce9c5bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2分钟规则</title>
      <link href="/2023/10/13/2%E5%88%86%E9%92%9F%E8%A7%84%E5%88%99/"/>
      <url>/2023/10/13/2%E5%88%86%E9%92%9F%E8%A7%84%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h1 id="2分钟规则"><a href="#2分钟规则" class="headerlink" title="2分钟规则"></a><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==" alt="img">2分钟规则</h1><p>实用技巧文摘</p><p>每当你发现很难开始执行某项任务时，可以试试将其缩减成2分钟的版本。</p><ul><li>看一本书 → 看一页书</li><li>写一篇文章 → 写一句话</li><li>跑10公里 → 穿上跑鞋</li><li>做100次俯卧撑 → 做1次俯卧撑</li><li>多吃蔬菜水果 → 吃一个水果</li><li>编写一个程序 → 编写一个函数 → 编写一行代码</li></ul><p>这样做的目的是使上手变得超级容易，让你先上手再说。一旦开始做了（这可能是最艰难的一步），你就会开始有动力，可能会继续做下去。</p><ul><li>阅读一页 → 阅读10页 → 读完第一章</li><li>写一个句子 → 写文章的开头 → 写出正文</li><li>穿上跑鞋 → 步行5分钟 → 跑步5分钟</li></ul><p>一旦开始，继续做下去就会容易得多。有时，你甚至会发现，自己在不知不觉间已经完成了任务。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 实用技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenAPI/Swagger</title>
      <link href="/2023/10/11/OpenAPI%20Swagger/"/>
      <url>/2023/10/11/OpenAPI%20Swagger/</url>
      
        <content type="html"><![CDATA[<h1 id="OpenAPI-Swagger"><a href="#OpenAPI-Swagger" class="headerlink" title="OpenAPI&#x2F;Swagger"></a>OpenAPI&#x2F;Swagger</h1><blockquote><p>OpenAPI &#x2F; Swagger 相较于其他规范完善程度更高，生态更加完整，是目前 CODING 推荐的 API 设计语言。</p></blockquote><h3 id="什么是-OpenAPI-Swagger"><a href="#什么是-OpenAPI-Swagger" class="headerlink" title="什么是 OpenAPI &#x2F; Swagger"></a>什么是 OpenAPI &#x2F; Swagger</h3><p><a href="https://swagger.io/resources/open-api">OpenAPI</a> 规范（OAS）是一种通用的、和编程语言无关的 API 描述规范，使人类和计算机都可以发现和理解服务的功能，而无需访问源代码、文档或针对接口进行嗅探。正确定义后，使用者可以使用最少的实现逻辑来理解远程服务并与之交互。</p><p>OpenAPI 始于 Swagger 规范，Swagger 规范已于 <a href="https://smartbear.com/blog/develop/what-is-the-difference-between-swagger-and-openapi/">2015 年捐赠给 Linux 基金会后改名为 OpenAPI</a>，并定义最新的规范为 OpenAPI 3.0。</p><p>CODING 目前支持以下版本导入：</p><ul><li>OpenAPI v3（OAS 3）</li><li>Swagger v2</li></ul><h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h3><p>通常，设计 API 规范有两个方向，Design-First（设计优先） 或 Code-First（编码优先）</p><ol><li><p>Design-First（设计优先）：</p><p>即优先设计 API 规范，设计完成后再着手进行代码开发工作。</p><p>采用 Design-First 就意味着，将设计 API 路由、参数等工作提前，后续整个软件开发的流程都需要围绕着 API 规范为核心，当然这需要有一定的设计经验的开发人员才能胜任。</p><p>Design-First 有很多好处：</p><p>-提高开发效率。开发团队将根据 API 规范进行并行开发和对接工作，而无需等待接口逻辑开发完毕。<br>-降低接口开发的成本，无需修改代码逻辑即可轻松地修改 API 规范，因为 API 描述语言（如：OpenAPI）与编码语言无关<br>-开发人员更加专注于设计 API 规范，对比 Code-First 可以描写更多 API 的细节，如：校验规则、范例数据等，同时开发人员对 API 的全局一致性、扩展性、规范性也有更好的把控。<br>-在联调开发的过程中可以提前发现和解决问题，避免问题在开发完毕后修改的成本过高。<br>-由于 API 描述更加标准化，可以方便做更多的 API 生态延伸，比如基于 API 规范生成 Mock API Server，开发 API 自动化测试代码，接入 API 网关等。</p><p>点击查看<a href="https://swagger.io/blog/api-design/design-first-or-code-first-api-development">更多参考</a></p></li><li><p>Code-First（编码优先）：</p><p>即通过代码中关于 API 描述特性、注解或注释自动生成 API 描述文件的设计方式，如：JAVA 生态的 SpringFox。</p><p>适合倾向于在代码上编写 API 规范，通过自动化设施自动生成文档的团队。</p><p>Code-First 的优点：</p><p>-节省时间。对于 API 开发者，编码的同时可以获得一份满足基本要求的 API 文档。<br>-方便接入自动化 CI&#x2F;CD 流程中。</p><p>虽然 Code-First 省去了开发者设计 API 描述文件的阶段，提高了 API 开发者的效率，但是从整个团队的角度来看，效率并不一定提升了，反而有可能降低了效率。</p><p>不同 API 开发者的经验和习惯的不同，极有可能在编码的过程中对 API 的限制条件考虑不全，又或者框架生成 API 文档的程序完善度不够，种种因素导致最终生成的 API 的描述无法达到理想标准。</p><p>而很多 API 开发者习惯开发完成后才推送代码，并生成 API 文档，也导致了团队的进程阻塞于此，拖后了整个团队的开发进程。另一方面，API 在开发完成如果没有测试，很有可能导致 API 对接者在对接的过程中遇到重重阻碍。</p><p>CODING 也希望各位开发者重视 API 设计的重要性，如果您喜欢 Code-First 设计方向，我们的建议是：</p><p>-选用完善程度比较高的生成组件<br>-对 API 的描述尽可能的细致、完整<br>-优先设计路由、请求、响应等规则，详细的逻辑代码在 API 设计完成后再着手开发。</p></li></ol><p>Design-First 和 Code-First 针对不同的场景有着各自的优势，不同团队对两者考虑的方向也不同，但是对 API 描述的完善不管是哪个方向都是最重要的。</p><p>下面我们将针对 Design-First 和 Code-First 两个方向的最佳实践作展开。</p><h4 id="Design-First"><a href="#Design-First" class="headerlink" title="Design-First"></a>Design-First</h4><p>OpenAPI 进化到 v3 版本后，虽然规范非常完善，但对于首次上手的同学来说还是非常复杂，那么带有界面的编辑工具会成为最佳选择。</p><p>这里我们推荐使用 <a href="https://mermade.github.io/openapi-gui">OpenAPI-GUI v3</a> 来设计 API 描述文件，如下图所示。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223145811.png"><img src="https://help-assets.codehub.cn/enterprise/20191223145811.png" alt="img"></a></p><h5 id="OpenAPI-GUI-v3-基本使用"><a href="#OpenAPI-GUI-v3-基本使用" class="headerlink" title="OpenAPI-GUI v3 基本使用"></a>OpenAPI-GUI v3 基本使用</h5><p>OpenAPI-GUI v3 支持设计大多数常见情况的 API 规则，并且支持本地部署，非常适合新手，下面我们简单介绍一下 OpenAPI-GUI v3 的基本使用方式。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223145901.png"><img src="https://help-assets.codehub.cn/enterprise/20191223145901.png" alt="img"></a></p><p>OpenAPI-GUI v3 的导航结构如上图所示。</p><p>首先，我们切换到 <code>Header</code>，给 API 文档定义标题、描述、作者等基础信息。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223150930.png"><img src="https://help-assets.codehub.cn/enterprise/20191223150930.png" alt="img"></a></p><p>接着，我们切换至 <code>Servers</code> 配置 API 各环境基础路径地址。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223150958.png"><img src="https://help-assets.codehub.cn/enterprise/20191223150958.png" alt="img"></a></p><p>如果您的 API 需要经过鉴权（OAuth、APIKey 等），您可以切换到 <code>Security</code> 配置响应的鉴权信息，如下图所示。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151344.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151344.png" alt="img"></a></p><p>下面将开始设计 API 分组，点击切换到 <code>Tags</code>，对应的之后设计的接口可与分组相关联，并在文档中展示时，合并到对应分组栏目中。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151421.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151421.png" alt="img"></a></p><p><code>Main</code> 为最主要的 API 设计界面，需要了解的是，CODING API 文档以 tag 分组，而该界面以路由+请求方法（Method）分组。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151435.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151435.png" alt="img"></a></p><p>Description TAB 用于填写接口的标题、描述和关联 tag 信息，建议全部填写，若未填 Summary，API 文档将显示 API ID（OperationID），未关联 tag 将归属于默认分组。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151448.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151448.png" alt="img"></a></p><p>Parameter 用于定义请求 Query、Header、Cookie 和路由参数规则，Location 可指定参数位置。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151518.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151518.png" alt="img"></a></p><p>而在非 GET 请求方式（Method）方式下，如 POST &#x2F; PATCH &#x2F; PUT 等，Request Body 则用于定义请求 Body 的规则，如 Form 表单参数、纯 JSON 方式提交参数定义等。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151530.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151530.png" alt="img"></a></p><p>对应的 Request Body 必须定义 Media-Type，可定义多个 Media-Type，API 服务器将根据该参数识别 Body 内容结构，如上图所示 <code>application/json</code> 即为纯 JSON 方式提交表单参数。</p><p>您可以复用实体，下面会讲到，或者直接编辑请求结构，点击后弹出如下图所示，可直接编辑。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151608.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151608.png" alt="img"></a></p><p>需要注意的是，该弹窗弹出位置可能会在显示页面下方，需要滚动到下方才可看到。</p><p>切换到 Response TAB，我们可以定义接口响应返回的结构。</p><p>在这个界面可以增加多条响应结构，如 200、400、401 多个状态码有多重不同响应返回结构，或者同状态码下不同 Media-Type 不同返回结构。</p><p>点击编辑结构和 Request Body 类似，可定义响应数据结构规则。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151646.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151646.png" alt="img"></a></p><p>切换到 Security TAB，可以配置接口的鉴权配置，由于编辑器未完善，您可在设计完成后通过导出 OpenAPI 描述文件，以源文件的形式修改 scope 范围（可参考下方进阶教程）。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151703.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151703.png" alt="img"></a></p><blockquote><p>由于 Docs &#x2F; Links &#x2F; Callbacks 在日常使用时不常用到，CODING API 文档暂不作展示。</p></blockquote><p>在设计完毕后，您可点击右上角 Save 按钮保存修改，并点击 <code>Export JSON</code> 或者 <code>Export YAML</code> 复制或者下载 OpenAPI 描述文件。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223151714.png"><img src="https://help-assets.codehub.cn/enterprise/20191223151714.png" alt="img"></a></p><p>接着，在 CODING API 文档导入并发布。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223152051.png"><img src="https://help-assets.codehub.cn/enterprise/20191223152051.png" alt="img"></a></p><p>等待发布完毕后，点击详情页的文档地址，查看最终效果。</p><h5 id="已有-OpenAPI-描述文件"><a href="#已有-OpenAPI-描述文件" class="headerlink" title="已有 OpenAPI 描述文件"></a>已有 OpenAPI 描述文件</h5><p>如果您已有 OpenAPI 描述文件，或者您想先看一下效果，那么您可以切换到 <code>Upload</code> TAB，将描述文件填入编辑框，或者点击 <code>Demo</code> 加载范例文件，并点击 <code>Load Definition</code> 加载描述文件。</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223152111.png"><img src="https://help-assets.codehub.cn/enterprise/20191223152111.png" alt="img"></a></p><h5 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h5><p>虽然使用 OpenAPI-GUI v3 设计非常方便，但是对 OpenAPI 支持的并不完整，比如 Request &amp; Response Example 无法在线编辑，这种场景下，我们就需要针对 OpenAPI 描述源文件进行编辑。</p><p>这里我们推荐使用 <a href="https://editor.swagger.io/">Swagger Editor</a> 进行编辑，如下图所示：</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223152739.png"><img src="https://help-assets.codehub.cn/enterprise/20191223152739.png" alt="img"></a></p><p>Swagger Editor 是所见即所得的，并且如果写的语法有问题，会在对应段落显示错误提示，并说明错误原因，如下图所示：</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223152823.png"><img src="https://help-assets.codehub.cn/enterprise/20191223152823.png" alt="img"></a></p><p>相对于纯手写 OpenAPI 描述文件，Swagger Editor 有个贴心的功能，您可以很方便的通过可视化界面插入描述（如：path、operation 等）至编辑框中，如下图所示，</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223152830.png"><img src="https://help-assets.codehub.cn/enterprise/20191223152830.png" alt="img"></a></p><p><a href="https://help-assets.codehub.cn/enterprise/20191223152838.png"><img src="https://help-assets.codehub.cn/enterprise/20191223152838.png" alt="img"></a></p><p>为了方便理解 OpenAPI v3 规范，我们在下方给出了 OpenAPI v3 的一般结构范例，对应的右边给出了字段的备注信息，方便对照：</p><blockquote><p>该范例 CODING API 文档均支持展示</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line">openapi: 3.0.0                                                        # 代表使用 OpenAPI v3 规范</span><br><span class="line">info:                                                                            # 这里写 API 文档基础信息</span><br><span class="line">  title: 宠物商店 API 文档                                        # API 文档标题</span><br><span class="line">  version: &#x27;1.0.0&#x27;                                                    # API 文档版本</span><br><span class="line">  description: 这是一篇关于宠物商店的 DEMO API 文档，仅做参考。        # API 文档描述</span><br><span class="line">  contact:                                                                    # 联系信息</span><br><span class="line">    name: CODING</span><br><span class="line">    url: &#x27;https://coding.net&#x27;</span><br><span class="line">    email: coding_support@tencent.com</span><br><span class="line">servers:                                                                    # 这里写 API 服务器地址，多条可代表不同环境</span><br><span class="line">  - url: &#x27;https://petstore.com/api/v1&#x27;</span><br><span class="line">    description: 生产环境</span><br><span class="line">  - url: &#x27;http://test.petstore.com/api/v1&#x27;</span><br><span class="line">    description: 测试环境</span><br><span class="line">tags:                                                                            # 标签，CODING 中可作为分组依据，name 作为分组名称</span><br><span class="line">  - name: 宠物</span><br><span class="line">    description: 所有关于宠物的内容</span><br><span class="line">  - name: 会话</span><br><span class="line">    description: 关于用户的注册、登录和登出</span><br><span class="line">paths:                                    # 这里写具体的 API 的相关信息（API 名称、请求类型、摘要、请求参数、响应等）</span><br><span class="line">  /pets/&#123;petId&#125;:                                                        # 第一层，API 路由</span><br><span class="line">    get:                                                                            # 第二层，请求方法（Method）,如: get, post, delete 等</span><br><span class="line">      tags:                                                                            # 标签，与上方全局的标签对应，将该接口归于对应 tag 的组中</span><br><span class="line">        - 宠物</span><br><span class="line">      summary: 宠物详情                                                        # 接口摘要，CODING 中可作为接口标题</span><br><span class="line">      operationId: get-pet                                            # 接口 ID（必填），接口的唯一识别方式 </span><br><span class="line">      description: 获取宠物信息                                          # 接口描述信息</span><br><span class="line">      parameters:                                                                # 接口参数，可多条，支持路由、Query、Header 参数</span><br><span class="line">          - schema:                                                                    # 参数结构</span><br><span class="line">          type: string                                                            # 参数类型，integer / string / array 等</span><br><span class="line">          name: petId                                                                # 参数 key</span><br><span class="line">          in: path                                                                    # 路由（path）类型的参数</span><br><span class="line">          required: true                                                        # 是否必填</span><br><span class="line">          description: 宠物 ID                                             # 参数描述</span><br><span class="line">        - schema:</span><br><span class="line">            type: string</span><br><span class="line">            enum:                                                                        # 参数枚举</span><br><span class="line">              - application/json</span><br><span class="line">              - application/xml</span><br><span class="line">            default: application/json</span><br><span class="line">          in: header                                                            # header 类型的参数</span><br><span class="line">          name: Accept</span><br><span class="line">          description: 返回数据媒体类型</span><br><span class="line">        - schema:</span><br><span class="line">            type: integer</span><br><span class="line">            default: 1                                                            # 参数默认值</span><br><span class="line">          in: query                                                                # Query 类型的参数</span><br><span class="line">          name: page</span><br><span class="line">          description: 页码</span><br><span class="line">      security:                                                                    # 接口授权信息，此处与全局 components/securitySchemes 对应</span><br><span class="line">        - petstore_auth:                                                    # 此处与 components/securitySchemes/petstore_auth 对应</span><br><span class="line">            - &#x27;read:pets&#x27;                                                        # 此处代表接口 OAuth Scope 信息</span><br><span class="line">      responses:                                                                # 接口响应信息</span><br><span class="line">        &#x27;200&#x27;:                                                                        # 响应状态码</span><br><span class="line">          description: 以数组形式返回宠物信息                     # 响应描述信息</span><br><span class="line">          headers:</span><br><span class="line">            X-PAGE:</span><br><span class="line">              schema:</span><br><span class="line">                type: integer</span><br><span class="line">              description: 当前页码</span><br><span class="line">          content:                                                                # 响应内容规范描述</span><br><span class="line">            application/json:                                                # 响应内容 Media Type</span><br><span class="line">              schema:                                                                    # 响应内容结构</span><br><span class="line">                type: array</span><br><span class="line">                description: 宠物信息</span><br><span class="line">                items:</span><br><span class="line">                  $ref: &#x27;#/components/schemas/Pet&#x27;    # $ref 可用来引用 components/schemas 中的各种实体声明，减少相同数据结构冗余，增加复用性</span><br><span class="line">              examples:                                                            # 响应范例，建议填写，可用于 CODING API 文档范例显示以及 Mock API 模拟数据</span><br><span class="line">                请求成功范例:                                                        # 范例名称</span><br><span class="line">                  value:                                                                # 范例，展示时将转换成 JSON 形式</span><br><span class="line">                    - id: 1</span><br><span class="line">                      name: doggie</span><br><span class="line">        &#x27;400&#x27;:</span><br><span class="line">          description: 请求失败</span><br><span class="line">        patch:                                                                    # patch 请求方法</span><br><span class="line">            tags:</span><br><span class="line">        - 宠物</span><br><span class="line">      summary: 单独更新宠物属性</span><br><span class="line">      operationId: patch-pet</span><br><span class="line">      description: 单独更新宠物属性</span><br><span class="line">      deprecated: true                                         # 接口是否已废弃</span><br><span class="line">      requestBody:                                                 # post / put / patch 等请求需要传输 body 时，请指定 requestBody，Path / Query / Header 请写在 parameters 中</span><br><span class="line">        content:</span><br><span class="line">          application/x-www-form-urlencoded:    # 媒体类型 Media Type</span><br><span class="line">            schema:                                                            # 参数结构与上述 parameters 中相同</span><br><span class="line">              type: object</span><br><span class="line">              properties:</span><br><span class="line">                categoryId:</span><br><span class="line">                  type: integer</span><br><span class="line">                  description: 分类 ID</span><br><span class="line">                status:</span><br><span class="line">                  type: string</span><br><span class="line">                  description: 状态</span><br><span class="line">                  enum:</span><br><span class="line">                    - available</span><br><span class="line">                    - pending</span><br><span class="line">                    - sold</span><br><span class="line">                photoUrls:</span><br><span class="line">                  type: array</span><br><span class="line">                  description: 照片地址列表</span><br><span class="line">                  items:</span><br><span class="line">                    type: string</span><br><span class="line">                    description: 照片地址</span><br><span class="line">                name:</span><br><span class="line">                  type: string</span><br><span class="line">                  description: 宠物名称</span><br><span class="line">                isHealthy:</span><br><span class="line">                  type: boolean</span><br><span class="line">                  description: 是否健康</span><br><span class="line">                tagIds:</span><br><span class="line">                  type: string</span><br><span class="line">                  description: 标签 ID 数组</span><br><span class="line">            examples:                                                            # 请求 Body 范例，将在 CODING API 文档右侧范例区展示</span><br><span class="line">              更新范例:                                                                # 范例名称</span><br><span class="line">                value:                                                                # 范例内容，以下将以 JSON 形式展示</span><br><span class="line">                  status: sold</span><br><span class="line">      responses:</span><br><span class="line">        &#x27;200&#x27;:</span><br><span class="line">          description: 更新成功</span><br><span class="line">          content:</span><br><span class="line">            application/json:</span><br><span class="line">              schema:</span><br><span class="line">                $ref: &#x27;#/components/schemas/Pet&#x27;</span><br><span class="line">components:                                                            # 通用组件，可定义复用的实体、响应、请求以及授权信息等</span><br><span class="line">  schemas:                                                                # 实体信息</span><br><span class="line">    Pet:                                                                        # 实体 key</span><br><span class="line">      title: Pet                                                            # 名称</span><br><span class="line">      type: object                                                        # 实体数据结构类型</span><br><span class="line">      description: 宠物实体信息                                    # 描述信息</span><br><span class="line">      properties:                                                            # 实体参数，可多条</span><br><span class="line">        id:</span><br><span class="line">          type: integer</span><br><span class="line">          format: int64</span><br><span class="line">          description: ID</span><br><span class="line">        name:</span><br><span class="line">          type: string</span><br><span class="line">          example: doggie</span><br><span class="line">          description: 名称</span><br><span class="line">  securitySchemes:                                                # API 所使用的授权方式，可多条，CODING 会展示所有授权方式</span><br><span class="line">    petstore_auth:                                                    # 授权方式 Key</span><br><span class="line">      type: oauth2                                                        # 授权类型，可为：apiKey、http、oauth2、openIdConnect</span><br><span class="line">      flows:                                                                    # OAuth2 所需要的流程信息</span><br><span class="line">        authorizationCode:                                            # OAuth2 授权类型，可为：implicit、password、clientCredentials、authorizationCode</span><br><span class="line">          authorizationUrl: &#x27;https://petstore.com/oauth/authorize&#x27;    # 跳转授权地址</span><br><span class="line">          tokenUrl: &#x27;https://petstore.com/oauth/token?grant_type=authorization_code&#x27;    # 获取 token 地址</span><br><span class="line">          scopes:                                                # 所有 scope 列表</span><br><span class="line">            &#x27;write:pets&#x27;: 修改宠物信息权限</span><br><span class="line">            &#x27;read:pets&#x27;: 查看宠物信息权限</span><br><span class="line">          refreshUrl: &#x27;https://petstore.com/oauth/token?grant_type=refresh_token&#x27;        # 刷新 token 地址</span><br><span class="line">      description: OAuth2 授权模式                    # 描述信息</span><br></pre></td></tr></table></figure><p>更详细的规范可参考：</p><ul><li><a href="https://openapi-map.apihandyman.io/">OpenAPI Map</a></li><li><a href="https://swagger.io/docs/specification/about/">OpenAPI Specification</a></li></ul><h4 id="Code-First"><a href="#Code-First" class="headerlink" title="Code-First"></a>Code-First</h4><p>通过自动生成 OpenAPI 描述文件，我们可以很简单的接入 CODING API 文档的自动化流程，方便开发同学提交代码自动发布 API 文档。</p><blockquote><p>此处我们以 Java 语言的 <a href="https://github.com/springfox/springfox">Springfox</a> 为例<br>其他语言可参考以下方案：</p><ul><li>PHP：<a href="https://github.com/zircote/swagger-php">Swagger PHP</a></li><li>Go：<a href="https://github.com/go-swagger/go-swagger/">Go Swagger</a></li><li>Python Flask：<a href="https://github.com/noirbizarre/flask-restplus">Flask RestPlus</a></li><li>NodeJS Express：<a href="https://www.npmjs.com/package/swagger-node-express">Swagger Node Express</a></li><li><a href="https://swagger.io/tools/open-source/open-source-integrations">点击查看</a></li></ul></blockquote><p>首先我们新建一个 SpringBoot 项目，添加 springfox 依赖：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile (&#x27;io.springfox:springfox-swagger2:2.9.2&#x27;) &#123;</span><br><span class="line">        exclude(module: &#x27;io.swagger:swagger-annotations&#x27;)</span><br><span class="line">        exclude(module: &#x27;io.swagger:swagger-models&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">    compile(&quot;io.swagger:swagger-annotations:1.6.0&quot;)</span><br><span class="line">    compile(&quot;io.swagger:swagger-models:1.6.0&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>上面 swagger-annotations 指定新版本操作，由于在非 String 的请求参数（如 Integer） @RequestParam 中指定 defaultValue 时，springfox 2.9.2 依赖的 swagger 包较旧，导致编译时报类型转换错误的问题，在新版已解决。</p></blockquote><p>然后我们在 Application 中针对 Springfox 进行初始化配置操作，并定义 Swagger API 文档的全局描述信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">public Docket docket(ServletContext servletContext) &#123;</span><br><span class="line">    ApiSelectorBuilder builder = new Docket(DocumentationType.SWAGGER_2)    // 定义 Swagger 2.0 规范</span><br><span class="line">            .apiInfo(apiInfo())                                                    // 定义全局描述信息</span><br><span class="line">            .tags(new Tag(&quot;宠物&quot;, &quot;所有关于宠物的内容&quot;),        // 定义 tag，对应 CODING API 文档的菜单 API 分组</span><br><span class="line">                    new Tag(&quot;会话&quot;, &quot;关于用户的注册、登录和登出&quot;))</span><br><span class="line">            .host(&quot;petstore.com&quot;)                                                // 定义 API 基础域名</span><br><span class="line">            .pathProvider(new RelativePathProvider(servletContext) &#123;    // 定义 API 基础路径前缀，与 host 配合组成 petstore.com/api/v1</span><br><span class="line">                @Override</span><br><span class="line">                public String getApplicationBasePath() &#123;</span><br><span class="line">                    return &quot;/api/v1&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .select();</span><br><span class="line"> </span><br><span class="line">    builder.apis(RequestHandlerSelectors.withClassAnnotation(RestController.class));    // 指定只扫描 @RestController 注解的 Controller 的 API</span><br><span class="line"> </span><br><span class="line">    return builder.build()</span><br><span class="line">            .ignoredParameterTypes(RequestAttribute.class)    // 排除扫描 @RequestAttribute 注解</span><br><span class="line">            .ignoredParameterTypes(Errors.class);                        // 排除扫描 @Errors 注解</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">private ApiInfo apiInfo() &#123;</span><br><span class="line">    return new ApiInfoBuilder()</span><br><span class="line">            .title(&quot;宠物商店 API 文档&quot;)                        // 定义文档标题</span><br><span class="line">            .description(&quot;这是一篇关于宠物商店的 DEMO API 文档，仅做参考。&quot;)    // 定义文档描述</span><br><span class="line">            .termsOfServiceUrl(&quot;http://swagger.io/terms/&quot;)                        // 定义服务条款</span><br><span class="line">            .contact(new Contact(&quot;CODING&quot;, &quot;https://coding.net&quot;, &quot;coding_support@tencent.com&quot;))    // 定义联系信息</span><br><span class="line">            .license(&quot;Apache 2.0&quot;)        // 定义 License</span><br><span class="line">            .licenseUrl(&quot;http://www.apache.org/licenses/LICENSE-2.0.html&quot;)        // 定义 License URL</span><br><span class="line">            .version(&quot;1.0.0&quot;)                    // 定义 API 版本</span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来，我们可以开始设计 API 规则，以 PetController 为例，即 <code>/pets</code> 路由：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Api(tags = &#123;&quot;宠物&quot;&#125;)</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/pets&quot;)</span><br><span class="line">public class PetController &#123;</span><br><span class="line"> </span><br><span class="line">    @ApiOperation(value = &quot;宠物列表&quot;, notes = &quot;列出所有宠物信息&quot;)</span><br><span class="line">    @GetMapping(&quot;&quot;)</span><br><span class="line">    public ResponseEntity&gt; all(@ApiParam(value=&quot;限制每页返回数量（最大限制：100）&quot;) @RequestParam(required = false, defaultValue = &quot;20&quot;) Integer pagesize,</span><br><span class="line">                                         @ApiParam(value=&quot;页码&quot;) @RequestParam(required = false, defaultValue = &quot;1&quot;) Integer page) &#123;</span><br><span class="line">        return ResponseEntity.ok(new ArrayList&lt;&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @ApiOperation(value = &quot;宠物详情&quot;, notes = &quot;获取指定 ID 的宠物详情&quot;)</span><br><span class="line">    @GetMapping(&quot;&#123;petId&#125;&quot;)</span><br><span class="line">    public ResponseEntity detail(@ApiParam(value=&quot;宠物 ID&quot;, required = true) @PathVariable Integer petId,</span><br><span class="line">                                      @ApiParam(value = &quot;媒体类型&quot;, required = true, allowableValues = &quot;application/json,application/xml&quot;, defaultValue = &quot;application/json&quot;) @RequestHeader String Accept) &#123;</span><br><span class="line">        return ResponseEntity.ok(null);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里我们定义了两个路由，分别为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /pets 宠物列表</span><br></pre></td></tr></table></figure><ul><li><p>Query 请求参数</p><p>-<strong>pagesize</strong> int 选填</p><p>限制每页返回数量（最大限制：100）</p><p>默认值 20</p><p>-<strong>page</strong> int 选填</p><p>页码</p><p>默认值 1</p></li><li><p>响应结构</p><p>-Pet 实体数组 array</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /pets/&#123;petId&#125; 宠物详情</span><br></pre></td></tr></table></figure><ul><li><p>Header 参数</p><p>-<strong>Accept</strong> string</p><p>可选值 <code>application/json</code> <code>application/xml</code>，默认值 <code>application/json</code>。</p><p>媒体类型</p></li><li><p>路由参数</p><p>-<strong>petId</strong> int</p><p>宠物 ID</p></li><li><p>响应结构</p><p>-Pet 实体 object</p></li></ul><p>至此，我们完成了上述两个 API 的设计，无需提前实现代码逻辑，我们即可获得 Swagger 2.0 的描述文件，步骤如下：</p><blockquote><p>该范例使用 Jetty 作为 Server</p></blockquote><ol><li><p>启动应用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew bootRun</span><br></pre></td></tr></table></figure></li><li><p>打开浏览器访问</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">   </span><br></pre></td></tr></table></figure><p>其中 {port} 为配置的服务 WEB 端口</p><p>返回的内容即为 Swagger 2.0 描述文件，如下图所示：</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223153216.png"><img src="https://help-assets.codehub.cn/enterprise/20191223153216.png" alt="img"></a></p></li></ol><p>右键选择「存储为」保存至本地，可命名为 <code>xxx.json</code>，将该 Swagger 2.0 描述文件导入至 CODING 即可生成 API 文档，如下图所示：</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223153228.png"><img src="https://help-assets.codehub.cn/enterprise/20191223153228.png" alt="img"></a></p><p>生成的 API 文档效果如下图所示：</p><p><a href="https://help-assets.codehub.cn/enterprise/20191223153241.png"><img src="https://help-assets.codehub.cn/enterprise/20191223153241.png" alt="img"></a></p><p><a href="https://demo-api.coding.net/public/springfox-demo/springfox-demo/git/files">点击查看</a>该范例的源代码。</p><p>更多 Springfox 的用法可参考<a href="http://springfox.github.io/springfox">官方文档</a></p>]]></content>
      
      
      <categories>
          
          <category> API文档管理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenAPI/Swagger </tag>
            
            <tag> API文档管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>电子书导航</title>
      <link href="/2023/10/08/Z-library/"/>
      <url>/2023/10/08/Z-library/</url>
      
        <content type="html"><![CDATA[<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><table><thead><tr><th align="left">S16-BT 导航</th><th align="left"><a href="https://www.runningcheese.cn/s17">S17-音乐导航</a></th><th align="left"><a href="https://www.runningcheese.cn/s18">S18-影视导航</a></th><th align="left"><a href="https://www.runningcheese.cn/s19">S19-网盘导航</a></th><th align="left"><a href="https://www.runningcheese.cn/s20">S20-软件导航</a></th></tr></thead><tbody><tr><td align="left"><a href="https://www.runningcheese.cn/s21">S21-Zlibrary</a></td><td align="left"><a href="https://www.runningcheese.cn/s22">S22-电子书导航</a></td><td align="left">S23-学术导航</td><td align="left">S24-考研导航</td><td align="left">S25-学习导航</td></tr><tr><td align="left">S26-生活导航</td><td align="left">S27-游戏导航</td><td align="left">S28-工具导航</td><td align="left">S29-网站导航</td><td align="left">S30-资源导航</td></tr></tbody></table><p>2009 年初，Z-library 成立。</p><p>2022 年底，Z-library 被封，2023 年初，Z-library 宣布回归。</p><p>关于 <strong>Z-library</strong> 的历史，大多就发生在<strong>这前后的两个月里</strong>，而本文，正是要带你<strong>厘清</strong>这两个月里发生的事情。</p><p>看懂了，你将拥有一座容量 <strong>31T</strong>，且<strong>永远不会下线</strong>的电子图书馆。</p><h2 id="一、Z-lib-官方项目"><a href="#一、Z-lib-官方项目" class="headerlink" title="一、Z-lib 官方项目"></a><strong>一、Z-lib 官方项目</strong></h2><p>我们先讲讲 Z-library 的官方渠道，毕竟它已经正式回归了。</p><h3 id="1-1、Z-lib-主页"><a href="#1-1、Z-lib-主页" class="headerlink" title="1.1、Z-lib 主页"></a>1.1、Z-lib 主页</h3><p>2023 年初，Z-library 宣布回归，但换了一种方式。</p><p>新版 Z-library 不再有统一的“<strong>主页</strong>”，取而代之的是“<strong>登陆页</strong>”，打开即可注册，但需要“<strong>魔法</strong>”访问。</p><p>地址 1：<a href="https://singlelogin.re/">https://singlelogin.re</a> 地址 2：<a href="https://singlelogin.site/">https://singlelogin.site</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax2.sinaimg.cn/large/7a6a15d5gy1hb6dzayzs9j228c1ecb2c.jpg" alt="S21_Zlib"></p><p>注册后，系统会自动分配两个“<strong>专属域名</strong>”给你，将它们保存起来，然后就可以用<strong>注册时的帐号密码</strong>来登陆了。</p><p>注册默认是初级用户，<strong>1 天可下载 10 次</strong>，通过捐赠则可以成为高级用户。</p><p><img src="https://image.baidu.com/search/down?url=https://tvax2.sinaimg.cn/large/7a6a15d5gy1hb6dzbwvlqj228c1ecket.jpg" alt="S21_Zlib"></p><h3 id="1-2、Z-lib-扩展"><a href="#1-2、Z-lib-扩展" class="headerlink" title="1.2、Z-lib 扩展"></a>1.2、Z-lib 扩展</h3><p>Z-library 最近又整了个新活。</p><p>Z-library 推出了<strong>浏览器扩展</strong>，支持 Firefox 和 Chrome，而这个扩展的作用，居然是用来“<strong>防止失联</strong>”的，</p><p>只需要点击扩展图标，它就会分配一个你当前网络可以访问的链接，而且无需魔法就可以直接访问。</p><p>比如我的是 zlibrary-china.se，也就是说，你再也不怕打不开 Z-lib 了。</p><p>我只能说，Z-library 花活挺多的。</p><p><strong>扩展下载：</strong></p><p>Firefox：<a href="https://zh.go-to-zlibrary.se/soft/mozilla-addon-latest.xpi">https://zh.go-to-zlibrary.se/soft/mozilla-addon-latest.xpi</a></p><p>Chrome：<a href="https://t.cn/A60EmvZL">https://t.cn/A60EmvZL</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hgqrz7qw47j228c1ec1au.jpg" alt="7a6a15d5gy1hgqrz7qw47j228c1ec1au"></p><h3 id="1-3、Z-lib-客户端"><a href="#1-3、Z-lib-客户端" class="headerlink" title="1.3、Z-lib 客户端"></a>1.3、Z-lib 客户端</h3><p>Z-library 官方还推出了 <strong>Windows、macOS、Linux</strong> 的客户端，并且<strong>无需魔法</strong>即可直接访问。</p><p>这可以说是一个重大利好，以后再也不怕网址会失效了。</p><p>地址：<a href="https://zh.go-to-zlibrary.se/">https://zh.go-to-zlibrary.se</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hfewqrxb2pj228c1ecnhe.jpg" alt="S21_桌面客户端"></p><h3 id="1-4、Z-lib-手机端"><a href="#1-4、Z-lib-手机端" class="headerlink" title="1.4、Z-lib 手机端"></a>1.4、Z-lib 手机端</h3><p>Z-library 官方的安卓 APP 一直可用，目前最新版本为 <strong>1.10.1</strong>，需要魔法。（仅支持安卓）</p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hfexj7ximvj22to23cqv6.jpg" alt="S21_Android"></p><h3 id="1-5、Z-lib-电报机器人"><a href="#1-5、Z-lib-电报机器人" class="headerlink" title="1.5、Z-lib 电报机器人"></a>1.5、Z-lib 电报机器人</h3><p>Z-library 的官方电报机器人分两种：一种是 <strong>Premium bot</strong>，一种是 <strong>Basic bot</strong>。（需要魔法）</p><p><strong>Premium bot：</strong></p><p>Premium bot 捐助过的用户才会拥有，绑定即可使用，地址： <a href="https://t.me/zlibrary2bot">https://t.me/zlibrary2bot</a></p><p>在窗口里输入<strong>书名、作者名、ISBN、ASIN</strong> 即可返回下载地址。</p><p>每天最多可以下载 <strong>60</strong> 次。</p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzcoo1dj22661boqv5.jpg" alt="S21_Zlibbot"></p><p><strong>Basic bot：</strong></p><p>Basic bot 则是由于 Z-library 频繁被封，所以推出了<strong>个人专属 bot</strong>，和网站主页一样，现在也可以人手一个。</p><p>1、点击 Z-library 页面右下角的「Telegram bot」。</p><p>2、点击 <a href="https://t.me/BotFather">https://t.me/BotFather</a> 进入 TG。</p><p>3、在窗口输入 &#x2F;newbot。</p><p>4、在窗口输入 bot 名称。（可任意输入）</p><p>5、在窗口输入 bot 用户名。（不可重复，且必须以 bot 结尾）</p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzdjk29j22661bou0x.jpg" alt="S21_Zlibbot_New"></p><p>6、保存生成的 <strong>Token</strong>，并粘贴到之前的网页里即可完成绑定。</p><p><img src="https://image.baidu.com/search/down?url=https://tvax2.sinaimg.cn/large/7a6a15d5gy1hb6dzefwcij228c1ece81.jpg" alt="S21_Zlibbot_New2"></p><p><strong>桌面端 TG ：</strong></p><p>桌面版 Telegram 如果因收不到验证码而无法登录，可以使用 <strong>Telegram Lite</strong> 版本。</p><p><strong>安卓端 TG：</strong></p><p>安卓版 TG 还可以使用第三方应用 <a href="https://github.com/NekoX-Dev/NekoX">NekoX</a>，自带代理，国内网络也可以直接访问。</p><h3 id="1-6、Z-lib-TOR-浏览器"><a href="#1-6、Z-lib-TOR-浏览器" class="headerlink" title="1.6、Z-lib TOR 浏览器"></a>1.6、<strong>Z-lib TOR 浏览器</strong></h3><p>Tor 浏览器，对于普通用户来说比较难理解。</p><p>大概的意思，就是先下载 <a href="https://www.torproject.org/zh-CN/download">TOR 浏览器</a>（需魔法），然后打开下面的任意一个网页地址，即可访问。</p><p>地址1：<a href="http://zh.loginzlib2vrak5zzpcocc3ouizykn6k5qecgj2tzlnab5wcbqhembyd.onion/">http://loginzlib2vrak5zzpcocc3ouizykn6k5qecgj2tzlnab5wcbqhembyd.onion</a></p><p>地址2：<a href="http://zlibrary24tuxziyiyfr7zd46ytefdqbqd2axkmxm4o5374ptpc52fad.onion/">http://zlibrary24tuxziyiyfr7zd46ytefdqbqd2axkmxm4o5374ptpc52fad.onion</a></p><p>得益于 Z-library 的回归，如果实在搞不懂，可直接略过。</p><h2 id="二、Z-lib-民间项目"><a href="#二、Z-lib-民间项目" class="headerlink" title="二、Z-lib 民间项目"></a>二、Z-lib 民间项目</h2><p>下面我们来重点讲一下，在 Z-library 被封的这段时间，互联网上都发生了什么。</p><h3 id="2-1、Anna’s-Archive"><a href="#2-1、Anna’s-Archive" class="headerlink" title="2.1、Anna’s Archive"></a>2.1、Anna’s Archive</h3><p>在 Z-library 关站之前，有一个叫 <strong>Anna</strong> 的网友爬取了 Z-library 上的所有资源。</p><p>原因是 Z-library 起源于 <strong>Libgen</strong>，而她认为 Z-library <strong>后续新增内容却不回流</strong> Libgen 的做法，不利于知识传播。</p><p>于是，在 <a href="http://pilimi.org/">Pirate Library Mirror</a> 上，她放出了采集的 <strong>31T</strong> 电子书资源。</p><p>之后， 她又把资源放到了去中心化的 <strong>IPFS</strong> 网络上，还做了个查询网站，这就网站就是“<strong>安娜的档案</strong>”。</p><p>地址：<a href="https://zh.annas-archive.org/">https://zh.annas-archive.org</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzgklgtj228c1ec7nd.jpg" alt="S21_Anna"></p><p>网站不但支持中文搜索，而且提供了三种下载方式，包括：<strong>Libgen</strong> 下载、 <strong>IPFS</strong> 下载、<strong>TOR</strong> 浏览器下载。</p><p>选项里的“<strong>Libgen</strong>”和“<strong>TOR 浏览器</strong>”下载的方法可以忽略。</p><p>用“<strong>IPFS 网关</strong>”的下载方法就可以。</p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzh6qasj228c1ec7up.jpg" alt="S21_Anna2"></p><h3 id="2-2、Book-Searcher"><a href="#2-2、Book-Searcher" class="headerlink" title="2.2、Book Searcher"></a>2.2、Book Searcher</h3><p>在此这后，国内也开始有网站效仿 <strong>Anna’s Archive</strong>，其中有两个网站比较知名。</p><p>地址 1：<a href="https://bk.hallowlib.org/">https://bk.hallowlib.org</a></p><p>地址 2：<a href="https://clibrary.cn/">https://clibrary.cn</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hfewqui25yj228c1ech8y.jpg" alt="S21_BookSearcher"></p><p>但这两个网站，常常会因为访问人数过多而超载。</p><p>于是，又有网友将 <strong>Anna’s Archive</strong> 数据库做成索引，然后搜索获得 <strong>IPFS CID</strong>，最后通过 <strong>IPFS 网关</strong>下载。</p><p>这个项目一开始叫做 <strong>zLib Searcher</strong>，后来又改名为了 <strong>Book Searcher</strong>。</p><p>地址：<a href="https://github.com/book-searcher-org/book-searcher">https://github.com/book-searcher-org/book-searcher</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzjdwfbj228c1ec1h2.jpg" alt="S21_BookSearcher3"></p><p>而且，由于是<strong>开源项目</strong>，又有多人在此基础上搭建了各种<strong>搜索网站</strong>，不用登录就可以使用，也还没下载限制。</p><p><strong>搜索网站：</strong></p><p><a href="https://zbook.lol/">https://zbook.lol</a></p><p><a href="https://zlib.awesc.com/">https://zlib.awesc.com</a></p><p><a href="https://zlibsearch.1kbtool.com/">https://zlibsearch.1kbtool.com</a></p><p><a href="https://zlib.knat.network/">https://zlib.knat.network</a>（无网关）</p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzjvueej228c1eckbi.jpg" alt="S21_BookSearcher2"></p><p>不仅如此，<strong>Book Searcher</strong> 还被做成了各种项目。</p><p>比如由吾爱用户开发的安卓应用 <strong>XLibrary</strong>，APP 在<strong>国内网络</strong>里就能正常使用，而且内置了<strong>多条线路</strong>。</p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzl7lqwj22to23c4qq.jpg" alt="S21_BookSearcher4"></p><p>换句话说，几乎所有标记 <strong>Zlib Searcher、Book Searcher</strong> 的应用，还有使用 <strong>IPFS</strong> 下载的应用。</p><p>都是来自 <strong>Anna’s Archive</strong> 和 <strong>Book Searcher</strong> 的开源。</p><h3 id="2-3、Ylibrary"><a href="#2-3、Ylibrary" class="headerlink" title="2.3、Ylibrary"></a>2.3、Ylibrary</h3><p>此外，国内的 Zhelper 团队还整了一个大项目。</p><p>就是 Z-library 毕竟是国外项目，对于中文书籍的收集，并没有做到很好的覆盖。</p><p>于是，Zhelper 在 <strong>Book Searcher</strong> 项目的基础上，又增加了 <strong>Superlib</strong> 超星书库的资源，中文书籍数量大为增加。</p><p>然后还把书库命名为了 <strong>Ylibrary</strong>。</p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzlxsu3j228c1eck4o.jpg" alt="S21_ZhelperSearch"></p><p><strong>Ylibrary</strong> 采用了 <strong>API</strong> 接口的模式，并集成在了网站“<strong>易书书籍检索</strong>”上，算得上是目前<strong>最好的中文电子书搜索引擎</strong>。</p><p>地址：<a href="https://search.yibook.org/">https://search.yibook.org</a></p><h2 id="三、Z-lib-下载方式"><a href="#三、Z-lib-下载方式" class="headerlink" title="三、Z-lib 下载方式"></a>三、Z-lib 下载方式</h2><p>说完下载网站，这里还有必要说一下下载方式，包括 <strong>IPFS 下载</strong>和<strong>秒传链接下载</strong>。</p><h3 id="3-1、IPFS-下载"><a href="#3-1、IPFS-下载" class="headerlink" title="3.1、IPFS 下载"></a>3.1、IPFS 下载</h3><p>简单的说，<strong>IPFS</strong> 是一个去中心化的网络文件存储系统，也就是 <strong>P2P 系统</strong>。</p><p>有了它，Z-library 就不再需要有<strong>中心服务器</strong>，因此可以避免<strong>再次被封站</strong>，文件可以永久地保存在网络上。</p><p>只要好配置 <strong>IPFS 网关</strong>就可以下载，当然，网站一般都会直接配置好的。</p><p><strong>常见 IPFS 网关：</strong></p><p><a href="https://dweb.link/">https://dweb.link</a></p><p><a href="https://gateway.pinata.cloud/">https://gateway.pinata.cloud</a></p><p><a href="https://ipfs.best-practice.se/">https://ipfs.best-practice.se</a></p><p>而如果那天用不了，那你还可以用下面的 <strong>IPFS 网关检查工具</strong>来替代，延迟越低的就是越好的那个。</p><p><strong>网关检查工具：</strong></p><p><a href="https://ipfs.github.io/public-gateway-checker">https://ipfs.github.io/public-gateway-checker</a></p><p><a href="https://ipfs-checker.1kbtool.com/">https://ipfs-checker.1kbtool.com</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hb6dzhtakpj228c1echcb.jpg" alt="S21_Anna3"></p><h3 id="3-2、秒传链接"><a href="#3-2、秒传链接" class="headerlink" title="3.2、秒传链接"></a>3.2、秒传链接</h3><p>什么是秒传链接？</p><p>当你用网盘上传文件时，有时候文件一秒都不用，然后就上传成功了。</p><p>这是因为你上传的文件，在服务器里已经有了，网盘只是“<strong>复制</strong>”了一份，所以文件就“<strong>秒传</strong>”上去了。</p><p>也正是因为这个特性，网友发明了“<strong>秒传链接</strong>”，它可以说是“<strong>网络冲浪老司机</strong>”必备的一个技能。</p><p><img src="https://image.baidu.com/search/down?url=https://tva1.sinaimg.cn/large/008vxvgGgy1h85saovoilj31al0u0wh3.jpg" alt="i74_秒传链接"></p><p>目前，秒传链接有两种下载方法，一种是用<strong>油猴脚本</strong>，一种是用<strong>帐号 Token</strong> 转存的方法。</p><p>使用方法也很简单，几乎一看就会。</p><p><strong>油猴脚本：</strong></p><p>地址1：<a href="https://greasyfork.org/zh-CN/scripts/468633">https://greasyfork.org/zh-CN/scripts/468633</a> （推荐）</p><p>地址2：<a href="https://greasyfork.org/zh-CN/scripts/427628">https://greasyfork.org/zh-CN/scripts/427628</a></p><p><strong>帐号 Token：</strong></p><p>地址 1：<a href="https://rapidupload.1kbtool.com/">https://rapidupload.1kbtool.com</a></p><p>地址 2：<a href="https://rulite.1kbtool.com/">https://rulite.1kbtool.com</a></p><p>PS：如果遇到下载的电子书格式为 PDG，又或者加密码了，公众号后台回复 <strong>S21</strong> 即可获取对应的转换工具。</p><h2 id="四、Z-lib-项目选择"><a href="#四、Z-lib-项目选择" class="headerlink" title="四、Z-lib 项目选择"></a>四、Z-lib 项目选择</h2><p>介绍了这么多 Zlibrary 的项目，有官方的，有民间的，要如何选择呢？</p><h3 id="4-1、首选-Z-library"><a href="#4-1、首选-Z-library" class="headerlink" title="4.1、首选 Z-library"></a>4.1、首选 Z-library</h3><p>Z-library 的优势在于书库集全，各种语言的都有，是目<strong>前最大的数字图书馆</strong>，而且还在<strong>持续增长中</strong>。</p><p>并且，Z-library 官方网站还有<strong>收藏夹，评论、书单推荐</strong>等诸多人性化功能。</p><p>我们没有理由不优先选择 <strong>Z-library</strong> 官方网站。</p><h3 id="4-2、次选-Book-Searcher"><a href="#4-2、次选-Book-Searcher" class="headerlink" title="4.2、次选 Book Searcher"></a>4.2、次选 <strong>Book Searcher</strong></h3><p>由于 <strong>Anna’s Archive</strong> 项目的诞生。</p><p>Z-library 2022 年 12 月之前的书库就此开源，再加上 <strong>Book Searcher</strong> 的索引，没有下载限制。</p><p>现在，你已经拥有了一座容量 <strong>31T</strong>，而且永远不会下线的电子图书馆。</p><p>应该说，你再也不会为找电子书发愁了。</p><h3 id="4-3、冷门-Ylibrary"><a href="#4-3、冷门-Ylibrary" class="headerlink" title="4.3、冷门 Ylibrary"></a>4.3、冷门 Ylibrary</h3><p>如果你需要查找的是一些<strong>冷门中文书籍</strong>，使用 <strong>Ylibrary（</strong>Z-library 书库 + Superlib 超星书库）搜索。</p><p>成功的概率将大大增加，它算得上是目前<strong>最好的中文电子书搜索引擎</strong>。</p><h3 id="4-4、末选-Zhelper"><a href="#4-4、末选-Zhelper" class="headerlink" title="4.4、末选 Zhelper"></a>4.4、末选 Zhelper</h3><p>如果后续出现失效的情况，可以查看“<strong>zhelper search 配置小工具</strong>”，这是国内团队 Zhelper 维护的网址。</p><p>应该说，现在能这么方便的下载电子书，他们的功能很大。</p><p>地址：<a href="https://tool.yibook.org/">https://tool.yibook.org</a></p>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电子书导航 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git 笔记</title>
      <link href="/2023/10/02/git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
      <url>/2023/10/02/git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="账户配置"><a href="#账户配置" class="headerlink" title="账户配置"></a>账户配置</h2><ol><li>配置全局账户，对所有 Git 仓库有效</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&#x27;Your Name&#x27;</span></span><br><span class="line">git config --global user.email <span class="string">&#x27;Your Email&#x27;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>配置局部账户，只对当前 Git 仓库有效</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="built_in">local</span> user.name <span class="string">&#x27;Your Name&#x27;</span></span><br><span class="line">git config --<span class="built_in">local</span> user.email <span class="string">&#x27;Your Email&#x27;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>查看全局配置</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global --list</span><br></pre></td></tr></table></figure><ol start="4"><li>查看局部配置</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="built_in">local</span> --list</span><br></pre></td></tr></table></figure><h2 id="生成ssh-密钥"><a href="#生成ssh-密钥" class="headerlink" title="生成ssh 密钥"></a>生成ssh 密钥</h2><p>连接到github仓库，公钥文件存放在C:&#x2F;用户文件夹&#x2F;.ssh&#x2F;id_rsa.pub</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;你的邮箱&quot;</span></span><br><span class="line">ssh -T git@github.com   //测试连接命令</span><br></pre></td></tr></table></figure><hr><h2 id="上传操作"><a href="#上传操作" class="headerlink" title="上传操作"></a>上传操作</h2><p>1.找到想要上传的文件夹，进入并点击 git sh here</p><p>然后输入 <code>git init</code></p><p>然后输入 <code>git remote add origin https://gitee.com/[码云的用户名]/[仓库路径].git</code><br>这里建议直接复制</p><p>然后 <code>git add ./</code> .&#x2F;表示当前文件夹内所有文件</p><p>然后 <code>git commit -m &quot;上传的信息&quot;</code></p><p>然后 <code>git push origin master</code> 查看gitee上发现文件上传成功</p><p>上面是第一次创建远程仓库的情况</p><p>如果有新的文件，从<code>git add [文件名]</code> 处开始即可。</p><hr><h2 id="git-push-error-failed-to-push-some-refs-to-异常处理"><a href="#git-push-error-failed-to-push-some-refs-to-异常处理" class="headerlink" title="git push error: failed to push some refs to 异常处理"></a>git push error: failed to push some refs to 异常处理</h2><h3 id="一、异常错误"><a href="#一、异常错误" class="headerlink" title="一、异常错误"></a>一、异常错误</h3><ul><li>使用Github时，<code>git push</code>命令出现 <code>error: failed to push some refs to &#39;git@github.com:xxxxx&#39;</code>错误</li></ul><h3 id="二、原因"><a href="#二、原因" class="headerlink" title="二、原因"></a>二、原因</h3><ul><li>远端仓库更新数据未同步到本地</li></ul><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231002092020.png"></p><h3 id="三、解决方法"><a href="#三、解决方法" class="headerlink" title="三、解决方法"></a>三、解决方法</h3><ul><li><p>先将远程代码库中文件pull到本地，进行代码合并，使用<code>git pull --rebase origin master</code></p></li><li><p>再push新的代码到Github代码库中，进行上传<code>git push -u origin master</code></p></li></ul><hr><h2 id="rejected-master-＞-master-non-fast-forward-异常处理"><a href="#rejected-master-＞-master-non-fast-forward-异常处理" class="headerlink" title="! [rejected] master -＞ master (non-fast-forward) 异常处理"></a>! [rejected] master -＞ master (non-fast-forward) 异常处理</h2><p>non-fast-forward：译为‘不能快速前进’，远程仓库更新了，你没有及时同步到本地，提交的时候添加了新的内容，提交的时候，然后检测到远程和本地不一样。为了安全起见，报了这个错误。</p><p>可以先合并之前的历史，在进行提交</p><ol><li>先把git的东西fetch到本地，需要合并就就合并，然后再push</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin master</span><br><span class="line"> </span><br><span class="line">git merge origin FETCH_HEAD </span><br></pre></td></tr></table></figure><p>2.<code>git pull --rebase origin master</code></p><hr><h2 id="Incorrect-username-or-password-access-token-异常处理"><a href="#Incorrect-username-or-password-access-token-异常处理" class="headerlink" title="Incorrect username or password (access token)  异常处理"></a>Incorrect username or password (access token)  异常处理</h2><p>由于我更改了 git 账号密码，导致我在push的时候出现<code>Incorrect username or password (access token)</code>。</p><p>然后网上查解决方式，有通过<a href="https://blog.csdn.net/qq_40428678/article/details/84074488">修改本地的 Windows 凭据</a> 所在的密码，但我发现了我的本地Windows凭据没有gitee。。。。</p><p>然后我发现了另一种解决方式，通过<a href="https://so.csdn.net/so/search?q=git%E5%91%BD%E4%BB%A4&spm=1001.2101.3001.7020">git命令</a>的方式解决 。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --system --<span class="built_in">unset</span> credential.helper</span><br></pre></td></tr></table></figure><p>先执行以上命令后，再重新执行push命令就会提示重新输入账号和密码，然后正确输入即可。</p>]]></content>
      
      
      <categories>
          
          <category> Git仓库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>软件导航</title>
      <link href="/2023/09/27/%E8%BD%AF%E4%BB%B6%E5%AF%BC%E8%88%AA/"/>
      <url>/2023/09/27/%E8%BD%AF%E4%BB%B6%E5%AF%BC%E8%88%AA/</url>
      
        <content type="html"><![CDATA[<h1 id="软件导航"><a href="#软件导航" class="headerlink" title="软件导航"></a>软件导航</h1><hr><h2 id="一、软件资讯"><a href="#一、软件资讯" class="headerlink" title="一、软件资讯"></a>一、软件资讯</h2><table><thead><tr><th align="left">▼ <strong>国内网站</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://github.com/">GitHub</a></td><td align="left">全球最大开源托管平台，开发者们“<strong>殿堂般</strong>”。</td></tr><tr><td align="left">🌐 <a href="https://www.52pojie.cn/">52Pojie</a></td><td align="left">GitHub 和 52Pojie 合称“<strong>北乔峰南慕容</strong>”，国内活跃度最高的软件交流社区。</td></tr><tr><td align="left">🌐 <a href="https://www.appinn.com/">小众软件</a></td><td align="left">老牌软件分享网站，介绍各种新鲜软件，还新开了一个“<a href="https://meta.appinn.net/c/faxian/10">发现分享</a>”频道。</td></tr><tr><td align="left">🌐 <a href="https://www.iplaysoft.com/">异次元软件</a></td><td align="left">与“<strong>小众软件</strong>”类似，但更新强度大不如以前。</td></tr><tr><td align="left">🌐 <a href="https://topbook.cc/overview">Topbook</a></td><td align="left">可以说是“<strong>视频版小众软件</strong>”，信噪音比不高，同样的内容需要的时间更多。</td></tr><tr><td align="left">🌐 <a href="https://sspai.com/">少数派</a></td><td align="left">软件界的“<strong>小红书</strong>”，文章更多的是“<strong>经验分享</strong>”，但苹果用户占比太高。</td></tr><tr><td align="left">🌐 <a href="https://soft.ithome.com/">IT 之家</a></td><td align="left">专业的 IT 新闻网站，有一个“<strong>软件</strong>”频道，软件界的大新闻，这里都有。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>国外网站</strong></td><td align="left">简介</td></tr><tr><td align="left">🌐 <a href="https://www.producthunt.com/">Product Hunt</a></td><td align="left">国外最火的软件应用资讯网站，能发掘很多前沿新产品。</td></tr><tr><td align="left">🌐 <a href="https://betalist.com/">BetaList</a></td><td align="left">与 Product Hunt 类似，但提供的都是新鲜前沿的应用。</td></tr><tr><td align="left">🌐 <a href="https://www.slant.co/">Slant</a></td><td align="left">提供各种应用的排名测评，有正反观点，比如“<a href="https://www.slant.co/topics/1507/~best-desktop-web-browsers">最好的浏览器是什么</a>”？</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>相似软件</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.producthunt.com/">Product Hunt</a></td><td align="left">网外最火的软件资讯网站，右下角的”View all alternatives”就是相似软件。</td></tr><tr><td align="left">🌐 <a href="https://alternativeto.net/">AlternativeTo</a></td><td align="left">老牌网站，支持 Windows、macOS、linux、网页、iOS、安卓。</td></tr><tr><td align="left">🌐 <a href="https://zh.altapps.net/">Altapps.net</a></td><td align="left">支持多语言，支持多平台，资源也比较丰富。</td></tr><tr><td align="left">🌐 <a href="https://progsoft.net/">ProgSoft</a></td><td align="left">支持桌面软件，热度也很高。</td></tr><tr><td align="left">🌐 <a href="https://alternative.me/">Alternative.me</a></td><td align="left">支持桌面软件，资讯相对较老。</td></tr><tr><td align="left">🌐 <a href="https://alternatives.app/">Alternatives.app</a></td><td align="left">支持桌面软件，资讯相对较老。</td></tr><tr><td align="left">🌐 <a href="https://www.similarsites.com/">Similarsites</a></td><td align="left">发明相似网站。</td></tr><tr><td align="left">🌐 <a href="https://www.similarweb.com/zh/">Similarweb</a></td><td align="left">发明相似网站和手机应用。</td></tr><tr><td align="left">🌐 <a href="https://www.btw.so/zh/open-source-alternatives">开源替代方案</a></td><td align="left">200 多个开源替代品，可替代企业日常运营所需的工具。</td></tr><tr><td align="left">🌐 <a href="https://mrfreetools.com/">MrFreeTools</a></td><td align="left">查找收费应用的免费方案。</td></tr></tbody></table><h2 id="二、软件论坛"><a href="#二、软件论坛" class="headerlink" title="二、软件论坛"></a>二、软件论坛</h2><table><thead><tr><th align="left">▼ <strong>国内论坛</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://www.52pojie.cn/forum-2-1.html">吾爱破解</a></td><td align="left">国内活跃度最高的软件交流社区。</td></tr><tr><td align="left">🌐 <a href="https://www.v2ex.com/">V2EX</a></td><td align="left">前知名开发者交流社区，现在需要“<strong>魔法</strong>”才能访问了。</td></tr><tr><td align="left">🌐 <a href="https://bbs.pcbeta.com/">远景论坛</a></td><td align="left">国内知名的 Windows 软件交流社区。</td></tr><tr><td align="left">🌐 <a href="https://bbs.kafan.cn/">卡饭论坛</a></td><td align="left">一个以“<strong>卡巴斯基</strong>”为起点的软件交流社区，需要登录才能访问。</td></tr><tr><td align="left">🌐 <a href="https://www.chongbuluo.com/">虫部落</a></td><td align="left">一个以搜索主题的资源交流社区。</td></tr><tr><td align="left">🌐 <a href="https://www.chinapyg.com/forum-83-1.html">飘云阁</a></td><td align="left">类似 52Pojie 的论坛。</td></tr><tr><td align="left">🌐 <a href="http://bbs.wuyou.net/forum.php">无忧启动</a></td><td align="left">类似 52Pojie 的论坛。</td></tr><tr><td align="left">🌐 <a href="https://www.52hb.com/forum-86-1.html">吾爱汇编</a></td><td align="left">类似 52Pojie 的论坛。</td></tr><tr><td align="left">🌐 <a href="http://www.bathome.net/">批处理之家</a></td><td align="left">一个专注于 <strong>.bat</strong> 批处理文件的软件论坛。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>国外论坛</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://rutracker.org/forum/index.php">RuTracker.org</a></td><td align="left">提供 BT 下载，综合性资源下载网站，各种内容都有，俄罗斯知名网站。</td></tr><tr><td align="left">🌐 <a href="https://forum.mobilism.org/index.php">Mobilism</a></td><td align="left">提供 BT 下载，综合性资源下载网站，各种内容都有。</td></tr><tr><td align="left">🌐 <a href="https://nsaneforums.com/forum/48-software-updates/">Nsane Forums</a></td><td align="left">提供 BT 下载，综合性资源下载网站，各种内容都有。</td></tr></tbody></table><h2 id="三、Win-软件"><a href="#三、Win-软件" class="headerlink" title="三、Win 软件"></a>三、Win 软件</h2><table><thead><tr><th align="left">▼ <strong>国内网站</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://www.423down.com/">423Down</a></td><td align="left">提供 蓝奏云、123 网盘、百度网盘。👍</td></tr><tr><td align="left">🌐 <a href="https://www.itrmb.com/">数字人民币</a></td><td align="left">423Down 需要会员才能下载的软件，这里有。👍</td></tr><tr><td align="left">🌐 <a href="https://www.ghxi.com/">果核剥壳</a></td><td align="left">提供 123 网盘、夸克网盘、阿里网盘。</td></tr><tr><td align="left">🌐 <a href="https://www.6yit.com/">六音软件</a></td><td align="left">提供 蓝奏云、123 网盘、天翼云。</td></tr><tr><td align="left">🌐 <a href="https://foxirj.com/">佛系软件</a></td><td align="left">提供 百度网盘、会员 123 网盘。</td></tr><tr><td align="left">🌐 <a href="https://www.luochenzhimu.com/">落尘之木</a></td><td align="left">提供 123 网盘、夸克网盘、百度网盘。</td></tr><tr><td align="left">🌐 <a href="http://www.qiuquan.cc/">QiuQuan</a></td><td align="left">提供 官方链接、蓝奏云、123 网盘。</td></tr><tr><td align="left">🌐 <a href="https://www.mefcl.com/">mefcl</a></td><td align="left">提供 123 网盘、天翼云、夸克网盘</td></tr><tr><td align="left">🌐 <a href="http://www.th-sjy.com/">th_sjy</a></td><td align="left">提供 城通网盘。</td></tr><tr><td align="left">🌐 <a href="http://www.apprcn.com/">反斗软件</a></td><td align="left">提供 官方链接、蓝奏云、123 网盘、内容较老。</td></tr><tr><td align="left">🌐 <a href="http://www.dayanzai.me/">大眼仔旭</a></td><td align="left">提供 百度网盘、城通网盘。</td></tr><tr><td align="left">🌐 <a href="https://www.sunweihu.com/">墨涩网</a></td><td align="left">提供 官方链接、蓝奏云、123 网盘、内容较老。</td></tr><tr><td align="left">🌐 <a href="https://www.ypojie.com/">易破解</a></td><td align="left">提供 百度网盘、夸克网盘。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>国外网站</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://en.softonic.com/">Softonic</a></td><td align="left">提供软件的介绍和下载，类似于国内的“<strong>华军下载</strong>”，无破解内容。</td></tr><tr><td align="left">🌐 <a href="https://en.taiwebs.com/?lang=SG">TaiWebs</a></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://filezner.com/">Filezner</a></td><td align="left">资源较老。</td></tr><tr><td align="left">🌐 <a href="https://filecr.com/en">FileCR</a></td><td align="left">号称世界最大</td></tr><tr><td align="left">🌐 <a href="https://haxnode.net/">haxNode</a></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://www.sadeempc.com/">SadeemPC</a></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://igetintopc.com/">iGet Into PC</a></td><td align="left">大型软件，专业软件。</td></tr><tr><td align="left"><a href="https://www.crackingcity.com/">🌐 CrackingCity</a></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://crackedfine.com/category/softwares/">CrackedFine</a></td><td align="left">博客网站，提供国外网盘下载。</td></tr><tr><td align="left">🌐 <a href="https://kickasscracks.com/">KickASSCracks</a></td><td align="left">博客网站，提供国外网盘下载，开头的“<strong>Direct Download</strong>”不要点。</td></tr><tr><td align="left">🌐 <a href="https://free4pc.org/">Free4PC</a></td><td align="left">博客网站，提供国外网盘下载，资源较老。</td></tr><tr><td align="left">🌐 <a href="https://repack.me/">REPACK.ME</a></td><td align="left">俄罗斯网站、</td></tr><tr><td align="left">🌐 <a href="https://lrepacks.net/">LRepacks</a></td><td align="left">俄罗斯网站、</td></tr><tr><td align="left">🌐 <a href="https://positiverecords.ru/">positiverecords.ru</a></td><td align="left">俄罗斯网站、提供 BT 下载，以 Windows 主为。</td></tr><tr><td align="left">🌐 <a href="https://w14.monkrus.ws/">monkrus.ws</a></td><td align="left">俄罗斯网站、一个专门破解 Adobe 软件网站。</td></tr><tr><td align="left">🌐 <a href="https://diakov.net/">DIAKOV.NET</a></td><td align="left">俄罗斯网站、但游客身份只提供慢速网盘下载。</td></tr></tbody></table><table><thead><tr><th align="left">▼ <strong>特色软件</strong></th><th align="left"></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://sourceforge.net/">SourceForge</a></td><td align="left">GitHub 兴起前的一个软件托管平台。</td></tr><tr><td align="left">🌐 <a href="https://portableapps.com/apps">PortableApps</a></td><td align="left">一个专门提供各软件“<strong>便携版本</strong>”的网站。</td></tr><tr><td align="left">🌐 <a href="http://www.oldversion.com/">Old versions</a></td><td align="left">一个专门提供各软件“<strong>历史版本</strong>”的网站。</td></tr><tr><td align="left">🌐 <a href="https://filehippo.com/">FileHippo.com</a></td><td align="left">一个专门提供各软件“<strong>最新版本</strong>”的网站。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>专业软件</strong></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://www.qijishow.com/down/index.html">奇迹秀工具箱</a></td><td align="left">一个专门提供“<strong>设计类软件</strong>”的网站，Win Mac 都有。</td></tr><tr><td align="left">🌐 <a href="https://ruancang.net/#/sim">软仓</a></td><td align="left">收录了 <strong>391</strong> 个专业软件，需关注公众号，可订阅”<a href="https://gcore.jsdelivr.net/gh/runningcheese/RunningCheese-Firefox/Restore/Adblock_Popup.txt">去弹窗广告</a>“过滤规则。</td></tr><tr><td align="left">🌐 <a href="https://www.0daydown.com/">0DayDown</a></td><td align="left">收录稀缺的 0day 软件，提供国外网盘下载，速度较慢，百度网盘要会员。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>反馬软件</strong></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://pan.luochenzhimu.com/disk/software/">落尘之木</a></td><td align="left">很多软件被”<strong>苏州思杰马克丁</strong>“公司代理而无法找到，这里是资源汇总。</td></tr><tr><td align="left">🌐 <a href="https://www.naodai.org/">脑袋瓜子</a></td><td align="left">自建网盘下载，地址：<a href="https://go.naodai.org/">瓜子云盘镜像</a></td></tr><tr><td align="left">🌐 <a href="https://ldqk.xyz/special/6">懒得勤快</a></td><td align="left">自建网盘下载，地址：<a href="https://ldqk.xyz/drive#/onedrive/softs">懒勤网盘</a></td></tr><tr><td align="left">🌐 <a href="https://software.storage.yuntu.eu.org/">云图小镇</a></td><td align="left">自建网盘下载，地址：<a href="https://software.storage.yuntu.eu.org/">云图小镇</a></td></tr></tbody></table><h2 id="四、Mac-软件"><a href="#四、Mac-软件" class="headerlink" title="四、Mac 软件"></a>四、Mac 软件</h2><table><thead><tr><th align="left">▼ <strong>国内网站</strong></th><th align="left">简介</th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://macapp.org.cn/">MacApp分享频道</a></td><td align="left">免注册、高速下载、无广告、资源首发。</td></tr><tr><td align="left">🌐 <a href="https://www.macyy.cn/">MacYY</a></td><td align="left">免注册、高速下载、无广告、资源丰富。</td></tr><tr><td align="left">🌐 <a href="https://xclient.info/">xClient</a></td><td align="left">免注册、高速下载、有广告、资源丰富。</td></tr><tr><td align="left">🌐 <a href="https://xmac.app/">XMac.App</a></td><td align="left">提供 国外网盘和 IPFS 下载，应用来自 TNT、HCiSO 等知名团队。</td></tr><tr><td align="left">🌐 <a href="https://www.digit77.com/">Digit77</a></td><td align="left">开启广告屏蔽工具会隐藏下载链接。</td></tr><tr><td align="left">🌐 <a href="https://www.mac8k.com/">Mac8k</a></td><td align="left">提供 百度网盘下载</td></tr><tr><td align="left">🌐 <a href="http://www.sdifen.com/">史蒂芬周</a></td><td align="left">需要登陆</td></tr><tr><td align="left">🌐 <a href="https://www.macxin.com/">Mac萌新</a></td><td align="left">需要等待 6 秒</td></tr><tr><td align="left">🌐 <a href="https://macbang.net/">Mac帮</a></td><td align="left">提供 百度网盘下载，需要注册，回复评论才能下载。</td></tr><tr><td align="left">🌐 <a href="https://www.zhiniw.com/">知您网</a></td><td align="left">提供 城通网盘下载。</td></tr><tr><td align="left">🌐 <a href="https://uleshi.com/">优乐事</a></td><td align="left">提供 城通网盘下载。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>国外网站</strong></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://www.torrentmac.net/">MacTorrents</a></td><td align="left">提供 BT 下载，TNT 和 HCISO 团队软件的源头。</td></tr><tr><td align="left">🌐 <a href="https://appstorrent.ru/">AppStorrent</a></td><td align="left">提供 国外网盘下载，俄罗斯知名 Mac 软件下载网站，这里也是源头。</td></tr><tr><td align="left">🌐 <a href="https://haxmac.cc/">Haxmac</a></td><td align="left">提供 国外网盘下载。</td></tr><tr><td align="left">🌐 <a href="https://cmacked.com/">Cmacked</a></td><td align="left">提供 国外网盘下载，资源较老。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>正版应用</strong></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://www.macupdate.com/">MacUpdate</a></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://setapp.com/">SetApp</a></td><td align="left">MacPaw 推出的订阅制付费 App 平台服务。</td></tr><tr><td align="left">🌐 <a href="https://www.lizhi.io/">荔枝数码</a></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://store.steampowered.com/">Steam</a></td><td align="left">很多 Mac 端游戏上不了 App Store，只能在 Steam 发布。</td></tr><tr><td align="left">🌐 <a href="https://www.taobao.com/">淘宝</a></td><td align="left">在淘宝购买的价格，往往要比官方价格低很多，拼多多同理。</td></tr></tbody></table><h2 id="六、软件搜索"><a href="#六、软件搜索" class="headerlink" title="六、软件搜索"></a>六、软件搜索</h2><p>聚合式软件搜索下载网站。</p><table><thead><tr><th align="left">▼ <strong>软件搜索</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://www.tansuotu.com/">探索兔</a></td><td align="left">Windows 软件搜索引擎，可能是目前最好的软件搜索网站。👍</td></tr><tr><td align="left">🌐 <a href="https://rjss.pages.dev/">软件搜搜</a></td><td align="left">Windows 软件搜索引擎，不支持 52Pojie、423Down 等网站。</td></tr><tr><td align="left">🌐 <a href="https://www.runningcheese.cn/rjss">奶酪搜搜</a></td><td align="left">Windows 软件搜索引擎，软件搜搜的奶酪 <strong>Fork</strong> 版本，源网站更多。</td></tr><tr><td align="left">🌐 <a href="https://www.xibuluo.com/">西部落</a></td><td align="left">Windows 软件搜索引擎，源网站较少。</td></tr><tr><td align="left">🌐 <a href="https://www.huaitui.com/">淮推软件</a></td><td align="left">Windows 软件搜索引擎，源网站较少。</td></tr><tr><td align="left">🌐 <a href="https://ourmacs.com/">Ourmacs</a></td><td align="left">Mac 软件搜索引擎。</td></tr></tbody></table><h2 id="七、系统安装"><a href="#七、系统安装" class="headerlink" title="七、系统安装"></a>七、系统安装</h2><table><thead><tr><th align="left">▼ <strong>镜像下载</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://msdn.itellyou.cn/">MSDN, ITellYou</a></td><td align="left">纯净的系统下载网站，还有 Office，但没有 Win11。</td></tr><tr><td align="left">🌐 <a href="https://next.itellyou.cn/Original/Index?id=7ab5f0cb-7607-4bbe-9e88-50716dc43de6#">NEXT, ITellYou</a></td><td align="left">MSDN 新网站，提供多平台系统下载，但需要登陆才能访问。</td></tr><tr><td align="left">🌐 <a href="https://hellowindows.cn/">HelloWindows</a></td><td align="left">极致的 Windows 系统下载网站。</td></tr><tr><td align="left">🌐 <a href="https://tb.rg-adguard.net/public.php">TechBench</a></td><td align="left">俄罗斯网站，提供菜单选择式的 Windows 镜像下载。</td></tr><tr><td align="left">🌐 <a href="https://www.xitongku.com/">MSDN 系统库</a></td><td align="left">提供菜单选择式的 Windows 镜像下载。</td></tr><tr><td align="left">🌐 <a href="https://iwin10.net/">专注 Win10 镜像</a></td><td align="left">专注 Win10 的精简优化版。</td></tr><tr><td align="left">🌐 <a href="https://www.newxitong.com/">专注 Win7 镜像</a></td><td align="left">专注 Win7 的精简优化版。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>系统激活</strong></td><td align="left"></td></tr><tr><td align="left">🌐 <a href="https://github.com/zbezj/HEU_KMS_Activator">KMSActivator</a></td><td align="left">国内大佬 @知彼而知己制作的 Windows 和 Office 激活工具。</td></tr><tr><td align="left">🌐 <a href="https://kms-auto.site/zh-CN/">KMSAuto Net</a></td><td align="left">知名系统激活工具 KMSAuto，支持 Windows 和 Office。</td></tr><tr><td align="left">🌐 <a href="https://github.com/OdysseusYuan/LKY_OfficeTools">LKY_OfficeTools</a></td><td align="left">一键自动化下载、安装、激活 Office 的利器，单独针对 Office。</td></tr><tr><td align="left">🌐 <a href="https://github.com/TGSAN/CMWTAT_Digital_Edition">云萌激活工具</a></td><td align="left">开源的 Win10、Win 11 激活工具。</td></tr><tr><td align="left">🌐 <a href="https://v0v.bid/">微零微</a></td><td align="left">一条命令激活 Windows 系统。</td></tr><tr><td align="left">🌐 <a href="https://pkeytool.com/ShareKeys">PKeyToolWeb</a></td><td align="left">微软激活密钥分享网站。</td></tr><tr><td align="left">🌐 <a href="https://blog.03k.org/post/kms.html">KMS 激活指南</a></td><td align="left">Windows 激活科普。</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
            <tag> 软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>影视导航</title>
      <link href="/2023/09/27/%E5%BD%B1%E8%A7%86%E5%AF%BC%E8%88%AA/"/>
      <url>/2023/09/27/%E5%BD%B1%E8%A7%86%E5%AF%BC%E8%88%AA/</url>
      
        <content type="html"><![CDATA[<h1 id="影视导航"><a href="#影视导航" class="headerlink" title="影视导航"></a>影视导航</h1><hr><h2 id="1、电影搜索"><a href="#1、电影搜索" class="headerlink" title="1、电影搜索"></a>1、电影搜索</h2><table><thead><tr><th align="left">▼ <strong>电影搜索</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.ikanbot.com/">爱看机器人</a></td><td align="left"><a href="https://cupfox.app/">茶杯狐</a></td><td align="left"><a href="https://soupian.app/">搜片.com</a></td><td align="left"><a href="https://www.wandou.la/">豌豆PRO</a></td></tr><tr><td align="left"><a href="https://www.dianyinggou.com/">电影狗</a></td><td align="left"><a href="https://www.dianyingtaotao.com/">电影淘淘</a></td><td align="left"><a href="https://yingshiso.com/">影搜</a></td><td align="left"><a href="https://www.qmtv.pro/">青麦</a></td></tr><tr><td align="left"><a href="https://www.ressou.com/">酷搜</a></td><td align="left"><a href="https://search.ymck.me/">影猫の仓库</a></td><td align="left"><a href="https://dogechan.com/">Doge分享</a></td><td align="left"><a href="https://zhuiyingmao2.com/">追影猫</a></td></tr><tr><td align="left"><a href="https://www.725998.com/">茶杯虎</a></td><td align="left"><a href="https://tbsdy.com/">土拨鼠电影</a></td><td align="left"><a href="https://wukongshipin.com/">悟空视频</a></td><td align="left"><a href="https://www.xmxone.cn/">MXONE</a></td></tr><tr><td align="left"><a href="https://7080.wang/index.html">7080影视搜</a></td><td align="left"></td><td align="left"></td><td align="left"></td></tr></tbody></table><h2 id="2、国内影视"><a href="#2、国内影视" class="headerlink" title="2、国内影视"></a>2、国内影视</h2><table><thead><tr><th align="left">▼ 影视综艺</th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.yijia5.com/">全集网</a></td><td align="left"><a href="https://zhuiyingmao2.com/">追影猫</a></td><td align="left"><a href="https://rebozj.pro/">热播之家</a></td><td align="left"><a href="https://dsxys.pro/">大师兄影视</a></td></tr><tr><td align="left"><a href="https://new.olevod.com/">欧乐影院 NEW</a></td><td align="left"><a href="https://olevod.com/">欧乐影院</a></td><td align="left"><a href="https://cokemv.me/">COKEMV</a></td><td align="left"><a href="https://www.fuju1.tv/">腐剧TV</a></td></tr><tr><td align="left"><a href="https://www.tuhao.tv/">土豪影视</a></td><td align="left"><a href="https://www.newfii.com/">奈落影视</a></td><td align="left"><a href="https://www.dbgys.top/">大表哥影视</a></td><td align="left"><a href="https://www.panghuys.com/">胖虎影视</a></td></tr><tr><td align="left"><a href="https://www.gptys.com/">GPT 影视</a></td><td align="left"><a href="https://www.57movie.cn/">无心影视</a></td><td align="left"><a href="https://www.keke1.app/">可可影视</a></td><td align="left"><a href="https://nbys.top/">泥巴影视</a></td></tr><tr><td align="left"><a href="https://www.pbpbs.com/">片吧</a></td><td align="left"><a href="https://www.bkyb.net/">真不卡影院</a></td><td align="left"><a href="https://wzyshi.com/">WZ影视</a></td><td align="left"><a href="https://www.netfly.tv/">奈飞中文影视</a></td></tr><tr><td align="left"><a href="https://www.appmovie.cc/">APP影院</a></td><td align="left"><a href="https://ttsp.tv/">天天视频</a></td><td align="left"><a href="https://www.iole.tv/">爱欧乐影院</a></td><td align="left"><a href="https://www.yunbtv.net/">云播TV</a></td></tr><tr><td align="left"><a href="https://www.honglingjin.tv/">红领巾影院</a></td><td align="left"><a href="https://duboku.su/">独播库</a></td><td align="left"><a href="https://www.nunuyy5.org/">努努影院</a></td><td align="left"><a href="https://www.tangrenjie.tv/">唐人街影院</a></td></tr><tr><td align="left"><a href="https://dami5.vip/">大米星球</a></td><td align="left"><a href="https://www.fantuanhd.com/">饭团影视</a></td><td align="left"><a href="https://hua355.com/">HuaHua影院</a></td><td align="left"><a href="https://xmvod520.com/">熊猫影院</a></td></tr><tr><td align="left"><a href="https://www.iyf1.tv/">爱壹帆</a></td><td align="left"><a href="https://55dy9.vip/">555电影</a></td><td align="left"><a href="https://www.pkmkv.com/">七味网</a></td><td align="left"><a href="https://kanb.tv/">看B站</a></td></tr><tr><td align="left"><a href="https://dianyi.ng/">电影先生</a></td><td align="left"><a href="https://www.3ayy.com/">爱看影院</a></td><td align="left"><a href="https://www.cctv365.co/">华联社影院</a></td><td align="left"><a href="https://www.mkvdo.com/">MK影视</a></td></tr><tr><td align="left"><a href="http://www.qnkk8.com/">全能影视</a></td><td align="left"><a href="https://adys.tv/">爱迪影视</a></td><td align="left"><a href="https://www.xy1080.net/">星影视频</a></td><td align="left"><a href="https://cddys.vip/">臭蛋蛋影视</a></td></tr><tr><td align="left"><a href="https://www.flixflop.com/">飞流视频</a></td><td align="left"><a href="https://www.maolvys.com/">毛驴影视</a></td><td align="left"><a href="https://www.1080p.club/">1080迷</a></td><td align="left"><a href="https://zpsps.com/">宝片视频</a></td></tr><tr><td align="left"><a href="https://www.pyys.top/">朴樱影视</a></td><td align="left"><a href="https://www.3ayy.com/">爱看影院</a></td><td align="left"><a href="https://www.huanyuxing.com/">麻衣呀呼</a></td><td align="left"><a href="https://www.xmxone.cn/">Xmxone</a></td></tr><tr><td align="left"><a href="https://www.fantuan1.com/">饭团影视</a></td><td align="left"><a href="https://www.qiuxia678.com/">秋霞影视</a></td><td align="left"><a href="https://www.chok8.cc/">Chok 吧</a></td><td align="left"><a href="https://www.ysgc.fun/">影视工场</a></td></tr><tr><td align="left"><a href="https://www.06ys.com/">你牛影视</a></td><td align="left"><a href="https://www.histar.tv/">星视界</a></td><td align="left"><a href="https://xiaoyakankan.com/">小鸭看看</a></td><td align="left"><a href="https://www.iyf1.tv/">爱壹帆清爽版</a></td></tr><tr><td align="left"><a href="https://www.kkdy.live/">看看电影</a></td><td align="left"><a href="https://www.okdyy.com/">OK电影院</a></td><td align="left"><a href="https://dadagui.me/">达达龟</a></td><td align="left"><a href="https://www.kuaizi.tv/">筷子视频</a></td></tr><tr><td align="left"><a href="https://www.fuxiafood.com/">蓝光影院</a></td><td align="left"><a href="https://xiaobaotv.net/index.php">小宝影院</a></td><td align="left"><a href="https://www.wangfei.de/">网飞TV</a></td><td align="left"><a href="https://www.hoho.tv/">HOHO TV</a></td></tr><tr><td align="left"><a href="https://www.shenma4480.com/">神马电影</a></td><td align="left"><a href="https://www.xifanys.com/">稀饭影视</a></td><td align="left"><a href="https://www.histar.tv/">星视界</a></td><td align="left"><a href="https://www.tv-8.com/">电视吧</a></td></tr><tr><td align="left"><a href="https://loveqtv.com/">爱情影院</a></td><td align="left"><a href="https://1090p.tk/">毛茂影视</a></td><td align="left"><a href="https://www.kcys.top/">酷茶影视</a></td><td align="left"><a href="https://aa4.cc/">AA影视</a></td></tr><tr><td align="left"><a href="https://vod.funsline.cn/">多多影视</a></td><td align="left"><a href="https://www.90s.one/">90s电影网</a></td><td align="left"><a href="https://laowang.lol/">老王电影</a></td><td align="left"><a href="https://maoo.tv/">猫影视</a></td></tr><tr><td align="left"><a href="https://www.wrnm.cc/">WRNM</a></td><td align="left"><a href="https://duboku.su/">独播库</a></td><td align="left"><a href="https://www.zhuiju.la/">天天追剧</a></td><td align="left"><a href="https://www.ysfxla.com/">影视分享</a></td></tr><tr><td align="left"><a href="https://www.6080yy1.com/">新视觉影院</a></td><td align="left"></td><td align="left"></td><td align="left"></td></tr></tbody></table><h2 id="3、海外影视"><a href="#3、海外影视" class="headerlink" title="3、海外影视"></a>3、海外影视</h2><table><thead><tr><th align="left">▼ <strong>综合</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.subaibaiys.com/">素白白影视</a></td><td align="left"><a href="https://www.bdys10.com/">哔嘀影视</a></td><td align="left"><a href="https://www.libvio.fun/">LIBVIO</a></td><td align="left"><a href="https://jojo.bdys.top/">JOJO</a></td></tr><tr><td align="left"><a href="https://www.taolix.com/">TAOLIX</a></td><td align="left"><a href="https://gaze.run/">注视影视</a></td><td align="left"><a href="https://cz01.cc/">厂长资源</a></td><td align="left"><a href="https://www.zxzjhd.com/">在线之家</a></td></tr><tr><td align="left"><a href="https://www.novipnoad.net/">NO视频</a></td><td align="left"><a href="https://ddys.pro/">低端影视</a></td><td align="left"><a href="https://hdmoli.com/">HDmoli</a></td><td align="left"><a href="https://ikanys.tv/">爱看影视</a></td></tr><tr><td align="left"><a href="https://waipian5.com/">歪片星球</a></td><td align="left"><a href="https://xmmi.xyz/">小猫咪影视</a></td><td align="left"><a href="https://suyingtv.xyz/">速影TV</a></td><td align="left"><a href="https://www.kpkuang.de/">看片狂人</a></td></tr><tr><td align="left"><a href="https://www.btnull.org/">无名小站</a></td><td align="left"><a href="https://dmxq.fun/">大米星球</a></td><td align="left"><a href="https://www.citydy.com/">城市电影</a></td><td align="left"><a href="https://www.4kvm.net/">4k影视</a></td></tr><tr><td align="left">▼ <strong>英文</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://myflixer.is/home">Myflixer</a></td><td align="left"><a href="https://watchseries.id/home">Watchseries</a></td><td align="left"><a href="https://g8b01.com/">CouchTuner</a></td><td align="left"><a href="https://fmovies.pub/home">FMovies</a></td></tr><tr><td align="left"><a href="https://yesmovies.ag/yes.html">YesMovies</a></td><td align="left"><a href="https://www1.solarmovie.cr/movie/">SolarMovie</a></td><td align="left"><a href="https://ww2.123moviesfree.net/home/">123Movies</a></td><td align="left"><a href="https://fmovies.to/">FMovies 2</a></td></tr><tr><td align="left">▼ <strong>美剧</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.meijutt.tv/">美剧天堂</a></td><td align="left"><a href="https://www.meijumi.net/">美剧迷</a></td><td align="left"><a href="https://agmov.com/">阿哥美剧</a></td><td align="left"><a href="https://ddys.one/">低端影视</a></td></tr><tr><td align="left"><a href="https://www.nfyingshi.com/">奈菲影视</a></td><td align="left"><a href="https://www.mjwo.net/">美剧窝</a></td><td align="left"><a href="https://mjw21.com/">美剧网</a></td><td align="left"><a href="https://www.meijucang.com/">美剧仓</a></td></tr><tr><td align="left"><a href="https://www.nfyingshi.com/">美剧行星</a></td><td align="left"><a href="https://www.91mjtt.cc/">91美剧网</a></td><td align="left"><a href="https://www.aimeijutv.com/">爱美剧TV</a></td><td align="left"><a href="https://www.meiju5.net/">美剧吧</a></td></tr><tr><td align="left"><a href="https://www.meijuttk.cc/">天天美剧</a></td><td align="left"><a href="https://www.2meiju.cc/">爱美剧</a></td><td align="left"><a href="https://www.xxhezi.com/">美剧的天堂</a></td><td align="left"><a href="https://kanmeiju.net/">看美剧</a></td></tr><tr><td align="left"><a href="https://www.fmeiju.com/">放美剧</a></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>英剧</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.icezmz.com/">冰冰字幕组</a></td><td align="left"><a href="https://www.meijumi.net/en/">英剧大全</a></td><td align="left"><a href="https://www.ivazimova.com/">英剧吧</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>韩剧</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.hanmi.org/">韩迷网</a></td><td align="left"><a href="https://www.tvn.cc/">韩剧网</a></td><td align="left"><a href="https://www.hanfan.cc/">韩饭网</a></td><td align="left"><a href="https://321tw.com/">韓劇網</a></td></tr><tr><td align="left"><a href="https://www.kan.cc/">看韩剧tv</a></td><td align="left"><a href="https://www.hanjukankan.com/">韩剧看看</a></td><td align="left"><a href="https://01hanju.com/">韩剧网</a></td><td align="left"><a href="https://www.hanju7.com/">韩剧播</a></td></tr><tr><td align="left"><a href="https://www.tvn.cc/">韩剧桃</a></td><td align="left"><a href="https://idoltv.tv/">IDOLTV線上看</a></td><td align="left"><a href="https://www.hanritai.com/">韩剧DVD</a></td><td align="left"><a href="https://www.hanjuwang.net/">韩剧网</a></td></tr><tr><td align="left">▼ <strong>日剧</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://rijuvip.com/">日剧TV网</a></td><td align="left"><a href="https://www.tnhzmz.com/">TNH Subtitle</a></td><td align="left"><a href="https://www.rijupao.com/">日剧跑</a></td><td align="left"><a href="https://www.fanxinzhui.com/">追新番</a></td></tr><tr><td align="left"><a href="https://www.dn51.net/">DN51</a></td><td align="left"><a href="https://rijuvip.com/">日剧网</a></td><td align="left"><a href="https://www.rijutt.com/">日剧天堂</a></td><td align="left"><a href="http://www.rjtv6.com/">日剧TV</a></td></tr><tr><td align="left">▼ <strong>泰剧</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.taijuz.com/">泰剧网</a></td><td align="left"><a href="http://www.tjtt.cc/">泰剧网</a></td><td align="left"><a href="https://www.taiju5.com/">泰剧大全</a></td><td align="left"><a href="https://www.taijumi.net/">泰剧迷</a></td></tr><tr><td align="left">▼ <strong>港剧</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.tvhk.cc/">粤语e族</a></td><td align="left"><a href="http://www.ii166.com/">港剧下载</a></td><td align="left"><a href="https://www.hktvz.com/">粤语屋</a></td><td align="left"><a href="https://www.gjtt5.cc/">港剧天堂</a></td></tr><tr><td align="left"><a href="https://www.gjyak.com/">粤爱看</a></td><td align="left"><a href="https://www.gjw3.com/">粤港网</a></td><td align="left"><a href="https://www.gj5.tv/">港剧屋</a></td><td align="left"><a href="https://www.gjw4.com/">港剧发烧友</a></td></tr><tr><td align="left"><a href="https://www.hnyrs.com/">粤语影院</a></td><td align="left"><a href="https://www.iyueyuw.xyz/">爱粤语网</a></td><td align="left"><a href="https://yueyuds.com/">粤语电视网</a></td><td align="left"><a href="https://www.aliyundrive.com/s/hf4a7foCdkb">500 多部港剧合集</a></td></tr></tbody></table><h2 id="4、动漫番剧"><a href="#4、动漫番剧" class="headerlink" title="4、动漫番剧"></a>4、动漫番剧</h2><table><thead><tr><th align="left">▼ 动漫频道</th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.soman.com/">搜漫</a></td><td align="left"><a href="https://www.jiligamefun.com/">叽哩叽哩</a></td><td align="left"><a href="https://bangumi.tv/">Bangumi 番组计划</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>漫画网站</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.mangabz.com/">Mangabz</a></td><td align="left"><a href="https://copymanga.site/">拷貝漫畫</a></td><td align="left"><a href="https://www.colamanhua.com/">COLA漫画</a></td><td align="left"><a href="https://cn.baozimh.com/">包子漫画</a></td></tr><tr><td align="left"><a href="https://www.cartoonmad.com/">動漫狂</a></td><td align="left"><a href="https://www.dmzj.com/">动漫之家</a></td><td align="left"><a href="https://www.dongman.la/">动漫啦</a></td><td align="left"><a href="http://www.kumw9.com/">酷漫屋</a></td></tr><tr><td align="left"><a href="https://www.xmanhua.com/">Xmanhua</a></td><td align="left"><a href="https://mhx12.com/">漫自由</a></td><td align="left"><a href="https://www.manhuagui.com/">漫画柜</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>动漫番剧</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.yhmgo.com/">樱花动漫</a></td><td align="left"><a href="https://www.dmla1.com/">风车动漫</a></td><td align="left"><a href="https://ysjdm.net/">異世界動漫</a></td><td align="left"><a href="https://www.agemys.org/">AGE动漫</a></td></tr><tr><td align="left"><a href="https://gqdm.net/">異世界動漫</a></td><td align="left"><a href="https://bangumi.online/">アニメ新番組</a></td><td align="left"><a href="http://www.dmd77.com/">动漫岛</a></td><td align="left"><a href="https://anime.girigirilove.com/">girigiri爱动漫</a></td></tr><tr><td align="left"><a href="http://www.nicotv.fun/">妮可动漫</a></td><td align="left"><a href="https://www.dm2022.com/">Z动漫</a></td><td align="left"><a href="https://07vods.fun/">柒之社</a></td><td align="left"><a href="https://pangciacg.com/">PangCI</a></td></tr><tr><td align="left"><a href="http://www.pilipili.ink/">P站</a></td><td align="left"><a href="https://www.mandaowang.com/">漫岛动漫</a></td><td align="left"><a href="http://halihali15.com/">哈哩哈哩</a></td><td align="left"><a href="https://www.heitaifun.com/">heitai动漫</a></td></tr><tr><td align="left"><a href="http://www.mxdm9.com/">MX动漫</a></td><td align="left"><a href="https://www.mengfan.tv/">萌番</a></td><td align="left"><a href="https://www.sbdm.net/">異世界動漫2</a></td><td align="left"><a href="http://www.yinghuavideo.com/">樱花动漫 2</a></td></tr><tr><td align="left"><a href="https://catw.moe/">喵物次元</a></td><td align="left"><a href="https://www.nyafun.net/">NyaFun</a></td><td align="left"><a href="https://www.kelatv.com/">克拉TV</a></td><td align="left"><a href="https://www.dmla1.com/">风车动漫</a></td></tr><tr><td align="left"><a href="https://www.lmm66.com/">路漫漫</a></td><td align="left"><a href="http://lmfun.vip/">蓝猫动漫</a></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>动漫磁力</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://share.dmhy.org/">動漫花園資</a></td><td align="left"><a href="https://nyaa.si/">Nyaa</a></td><td align="left"><a href="https://bangumi.moe/">萌番组</a></td><td align="left"><a href="https://acg.rip/">ACG.RIP</a></td></tr><tr><td align="left"><a href="https://mikanani.me/">蜜柑计划</a></td><td align="left"><a href="http://www.hysub.net/">幻樱字幕组</a></td><td align="left"></td><td align="left"></td></tr></tbody></table><h2 id="5、纪录片"><a href="#5、纪录片" class="headerlink" title="5、纪录片"></a>5、纪录片</h2><table><thead><tr><th align="left">▼ <strong>在线纪录片</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://jishi.cctv.com/">央视纪录片</a></td><td align="left"><a href="https://www.bilibili.com/documentary/">B 站纪录片</a></td><td align="left"><a href="https://v.qq.com/channel/doco">腾讯纪录片</a></td><td align="left"><a href="https://www.iqiyi.com/jilupian/">爱奇艺纪录</a></td></tr><tr><td align="left"><a href="https://space.bilibili.com/7584632/video">哔哩哔哩纪录片</a></td><td align="left"><a href="https://space.bilibili.com/22121599/video">纪录片之家字幕组</a></td><td align="left"><a href="https://space.bilibili.com/13374324/video">猛犸君侯</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>纪录片频道</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="http://xz.tqiantu.com/jilupian/">行者物语网</a></td><td align="left"><a href="http://www.opclass.com/">公开课纪录片下载网</a></td><td align="left"><a href="https://dao-fire.com/">盗火纪录片</a></td><td align="left"><a href="https://www.jiluhome.cn/">纪录家园</a></td></tr><tr><td align="left"><a href="https://www.05jl.com/">纪录片之家</a></td><td align="left"><a href="https://www.onehourlife.com/">每天一小时纪录片</a></td><td align="left"></td><td align="left"></td></tr></tbody></table><h2 id="6、电视直播"><a href="#6、电视直播" class="headerlink" title="6、电视直播"></a>6、电视直播</h2><p>直播源：通常来说是<strong>一个链接</strong>，以 <strong>m3u</strong> 或 <strong>m3u8</strong> 等结尾，可以在线播放，也可以需要借助相关软件来打开。</p><table><thead><tr><th align="left">▼ <strong>在线直播</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="http://www.yangshizhibo.com/">央视直播</a></td><td align="left"><a href="https://www.tvniu.com/">电视牛</a></td><td align="left"><a href="http://www.haoqiu365.com/">365直播</a></td><td align="left"><a href="http://www.126zhibo.net/">126直播</a></td></tr><tr><td align="left"><a href="http://www.lshitv.com/">乐视直播</a></td><td align="left"><a href="http://www.360live.cc/">爱看直播</a></td><td align="left"><a href="http://tv.haoqu99.com/">好趣网</a></td><td align="left"><a href="http://www.tvyan.com/">电视眼</a></td></tr><tr><td align="left"><a href="http://zqjy.info/t/">M3U8 IPTV Player</a></td><td align="left"><a href="https://eja.tv/">eja.tv</a></td><td align="left"><a href="http://nettv.live/">Nettv.live</a></td><td align="left"><a href="http://www.tvquanqiu.com/">看全球</a></td></tr><tr><td align="left">▼ <strong>直播源</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://github.com/iptv-org/iptv">IPTV.org</a></td><td align="left"><a href="https://live.fanmingming.com/">Fanmingming Live</a></td><td align="left"><a href="https://github.com/imDazui/Tvlist-awesome-m3u-m3u8">Tvlist</a></td><td align="left"><a href="https://epg.pw/test_channel_page.html?lang=zh-hans">EPG 电视节目表</a></td></tr><tr><td align="left"><a href="https://owen2000wy.github.io/">OwenTV</a></td><td align="left"><a href="http://tonkiang.us/">IPTV Link Search</a></td><td align="left"><a href="https://www.foodieguide.com/iptvsearch/">IPTV Link Search 2</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>直播源软件</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><strong>Windows</strong>：</td><td align="left">首选：<a href="https://www.videolan.org/index.zh.html">VLC</a></td><td align="left">可选：<a href="https://potplayer.daum.net/">Potplayer</a></td><td align="left"></td></tr><tr><td align="left"><strong>Mac</strong>：</td><td align="left">首选：<a href="https://www.videolan.org/index.zh.html">VLC</a></td><td align="left">可选：<a href="https://iina.io/">IINA</a></td><td align="left">可选：<a href="https://apps.apple.com/cn/app/id1630403500">‎APTV</a></td></tr><tr><td align="left"><strong>iOS</strong>：</td><td align="left">首选：<a href="https://www.videolan.org/index.zh.html">VLC</a></td><td align="left">可选：<a href="https://apps.apple.com/cn/app/ntplayer/id1613758141">ntPlayer</a></td><td align="left">可选：<a href="https://apps.apple.com/cn/app/id1630403500">‎APTV</a></td></tr><tr><td align="left"><strong>Android</strong>：</td><td align="left">首选：<a href="https://www.videolan.org/index.zh.html">VLC</a></td><td align="left">可选：<a href="https://www.lanzoub.com/izIp40ve9ing">DIYP 影音</a></td><td align="left"></td></tr><tr><td align="left"><strong>工具：</strong></td><td align="left"><a href="https://guihet.com/tvlistconvert.html">直播源列表格式转换</a></td><td align="left"></td><td align="left"></td></tr></tbody></table><h2 id="7、体育直播"><a href="#7、体育直播" class="headerlink" title="7、体育直播"></a>7、体育直播</h2><table><thead><tr><th align="left">▼ <strong>体育直播</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.zhibo8.com/">直播8</a></td><td align="left"><a href="https://www.qiumihui.tv/">球迷汇</a></td><td align="left"><a href="https://www.ningmengzhibo.cc/">柠檬直播</a></td><td align="left"><a href="https://www.yoozhibo.net/">优直播</a></td></tr><tr><td align="left"><a href="https://www.zhiboz.com/">直播吧</a></td><td align="left"><a href="https://dongqiudi.com/">懂球帝</a></td><td align="left"><a href="https://www.lanqiudi.com/">篮球帝</a></td><td align="left"><a href="https://www.zhibo1.cc/index.html">一直播</a></td></tr><tr><td align="left"><a href="http://www.jrkan2023.com/">JRKAN直播</a></td><td align="left"><a href="http://www.515.tv/">515直播</a></td><td align="left"><a href="http://www.lanqiuzhibo.com/">篮球直播吧</a></td><td align="left"><a href="https://www.98zhibo.com/">98直播吧</a></td></tr><tr><td align="left"><a href="https://www.kankanzhibo.com/">看看直播</a></td><td align="left"><a href="https://www.zb06.com/">体育6</a></td><td align="left"><a href="http://www.zhiboche5.com/">直播车</a></td><td align="left"><a href="https://www.tiantianzhibo.net/">天天直播</a></td></tr><tr><td align="left">▼ <strong>体育下载</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://www.sport-video.org.ua/">Sport Video</a></td><td align="left"><a href="http://www.miejw.com/html/mdown">米尔体育网</a></td><td align="left"><a href="http://www.qklnews.com/matchdown">巧克力直播网</a></td><td align="left"><a href="https://www.txzqw.me/">天下足球网</a></td></tr><tr><td align="left"><a href="http://www.qm5.cc/">球迷网</a></td><td align="left"></td><td align="left"></td><td align="left"></td></tr></tbody></table><h2 id="8、VIP-解析"><a href="#8、VIP-解析" class="headerlink" title="8、VIP 解析"></a>8、VIP 解析</h2><p>各大网站的 VIP 视频解析，输入<strong>视频地址</strong>即可。</p><table><thead><tr><th align="left">▼ <strong>VIP 解析</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.btnull.org/vipplay/">片库解析</a></td><td align="left"><a href="https://vip.bljiex.com/?wd=">BL 解析</a></td><td align="left"><a href="https://bd.jx.cn/?url=">冰豆解析</a></td><td align="left"><a href="https://okjx.cc/?url=">OK解析</a></td></tr><tr><td align="left"><a href="https://www.bavei.com/vip/?url=">全民解析</a></td><td align="left"><a href="https://www.pangujiexi.com/pangu/?url=">盘古解析</a></td><td align="left"><a href="https://jx.xmflv.com/?url=">虾米解析</a></td><td align="left"><a href="https://jx.jsonplayer.com/player/?url=">JsonPlayer 解析</a></td></tr><tr><td align="left"><a href="http://so.fulishe.live/">刚刚解析</a></td><td align="left"><a href="https://jx.kingtail.xyz/?url=">KingTail</a></td><td align="left"><a href="https://www.ckplayer.vip/jiexi/?url=">CKPlayer</a></td><td align="left"><a href="https://www.playm3u8.cn/jiexi.php?url=">Playm3u8</a></td></tr><tr><td align="left"><a href="https://jx.m3u8.tv/jiexi/?url=">M3u8.tv</a></td><td align="left"><a href="https://jx.xmflv.com/?url=">XmFlv</a></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>脚本辅助</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://greasyfork.org/zh-CN/scripts/438657">全网 VIP 视频解析</a></td><td align="left"><a href="https://greasyfork.org/zh-CN/scripts/467776">懒人 VIP 视频解析</a></td><td align="left"><a href="https://greasyfork.org/zh-CN/scripts/449203">非常简洁视频解析</a></td><td align="left"><a href="https://greasyfork.org/zh-CN/scripts/472455">落雪视频解析</a></td></tr></tbody></table><h2 id="9、电脑软件"><a href="#9、电脑软件" class="headerlink" title="9、电脑软件"></a>9、电脑软件</h2><p>如果你不想记那么多的网站。</p><p>想直接有一款软件能囊括所有网站的话，推荐 <strong>ZY Player</strong>。</p><p><strong>ZY Player</strong> 是一款开源的、跨平台的电脑端视频播放器，支持 Windows、macOS、Linux 多个平台。</p><p>项目：<a href="https://github.com/Hiram-Wong/ZyPlayer">https://github.com/Hiram-Wong/ZyPlayer</a></p><p>下载：<a href="https://ghproxy.com/https://github.com/Hiram-Wong/ZyPlayer/releases/download/v3.2.7/zyplayer-win-3.2.7-x64.exe">Windows 版</a>、<a href="https://ghproxy.com/https://github.com/Hiram-Wong/ZyPlayer/releases/download/v3.2.7/zyplayer-mac-3.2.7-x64.dmg">Mac Intel 版</a>、<a href="https://ghproxy.com/https://github.com/Hiram-Wong/ZyPlayer/releases/download/v3.2.7/zyplayer-mac-3.2.7-arm64.dmg">Mac ARM 版</a></p><p><strong>使用方法：</strong></p><p><strong>ZY Player</strong> 使用的是接口解析的方式，因此需要订阅 m3u8 链接。推荐链接：来自 <a href="https://github.com/ls125781003/dmtg">@ls125781003</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://gcore.jsdelivr.net/gh/ls125781003/dmtg/zy.json</span><br><span class="line">https://gcore.jsdelivr.net/gh/ls125781003/dmtg/zy_yuan.json</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231215222125.png"></p><p>订阅链接后，ZY Player 就会展示所有可用源，主要包括<strong>影视、电视、解析</strong>三个部分。</p><p><strong>在线影视：</strong></p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231215222145.png"></p><p><strong>电视直播：</strong></p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231215222205.png"></p><p><strong>视频解析：</strong></p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20231215222223.png"></p><h2 id="10、手机APP"><a href="#10、手机APP" class="headerlink" title="10、手机APP"></a>10、手机APP</h2><p>安卓上安装 APP 很简单，但 iOS 就比较麻烦了。</p><p>一种方法是通过安装“<strong>描述文件</strong>” 来安装，另一种是“<strong>伪装上架</strong>”应用到 App Store。</p><p>也就是 App 看上去是一个普通应用，但只要点某个按钮，又或者输入某个关键字，应用就会<strong>变身为影视 App</strong>。</p><p>如果打开的伪装应用 App Store 链接，提示地区不支持，那么说明 App 已经下架。</p><table><thead><tr><th align="left">▼ <strong>安卓</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://cupfox.app/app">茶杯狐</a></td><td align="left"><a href="https://www.looo.top/">龙门影视</a></td><td align="left"><a href="https://cokemv.me/index.php/label/down.html">COKEMV</a></td><td align="left"><a href="https://tbsdy.com/download.html">土拨鼠电影</a></td></tr><tr><td align="left"><a href="http://www.zhuijuapp.com/">追剧影院</a></td><td align="left"><a href="https://www.dmmd.tv/">萌妹视频</a></td><td align="left"><a href="https://ikaola.tv/app/">考拉TV</a></td><td align="left"><a href="https://555dy.shop/">555 电影</a></td></tr><tr><td align="left"><a href="https://dsxys.pro/app/">大师兄影视</a></td><td align="left"><a href="https://danboxingqiu.github.io/">蛋播星球</a></td><td align="left"><a href="https://lekan.app/">乐看视频</a></td><td align="left"><a href="https://www.akuaizi.vip/">筷子视频</a></td></tr><tr><td align="left"><a href="https://www.yzys.app/">柚子影视</a></td><td align="left"><a href="https://yrzj.tv/">伊人追剧</a></td><td align="left"><a href="https://www.dmys.tv/">大米星球</a></td><td align="left"><a href="https://jinju1.app/">加菲猫影视</a></td></tr><tr><td align="left"><a href="https://qcjlpro.com/">青橙影视</a></td><td align="left"><a href="https://heib.cc/">黑豹影视</a></td><td align="left"><a href="https://mj2.app/">AG美剧</a></td><td align="left"></td></tr><tr><td align="left">▼ <strong>iOS</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://apps.apple.com/cn/app/id1594160763">电视直播</a></td><td align="left"><a href="https://apps.apple.com/cn/app/id1322243737">今日影视</a></td><td align="left"><a href="https://apps.apple.com/cn/app/id1135798414">影视大全</a></td><td align="left"><a href="https://apps.apple.com/cn/app/id1525688578">月亮播放器</a></td></tr><tr><td align="left"><a href="https://apps.apple.com/cn/app/id1630151775?platform=ipad">美剧TV</a></td><td align="left"><a href="https://apps.apple.com/cn/app/%E6%B8%AF%E5%89%A7tv-%E6%B8%AF%E5%89%A7%E7%BD%91/id1510213105">港剧TV</a></td><td align="left"></td><td align="left"></td></tr></tbody></table><table><thead><tr><th align="left">▼ <strong>伪装上架</strong></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.dmmd.tv/iosdownload.html">萌妹影视</a></td><td align="left">点击“意见反馈”，在最上面输入框中输入：萌妹，点击提交后，重新打开即可。</td></tr><tr><td align="left"><a href="https://apps.apple.com/cn/app/id1465366080">蚂蚁书签</a></td><td align="left">点击右上角“齿轮”，选择“联系作者–&gt;点我恢复备份”，就会导入影视网站。</td></tr></tbody></table><h2 id="11、电视盒子"><a href="#11、电视盒子" class="headerlink" title="11、电视盒子"></a>11、电视盒子</h2><table><thead><tr><th align="left">▼ <strong>电视盒子</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.lanzoui.com/b0f1944aj">423Down TV</a> 👍</td><td align="left"><a href="https://docs.qq.com/doc/DRXhVYWF0cEpwV2FF">电视 TV 玩法大全</a></td><td align="left"><a href="http://www.miaokantv.cn/">秒看电视</a></td><td align="left"><a href="https://ikaola.tv/app/">考拉TV</a></td></tr><tr><td align="left"><a href="https://www.idianshijia.com/">电视家</a></td><td align="left"><a href="http://m.ismartv.cn/tv/introductionTV">电视猫视频</a></td><td align="left"><a href="http://mingri.tv/">明日影视</a></td><td align="left"><a href="http://tvhuoxing.com/">火星直播</a></td></tr><tr><td align="left"><a href="http://www.yunhitv.com/">云海电视</a></td><td align="left"></td><td align="left"></td><td align="left"></td></tr></tbody></table><h2 id="12、电影下载"><a href="#12、电影下载" class="headerlink" title="12、电影下载"></a>12、电影下载</h2><p>如果想看高清、超高清、无广告、无删减的电影，则需要单独下载，一般有<strong>磁力</strong>和<strong>网盘</strong>两种下载形式。</p><table><thead><tr><th align="left">▼ <strong>磁力下载</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://www.cilixiong.com/">磁力熊</a></td><td align="left"><a href="https://www.yinfans.me/">音范丝</a></td><td align="left"><a href="https://www.btsj6.com/">BT世界网</a></td><td align="left"><a href="https://www.mini4k.com/">MINI4K</a></td></tr><tr><td align="left"><a href="https://seedhub.info/">SeedHub</a></td><td align="left"><a href="https://www.2bt0.com/">不太灵影视</a></td><td align="left"><a href="https://4kysxz.top/">4K影视小站</a></td><td align="left"><a href="https://www.bugutv.org/">布谷TV</a></td></tr><tr><td align="left"><a href="https://www.hao6v.tv/">6v电影</a></td><td align="left"><a href="https://www.dygang.cc/">电影港</a></td><td align="left"><a href="https://yyets.click/search">人人影视</a></td><td align="left"><a href="https://www.mp4us.com/">Mp4电影</a></td></tr><tr><td align="left"><a href="https://www.yikedy.cc/">一刻电影</a></td><td align="left"><a href="https://www.xl720.com/">迅雷电影天堂</a></td><td align="left"><a href="https://www.gaoqingw.com/">高清网</a></td><td align="left"><a href="https://gaoqing.la/">中国高清网</a></td></tr><tr><td align="left"><a href="https://btbtt18.com/">BT之家</a></td><td align="left"><a href="https://www.dygod.net/">电影天堂</a></td><td align="left"><a href="https://yts.mx/">YTS</a></td><td align="left"><a href="https://www.btbuluo.net/">BT部落天堂</a></td></tr><tr><td align="left"><a href="https://torrentgalaxy.to/">Torrent Galaxy</a></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>网盘下载</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://nmme.xyz/">橘子盘搜</a></td><td align="left"><a href="https://xunso.fun/">迅搜搜</a></td><td align="left"><a href="https://res.yunpan.win/">云盘资源</a></td><td align="left"><a href="http://m.kkkob.com/apps/index.html?id=211229kl">数据搜索</a></td></tr><tr><td align="left"><a href="https://nzmz.xyz/index.html">NEW字幕组</a></td><td align="left"><a href="https://www.xinjuc.com/">新剧场</a></td><td align="left"><a href="https://ppxzy.net/">皮皮虾资源</a></td><td align="left"><a href="https://susuifa.com/">SuSu Share</a></td></tr><tr><td align="left"><a href="https://xzys.fun/">校长影视</a></td><td align="left"><a href="https://www.rrdynb.com/index.html">人人电影网</a></td><td align="left"><a href="http://www.xyxz001.com/">夕阳小站</a></td><td align="left"><a href="https://wanwansub.com/">弯弯字幕组</a></td></tr></tbody></table><h2 id="13、字幕台词"><a href="#13、字幕台词" class="headerlink" title="13、字幕台词"></a>13、字幕台词</h2><p>大多数原语种资源（无删减、无广告）都没有字幕，为此，你需要单独下载字幕。</p><table><thead><tr><th align="left">▼ <strong>电影字幕</strong></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left"><a href="https://zimuku.org/">字幕库</a></td><td align="left"><a href="https://subhd.tv/">SubHD</a></td><td align="left"><a href="https://assrt.net/">射手网(伪)</a></td><td align="left"><a href="https://www.ddzimu.com/">点点字幕</a></td></tr><tr><td align="left"><a href="https://cn.zimuzimu.net/">中文字幕网</a></td><td align="left"><a href="https://a4k.net/">A4K字幕</a></td><td align="left"><a href="https://www.rikua.com/">日夸字幕</a></td><td align="left"></td></tr><tr><td align="left"><a href="https://subbers.org/subtitles/">Subbers</a> (动漫)</td><td align="left"><a href="https://r3sub.com/">R3字幕網</a>（繁体）</td><td align="left"><a href="https://www.subtitlecat.com/">Subtitle Cat</a> (番号)</td><td align="left"></td></tr><tr><td align="left">▼ <strong>英文字幕</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://subscene.com/">Subscene</a></td><td align="left"><a href="https://www.opensubtitles.org/en/search/subs">OpenSubtitles</a></td><td align="left"><a href="https://subflicks.com/">SubFlicks</a></td><td align="left"><a href="https://www.addic7ed.com/">Addic7ed</a></td></tr><tr><td align="left">▼ <strong>电影台词</strong></td><td align="left"></td><td align="left"></td><td align="left"></td></tr><tr><td align="left"><a href="https://33.agilestudio.cn/">33台词</a></td><td align="left"><a href="https://zhaotaici.cn/">找台词</a></td><td align="left"><a href="https://www.quodb.com/">QuoDB</a>（英文）</td><td align="left"><a href="https://dialogue.moe/">Dialogue</a>（动漫）</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
            <tag> 影视 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>音乐导航</title>
      <link href="/2023/09/27/%E9%9F%B3%E4%B9%90%E5%AF%BC%E8%88%AA/"/>
      <url>/2023/09/27/%E9%9F%B3%E4%B9%90%E5%AF%BC%E8%88%AA/</url>
      
        <content type="html"><![CDATA[<h1 id="音乐导航"><a href="#音乐导航" class="headerlink" title="音乐导航"></a>音乐导航</h1><hr><h2 id="1、音乐搜索"><a href="#1、音乐搜索" class="headerlink" title="1、音乐搜索"></a>1、音乐搜索</h2><p>要说 Mp3 搜索和下载的“<strong>众神之王</strong>”，<strong>MyFreeMp3</strong> 当之无愧。</p><p>地址：<a href="https://myfreemp3juices.cc/">https://myfreemp3juices.cc</a></p><p><strong>特点 1：资源齐全</strong></p><p>网站资源丰富，超过 1 亿首音乐。</p><p>比 Apple Store 还齐全，包括已经下架的音乐也能搜索，比如“<strong>PG One</strong>”的歌，堪称音乐界的 <strong>Z-library</strong>。</p><p><strong>特点 2：提供下载</strong></p><p>除了支持在线收听，网站还提供了 <strong>320Kbps</strong> 的 Mp3 下载，要知道这个比特率已经十分接近无损音乐。</p><p>而它的体积，只有无损音乐的 <strong>1&#x2F;3</strong>。</p><p><strong>特点 3：免费无限制</strong></p><p>网站无需注册，没有限制，支持中文等多种语言，国内也可以正常访问，音乐搜索里唯一的神，无误了。</p><p><strong>类似网站：</strong>下面的这些网站与 <strong>MyFreeMp3</strong> 类似，资源也很齐全。</p><table><thead><tr><th align="left">▼ <strong>国外应用</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://new.myfreemp3juices.cc/">MyFreeMp3</a></td><td align="left">免注册、支持下载、资源丰富，支持下架音乐。👍</td></tr><tr><td align="left">🌐 <a href="https://freemp3cloud.com/">Free Mp3 Cloud</a></td><td align="left">免注册、支持下载、资源丰富，支持下架音乐。👍</td></tr><tr><td align="left">🌐 <a href="https://slider.kz/">Slider.kz</a></td><td align="left">免注册、支持下载、资源丰富，支持下架音乐。👍</td></tr><tr><td align="left">🌐 <a href="https://free-mp3-download.net/">Free MP3 Down</a></td><td align="left">免注册、支持下载、支持无损下载。👍</td></tr><tr><td align="left">🌐 <a href="https://v2.mp3paw.link/">MP3Paw</a></td><td align="left">免注册、支持下载、内容来自 U2B。👍</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>国内应用</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://mu-jie.cc/musicBox/">昔枫音乐盒</a></td><td align="left">免注册、支持下载、支持歌单。</td></tr><tr><td align="left">🌐 <a href="https://zz123.com/">zz123音乐</a></td><td align="left">免注册、支持下载、支持歌单。</td></tr><tr><td align="left">🌐 <a href="https://tonzhon.com/">钟铜</a></td><td align="left">免注册、支持下载、支持歌单。</td></tr><tr><td align="left">🌐 <a href="https://bailemi.com/dance">百乐米</a></td><td align="left">免注册、支持下载、支持歌单。</td></tr><tr><td align="left">🌐 <a href="https://www.gequbao.com/">歌曲宝</a></td><td align="left">免注册、支持下载、支持歌词。</td></tr><tr><td align="left">🌐 <a href="https://www.fangpi.net/">放屁网</a></td><td align="left">免注册、支持下载、支持歌词。</td></tr><tr><td align="left">🌐 <a href="https://music.dogged.cn/">顽狗音乐</a></td><td align="left">免注册、支持下载、支持歌词。</td></tr><tr><td align="left">🌐 <a href="https://tool.liumingye.cn/music/#/">Liumingye</a></td><td align="left">免注册、支持下载、支持歌词。</td></tr><tr><td align="left">🌐 <a href="https://www.musicenc.com/">MusicEnc</a></td><td align="left">免注册、支持下载、支持歌词，但不支持版权音乐。</td></tr><tr><td align="left">🌐 <a href="https://www.shiyinren.com/">拾音人</a></td><td align="left">免注册、支持下载、支持 MTV 下载，支持无损音质下载。</td></tr></tbody></table><h2 id="2、听歌应用"><a href="#2、听歌应用" class="headerlink" title="2、听歌应用"></a>2、听歌应用</h2><p>桌面端听歌，可以选择<strong>洛雪音乐助手</strong>。</p><p>它是一款<strong>高颜值的第三方音乐播放软件</strong>，基于 Electron + Vue 开发，是 GitHub 上的开源音乐搜索软件。</p><p>支持在线搜索和收听，下载功能需要在“<strong>设置</strong>”里手动开启。</p><p>官网地址：<a href="https://lxmusic.toside.cn/">https://lxmusic.toside.cn/</a></p><p>项目地址：<a href="https://github.com/lyswhut/lx-music-desktop">https://github.com/lyswhut/lx-music-desktop</a></p><p><strong>桌面端</strong>：支持 Windows、Mac、Linux。下载：[<a href="https://github.com/lyswhut/lx-music-desktop/releases">GitHub 下载</a>]、[<a href="https://www.lanzoui.com/b0bf2cfa">网盘下载</a>]、密码：glqw</p><p><strong>手机端</strong>：支持 安卓，不支持 iOS。下载：[<a href="https://github.com/lyswhut/lx-music-mobile/releases">GitHub 下载</a>]、[<a href="https://www.lanzoui.com/b0bf2cfa">网盘下载</a>]、密码：glqw</p><p><strong>浏览器</strong>：可配合脚本一键调用播放，地址：<a href="https://greasyfork.org/zh-CN/scripts/438148">https://greasyfork.org/zh-CN/scripts/438148</a></p><table><thead><tr><th align="left">▼ <strong>桌面应用</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">📥 <a href="https://github.com/lyswhut/lx-music-desktop">洛雪音乐</a></td><td align="left">音乐搜索软件，支持版权音乐，支持 Windows、Mac、Linux</td></tr><tr><td align="left">📜 <a href="https://greasyfork.org/zh-CN/scripts/438148">洛雪音乐脚本</a></td><td align="left">从网页端一键调用洛雪音乐来播放“<strong>灰色</strong>”音乐</td></tr><tr><td align="left">📥 <a href="https://listen1.github.io/listen1/">Listen1</a></td><td align="left">多平台聚合音乐播放软，支持 Win、Mac、Linux</td></tr><tr><td align="left">📥 <a href="https://cider.sh/">Cider</a></td><td align="left">Apple Music 第三方客户端，支持 Win、Mac、Linux</td></tr><tr><td align="left">📥 <a href="https://github.com/qier222/YesPlayMusic">YesPlayMusic</a></td><td align="left">高颜值第三方网易云播放器，支持 Win、Mac、Linux</td></tr><tr><td align="left">📥 <a href="https://423down.lanzouo.com/iAYaX0nd8icf">酷我音乐 PC 版</a></td><td align="left">酷我音乐 PC 去广告豪华版，由 423Down 维护。<a href="https://423down.lanzouo.com/iAYaX0nd8icf">🪟</a></td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>手机应用</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">📥 <a href="https://www.kuwo.cn/">酷我音乐 APP</a></td><td align="left">酷我音乐 APP 豪华版，由 423Down 维护，仅支持安卓。<a href="https://www.lanzouo.com/b0f3nm6rc">🤖</a></td></tr><tr><td align="left">📥 <a href="https://github.com/lyswhut/lx-music-mobile">洛雪音乐 APP</a></td><td align="left">音乐搜索软件，支持版权音乐，仅支持安卓。<a href="https://www.lanzouy.com/b07pq1lja">🤖</a></td></tr><tr><td align="left">📥 <a href="https://mu-jie.cc/musicBox/">昔枫音乐盒</a></td><td align="left">音乐搜索软件，支持版权音乐，仅支持安卓。<a href="https://www.lanzouy.com/b07pq1lja">🤖</a></td></tr></tbody></table><h2 id="3、浏览器扩展"><a href="#3、浏览器扩展" class="headerlink" title="3、浏览器扩展"></a>3、浏览器扩展</h2><table><thead><tr><th align="left">▼ <strong>音乐扩展</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🔷 音乐收听</td><td align="left"><a href="https://listen1.github.io/listen1/">Listen 1</a>，聚合网易云音乐、QQ音乐、酷狗等网站的歌曲。👍 <a href="https://github.com/windmiles/listen1_firefox_extension/releases">🟠</a> <a href="https://chrome.google.com/webstore/detail/listen-1/indecfegkejajpaipjipfkkbedgaodbp">🟢</a> <a href="https://microsoftedge.microsoft.com/addons/detail/listen-1/hneiglcmpeedblkmbndhfbeahcpjojjg">🔵</a></td></tr><tr><td align="left">🔷 广播收听</td><td align="left"><a href="https://chrome.google.com/webstore/detail/search-to-play-the-song/anfmgjkkbagjfdejhbjdiapgkbhpigpm?hl=zh-CN">Search to Play the Song</a>，可以说是 Listen 1的简洁版，还能听广播。<a href="https://chrome.google.com/webstore/detail/search-to-play-the-song/anfmgjkkbagjfdejhbjdiapgkbhpigpm">🟢</a></td></tr><tr><td align="left">📜 歌词展示</td><td align="left">脚本 <a href="https://greasyfork.org/zh-CN/scripts/386259">U2B Genius Lyrics</a> 更好，支持显示播放音乐的歌词。<a href="https://greasyfork.org/zh-CN/scripts/386259">📜</a>（<a href="https://robwu.nl/lyricshere/">扩展方案</a>）</td></tr><tr><td align="left">🔷 歌曲识别¹</td><td align="left"><a href="https://www.aha-music.com/">AHA Music</a>，识别当前浏览器播放中的歌曲，还支持本地音乐。<a href="https://addons.mozilla.org/zh-CN/firefox/addon/song-identifier/?src=search">🟠</a> <a href="https://chrome.google.com/webstore/detail/aha-music-music-identifie/dpacanjfikmhoddligfbehkpomnbgblf">🟢</a> <a href="https://microsoftedge.microsoft.com/addons/detail/aha-music-music-identif/ejfccgmelcclnoadalcepdmnpgcnglfc">🔵</a></td></tr><tr><td align="left">🔷 歌曲识别²</td><td align="left"><a href="https://chrome.google.com/webstore/detail/%E4%BA%91%E9%9F%B3%E4%B9%90%E5%90%AC%E6%AD%8C/kemcalcncfhmdkgglekijclbomdoohkp">云音乐听歌</a>，网易云音乐官方出品的歌曲识别工具。️<a href="https://chrome.google.com/webstore/detail/%E4%BA%91%E9%9F%B3%E4%B9%90%E5%90%AC%E6%AD%8C/kemcalcncfhmdkgglekijclbomdoohkp">🟢</a></td></tr><tr><td align="left">🔷 音量增强</td><td align="left"><a href="https://www.petasittek.com/">Volume Master</a>，简单可靠的音量增强器，最高 **600%**。<a href="https://addons.mozilla.org/zh-CN/firefox/addon/600-sound-volume/">🟠</a> <a href="https://chrome.google.com/webstore/detail/volume-master/jghecgabfgfdldnmbfkhmffcabddioke">🟢</a></td></tr><tr><td align="left">🔷 文本阅读</td><td align="left"><a href="https://readaloud.app/">Read Aloud</a>，朗读网页内容，同时支持微软和谷歌的语音库。<a href="https://addons.mozilla.org/zh-CN/firefox/addon/read-aloud/">🟠</a> <a href="https://chrome.google.com/webstore/detail/read-aloud-a-text-to-spee/hdhinadidafjejdhmfkjgnolgimiaplp">🟢</a> <a href="https://microsoftedge.microsoft.com/addons/detail/read-aloud-%E6%96%87%E6%9C%AC%E8%AF%AD%E9%9F%B3%E6%9C%97%E8%AF%BB%E5%8A%A9%E7%90%86/pnfonnnmfjnpfgagnklfaccicnnjcdkm">🔵</a></td></tr><tr><td align="left">📜 音频下载</td><td align="left">脚本 <a href="https://greasyfork.org/zh-CN/scripts/382057">音视频通用下载器</a>，点击页面右边按钮打开菜单下载。<a href="https://greasyfork.org/zh-CN/scripts/382057">📜</a>（<a href="https://mediasave.ru/en/">扩展方案</a>）</td></tr></tbody></table><h2 id="4、网易云音乐"><a href="#4、网易云音乐" class="headerlink" title="4、网易云音乐"></a>4、网易云音乐</h2><p>不得不承认，听歌应用也是存在“<strong>鄙视链</strong>”的。</p><p>除了 Apple Music，网易云音乐可以说是听歌应用里的“<strong>新浪微博</strong>”，很多原创歌手都在“<strong>云村</strong>”里集合。</p><p>因此，网易云音乐是很多人听歌的<strong>第一选择</strong>。</p><p><strong>4.1、BetterNCM</strong></p><p>但网易云音乐客户端，并是怎么好用。</p><p>因此，有一个叫 <strong>BetterNCM</strong> 的增强插件诞生了，它可以通过自定义插件，为网易云音乐实现各类新功能。</p><p>主要包括“<strong>扩展</strong>”和“<strong>主题</strong>”两个部分，与浏览器的使用方法类似。</p><p>项目主页：<a href="https://github.com/MicroCBer/BetterNCM">https://github.com/MicroCBer/BetterNCM</a></p><p>一键安装：<a href="https://github.com/MicroCBer/BetterNCM-Installer">https://github.com/MicroCBer/BetterNCM-Installer</a></p><p>使用文档：<a href="https://v2e2npdz15.feishu.cn/docx/UZkSd9d46o4fVOxaPNBcGXSenme">https://v2e2npdz15.feishu.cn/docx/UZkSd9d46o4fVOxaPNBcGXSenme</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax2.sinaimg.cn/large/7a6a15d5gy1hho9q029pxj22801e0npe.jpg" alt="S17_BetterNCM"></p><p><strong>4.2、Go Musicfox</strong></p><p>如果你不想要那么多<strong>花里胡哨</strong>的功能，就想单纯的听歌。</p><p>使用 Go 语言编写的网易音乐“<strong>命令行</strong>”客户端 <strong>Go Musicfox</strong> 是一个不错的选择。</p><p>支持 Windows 、Mac 、Linux。</p><p>它可以通过命令行的方式实现登录、播放、下载、搜索、歌词、Last.fm、签到等功能。</p><p>按快捷键 <strong>D</strong> 就是下载前当播放的音乐。</p><p>下载地址：<a href="https://github.com/go-musicfox/go-musicfox/releases">https://github.com/go-musicfox/go-musicfox/releases</a></p><p>代理下载：<a href="https://githubfast.com/go-musicfox/go-musicfox/releases">https://githubfast.com/go-musicfox/go-musicfox/releases</a></p><p><img src="https://image.baidu.com/search/down?url=https://tvax1.sinaimg.cn/large/7a6a15d5gy1hho9q0gci7j21uo18aqei.jpg" alt="S17_MusicFox"></p><p><strong>4.3、UnblockNeteaseMusic</strong></p><p>但一些歌曲，由于版权被买断，导致网易云音乐曲库少，因为很多音乐都没办法听。</p><p>插件 <a href="https://github.com/nondanee/UnblockNeteaseMusic">UnblockNeteaseMusic</a>，则可以自动使用各类音源替换变灰歌曲链接，包括 QQ &#x2F; 酷狗 &#x2F; 酷我 等音源。</p><p>使用方法一：<strong>BetterNCM 插件</strong></p><p>项目地址：<a href="https://github.com/nondanee/UnblockNeteaseMusic">https://github.com/nondanee/UnblockNeteaseMusic</a></p><p>一键安装：<a href="https://github.com/ReviveUnblockNCMInstaller/RevivedUnblockInstaller">https://github.com/ReviveUnblockNCMInstaller/RevivedUnblockInstaller</a></p><p>使用方法二：<strong>独立安装包</strong></p><p>独立插件包一键安装，可参考 52pojie 论坛文章：<a href="https://www.52pojie.cn/thread-1664098-1-1.html">https://www.52pojie.cn/thread-1664098-1-1.html</a></p><h2 id="5、本地播放器"><a href="#5、本地播放器" class="headerlink" title="5、本地播放器"></a>5、本地播放器</h2><table><thead><tr><th align="left"><strong>▼ Win 播放器</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">📥 <a href="https://github.com/clsid2/mpc-hc">MPC-HC</a></td><td align="left">纯碎的、小巧的、极致快速的音乐播放器，MPC-HC 的 Fork 版本。</td></tr><tr><td align="left">📥 <a href="https://github.com/Aleksoid1978/MPC-BE">MPC-BE</a></td><td align="left">纯碎的、小巧的、极致快速的的音乐播放器，MPC-HC 的 BE 版本。</td></tr><tr><td align="left">📥 <a href="https://www.foobar2000.org/">Foobar2000</a></td><td align="left">插件丰富，支持高度定制化的音乐播放器，推荐配置 <a href="https://github.com/dream7180/foobox-cn">Foobox</a>。</td></tr><tr><td align="left">📥 <a href="https://www.videolan.org/index.zh.html">VLC</a></td><td align="left">开源的多媒体播放器，支持几乎所有音视频格式，全平台支持。</td></tr><tr><td align="left">📥 <a href="http://www.aimp.ru/">AIMP</a></td><td align="left">来自俄罗斯的一款多媒体播放器（非开源），支持 Win、安卓。</td></tr><tr><td align="left">📥 <a href="https://www.winamp.com/">Winamp</a></td><td align="left">化石级播放器，现已重新回归，并拥有了全新的设计，仅支持 Windows。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>Mac 播放器</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">📥 <a href="https://iina.io/">IINA</a></td><td align="left">可能是 Mac 最受欢迎的多媒体播放器，开源免费，简洁美观。</td></tr><tr><td align="left">📥 <a href="https://www.foobar2000.org/">Foobar2000</a></td><td align="left">支持高度定制化的音乐播放器，现在也支持 Mac 版本了。</td></tr><tr><td align="left">📥 <a href="https://github.com/ddddxxx/LyricsX">LyricsX</a></td><td align="left">Mac 下的歌词辅助工具，支持搜索和滚动显示歌词，支持本地任何播放器。</td></tr></tbody></table><h2 id="6、无损音乐"><a href="#6、无损音乐" class="headerlink" title="6、无损音乐"></a>6、无损音乐</h2><p>下面的这些网站免费并提供了下载，但部分需要注册、或者关注公众号才能下载。</p><table><thead><tr><th align="left">▼ <strong>无损音乐</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://free-mp3-download.net/">Free MP3 Down</a></td><td align="left">免登陆、三种格式 👍</td></tr><tr><td align="left">🌐 <a href="https://xiageba.com/">下歌吧</a></td><td align="left">免登陆、网盘下载 👍</td></tr><tr><td align="left">🌐 <a href="https://www.xmwav.com/">熊猫无损音乐</a></td><td align="left">免登陆、网盘下载</td></tr><tr><td align="left">🌐 <a href="http://www.23ape.net/">23ape.net</a></td><td align="left">免登陆、网盘下载</td></tr><tr><td align="left">🌐 <a href="https://tieba.baidu.com/f?kw=%E6%97%A0%E6%8D%9F%E9%9F%B3%E4%B9%90">无损音乐吧</a></td><td align="left">免登陆、网盘下载</td></tr><tr><td align="left">🌐 <a href="https://mp3bst.com/">MP3BST</a></td><td align="left">免登陆、城通网盘下载</td></tr><tr><td align="left">🌐 <a href="http://www.52wusun.com/">我爱无损音乐网</a></td><td align="left">免登陆、城通网盘下载</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>无损音乐（登陆）</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://www.hifini.com/">HiFiNi</a></td><td align="left">要登陆、网盘下载。（需要注册，登陆后即可无限制使用。）</td></tr><tr><td align="left">🌐 <a href="https://www.cdbao.net/">CD包音乐网</a></td><td align="left">要登陆、网盘下载</td></tr><tr><td align="left">🌐 <a href="https://wusunyinyue.cn/">无损音乐网</a></td><td align="left">要登陆、网盘下载</td></tr><tr><td align="left">🌐 <a href="http://www.ape-flac.com/">无损音乐</a></td><td align="left">要登陆、网盘下载</td></tr><tr><td align="left">🌐 <a href="https://sacdr.net/">易音</a></td><td align="left">要登陆、网盘下载</td></tr><tr><td align="left">🌐 <a href="https://www.onelai.cn/">万籁音乐</a></td><td align="left">要关注公众号、网盘下载</td></tr><tr><td align="left">🌐 <a href="https://www.xlebbs.com/">享乐音乐论坛</a></td><td align="left">要登陆、网盘下载、部分收费</td></tr><tr><td align="left">🌐 <a href="https://www.dtshot.com/">DTshot</a></td><td align="left">要登陆、网盘下载、部分收费</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>无损资源</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">📥 资源 1</td><td align="left">🔗 <a href="https://www.aliyundrive.com/s/fTHhCLg1J3W">洛雪音乐 200T 音乐大合集</a>、🔗 <a href="https://www.aliyundrive.com/s/xymEytGyymx/folder/6190bd57c147df52764f45f2b7d0157a2c95c220">2 万首音乐 MTV</a></td></tr><tr><td align="left">📥 资源 2</td><td align="left">🔗 <a href="https://pan.quark.cn/s/f98de583cff9#/list/share">美国 Billboard Top100</a>、🔗 <a href="https://www.aliyundrive.com/s/7yE49zBCHr8">老歌珍藏 一人一首成名曲</a></td></tr><tr><td align="left">📥 资源 3</td><td align="left">🔗 <a href="https://cloud.189.cn/web/share?code=Jj2MravyQ7fe">豆瓣音乐Top250无损音乐</a>、🔗 <a href="https://www.aliyundrive.com/s/kT6accQfFow">700G 无损音乐</a></td></tr><tr><td align="left">📥 资源 4</td><td align="left">🔗 <a href="https://www.aliyundrive.com/s/QNnwcyZJrTK">世界名曲 6CD</a>、🔗 <a href="https://www.aliyundrive.com/s/Xyobrwvm7K1">班得瑞全14张专辑</a></td></tr><tr><td align="left">📥 资源 5</td><td align="left">🔗 <a href="https://www.aliyundrive.com/s/yK1tK7Y38mL">中国戏曲大全mp3格式</a></td></tr><tr><td align="left">📥 资源 6</td><td align="left">🔗 <a href="https://lvyueyang.github.io/web-music/">周杰伦所有音乐在线听</a>、🔗 <a href="https://www.aliyundrive.com/s/VEoHM3CQrzy">周杰伦张专辑无损珍藏版</a></td></tr><tr><td align="left">📥 资源 7</td><td align="left">🔗 <a href="https://www.aliyundrive.com/s/Pkjzg69LXiG">邓丽君195首无损</a>、🔗 <a href="https://www.aliyundrive.com/s/GYs3v6pg7N7">久石让 51张专辑无损</a></td></tr></tbody></table><h2 id="7、白噪音"><a href="#7、白噪音" class="headerlink" title="7、白噪音"></a>7、白噪音</h2><table><thead><tr><th align="left">▼ <strong>白噪音</strong></th><th align="left"><strong>简介</strong></th></tr></thead><tbody><tr><td align="left">🌐 <a href="https://raining.fm/">Raining FM</a></td><td align="left">下雨音效。</td></tr><tr><td align="left">🌐 <a href="https://rainyscope.com/">Rainyscope</a></td><td align="left">下雨音效。</td></tr><tr><td align="left">🌐 <a href="https://www.rainymood.com/">Rainy Mood</a></td><td align="left">下雨音效。</td></tr><tr><td align="left">🌐 <a href="https://www.tree.fm/">Tree.FM</a></td><td align="left">森林音效。</td></tr><tr><td align="left">🌐 <a href="https://earth.fm/">Earth.FM</a></td><td align="left">森林音效，各地风景都有。</td></tr><tr><td align="left">🌐 <a href="https://virtocean.com/#">Virtual Ocean</a></td><td align="left">海洋音效，可自定义混合。</td></tr><tr><td align="left">🌐 <a href="https://defonic.com/">Defonic</a></td><td align="left">自然音效，可自定义混合。</td></tr><tr><td align="left">🌐 <a href="https://asoftmurmur.com/">A Soft Murmur</a></td><td align="left">自然音效，可自定义混合。</td></tr><tr><td align="left">🌐 <a href="https://www.noisli.com/">Noisli</a></td><td align="left">自然音效，可自定义混合，需要登陆使用。</td></tr><tr><td align="left">🌐 <a href="https://music.163.com/#/artist?id=22095">NSSJP</a></td><td align="left">自然音效，网易云音乐播放，日本自然之声协会出品。</td></tr><tr><td align="left">📥 <a href="https://github.com/jenius-apps/ambie">Ambie</a></td><td align="left">自然音效，一款播放自然声音的应用程序，仅支持 Windows。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>场景音效</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://soundofcolleagues.com/">SoundColleague</a></td><td align="left">大学教室场景。</td></tr><tr><td align="left">🌐 <a href="https://imisstheoffice.eu/">IMissTheOffice</a></td><td align="left">办公室场景。</td></tr><tr><td align="left">🌐 <a href="https://coffitivity.com/">Coffitivity</a></td><td align="left">咖啡馆场景。</td></tr><tr><td align="left">🌐 <a href="http://imissmybar.com/">I Miss My Bar</a></td><td align="left">酒吧场景。</td></tr><tr><td align="left">🌐 <a href="https://www.window-swap.com/">WindowSwap</a></td><td align="left">窗外场景，需要登陆使用。</td></tr><tr><td align="left">🌐 <a href="https://www.thisisathing.io/">This is a thing</a></td><td align="left">冥想音效。</td></tr><tr><td align="left">🌐 <a href="https://www.calm.com/">Calm</a></td><td align="left">冥想和睡眠音效，但只有“<a href="https://www.calm.com/app/scenes">白噪音</a>”是免费的，需要登陆使用。</td></tr><tr><td align="left">🌐 <a href="https://app.lofi.co/">Lofi.co</a></td><td align="left">生产力音效，提供各种高质量场景，但免费只能用 2 个。</td></tr><tr><td align="left">🌐 <a href="https://tide.fm/zh_CN/">潮汐</a></td><td align="left">主打自然，场景，环境音乐，冥想音乐等综合性网站，支持 APP 和扩展。</td></tr><tr><td align="left">🌐 <a href="https://www.ppbzy.com/">泡泡白噪音</a></td><td align="left">主打场景白噪音，可自定义混合。</td></tr><tr><td align="left"></td><td align="left"></td></tr><tr><td align="left">▼ <strong>环境音乐</strong></td><td align="left"><strong>简介</strong></td></tr><tr><td align="left">🌐 <a href="https://mynoise.net/">myNoise</a></td><td align="left">环境音乐。</td></tr><tr><td align="left">🌐 <a href="https://kaizenflow.co/">Kaizen Flow</a></td><td align="left">工作音效，同时支持“番茄时钟”。</td></tr><tr><td align="left">🌐 <a href="https://www.lofly.site/">Lofly</a></td><td align="left">环境音乐+白噪音，可自定义混合，同时支持“番茄时钟”，<strong>需要魔法</strong>。</td></tr><tr><td align="left">🌐 <a href="https://melofi.app/">Melofi</a></td><td align="left">环境音乐。</td></tr><tr><td align="left">🌐 <a href="https://soundscape.world/">Soundscape</a></td><td align="left">环境音乐。</td></tr><tr><td align="left">🌐 <a href="https://www.lavaradio.com/milieumusic">LavaRadio</a></td><td align="left">高品质情景造乐师，使用<a href="https://www.lavaradio.com/shopmusic">客户端</a>（音乐宽带版），功能更齐全。👍</td></tr><tr><td align="left">🌐 <a href="https://www.lofi.cafe/">lofi.cafe</a></td><td align="left">环境音乐。</td></tr><tr><td align="left">🌐 <a href="https://www.jazzandrain.com/">JazzAndRain</a></td><td align="left">环境音乐。</td></tr><tr><td align="left">🌐 <a href="https://ambicular.com/index.html">Ambicular</a></td><td align="left">环境音乐。</td></tr><tr><td align="left">🌐 <a href="https://www.ambient-mixer.com/">Ambient Mixer</a></td><td align="left">环境音乐。</td></tr><tr><td align="left">🌐 <a href="https://www.loungev.com/">Lounge V Studio</a></td><td align="left">放松音乐+自然音效，还有 4K 超清视频，这是它的 <a href="https://www.youtube.com/@LoungeVstudio/videos">U2B 频道</a>。👍</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
            <tag> 音乐 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信小程序this.setData给对象</title>
      <link href="/2023/09/22/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8Fthis-setData%E7%BB%99%E5%AF%B9%E8%B1%A1/"/>
      <url>/2023/09/22/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8Fthis-setData%E7%BB%99%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<ol><li><h2 id="固定属性赋值"><a href="#固定属性赋值" class="headerlink" title="固定属性赋值"></a>固定属性赋值</h2></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span> <span class="attr">bind:tap</span>=<span class="string">&quot;getUserProfile&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">van-image</span></span></span><br><span class="line"><span class="tag">        <span class="attr">round</span></span></span><br><span class="line"><span class="tag">        <span class="attr">width</span>=<span class="string">&quot;5rem&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">height</span>=<span class="string">&quot;5rem&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;userInfo.avatarUrl&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">                &#123;&#123;userInfo.username&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">bind:tap</span>=<span class="string">&quot;edit&quot;</span>&gt;</span></span><br><span class="line">                编辑资料</span><br><span class="line">                <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">&quot;arrow&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">userInfo</span>:&#123;</span><br><span class="line">        <span class="attr">username</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">class</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">stuNum</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">gender</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">avatarUrl</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">getUserProfile</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    wx.<span class="title function_">getUserProfile</span>(&#123;</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&#x27;用于完善个人资料&#x27;</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> name = res.<span class="property">userInfo</span>.<span class="property">nickName</span></span><br><span class="line">        <span class="keyword">const</span> <span class="title class_">Url</span> = res.<span class="property">userInfo</span>.<span class="property">avatarUrl</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">          <span class="attr">username</span>:name,</span><br><span class="line">          <span class="attr">avatarUrl</span>:<span class="title class_">Url</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>这个时候页面上显示的是 空白</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20230922010958.png"></p><p>当我们修改的时候有2种方案</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方案一 整体赋值</span></span><br><span class="line"> </span><br><span class="line"><span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">formData</span>.<span class="property">title</span> = <span class="string">&#x27;china&#x27;</span>;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">    <span class="attr">userInfo</span>: res.<span class="property">userInfo</span>,</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 方案二 单个属性赋值</span></span><br><span class="line"><span class="keyword">const</span> name = res.<span class="property">userInfo</span>.<span class="property">nickName</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Url</span> = res.<span class="property">userInfo</span>.<span class="property">avatarUrl</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">    <span class="string">&#x27;userInfo.username&#x27;</span>:name,</span><br><span class="line">    <span class="string">&#x27;userInfo.avatarUrl&#x27;</span>:<span class="title class_">Url</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><hr><h2 id="2-动态属性赋值"><a href="#2-动态属性赋值" class="headerlink" title="2.动态属性赋值"></a>2.动态属性赋值</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:for=&quot;&#123;&#123;arr&#125;&#125;&quot; wx:for-item=&quot;item&quot; wx:key=&quot;*this&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;/view&gt;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>:&#123;</span><br><span class="line">    <span class="attr">arr</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">id</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">title</span>:<span class="string">&#x27;标题一&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">id</span>:<span class="number">2</span>,</span><br><span class="line">            <span class="attr">title</span>:<span class="string">&#x27;标题二&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改数组里对象的属性</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">    <span class="string">`[arr[<span class="subst">$&#123;index&#125;</span>].title]`</span>:<span class="string">&#x27;china&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line">或</span><br><span class="line"><span class="keyword">let</span> name = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">arr</span>[<span class="number">0</span>].<span class="property">title</span>;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">    [name]:<span class="string">&#x27;china&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>通过es6模版字符串 &#96;&#96; 的方式 key 可以作为变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view&gt;&#123;&#123;formData.a0&#125;&#125;&lt;/view&gt;</span><br><span class="line">&lt;view&gt;&#123;&#123;formData.a1&#125;&#125;&lt;/view&gt;</span><br><span class="line">&lt;view&gt;&#123;&#123;formData.a2&#125;&#125;&lt;/view&gt;</span><br></pre></td></tr></table></figure><p>循环修改</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span> ; i&lt;<span class="number">2</span> ; i++)&#123;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="string">`a<span class="subst">$&#123;i&#125;</span>`</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        [name]:<span class="string">&#x27;c&#x27;</span>+i</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//显示结果</span></span><br><span class="line"><span class="attr">a0</span>:c0</span><br><span class="line"><span class="attr">a1</span>:c1</span><br><span class="line"><span class="attr">a2</span>:c2</span><br></pre></td></tr></table></figure><h2 id="3-双向数据绑定"><a href="#3-双向数据绑定" class="headerlink" title="3.双向数据绑定"></a>3.双向数据绑定</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;名称&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123;formData.title&#125;&#125;&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">bindtap</span>=<span class="string">&quot;onSubmit&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>经过多次尝试提交 获取到的formData.title数据为空，据说加上model:value会生效，然而并没有任何效果，甚至一度怀疑人生，直到找到一篇帖子说 2.9.3以上版本才支持</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wx.getSystemInfo(&#123;</span><br><span class="line">   success: function (res) &#123;</span><br><span class="line">        console.log(&#x27;该版本号为: &#x27;,res.SDKVersion)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>&#x2F;&#x2F; 输出结果 该版本号为:  2.19.4</p><p>很显然不支持</p><p>网上搜索了一番，微信小程序居然没有双向数据绑定，如果想要动态改变 data 值需要用到 bindinput 方法拿到输入的值，再赋值给data，看到这里有点无语，既然找到了方法就写吧。</p><p>考虑到一个页面上可能存在多个input总不能每个都加一个bindinput方法吧，这样太鸡肋的，有没有办法写一个通用的。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;姓名&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123;formData.title&#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">data-name</span>=<span class="string">&quot;title&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;handleInput&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;手机号码&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123;formData.phone&#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">data-name</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;handleInput&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入号码&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;地址&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123;formData.address&#125;&#125;&quot;</span>  </span></span><br><span class="line"><span class="tag"><span class="attr">data-name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;handleInput&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>:&#123;</span><br><span class="line">    <span class="attr">formData</span>:&#123;</span><br><span class="line">        <span class="attr">title</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">phone</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">address</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就可以用data-属性获取我当前需要修改的key，再结合上面动态变量</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">handleInput</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> valueName = e.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">name</span>;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="string">`formData.<span class="subst">$&#123;valueName&#125;</span>`</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">      [name]:e.<span class="property">detail</span>.<span class="property">value</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 微信小程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6常用知识</title>
      <link href="/2023/09/14/ES6%E5%B8%B8%E7%94%A8%E7%9F%A5%E8%AF%86/"/>
      <url>/2023/09/14/ES6%E5%B8%B8%E7%94%A8%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<p><code>ECMAScript 6</code> (简称 <code>ES6</code>) 是 <code>JavaScript</code> 语言的下一代标准</p><p><code>ECMAScript</code> 的提案流程</p><ul><li><code>Stage 0 - Strawman</code>（展示阶段）</li><li><code>Stage 1 - Proposal</code>（征求意见阶段）</li><li><code>Stage 2 - Draft</code>（草案阶段）</li><li><code>Stage 3 - Candidate</code>（候选人阶段）</li><li><code>Stage 4 - Finished</code>（定案阶段）</li></ul><p>一个提案只要能进入 <code>Stage 2</code> 就差不多肯定会包括在以后的正式标准里面</p><p><a href="https://github.com/tc39/ecma262">ECMAScript 当前的所有提案</a></p><p>ES6 和 ES2015 的区别</p><p><code>ES2015</code> 是一个年份标记，表示当年发布的 <code>ECMAScript</code> 标准的正式版本，其全称为《<code>ECMAScript 2015</code> 标准》（简称 <code>ES2015</code>）<br><code>ES6</code> 是一个历史名词也是一个泛指，含义是 <code>5.1</code> 版以后的 <code>JavaScript</code> 的下一代标准，涵盖了 <code>ES2015、ES2016、ES2017 ES2018</code> 等等</p><hr><h2 id="let-const"><a href="#let-const" class="headerlink" title="let const"></a>let const</h2><p><code>ES6</code> 新增了 <strong><code>let</code></strong> 和 <strong><code>const</code></strong> 命令，用于声明变量，其声明的变量只在声明所在的块级作用域内有效</p><p>let const var 的区别</p><ul><li><code>var</code> 声明的变量会提升到作用域的顶部，<code>let const</code> 不存在变量提升</li><li><code>var</code> 声明的全局变量会被挂载到全局对象 <code>window</code> 上，而 <code>let const</code> 不会</li><li><code>var</code> 可以对一个变量进行重复声明，而 <code>let const</code> 不能重复声明</li><li><code>var</code> 声明的变量作用域范围是函数作用域，<code>let const</code> 声明的变量作用域范围是块级作用域</li><li><code>const</code>声明的是一个只读的常量，一旦声明常量的值就不能改变(必须对变量进行初始化)<ul><li>基本类型保证值不可变</li><li>引用类型保证内存指针不可变</li></ul></li></ul><h3 id="变量提升"><a href="#变量提升" class="headerlink" title="变量提升"></a>变量提升</h3><p>变量提升是指<strong>在代码执行过程中 <code>var</code> 变量和函数声明会在它们被实际执行之前被”提升”到它们所在作用域的顶部</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// 输出 undefined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">// 报错</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c) <span class="comment">// 报错</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;var&#x27;</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="string">&#x27;let&#x27;</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="string">&#x27;const&#x27;</span></span><br></pre></td></tr></table></figure><p><a href="https://www.zhihu.com/question/535442142/answer/2510328090">为什么 let 和 const 不存在变量提升？ - 知乎</a></p><p>函数声明优先于变量声明，函数声明会覆盖变量声明</p><p>变量提升</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* var 变量声明 */</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;var&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 函数声明 */</span></span><br><span class="line"><span class="title function_">fn</span>() <span class="comment">// function a() &#123; console.log(&#x27;fn&#x27;) &#125;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fn&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在同一作用域内存在同名的函数声明和 <code>var</code> 变量声明时<strong>函数声明会覆盖变量声明</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// function a() &#123; console.log(&#x27;fn&#x27;) &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;var&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fn&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="挂载到全局对象"><a href="#挂载到全局对象" class="headerlink" title="挂载到全局对象"></a>挂载到全局对象</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;var&#x27;</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="string">&#x27;let&#x27;</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="string">&#x27;const&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">a</span>) <span class="comment">// 输出 var</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">b</span>) <span class="comment">// 输出 undefined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">c</span>) <span class="comment">// 输出 undefined</span></span><br></pre></td></tr></table></figure><h3 id="重复声明"><a href="#重复声明" class="headerlink" title="重复声明"></a>重复声明</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;var&#x27;</span></span><br><span class="line"><span class="keyword">var</span> a</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// 输出 var</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="string">&#x27;let&#x27;</span></span><br><span class="line"><span class="keyword">let</span> b <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure><p>同一作用域下let和const不能声明同名变量，而var可以</p><h3 id="作用域范围"><a href="#作用域范围" class="headerlink" title="作用域范围"></a>作用域范围</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="string">&#x27;var&#x27;</span></span><br><span class="line">    <span class="keyword">let</span> b = <span class="string">&#x27;let&#x27;</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="string">&#x27;const&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// 输出 var</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">// 输出 let</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(c) <span class="comment">// 输出 const</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// 输出 var</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">// 报错</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(c) <span class="comment">// 报错</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>()</span><br></pre></td></tr></table></figure><p>let和const只能在块作用域里访问</p><h3 id="const-常量定义"><a href="#const-常量定义" class="headerlink" title="const 常量定义"></a>const 常量定义</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">NAME</span> = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="variable constant_">NAME</span> = <span class="string">&#x27;strawberry2002&#x27;</span> <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure><p>const定义常量，而且不能修改，<code>但是在定义的对象时对象属性值可以改变</code></p><hr><h2 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h2><p>模板字符串 (template string) 是增强版的字符串，用反引号(<strong>&#96;</strong>)标识。它可以当作普通字符串、定义多行字符串或者在字符串中嵌入变量、函数调用以及表达式</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">let</span> age = <span class="number">18</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES5 拼接字符串 */</span></span><br><span class="line"><span class="keyword">let</span> es5Str = <span class="string">&#x27;我叫: &#x27;</span> + name + <span class="string">&#x27;，我的年龄是: &#x27;</span> + (age + <span class="number">1</span>) + <span class="string">&#x27; 岁&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES6 模板字符串 */</span></span><br><span class="line"><span class="keyword">let</span> es6Str = <span class="string">`我叫: <span class="subst">$&#123;name&#125;</span>，我的年龄是: <span class="subst">$&#123;age + <span class="number">1</span>&#125;</span> 岁`</span></span><br></pre></td></tr></table></figure><hr><h2 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h2><h3 id="解构对象"><a href="#解构对象" class="headerlink" title="解构对象"></a>解构对象</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;strawberry&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5 写法</span></span><br><span class="line"><span class="keyword">const</span> name = obj.<span class="property">name</span></span><br><span class="line"><span class="keyword">const</span> age = obj.<span class="property">age</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES6 解构写法 */</span></span><br><span class="line"><span class="keyword">const</span> &#123; name, age &#125; = obj</span><br><span class="line"><span class="comment">// 重命名</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">name</span>: myName &#125; = obj</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 指定默认值 */</span></span><br><span class="line"><span class="keyword">const</span> &#123; x = <span class="number">1</span>, y = <span class="number">2</span> &#125; = &#123; <span class="attr">y</span>: <span class="literal">null</span> &#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x) <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(y) <span class="comment">// null</span></span><br></pre></td></tr></table></figure><h3 id="解构数组"><a href="#解构数组" class="headerlink" title="解构数组"></a>解构数组</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;strawberry&#x27;</span>, <span class="number">18</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES5 写法 */</span></span><br><span class="line"><span class="keyword">const</span> name = arr[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">const</span> age = arr[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES6 解构写法 */</span></span><br><span class="line"><span class="keyword">const</span> [name, age] = arr</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="number">0</span>: name, <span class="number">1</span>: age &#125; = arr</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 指定默认值 */</span></span><br><span class="line"><span class="keyword">const</span> [x = <span class="number">1</span>] = []</span><br><span class="line"><span class="keyword">const</span> [y = <span class="number">2</span>] = [<span class="literal">undefined</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x) <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(y) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [z = <span class="number">3</span>] = [<span class="literal">null</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(z) <span class="comment">// null</span></span><br></pre></td></tr></table></figure><h3 id="解构字符串"><a href="#解构字符串" class="headerlink" title="解构字符串"></a>解构字符串</h3><p>字符串也可以解构赋值，因为字符串被转换成了一个类似数组的对象</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [a, b, c] = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// m</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">// a</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c) <span class="comment">// o</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 解构 length 属性 */</span></span><br><span class="line"><span class="keyword">const</span> &#123; length &#125; = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(length) <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><p>解构赋值注意点</p><ul><li>解构数组和字符串时变量的取值由它的位置决定</li><li>解构对象时变量必须与属性同名，才能取到正确的值</li><li>变量在没有找到对应的值，多余的变量会被赋值为 <code>undefined</code></li><li>在指定默认值时，只有属性值严格等于 <code>undefined</code> 才会生效</li><li>数组本质是特殊的对象，因此可以对数组进行对象属性的解构</li><li>解构数值和布尔值时会通过其对应的包装函数将其转换成对象再解构</li><li><code>undefined</code> 和 <code>null</code> 无法转为对象，在解构时会报错</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; toString &#125; = <span class="number">123</span></span><br><span class="line">toString === <span class="title class_">Number</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; toString &#125; = <span class="literal">true</span></span><br><span class="line">toString === <span class="title class_">Boolean</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; x &#125; = <span class="literal">undefined</span> <span class="comment">// TypeError</span></span><br><span class="line"><span class="keyword">const</span> &#123; y &#125; = <span class="literal">null</span> <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure><hr><h2 id="函数的扩展"><a href="#函数的扩展" class="headerlink" title="函数的扩展"></a>函数的扩展</h2><h3 id="参数默认值"><a href="#参数默认值" class="headerlink" title="参数默认值"></a>参数默认值</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ES5 */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="comment">// 当参数 y 对应的布尔值为 false 则该赋值不起作用</span></span><br><span class="line">  y = y || <span class="number">1</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">add</span>(<span class="number">10</span>) <span class="comment">// 11</span></span><br><span class="line"><span class="title function_">add</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="comment">// 12</span></span><br><span class="line"><span class="title function_">add</span>(<span class="number">10</span>, <span class="number">0</span>) <span class="comment">// 11</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES6 */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">x, y = <span class="number">1</span></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">add</span>(<span class="number">10</span>) <span class="comment">// 11</span></span><br><span class="line"><span class="title function_">add</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="comment">// 12</span></span><br><span class="line"><span class="title function_">add</span>(<span class="number">10</span>, <span class="number">0</span>) <span class="comment">// 10</span></span><br></pre></td></tr></table></figure><p>函数参数的默认值</p><ul><li>参数变量是默认声明的不能用 <code>let</code>或 <code>const</code> 再次声明，否则会报错</li><li>使用参数默认值时函数不能有同名参数</li><li>参数默认值的位置应该是函数的尾参数</li></ul><h3 id="剩余参数-rest-参数"><a href="#剩余参数-rest-参数" class="headerlink" title="剩余参数(rest 参数)"></a>剩余参数(rest 参数)</h3><p><code>ES6</code> 引入 <code>rest</code> 参数(形式为 <code>...变量名</code>) 用于获取函数的剩余参数(可以替换 <code>arguments</code> 对象)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params">name, ...params</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name, params)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">log</span>(<span class="string">&#x27;strawberry&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>) <span class="comment">// strawberry [1, 2]</span></span><br><span class="line"><span class="title function_">log</span>(<span class="string">&#x27;strawberry&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// strawberry [1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>剩余参数(rest 参数)</p><ul><li><code>rest</code> 参数是一个真正的数组，数组特有的方法都可以使用</li><li><code>rest</code> 参数之后不能再有其他参数，否则会报错</li><li>函数的 <code>length</code> 属性，不包括 <code>rest</code> 参数</li></ul><h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><p><code>ES6</code> 允许使用<strong>箭头</strong>(<code>=&gt;</code>)定义函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不需要参数时使用一个圆括号代表参数部分</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fn</span> = (<span class="params"></span>) =&gt; &#123;&#125;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">const</span> fn = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当函数体只有 return 时</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fn</span> = (<span class="params">value</span>) =&gt; value</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">const</span> fn = <span class="keyword">function</span> (<span class="params">value</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>箭头函数与普通函数的区别</strong></p><ul><li><code>this</code><ul><li>普通函数<ul><li><code>this</code> 指向是动态的(取决于函数的调用方式)</li><li>可以用 <code>call apply bind</code> 改变 <code>this</code> 指向</li></ul></li><li>箭头函数<ul><li><code>this</code> 指向是固定的，指向定义时上层作用域中的 <code>this</code>(它没有自己的 <code>this</code>)</li><li><code>call apply bind</code> 无法改变箭头函数的 <code>this</code> 指向(上下文值始终按词法解析)</li><li>全局作用域下 <code>this</code> 指向全局对象</li></ul></li></ul></li><li>箭头函数不可以当作构造函数(不能使用 <code>new</code> 运算符，否则会报错)</li><li>箭头函数的函数体内不可以使用<code>arguments super new.target</code></li><li>箭头函数不可以使用 yield 命令(不能用作 <code>Generator</code> 函数)</li><li>在 <code>class</code> 中使用箭头函数其 <code>this</code> 会和类实例进行绑定</li></ul><p>注意点(以下场合不应该使用箭头函数)</p><ul><li>定义对象方法且该方法内部包括 <code>this</code> 时</li><li>定义原型方法且该方法内部包括 <code>this</code> 时</li><li>需要动态 <code>this</code> 时</li></ul><p>[利用 <code>babel</code> 编译箭头函数代码查看 <code>this</code> 的指向](<a href="https://www.babeljs.cn/repl#?browsers=defaults%2C">https://www.babeljs.cn/repl#?browsers=defaults%2C</a> not ie 11%2C not ie_mob 11&amp;build&#x3D;&amp;builtIns&#x3D;false&amp;corejs&#x3D;3.6&amp;spec&#x3D;false&amp;loose&#x3D;false&amp;code_lz&#x3D;MYewdgzgLgBANiA5jAvDAFASlQPhgbwCgYZRIQ4BTAOgUXQHI6YoALASwgC4GAaFjhEyEAvoUIAzAK5hgUduBgSwWAsRgRKUACrsAtpRBSo6VSjxESJMhAo06jZQM49-bTsJIj-ARgAMfsIiQA&amp;debug&#x3D;false&amp;forceAllTransforms&#x3D;true&amp;shippedProposals&#x3D;false&amp;circleciRepo&#x3D;&amp;evaluate&#x3D;false&amp;fileSize&#x3D;false&amp;timeTravel&#x3D;false&amp;sourceType&#x3D;script&amp;lineWrap&#x3D;true&amp;presets&#x3D;env%2Creact&amp;prettier&#x3D;false&amp;targets&#x3D;&amp;version&#x3D;7.17.11&amp;externalPlugins&#x3D;&amp;assumptions&#x3D;{})</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ES6 */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">log</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;log this:&#x27;</span>, <span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fn this:&#x27;</span>, <span class="variable language_">this</span>)</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* babel 编译后的 ES5 代码 */</span></span><br><span class="line"><span class="keyword">var</span> _this = <span class="variable language_">this</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> log = <span class="keyword">function</span> <span class="title function_">log</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;log this:&#x27;</span>, _this)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> _this2 = <span class="variable language_">this</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fn this:&#x27;</span>, _this2)</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="扩展运算符"><a href="#扩展运算符" class="headerlink" title="扩展运算符"></a>扩展运算符</h2><p>扩展运算符 (<code>spread</code>)是三个点 (<code>...</code>) 它好比 <code>rest</code> 参数的逆运算</p><ul><li>数组的扩展运算符会将数组转为用逗号分隔的参数序列</li><li>对象的扩展运算符会取出参数对象的所有可遍历属性，拷贝到当前对象之中</li></ul><h3 id="函数调用"><a href="#函数调用" class="headerlink" title="函数调用"></a>函数调用</h3><p>扩展运算符在函数调用时可以将一个数组变为参数序列，从而可以替代函数的 <code>apply()</code> 方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 举个 🌰 求出一个数组最大元素</span></span><br><span class="line"><span class="comment">/* ES5 写法 */</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, [<span class="number">2022</span>, <span class="number">520</span>, <span class="number">1314</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES6 写法 */</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">max</span>(...[<span class="number">2022</span>, <span class="number">520</span>, <span class="number">1314</span>])</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="number">2022</span>, <span class="number">520</span>, <span class="number">1314</span>)</span><br></pre></td></tr></table></figure><h3 id="拷贝数组-对象"><a href="#拷贝数组-对象" class="headerlink" title="拷贝数组&#x2F;对象"></a>拷贝数组&#x2F;对象</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 拷贝数组 */</span></span><br><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment">// 写法一</span></span><br><span class="line"><span class="keyword">const</span> arr2 = [...arr1]</span><br><span class="line"><span class="comment">// 写法二</span></span><br><span class="line"><span class="keyword">const</span> [...arr2] = arr1</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 拷贝对象 */</span></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">name</span>: <span class="string">&#x27;strawberry&#x27;</span> &#125;</span><br><span class="line"><span class="comment">// 写法一</span></span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; ...obj1 &#125;</span><br><span class="line"><span class="comment">// 写法二</span></span><br><span class="line"><span class="keyword">const</span> &#123; ...obj2 &#125; = obj1</span><br></pre></td></tr></table></figure><h3 id="合并数组-对象"><a href="#合并数组-对象" class="headerlink" title="合并数组&#x2F;对象"></a>合并数组&#x2F;对象</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 合并数组 */</span></span><br><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="keyword">const</span> arr = [...arr1, ...arr2]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 合并对象 */</span></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">name</span>: <span class="string">&#x27;strawberry&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; <span class="attr">age</span>: <span class="number">18</span> &#125;</span><br><span class="line"><span class="keyword">const</span> obj = &#123; ...obj1, ...obj2 &#125;</span><br></pre></td></tr></table></figure><h3 id="使用表达式"><a href="#使用表达式" class="headerlink" title="使用表达式"></a>使用表达式</h3><blockquote><p>展开对象</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  ...(<span class="literal">false</span> ? &#123; <span class="attr">a</span>: <span class="number">1</span> &#125; : &#123;&#125;),</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#123;b: 2&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  ...(<span class="literal">true</span> ? &#123; <span class="attr">a</span>: <span class="number">1</span> &#125; : &#123;&#125;),</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#123;a: 1, b: 2&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>展开数组</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [...(<span class="literal">false</span> ? [<span class="number">1</span>] : []), <span class="number">2</span>]</span><br><span class="line"><span class="comment">// [2]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = [...(<span class="literal">true</span> ? [<span class="number">1</span>] : []), <span class="number">2</span>]</span><br><span class="line"><span class="comment">// [1, 2]</span></span><br></pre></td></tr></table></figure><h3 id="与解构赋值结合"><a href="#与解构赋值结合" class="headerlink" title="与解构赋值结合"></a>与解构赋值结合</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES5 写法 */</span></span><br><span class="line"><span class="keyword">const</span> first = arr1[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">const</span> rest = arr1.<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ES6 写法 */</span></span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = arr1</span><br></pre></td></tr></table></figure><p>扩展运算符</p><ul><li>使用扩展运算符拷贝数组或对象时其都是<strong>浅拷贝</strong></li><li>对象的扩展运算符等同于使用 <code>Object.assign()</code> 方法</li><li>只有函数调用时扩展运算符才可以放在圆括号中，否则会报错</li><li>扩展运算符用于赋值时只能放在参数的最后一位，否则会报错</li><li>在扩展运算符展开数组时，其参数必须要有 <code>iterator</code> 接口，否则会报错</li><li>在扩展运算符展开对象时，其参数如果不是对象时会自动转为对象（调用 <code>Object()</code>）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 等同于 &#123;...Object(1)&#125;</span></span><br><span class="line">&#123;...<span class="number">1</span>&#125; <span class="comment">// &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于 &#123;...Object(true)&#125;</span></span><br><span class="line">&#123;...<span class="literal">true</span>&#125; <span class="comment">// &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于 &#123;...Object(undefined)&#125;</span></span><br><span class="line">&#123;...<span class="literal">undefined</span>&#125; <span class="comment">// &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于 &#123;...Object(null)&#125;</span></span><br><span class="line">&#123;...<span class="literal">null</span>&#125; <span class="comment">// &#123;&#125;</span></span><br></pre></td></tr></table></figure><hr><h2 id="数组的扩展"><a href="#数组的扩展" class="headerlink" title="数组的扩展"></a>数组的扩展</h2><h3 id="Array-from"><a href="#Array-from" class="headerlink" title="Array.from()"></a>Array.from()</h3><p><code>Array.from()</code> 用于将两类对象转为真正的数组</p><ul><li>类似数组的对象 (<code>array-like object</code>)<ul><li><code>DOM</code> 操作返回的 <code>NodeList</code></li><li><code>arguments</code> 对象</li></ul></li><li>可遍历 (<code>iterable</code>) 的对象 (包括 <code>ES6</code> 新增的数据结构 <code>Set</code> 和 <code>Map</code>)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* array-like object 转数组 */</span></span><br><span class="line"><span class="keyword">const</span> arrayLike = &#123;</span><br><span class="line">  <span class="number">0</span>: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">  <span class="number">1</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">  <span class="number">2</span>: <span class="string">&#x27;c&#x27;</span>,</span><br><span class="line">  <span class="attr">length</span>: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5 写法</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [].<span class="property">slice</span>.<span class="title function_">call</span>(arrayLike) <span class="comment">// [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6 写法</span></span><br><span class="line"><span class="keyword">let</span> arr2 = <span class="title class_">Array</span>.<span class="title function_">from</span>(arrayLike) <span class="comment">// [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]</span></span><br></pre></td></tr></table></figure><p>Array.from()</p><p><code>Array.from()</code> 可以接受一个函数作为第二个参数，作用类似于数组的<code>map()</code> 用来对每个元素进行处理，将处理后的值放入返回的数组</p><p>在字符串转为数组时 <code>Array.from()</code> 能正确处理各种 <code>Unicode</code> 字符，可以避免 <code>JavaScript</code> 将大于 <code>\uFFFF</code> 的 <code>Unicode</code> 字符算作两个字符的 <code>bug</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;𠮷&#x27;</span>.<span class="property">length</span> <span class="comment">// 2</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="string">&#x27;𠮷&#x27;</span>).<span class="property">length</span> <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;👪&#x27;</span>.<span class="property">length</span> <span class="comment">// 2</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="string">&#x27;👪&#x27;</span>).<span class="property">length</span> <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><h3 id="Array-of"><a href="#Array-of" class="headerlink" title="Array.of()"></a>Array.of()</h3><p><code>Array.of()</code> 用于将一组值转换为数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3,11,8]</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">3</span>) <span class="comment">// [3]</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">3</span>).<span class="property">length</span> <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p>Array.of()</p><p><code>Array.of()</code> 方法的主要目的是弥补数组构造函数 <code>Array()</code> 的不足(因为参数个数的不同会导致<code>Array()</code>的行为有差异)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Array</span>() <span class="comment">// []</span></span><br><span class="line"><span class="title class_">Array</span>(<span class="number">3</span>) <span class="comment">// [, , ,]</span></span><br><span class="line"><span class="title class_">Array</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3, 11, 8]</span></span><br></pre></td></tr></table></figure><p><code>Array.of()</code> 总是返回参数值组成的数组。如果没有参数就返回一个空数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Array.of() 的模拟实现 */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ArrayOf</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [].<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="实例方法-includes"><a href="#实例方法-includes" class="headerlink" title="实例方法: includes()"></a>实例方法: includes()</h3><p><code>includes()</code> 方法返回一个布尔值，表示某个数组是否包含给定的值(<code>ES2016</code> 引入)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="title class_">NaN</span>]</span><br><span class="line">arr.<span class="title function_">includes</span>(<span class="number">2</span>) <span class="comment">// true</span></span><br><span class="line">arr.<span class="title function_">includes</span>(<span class="number">4</span>) <span class="comment">// false</span></span><br><span class="line">arr.<span class="title function_">includes</span>(<span class="title class_">NaN</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>includes() 和 indexOf() 的对比</p><p><code>indexOf()</code> 不够语义化，其含义是找到参数值的第一个出现位置，所以要去比较是否不等于 <code>-1</code>，表达起来不够直观<br><code>indexOf()</code> 内部使用严格相等运算符 (<code>===</code>) 进行判断，这会导致对 <code>NaN</code> 的误判</p><h3 id="实例方法-find-和-findIndex"><a href="#实例方法-find-和-findIndex" class="headerlink" title="实例方法: find() 和 findIndex()"></a>实例方法: find() 和 findIndex()</h3><p><code>find()</code> 方法用于找出第一个符合条件的数组成员，如果<strong>没有符合条件的成员则返回 <code>undefined</code></strong></p><p><code>findIndex()</code> 方法用于找出第一个符合条件的数组成员的位置，如果<strong>没有符合条件的成员则返回 <code>-1</code></strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* find() */</span></span><br><span class="line">arr.<span class="title function_">find</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item &gt; <span class="number">9</span>) <span class="comment">// 10</span></span><br><span class="line">arr.<span class="title function_">find</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item === <span class="number">9</span>) <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* findIndex() */</span></span><br><span class="line">arr.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item &gt; <span class="number">9</span>) <span class="comment">// 2</span></span><br><span class="line">arr.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item === <span class="number">9</span>) <span class="comment">// -1</span></span><br></pre></td></tr></table></figure><h3 id="实例方法-at"><a href="#实例方法-at" class="headerlink" title="实例方法: at()"></a>实例方法: at()</h3><p><code>at()</code> 方法接受一个整数(支持负数)作为参数返回对应位置的成员，如果<strong>参数位置超出了数组范围则返回 <code>undefined</code></strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;strawberry&#x27;</span>, <span class="number">18</span>]</span><br><span class="line"></span><br><span class="line">arr.<span class="title function_">at</span>(<span class="number">0</span>) <span class="comment">// &#x27;strawberry&#x27;</span></span><br><span class="line">arr.<span class="title function_">at</span>(-<span class="number">1</span>) <span class="comment">// 18</span></span><br><span class="line">arr.<span class="title function_">at</span>(<span class="number">99</span>) <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><h3 id="实例方法-flat-和-flatMap"><a href="#实例方法-flat-和-flatMap" class="headerlink" title="实例方法: flat() 和 flatMap()"></a>实例方法: flat() 和 flatMap()</h3><p><code>flat()</code> 方法用于将嵌套的数组拍平变成一维的数组，该方法<strong>返回一个新数组不改变原数组</strong></p><p><code>flatMap()</code> 方法会先对原数组的每个成员执行一个函数(相当于执行 <code>Array.prototype.map()</code>) 然后对返回值组成的数组执行 <code>flat()</code> 方法，该方法<strong>返回一个新数组不改变原数组</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* flat() */</span></span><br><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]]</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, , <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">arr1.<span class="title function_">flat</span>() <span class="comment">// [1, 2, 3, [4, 5]]</span></span><br><span class="line">arr1.<span class="title function_">flat</span>(<span class="number">2</span>) <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line"></span><br><span class="line">arr2.<span class="title function_">flat</span>() <span class="comment">// [1, 2, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* flatMap() */</span></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">arr.<span class="title function_">flatMap</span>(<span class="function">(<span class="params">x</span>) =&gt;</span> [[x * <span class="number">2</span>]]) <span class="comment">// [[2], [4], [6], [8]]</span></span><br><span class="line"><span class="comment">// 相当于 [[2, 4], [3, 6], [4, 8]].flat()</span></span><br></pre></td></tr></table></figure><p>flat() 和 flatMap() 注意点</p><ul><li><code>flat()</code> 方法默认只会拉平一层</li><li><code>flat()</code>方法会跳过原数组中的空位</li><li><code>flatMap()</code> 只能展开一层数组</li></ul><hr><h2 id="对象的扩展"><a href="#对象的扩展" class="headerlink" title="对象的扩展"></a>对象的扩展</h2><h3 id="属性简写"><a href="#属性简写" class="headerlink" title="属性简写"></a>属性简写</h3><p><code>ES6</code> 允许在大括号里面直接写入变量和函数作为对象的属性和方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 属性简写 */</span></span><br><span class="line"><span class="comment">// ES5 写法</span></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">key</span>: key &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6 写法</span></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123; key &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 方法简写 */</span></span><br><span class="line"><span class="comment">// ES5 写法</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">log</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;strawberry&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6 写法</span></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="title function_">log</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>属性简写</p><p>简写的对象方法不能用作构造函数否则会报错</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> obj.<span class="title function_">f</span>() <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure><h3 id="属性名表达式"><a href="#属性名表达式" class="headerlink" title="属性名表达式"></a>属性名表达式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义属性名</span></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;age&#x27;</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  [<span class="string">&#x27;name&#x27;</span> + <span class="number">1</span>]: <span class="string">&#x27;strawberry&#x27;</span>,</span><br><span class="line">  [key]: <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义方法名</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  [<span class="string">&#x27;log&#x27;</span> + <span class="string">&#x27;name&#x27;</span>]() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;strawberry&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>属性名表达式</p><p>属性名表达式与属性简写不能同时使用否则会报错</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;name&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> obj = &#123; [key] &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;name&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> obj = &#123; [key]: <span class="string">&#x27;strawberry&#x27;</span>&#125;;</span><br></pre></td></tr></table></figure><p>属性名表达式如果是一个对象会自动将其转为字符串 <code>[object Object]</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> keyA = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</span><br><span class="line"><span class="keyword">const</span> keyB = &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  [keyA]: <span class="string">&#x27;valueA&#x27;</span>,</span><br><span class="line">  [keyB]: <span class="string">&#x27;valueB&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj) <span class="comment">// &#123;[object Object]: &#x27;valueB&#x27;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Object-is"><a href="#Object-is" class="headerlink" title="Object.is()"></a>Object.is()</h3><p><code>Object.is()</code> 方法用来比较两个值是否严格相等，严格比较运算符 (<code>===</code>) 的行为基本一致</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;key&#x27;</span>) <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(&#123;&#125;, &#123;&#125;) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>Object.is() 与 &#x3D;&#x3D;&#x3D; 的不同之处：<code>+0 不等于 -0</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* +0 不等于 -0 */</span></span><br><span class="line">;+<span class="number">0</span> === -<span class="number">0</span> <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(+<span class="number">0</span>, -<span class="number">0</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* NaN 等于自身 */</span></span><br><span class="line"><span class="title class_">NaN</span> === <span class="title class_">NaN</span> <span class="comment">// false</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="title class_">NaN</span>, <span class="title class_">NaN</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign()"></a>Object.assign()</h3><p><code>Object.assign()</code> 方法用于对象的合并，将源对象的所有可枚举属性复制到目标对象（第一个参数是目标对象后面的参数都是源对象）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">1</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> source1 = &#123; <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">2</span> &#125;</span><br><span class="line"><span class="keyword">const</span> source2 = &#123; <span class="attr">c</span>: <span class="number">3</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(target, source1, source2)</span><br></pre></td></tr></table></figure><h5 id="只有一个参数时会直接返回该参数"><a href="#只有一个参数时会直接返回该参数" class="headerlink" title="只有一个参数时会直接返回该参数"></a>只有一个参数时会直接返回该参数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(obj) === obj <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h5 id="传入参数不是对象时会先转成对象再返回"><a href="#传入参数不是对象时会先转成对象再返回" class="headerlink" title="传入参数不是对象时会先转成对象再返回"></a>传入参数不是对象时会先转成对象再返回</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="number">1</span>) <span class="comment">// &quot;object&quot;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="literal">true</span>) <span class="comment">// &quot;object&quot;</span></span><br></pre></td></tr></table></figure><h5 id="传入非对象类型的场景"><a href="#传入非对象类型的场景" class="headerlink" title="传入非对象类型的场景"></a>传入非对象类型的场景</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* undefined 和 null */</span></span><br><span class="line"><span class="comment">// 首位参数时会报错</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="literal">undefined</span>) <span class="comment">// TypeError</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="literal">null</span>) <span class="comment">// TypeError</span></span><br><span class="line"><span class="comment">// 非首位参数时会忽略</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(obj, <span class="literal">undefined</span>) === obj <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(obj, <span class="literal">null</span>) === obj <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 非首位参数为数值 布尔值 字符串时 */</span></span><br><span class="line"><span class="comment">// 数值和布尔值会忽略</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(obj, <span class="number">1</span>, <span class="literal">true</span>) === obj <span class="comment">// true</span></span><br><span class="line"><span class="comment">// 字符串会以字符数组的形式做合并</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, <span class="string">&#x27;strawberry&#x27;</span>) <span class="comment">// &#123;0: &#x27;m&#x27;, 1: &#x27;a&#x27;, 2: &#x27;o&#x27;, 3: &#x27;m&#x27;, 4: &#x27;a&#x27;, 5: &#x27;o&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 数组 */</span></span><br><span class="line"><span class="comment">// 当参数都为数组时</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]) <span class="comment">// [4, 5, 3]</span></span><br><span class="line"><span class="comment">// 当首位参数为对象时，后续参数为数组时</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123; <span class="attr">a</span>: <span class="number">1</span> &#125;, [<span class="number">1</span>, <span class="number">2</span>]) <span class="comment">// &#123;0: 1, 1: 2, a: 1&#125;</span></span><br></pre></td></tr></table></figure><h5 id="传入数组时会把数组当对象处理"><a href="#传入数组时会把数组当对象处理" class="headerlink" title="传入数组时会把数组当对象处理"></a>传入数组时会把数组当对象处理</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]) <span class="comment">// [4, 5, 3]</span></span><br></pre></td></tr></table></figure><p>Object.assign() 总结和应用场景</p><p>总结</p><ul><li><code>Object.assign()</code> 是<strong>浅拷贝</strong>方法</li><li>存在同名属性时，后面的属性会覆盖前面的属性</li><li>只有一个参数时会直接返回该参数</li><li>传入参数不是对象时会先转成对象再返回</li><li>传入 <code>undefined</code>和 <code>null</code>时</li><li>如果为第一个参数会报错（无法转成对象）</li><li>如果不为第一个参数时会被忽略</li><li>传入数组时会把数组当对象处理</li></ul><p>应用场景</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 为对象添加属性 */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>, &#123; x, y &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 为对象添加方法 */</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">  <span class="title function_">log</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 拷贝对象 */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clone</span> = (<span class="params">origin</span>) =&gt; <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, origin)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 合并多个对象 */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">merge</span> = (<span class="params">target, ...sources</span>) =&gt; <span class="title class_">Object</span>.<span class="title function_">assign</span>(target, ...sources)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 为属性指定默认值 */</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">DEFAULTS</span> = &#123; <span class="attr">duration</span>: <span class="number">2000</span> &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toast</span>(<span class="params">options</span>) &#123;</span><br><span class="line">  options = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, <span class="variable constant_">DEFAULTS</span>, options)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">toast</span>(&#123; <span class="attr">content</span>: <span class="string">&#x27;提示&#x27;</span> &#125;) <span class="comment">// &#123;duration: 2000, content: &#x27;提示&#x27;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Object-keys-Object-value-Object-entries"><a href="#Object-keys-Object-value-Object-entries" class="headerlink" title="Object.keys() Object.value() Object.entries()"></a>Object.keys() Object.value() Object.entries()</h3><p><code>Object.keys()</code> 方法返回一个数组，其成员为参数对象自身的（不含继承的）所有可遍历属性的键名(<code>ES5</code> 引入)</p><p><code>Object.value()</code> 方法返回一个数组，其成员为参数对象自身的（不含继承的）所有可遍历属性的键值(<code>ES2017</code> 引入)</p><p><code>Object.entries()</code> 方法返回一个数组（二维数组），其成员为参数对象自身的（不含继承的）所有可遍历属性的键值对数组(<code>ES2017</code> 引入)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">name</span>: <span class="string">&#x27;strawberry&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(obj) <span class="comment">// [&#x27;name&#x27;, &#x27;age&#x27;]</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">values</span>(obj) <span class="comment">//  [&#x27;strawberry&#x27;, 18]</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">entries</span>(obj) <span class="comment">// [[&#x27;name&#x27;, &#x27;strawberry&#x27;], [&#x27;age&#x27;, 18]]</span></span><br></pre></td></tr></table></figure><h3 id="Object-fromEntries"><a href="#Object-fromEntries" class="headerlink" title="Object.fromEntries()"></a>Object.fromEntries()</h3><p><code>Object.fromEntries()</code> 方法是 <code>Object.entries()</code> 的逆操作，用于将键值对的数据结构还原为对象</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">fromEntries</span>([[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;strawberry&#x27;</span>]]) <span class="comment">// &#123;name: &#x27;strawberry&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Map 转对象 */</span></span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;strawberry&#x27;</span>]])</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(map) <span class="comment">// &#123;name: &#x27;strawberry&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 将查询字符串转为对象 */</span></span><br><span class="line"><span class="keyword">const</span> params = <span class="string">&#x27;name=strawberry&amp;age=18&#x27;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(params)) <span class="comment">// &#123;name: &#x27;strawberry&#x27;, age: &#x27;18&#x27;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="对象遍历方法对比"><a href="#对象遍历方法对比" class="headerlink" title="对象遍历方法对比"></a>对象遍历方法对比</h3><table><thead><tr><th align="left">方法名</th><th align="left">说明</th><th align="center">继承的原型属性</th><th align="center">不可枚举属性</th><th align="center">Symbol 属性</th><th align="center">返回值</th></tr></thead><tbody><tr><td align="left">for…in</td><td align="left">遍历对象自身和继承的所有可枚举属性(不含 Symbol 属性)</td><td align="center">✅</td><td align="center">❌</td><td align="center">❌</td><td align="center">key</td></tr><tr><td align="left">Object.keys</td><td align="left">遍历对象自身所有可枚举属性(不含 Symbol 属性)</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">[key…]</td></tr><tr><td align="left">Object.getOwnPropertyNames</td><td align="left">遍历对象自身所有属性(不含 Symbol 属性)</td><td align="center">❌</td><td align="center">✅</td><td align="center">❌</td><td align="center">[key…]</td></tr><tr><td align="left">Object.getOwnPropertySymbols</td><td align="left">遍历对象自身所有的 Symbol 属性</td><td align="center">❌</td><td align="center">✅</td><td align="center">✅</td><td align="center">[key…]</td></tr><tr><td align="left">Reflect.ownKeys</td><td align="left">遍历对象自身所有的属性(包含不可枚举和 Symbol 属性)</td><td align="center">❌</td><td align="center">✅</td><td align="center">✅</td><td align="center">[key…]</td></tr><tr><td align="left">Object.values</td><td align="left">遍历对象自身所有可枚举属性(不含 Symbol 属性)</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">[value…]</td></tr><tr><td align="left">Object.entries</td><td align="left">遍历对象自身所有可枚举属性(不含 Symbol 属性)</td><td align="center">❌</td><td align="center">❌</td><td align="center">❌</td><td align="center">[[key,value]…]</td></tr></tbody></table><p>遍历顺序</p><p><code>ES5</code> 没有规定遍历顺序，其遍历顺序由浏览器厂商定义(可以简单理解为无序的)</p><p><code>ES6</code> 之后规定遍历顺序将按如下规则进行</p><ol><li>首先遍历所有数值键，按照数值升序排列。</li><li>其次遍历所有字符串键，按照加入时间升序排列。</li><li>最后遍历所有 <code>Symbol</code> 键，按照加入时间升序排列。</li></ol><p><code>ES6</code> 内部定义了 [<a href="https://262.ecma-international.org/11.0/#sec-ordinary-object-internal-methods-and-internal-slots-ownpropertykeys">[OwnPropertyKeys]]()</a> 方法对属性进行分类和排序</p><hr><h2 id="运算符的扩展"><a href="#运算符的扩展" class="headerlink" title="运算符的扩展"></a>运算符的扩展</h2><h3 id="可选链操作符"><a href="#可选链操作符" class="headerlink" title="?. 可选链操作符"></a>?. 可选链操作符</h3><p><a href="https://github.com/tc39/proposal-optional-chaining">ES2020</a> 引入了可选链操作符(又名链判断运算符)，其允许我们在读取对象内部的某个属性时，不需要判断属性的上层对象是否存在</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可选链操作符之前的写法</span></span><br><span class="line"><span class="keyword">const</span> firstName =</span><br><span class="line">  (message &amp;&amp; message.<span class="property">body</span> &amp;&amp; message.<span class="property">body</span>.<span class="property">user</span> &amp;&amp; message.<span class="property">body</span>.<span class="property">user</span>.<span class="property">firstName</span>) || <span class="string">&#x27;default&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 可选链操作符简化写法</span></span><br><span class="line"><span class="keyword">const</span> firstName = message?.<span class="property">body</span>?.<span class="property">user</span>?.<span class="property">firstName</span> || <span class="string">&#x27;default&#x27;</span></span><br></pre></td></tr></table></figure><p>可选链操作符 <code>?.</code> 的三种写法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 属性是否存在 */</span></span><br><span class="line">obj?.<span class="property">prop</span></span><br><span class="line">obj?.[expr]</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line">obj == <span class="literal">null</span> ? <span class="literal">undefined</span> : obj.<span class="property">prop</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 函数或对象方法是否存在 */</span></span><br><span class="line">func?.(...args)</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line">func == <span class="literal">null</span> ? <span class="literal">undefined</span> : <span class="title function_">func</span>()</span><br></pre></td></tr></table></figure><p>注意点</p><ol><li>可选链操作符相当于一种短路机制，只要不满足条件就不再往下执行</li><li>当有括号时，可选链操作符对圆括号外部没有影响，只对圆括号内部有影响。</li><li>右侧不得为十进制数值。为了保证兼容以前的代码，允许 <code>foo?.3:0</code> 会被解析成 <code>foo ? .3 : 0</code>，因此规定如果 <code>?.</code> 后面紧跟一个十进制数字，那么 <code>?.</code> 不再被看成是一个完整的运算符，而会按照三元运算符进行处理，即小数点会归属于后面的十进制数字形成一个小数。</li><li>禁止使用以下写法</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数</span></span><br><span class="line"><span class="keyword">new</span> a?.()</span><br><span class="line"><span class="keyword">new</span> a?.<span class="title function_">b</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 右侧有模板字符串</span></span><br><span class="line">a?.<span class="string">`&#123;b&#125;`</span></span><br><span class="line">a?.<span class="property">b</span><span class="string">`&#123;c&#125;`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 左侧是 super</span></span><br><span class="line"><span class="variable language_">super</span>?.()</span><br><span class="line"><span class="variable language_">super</span>?.<span class="property">foo</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于赋值运算符左侧</span></span><br><span class="line">a?.<span class="property">b</span> = c</span><br></pre></td></tr></table></figure><h3 id="空值合并运算符"><a href="#空值合并运算符" class="headerlink" title="?? 空值合并运算符"></a>?? 空值合并运算符</h3><p><a href="https://github.com/tc39/proposal-nullish-coalescing">ES2020</a> 引入了空值合并运算符，只有运算符左侧的值为 <code>null</code> 或 <code>undefined</code> 时才会返回右侧的值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ?? 运算符 */</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">0</span> ?? <span class="string">&#x27;strawberry&#x27;</span>         <span class="comment">// 0</span></span><br><span class="line"><span class="keyword">const</span> b = <span class="string">&#x27;&#x27;</span> ?? <span class="string">&#x27;strawberry&#x27;</span>        <span class="comment">// &#x27;&#x27;</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="literal">null</span> ?? <span class="string">&#x27;strawberry&#x27;</span>      <span class="comment">// &#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">const</span> d = <span class="literal">undefined</span> ?? <span class="string">&#x27;strawberry&#x27;</span> <span class="comment">// &#x27;strawberry&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* || 运算符 */</span></span><br><span class="line"><span class="keyword">const</span> A = <span class="number">0</span> || <span class="string">&#x27;strawberry&#x27;</span>         <span class="comment">// &#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">const</span> B = <span class="string">&#x27;&#x27;</span> || <span class="string">&#x27;strawberry&#x27;</span>        <span class="comment">// &#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">const</span> C = <span class="literal">null</span> || <span class="string">&#x27;strawberry&#x27;</span>      <span class="comment">// &#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">const</span> D = <span class="literal">undefined</span> || <span class="string">&#x27;strawberry&#x27;</span> <span class="comment">// &#x27;strawberry&#x27;</span></span><br></pre></td></tr></table></figure><p>?? 和 || 的区别</p><ul><li><strong><code>??</code> 运算符</strong>只有左侧是 <code>null</code> 或 <code>undefined</code>才会返回右侧的值</li><li><strong><code>||</code> 运算符</strong>只要左侧是 <a href="https://notes.fe-mm.com/fe/javascript/conversions#toboolean">假值</a> 就会返回右侧的值</li></ul><h3 id="逻辑赋值运算符"><a href="#逻辑赋值运算符" class="headerlink" title="逻辑赋值运算符"></a>逻辑赋值运算符</h3><p><code>ES2021</code> 引了入三个新的逻辑赋值运算符，用于将逻辑运算符与赋值运算符进行结合</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 或赋值运算符 */</span></span><br><span class="line">x ||= y</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line">x || (x = y)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 与赋值运算符 */</span></span><br><span class="line">x &amp;&amp;= y</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line">x &amp;&amp; (x = y)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Null 赋值运算符 */</span></span><br><span class="line">x ??= y</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line">x ?? (x = y)</span><br></pre></td></tr></table></figure><hr><h2 id="ESModule"><a href="#ESModule" class="headerlink" title="ESModule"></a>ESModule</h2><p><code>ESModule</code> 是 <code>ES6</code> 在语言标准的层面上实现的模块功能，其设计思想是尽量的静态化，使得编译时就能确定模块的依赖关系以及输入和输出的变量</p><ul><li><code>ESModule</code> 是编译时加载，使静态分析成为可能</li><li>模块内部<strong>自动使用严格模式</strong></li><li>模块中的<strong>顶层 <code>this</code> 指向 <code>undefined</code></strong></li></ul><h3 id="export-命令"><a href="#export-命令" class="headerlink" title="export 命令"></a>export 命令</h3><p><code>export</code> 命令用于规定模块的对外接口</p><ul><li>一个模块就是一个独立的文件，该文件内部的所有变量外部无法获取，如果希望外部可以获取必须使用 <code>export</code> 关键字输出该变量</li><li>通常情况下 <code>export</code> 输出的变量就是本来的名字，但可以使用 <code>as</code> 关键字重命名</li><li><code>export</code> 命令规定的是对外的接口其必须与模块内部的变量建立一一对应关系</li><li><code>export</code> 命令输出的接口与其对应的值是动态绑定关系(可以取到模块内部实时的值)</li><li><code>export</code> 命令可以出现在模块的任何位置，只要处于<strong>模块顶层</strong>就可以(在块级作用域内使用会报错)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// util.js</span></span><br><span class="line"><span class="comment">/* 单个输出 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> name = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">log</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 统一输出 */</span></span><br><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; name, log &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 使用 as 关键字重命名 */</span></span><br><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; name <span class="keyword">as</span> nickname &#125;</span><br></pre></td></tr></table></figure><h3 id="import-命令"><a href="#import-命令" class="headerlink" title="import 命令"></a>import 命令</h3><p><code>import</code> 命令用于输入其他模块提供的功能(变量、函数、class 等)</p><ul><li><p><code>import</code> 命令<strong>输入的变量都是只读的</strong>(类似于常量，即基本类型不可重新赋值，引用类型可修改属性)</p></li><li><p><code>import</code>命令具有提升效果，会提升到整个模块的头部首先执行</p><ul><li><code>import</code> 命令是编译阶段执行的</li><li>不能使用表达式和变量</li></ul></li><li><p>重复执行同一句 <code>import</code> 命令只会执行一次</p></li><li><p><code>import</code> 后面的 <code>from</code> 指定模块文件的位置，其可以是相对路径，也可以是绝对路径</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; name, log &#125; <span class="keyword">from</span> <span class="string">&#x27;./util&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 使用 as 关键字重命名 */</span></span><br><span class="line"><span class="keyword">import</span> &#123; name <span class="keyword">as</span> nickname, log <span class="keyword">as</span> logName &#125; <span class="keyword">from</span> <span class="string">&#x27;./util&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 模块的整体加载 */</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> util <span class="keyword">from</span> <span class="string">&#x27;./util&#x27;</span></span><br><span class="line">util.<span class="property">name</span> <span class="comment">// strawberry</span></span><br><span class="line">util.<span class="title function_">log</span>() <span class="comment">// strawberry</span></span><br></pre></td></tr></table></figure><h3 id="export-default-命令"><a href="#export-default-命令" class="headerlink" title="export default 命令"></a>export default 命令</h3><p><code>export default</code> 命令可以为模块指定默认输出，是<strong>对 <code>default</code> 赋值的特例，本质上是一种赋值</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 输出匿名函数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;strawberry&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> log <span class="keyword">from</span> <span class="string">&#x27;./export-default&#x27;</span></span><br><span class="line"><span class="title function_">log</span>() <span class="comment">// &#x27;strawberry&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 输出非匿名函数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> fn <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;strawberry&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> log <span class="keyword">from</span> <span class="string">&#x27;./export-default&#x27;</span></span><br><span class="line"><span class="title function_">log</span>() <span class="comment">// &#x27;strawberry&#x27;</span></span><br></pre></td></tr></table></figure><p>export default 命令注意点</p><ul><li>一个模块只能有一个默认输出(<code>export default</code> 命令只能使用一次)</li><li><code>export default</code> 命令本质上是输出一个叫做 <code>default</code> 的变量或方法，使用时可以为它取任意名字</li><li><code>export default</code> 命令后面是一个表达式，不能跟变量声明语句</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 错误 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 正确 */</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> a;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接输出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">&#x27;strawberry&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="number">1</span> + <span class="number">2</span></span><br></pre></td></tr></table></figure><p>export 和 export default 的区别</p><ul><li><p><code>export &#123;&#125;</code> 导出的都是引用</p></li><li><p><code>export default</code>导出的都是值而不是引用</p><ul><li><code>export default</code> 是<strong>对 <code>default</code> 赋值的特例，本质上是一种赋值</strong>（即 <code>export default</code> 后的语句会被视为表达式）所以拿到的是值而不是引用</li><li><strong><code>export default function</code> 是特例，导出的是引用</strong></li></ul></li><li><p><code>export &#123; thing as default &#125;</code> 写法为引用导出</p></li><li><p>导入时除 <code>&#123;&#125; = await import()</code> 外均为引用</p></li></ul><h6 id="如何保证导入都是引用？"><a href="#如何保证导入都是引用？" class="headerlink" title="如何保证导入都是引用？"></a>如何保证导入都是引用？</h6><ul><li>保证导入总是引用<ul><li>尽量使用命名导入（使用除 <code>&#123;&#125; = await import()</code> 外的写法）</li><li>注意命名导出的写法</li><li>少用默认导出</li></ul></li><li>做不到上面的要求时尽量把需要维持引用的变量使用 <code>Object</code> 封装，不要使用简单变量</li></ul><blockquote><p>相关文章</p><ul><li><a href="https://github.com/ascoders/weekly/blob/master/%E5%89%8D%E6%B2%BF%E6%8A%80%E6%9C%AF/204.%E7%B2%BE%E8%AF%BB%E3%80%8A%E9%BB%98%E8%AE%A4%E3%80%81%E5%91%BD%E5%90%8D%E5%AF%BC%E5%87%BA%E7%9A%84%E5%8C%BA%E5%88%AB%E3%80%8B.md">精读《默认、命名导出的区别》</a></li><li><a href="https://jakearchibald.com/2021/export-default-thing-vs-thing-as-default/"><code>export default thing</code> is different to <code>export &#123; thing as default &#125;</code></a></li></ul></blockquote><h3 id="export-与-import-的复合写法"><a href="#export-与-import-的复合写法" class="headerlink" title="export 与 import 的复合写法"></a>export 与 import 的复合写法</h3><p>如果在一个模块之中，需要先输入后输出同一个模块，<code>import</code> 命令可以与 <code>export</code> 命令写在一起</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">import</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; foo, bar &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 接口改名 */</span></span><br><span class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> myFoo &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 整体输出 */</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 具名接口改为默认接口 */</span></span><br><span class="line"><span class="keyword">export</span> &#123; es6 <span class="keyword">as</span> <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span>;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">import</span> &#123; es6 &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> es6;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 默认接口改为具名接口 */</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> es6 &#125; <span class="keyword">from</span> <span class="string">&#x27;my_module&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 整体加载 */</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">as</span> util <span class="keyword">from</span> <span class="string">&quot;util&quot;</span>;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> util <span class="keyword">from</span> <span class="string">&quot;util&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> &#123;util&#125;;</span><br></pre></td></tr></table></figure><p>注意点</p><p>在 <code>export</code> 与 <code>import</code> 的复合写法时，输入的接口不能在当前模块中使用，只是相当于对外转发了接口</p><h3 id="import"><a href="#import" class="headerlink" title="import()"></a>import()</h3><p><a href="https://github.com/tc39/proposal-dynamic-import">ES2020</a> 引入 <code>import()</code> 函数支持动态加载模块</p><ul><li><code>import()</code> 函数可以用在任何地方，不仅仅是模块非模块的脚本也可以使用</li><li><code>import()</code> 函数是运行时执行</li><li><code>import()</code> 函数与所加载的模块没有静态连接关系</li><li><code>import()</code> 函数类似于 <code>Node.js</code> 中的 <code>require()</code> 函数，区别主要是前者是异步加载后者是同步加载</li><li><code>import()</code> 函数的返回值是 <code>Promise</code> 对象</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">&#x27;./dialogBox.js&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">dialogBox</span>) =&gt;</span> &#123;</span><br><span class="line">    dialogBox.<span class="title function_">open</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/* Error handling */</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p>import() 函数的使用场景</p><ul><li>按需加载</li><li>条件加载</li><li>动态的模块路径</li></ul><h3 id="浏览器对-ESModule-的加载规则"><a href="#浏览器对-ESModule-的加载规则" class="headerlink" title="浏览器对 ESModule 的加载规则"></a>浏览器对 ESModule 的加载规则</h3><p>浏览器加载 <code>ESModule</code> 同样使用 <code>&lt;script&gt;</code> 标签但是需要设置 <code>type=&quot;module</code>“ 属性<br>浏览器对于带有 <code>type=&quot;module&quot;</code> 的 <code>&lt;script&gt;</code>都是异步加载，不会堵塞浏览器，即等到整个页面渲染完再执行模块脚本，等同于设置了 <code>&lt;script&gt;</code> 标签的 <code>defer</code> 属性<br>有多个 <code>&lt;script type=&quot;module&quot;&gt;</code> 时会按照在页面出现的顺序依次执行</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./util.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 等同于 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./util.js&quot;</span> <span class="attr">defer</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>当 <code>&lt;script&gt;</code> 同时设置了 <code>type=&quot;module&quot;</code> 和 <code>async</code> 属性时，只要加载完成渲染引擎就会中断渲染立即执行，等执行完成后再恢复渲染，即不会按照在页面出现的顺序执行，而是只要该模块加载完成就执行该模块</p><h4 id="在-script-中使用-ESModule"><a href="#在-script-中使用-ESModule" class="headerlink" title="在 script 中使用 ESModule"></a>在 script 中使用 ESModule</h4><p><code>ESModule</code> 内嵌在网页中使用时语法行为与加载外部脚本完全一致，只需注意以下几点</p><ul><li>代码是在模块作用域之中运行而不是在全局作用域运行，模块内部的顶层变量外部不可见</li><li>自动采用严格模式不管有没有声明 <code>use strict</code></li><li>可以使用 <code>import</code> 命令加载其他模块(<code>.js</code> 后缀不可省略，需要提供绝对 <code>URL</code> 或相对 <code>URL</code>) 也可以使用 <code>export</code> 命令输出对外接口</li><li>顶层的 <code>this</code> 关键字返回 <code>undefined</code> 而不是指向 <code>window</code></li><li>同一个模块如果加载多次将只执行一次</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">&#x27;./jquery/src/jquery.js&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  $(<span class="string">&#x27;#message&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;Hi from jQuery!&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>小技巧</p><p>利用顶层的 <code>this</code> 等于 <code>undefined</code> 这个语法点可以判断当前代码是否在 ES6 模块之中</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isNotModuleScript = <span class="variable language_">this</span> !== <span class="literal">undefined</span></span><br></pre></td></tr></table></figure><hr><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><p><code>Promise</code> 是异步编程的一种解决方案，比传统的解决方案(回调函数和事件)更合理和更强大</p><p><code>Promise</code> 对象具有以下 <code>3</code> 种状态</p><ul><li><code>pending</code> 等待(初始)</li><li><code>fulfilled</code> 成功</li><li><code>rejected</code> 拒绝</li></ul><p>Promise 的特点</p><ul><li><code>Promise</code> 对象的状态不受外界影响</li><li>状态一旦改变就不会再变(不可逆)，任何时候都可以得到这个结果</li><li>无法取消 <code>Promise</code>，一旦新建就会立即执行无法中途取消</li><li>当处于 <code>pending</code> 状态时，无法得知目前进展到哪一个阶段(刚刚开始还是即将完成)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 基本用法 */</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="string">&#x27;成功&#x27;</span>), <span class="number">1000</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 链式调用 */</span></span><br><span class="line"><span class="title function_">ajax</span>(<span class="string">&#x27;/get/1&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">ajax</span>(<span class="string">&#x27;/get/2&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">ajax</span>(<span class="string">&#x27;/get/3&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(res))</span><br></pre></td></tr></table></figure><h3 id="Promise-实例方法"><a href="#Promise-实例方法" class="headerlink" title="Promise 实例方法"></a>Promise 实例方法</h3><ul><li><code>Promise.prototype.then()</code> 用于实例添加状态改变时的回调函数(第一个参数是 <code>fulfilled</code> 状态的回调函数，第二个参数是 <code>rejected</code> 状态的回调函数)，会返回的是一个新的 <code>Promise</code> 实例</li><li><code>Promise.prototype.catch()</code> 用于指定 <code>rejected</code> 状态的回调函数(是 <code>.then(null, rejection)</code> 或 <code>.then(undefined, rejection)</code> 的别名)</li><li><code>Promise.prototype.finally()</code> (ES2018) 用于指定不管 <code>Promise</code> 对象最后状态如何都会执行的操作 (<code>finally</code> 本质上是 <code>then</code> 方法的特例)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  实现 finally 方法 */</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">finally</span> = <span class="keyword">function</span> (<span class="params">callback</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> P = <span class="variable language_">this</span>.<span class="property">constructor</span></span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">then</span>(</span><br><span class="line">    <span class="function">(<span class="params">value</span>) =&gt;</span> P.<span class="title function_">resolve</span>(<span class="title function_">callback</span>()).<span class="title function_">then</span>(<span class="function">() =&gt;</span> value),</span><br><span class="line">    <span class="function">(<span class="params">reason</span>) =&gt;</span></span><br><span class="line">      P.<span class="title function_">resolve</span>(<span class="title function_">callback</span>()).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> reason</span><br><span class="line">      &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Promise-静态方法"><a href="#Promise-静态方法" class="headerlink" title="Promise 静态方法"></a>Promise 静态方法</h3><ul><li><p><code>Promise.resolve()</code></p><ul><li><p>将传入的参数转为<code>Promise</code>对象</p></li><li><p>参数是一个 <code>Promise</code> 实例则直接返回</p></li><li><p>参数是一个 <code>thenable</code> 对象(具有 <code>then</code> 方法的对象) 转为 <code>Promise</code> 对象再立即执行 <code>thenable</code> 对象的 <code>then</code> 方法</p></li><li><p>参数不是具有 <code>then</code> 方法的对象或根本就不是对象时返回一个 <code>fulfilled</code> 状态的新 <code>Promise</code> 对象</p><ul><li>没有参数时返回一个 <code>fulfilled</code> 状态的新 <code>Promise</code> 对象</li></ul></li></ul></li><li><p><code>Promise.reject()</code></p><ul><li>返回一个 <code>rejected</code> 状态的新 <code>Promise</code> 对象</li></ul></li><li><p><code>Promise.all()</code></p><ul><li>将多个 <code>Promise</code> 实例，包装成一个新的 <code>Promise</code> 实例，只有所有的 <code>Promise</code> 状态成功才会成功，如果其中一个 <code>Promise</code> 的状态失败就会失败</li></ul></li><li><p><code>Promise.race()</code></p><ul><li>将多个 <code>Promise</code> 实例，包装成一个新的 <code>Promise</code> 实例，新的 <code>Promise</code> 实例状态会根据最先更改状态的参数实例而更改状态(可以轻松实现超时方法)</li></ul></li><li><p><code>Promise.allSettled()</code>(ES2020)</p><ul><li>将多个 <code>Promise</code> 实例，包装成一个新的 <code>Promise</code> 实例，新的 <code>Promise</code> 实例只有等到所有这些参数实例都返回结果，不管是 <code>fulfilled</code> 还是 <code>rejected</code> ，包装实例才会结束，一旦结束，状态总是 <code>fulfilled</code></li></ul></li><li><p><code>Promise.any()</code>(ES2021)</p><ul><li>将多个 <code>Promise</code> 实例，包装成一个新的 <code>Promise</code> 实例，只要参数实例有一个变成 <code>fulfilled</code> 状态，包装实例就会变成 <code>fulfilled</code> 状态；如果所有参数实例都变成 <code>rejected</code> 状态，包装实例才会变成 <code>rejected</code> 状态</li></ul></li></ul><p><a href="https://github.com/strawberry2002/Promise">Promise 实现</a> 简易实现、A+ 规范实现、原型方法、静态方法实现</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用代码片段</title>
      <link href="/2023/09/13/%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5/"/>
      <url>/2023/09/13/%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5/</url>
      
        <content type="html"><![CDATA[<h2 id="微信小程序-request-js-封装请求"><a href="#微信小程序-request-js-封装请求" class="headerlink" title="微信小程序 request.js 封装请求"></a>微信小程序 request.js 封装请求</h2><h3 id="请求参数options"><a href="#请求参数options" class="headerlink" title="请求参数options"></a>请求参数options</h3><p>根据我们的业务需求，设置以下参数，其他参数可按项目业务需求添加。</p><ul><li>url 请求url</li><li>method 请求方式，默认<code>GET</code></li><li>data 请求数据</li><li>timeout 请求最长时间(ms)，默认20000，即20s</li><li>needLogin 是否需要登录，默认为<code>true</code>，需要登录并且未登录状态直接跳转到登录页面</li><li>showLoading 是否展示loading，默认为<code>true</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">createRequest</span>(<span class="params">options</span>)&#123;</span><br><span class="line">    <span class="comment">// util/request.js</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> token = wx.<span class="title function_">getStorageSync</span>(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="comment">// 未登录状态，跳转到登录页面</span></span><br><span class="line">        <span class="keyword">if</span> (options.<span class="property">needLogin</span> !== <span class="literal">false</span> &amp;&amp; !token) &#123;</span><br><span class="line">        wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;请先登录&#x27;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            wx.<span class="title function_">redirectTo</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;/pages/login/index&#x27;</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 构建请求url</span></span><br><span class="line">    <span class="comment">// 这里暂时配置本地环境域名</span></span><br><span class="line">    <span class="comment">// 等我们把环境配置讲了，再进一步优化</span></span><br><span class="line">    <span class="keyword">const</span> baseUrl = <span class="string">&quot;http://localhost:3000&quot;</span></span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">`<span class="subst">$&#123;baseUrl&#125;</span><span class="subst">$&#123;options.url&#125;</span>`</span></span><br><span class="line">    <span class="comment">// 构建请求header，把token放到header</span></span><br><span class="line">    <span class="keyword">const</span> header = &#123;</span><br><span class="line">        token</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 设置showLoading</span></span><br><span class="line">    <span class="comment">// 因为showLoading要配合hideLoading使用，因此需要记录这个变量</span></span><br><span class="line">    <span class="keyword">let</span> showLoading = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">if</span> (options.<span class="property">loading</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">        showLoading = <span class="literal">true</span></span><br><span class="line">        wx.<span class="title function_">showLoading</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;正在加载&#x27;</span>,</span><br><span class="line">        <span class="attr">mask</span>: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 发送请求</span></span><br><span class="line">wx.<span class="title function_">request</span>(&#123;</span><br><span class="line">    url,</span><br><span class="line">    <span class="attr">method</span>: options.<span class="property">method</span> || <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: options.<span class="property">timeout</span> || <span class="number">20000</span>,</span><br><span class="line">    header,</span><br><span class="line">    <span class="attr">data</span>: options.<span class="property">data</span> || &#123;&#125;,</span><br><span class="line">    <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">        res = res.<span class="property">data</span></span><br><span class="line">        <span class="keyword">switch</span>(res.<span class="property">code</span>) &#123;</span><br><span class="line">          <span class="comment">// 请求没问题</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">resolve</span>(res)</span><br><span class="line">          <span class="comment">// 异常信息</span></span><br><span class="line">          <span class="keyword">case</span> -<span class="number">1</span>:</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: res.<span class="property">msg</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="comment">// 登录已失效，需要重新登录</span></span><br><span class="line">          <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&#x27;登录已失效，请重新登录&#x27;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              wx.<span class="title function_">redirectTo</span>(&#123;</span><br><span class="line">                <span class="attr">url</span>: <span class="string">&#x27;/pages/login/index&#x27;</span>,</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="comment">// 其他异常</span></span><br><span class="line">          <span class="attr">default</span>:</span><br><span class="line">            wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">              <span class="attr">title</span>: <span class="string">&#x27;服务开小差啦！&#x27;</span>,</span><br><span class="line">              <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">fail</span>(<span class="params">res</span>) &#123;</span><br><span class="line">        wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;服务开小差啦！&#x27;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">          &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">complete</span>(<span class="params">res</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果有loading，就隐藏</span></span><br><span class="line">      <span class="keyword">if</span> (showLoading) &#123;</span><br><span class="line">        wx.<span class="title function_">hideLoading</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="微信小程序设置环境变量"><a href="#微信小程序设置环境变量" class="headerlink" title="微信小程序设置环境变量"></a>微信小程序设置环境变量</h2><p>在项目根目录新建<code>config.js</code>文件，用来存放我们的环境变量。以请求的域名<code>baseUrl</code>为例，配置不同环境的域名。</p><p>这里我们只配置两个环境，</p><ul><li><p>开发环境<code>develop</code></p></li><li><p>生产环境<code>production</code></p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> env = <span class="string">&quot;develop&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 防止我们在上传代码的时候，没有将env改成production</span></span><br><span class="line"><span class="keyword">const</span> envVersion = wx.<span class="title function_">getAccountInfoSync</span>().<span class="property">miniProgram</span>.<span class="property">envVersion</span></span><br><span class="line"><span class="keyword">if</span> (envVersion === <span class="string">&quot;release&quot;</span> &amp;&amp; env !== <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">  env = <span class="string">&quot;production&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// 当前环境</span></span><br><span class="line">  env,</span><br><span class="line">  <span class="comment">// 请求接口域名</span></span><br><span class="line">  <span class="attr">baseUrl</span>: &#123;</span><br><span class="line">    <span class="attr">develop</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span>, </span><br><span class="line">    <span class="attr">production</span>: <span class="string">&#x27;http://api.xxx.com&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个文件导出一个配置对象，<code>env</code>变量是当前的环境，<code>baseUrl</code>是网络请求域名，已每个环境作为key，分别配置参数。</p><p><strong><strong>为了防止我们在上传代码的时候，没有将<code>env</code>改成<code>production</code>，我们可以这样解决这个问题。</strong></strong></p><p>通过<code>wx.getAccountInfoSync()</code>获取当前小程序环境，如果是release并且<code>env=develop</code>，那我们就设置<code>env</code>为<code>production</code></p><p>微信小程序有三个版本，具体如下：</p><table><thead><tr><th>develop</th><th>开发版，扫码预览二维码进去就是开发版</th></tr></thead><tbody><tr><td>trial</td><td>体验版，上传代码后设置为体验版</td></tr><tr><td>release</td><td>正式版，上传代码-提交审核-发布，正式版小程序生效</td></tr></tbody></table><h2 id="获取环境变量"><a href="#获取环境变量" class="headerlink" title="获取环境变量"></a>获取环境变量</h2><p>我们在<code>app.js</code>的<code>App</code>实例化对象中新建一个<code>getConfig</code>方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> localConfigs <span class="keyword">from</span> <span class="string">&quot;./config&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">App</span>(&#123;</span><br><span class="line">  <span class="comment">// 获取配置</span></span><br><span class="line">  <span class="title function_">getConfig</span>(<span class="params">key = <span class="string">&quot;&quot;</span></span>) &#123;</span><br><span class="line">    <span class="comment">// 不指定key，返回全部</span></span><br><span class="line">    <span class="keyword">if</span> (key === <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> localConfigs</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 不存在配置</span></span><br><span class="line">    <span class="keyword">if</span> (!localConfigs[key]) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`<span class="subst">$&#123;key&#125;</span> config is no exist`</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 配置是否区分环境</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> localConfigs[key] === <span class="string">&quot;object&quot;</span> &amp;&amp; <span class="keyword">typeof</span> localConfigs[key] !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="comment">// 获取当前环境类型</span></span><br><span class="line">      <span class="keyword">const</span> env = <span class="variable language_">this</span>.<span class="title function_">getConfig</span>(<span class="string">&quot;env&quot;</span>)</span><br><span class="line">      <span class="keyword">return</span> localConfigs[key][env]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> localConfigs[key]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>首先导入我们的配置文件，然后判断是否存在，之后判断是否是一个对象，是的话就返回当前环境的变量。</p><h3 id="使用案例"><a href="#使用案例" class="headerlink" title="使用案例"></a>使用案例</h3><p><code>util/request.js</code>中，我们要获取<code>baseUrl</code>环境变量。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取app对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">getApp</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baseUrl = app.<span class="title function_">getConfig</span>(<span class="string">&quot;baseUrl&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h2 id="提取身份证信息"><a href="#提取身份证信息" class="headerlink" title="提取身份证信息"></a>提取身份证信息</h2><ul><li><h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><ul><li><strong>idCard:</strong> 身份证号码</li><li><strong>separator:</strong> 出生年月日的分割字符，默认为 <code>/</code></li></ul></li><li><h4 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h4><ul><li><strong>age:</strong> 年龄（实岁）</li><li><strong>birthday:</strong> 出生年月日</li><li><strong>gender:</strong> 性别（0 女 1 男）</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getIdCardInfo</span>(<span class="params">idCard, separator = <span class="string">&#x27;/&#x27;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    !<span class="regexp">/^[1-9]\d&#123;5&#125;(?:18|19|20)\d&#123;2&#125;(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d&#123;3&#125;[\dXx]$/</span>.<span class="title function_">test</span>(</span><br><span class="line">      idCard</span><br><span class="line">    )</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">`<span class="subst">$&#123;idCard&#125;</span>不是一个身份证号码`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 提取 idCard 中的字符</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">idSubstr</span> = (<span class="params">s, e</span>) =&gt; idCard.<span class="title function_">substr</span>(s, e)</span><br><span class="line">  <span class="comment">// 拼接日期</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">splice</span> = (<span class="params">d</span>) =&gt; d.<span class="title function_">join</span>(separator)</span><br><span class="line">  <span class="comment">// 获取出生年月日 性别（0 女 1 男）</span></span><br><span class="line">  <span class="keyword">let</span> birthday, gender</span><br><span class="line">  <span class="keyword">if</span> (idCard.<span class="property">length</span> === <span class="number">18</span>) &#123;</span><br><span class="line">    birthday = <span class="title function_">splice</span>([<span class="title function_">idSubstr</span>(<span class="number">6</span>, <span class="number">4</span>), <span class="title function_">idSubstr</span>(<span class="number">10</span>, <span class="number">2</span>), <span class="title function_">idSubstr</span>(<span class="number">12</span>, <span class="number">2</span>)])</span><br><span class="line">    gender = <span class="title function_">idSubstr</span>(-<span class="number">2</span>, <span class="number">1</span>) &amp; <span class="number">1</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    birthday = <span class="title function_">splice</span>(<span class="title function_">idSubstr</span>(<span class="number">6</span>, <span class="number">2</span>), <span class="title function_">idSubstr</span>(<span class="number">8</span>, <span class="number">2</span>), <span class="title function_">idSubstr</span>(<span class="number">10</span>, <span class="number">2</span>))</span><br><span class="line">    gender = <span class="title function_">idSubstr</span>(-<span class="number">1</span>, <span class="number">1</span>) &amp; <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 获取年龄（实岁）</span></span><br><span class="line">  <span class="keyword">const</span> birthDate = <span class="keyword">new</span> <span class="title class_">Date</span>(birthday)</span><br><span class="line">  <span class="keyword">const</span> newDate = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  <span class="keyword">const</span> year = newDate.<span class="title function_">getFullYear</span>()</span><br><span class="line">  <span class="keyword">let</span> age = year - birthDate.<span class="title function_">getFullYear</span>()</span><br><span class="line">  <span class="keyword">if</span> (newDate &lt; <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title function_">splice</span>([year, birthday.<span class="title function_">substring</span>(<span class="number">5</span>)]))) &#123;</span><br><span class="line">    age--</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    age,</span><br><span class="line">    birthday,</span><br><span class="line">    gender</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 微信小程序 </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用正则表达式</title>
      <link href="/2023/09/13/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2023/09/13/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="常用正则"><a href="#常用正则" class="headerlink" title="常用正则"></a>常用正则</h1><blockquote><p>收集开发中的一些常用正则，使用时建议根据实际需求进行修改</p><p>由于格式化会在前面添加分号，故采用变量形式</p></blockquote><p><strong>正则表达式应当符合实际需求即可，无需过于追求完美</strong>。有时候过于追求准确性可能反而破坏实际需求。例如，手机号、邮箱、URL 的正则，很多人试图编写完美的表达式，结果过于严格，反而引发了问题，从而影响了用户的正常使用</p><p><a href="https://juejin.cn/post/6844903501034684430">JS 正则表达式完整教程</a></p><h2 id="验证相关"><a href="#验证相关" class="headerlink" title="验证相关"></a>验证相关</h2><h3 id="是否是金额（精确到分）"><a href="#是否是金额（精确到分）" class="headerlink" title="是否是金额（精确到分）"></a>是否是金额（精确到分）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">MONEY_PATTERN</span> = <span class="regexp">/^(0|([1-9]\d*))(\.\d&#123;1,2&#125;)?$/</span></span><br></pre></td></tr></table></figure><blockquote><p>更严格</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">MONEY_PATTERN</span> =</span><br><span class="line">  <span class="regexp">/(?:^[1-9]([0-9]+)?(?:\.[0-9]&#123;1,2&#125;)?$)|(?:^(?:0)&#123;1&#125;$)|(?:^[0-9]\.[0-9](?:[0-9])?$)/</span></span><br></pre></td></tr></table></figure><h3 id="是否是手机号"><a href="#是否是手机号" class="headerlink" title="是否是手机号"></a>是否是手机号</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">MOBILE_PATTERN</span> = <span class="regexp">/^1\d&#123;10&#125;$/</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">MOBILE_PATTERN</span> = <span class="regexp">/^1[3-9]\d&#123;9&#125;$/</span></span><br></pre></td></tr></table></figure><h3 id="是否是邮箱号"><a href="#是否是邮箱号" class="headerlink" title="是否是邮箱号"></a>是否是邮箱号</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">EMAIL_PATTERN</span> = <span class="regexp">/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/</span></span><br></pre></td></tr></table></figure><blockquote><p>更严格的邮箱正则 —— <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/input/email#%E5%9F%BA%E6%9C%AC%E9%AA%8C%E8%AF%81">参考 MDN</a></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">EMAIL_PATTERN</span> =</span><br><span class="line">  <span class="regexp">/^[a-zA-Z0-9.!#$%&amp;&#x27;*+/=?^_`&#123;|&#125;~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]&#123;0,61&#125;[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]&#123;0,61&#125;[a-zA-Z0-9])?)*$/</span></span><br></pre></td></tr></table></figure><h3 id="是否是-QQ-号"><a href="#是否是-QQ-号" class="headerlink" title="是否是 QQ 号"></a>是否是 QQ 号</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">QQ_NUMBER_PATTERN</span> = <span class="regexp">/^[1-9]&#123;1&#125;\d&#123;4,11&#125;$/</span></span><br></pre></td></tr></table></figure><h3 id="是否是链接地址"><a href="#是否是链接地址" class="headerlink" title="是否是链接地址"></a>是否是链接地址</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">URL_PATTERN</span> =</span><br><span class="line">  <span class="regexp">/^(https|http):\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9]+[\/=\?%\-&amp;_~`@[\]\&#x27;:+!]*([^&lt;&gt;\&quot;\&quot;])*$/</span></span><br></pre></td></tr></table></figure><h3 id="是否是身份证号码"><a href="#是否是身份证号码" class="headerlink" title="是否是身份证号码"></a>是否是身份证号码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">ID_CARD_NUMBER_PATTERN</span> =</span><br><span class="line">  <span class="regexp">/^[1-9]\d&#123;5&#125;(?:18|19|20)\d&#123;2&#125;(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d&#123;3&#125;[\dXx]$/</span></span><br></pre></td></tr></table></figure><h3 id="是否是-16-进制颜色"><a href="#是否是-16-进制颜色" class="headerlink" title="是否是 16 进制颜色"></a>是否是 16 进制颜色</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">HEX_COLOR_PATTERN</span> = <span class="regexp">/^#?([a-fA-F0-9]&#123;6&#125;|[a-fA-F0-9]&#123;3&#125;)$/</span></span><br></pre></td></tr></table></figure><h2 id="格式相关"><a href="#格式相关" class="headerlink" title="格式相关"></a>格式相关</h2><h3 id="344-格式手机号"><a href="#344-格式手机号" class="headerlink" title="344 格式手机号"></a>344 格式手机号</h3><p><strong>从左到右匹配</strong>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pattern = <span class="regexp">/(^\d&#123;3&#125;|\d&#123;4&#125;\B)/g</span></span><br></pre></td></tr></table></figure><blockquote><p>举 🌰</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;15512341234&#x27;</span>.<span class="title function_">replace</span>(<span class="regexp">/(^\d&#123;3&#125;|\d&#123;4&#125;\B)/g</span>, <span class="string">&#x27;$1 &#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>从右到左匹配</strong>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pattern = <span class="regexp">/\B(?=(\d&#123;4&#125;)+\b)/g</span></span><br></pre></td></tr></table></figure><blockquote><p>举 🌰 ：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;15512341234&#x27;</span>.<span class="title function_">replace</span>(<span class="regexp">/\B(?=(\d&#123;4&#125;)+\b)/g</span>, <span class="string">&#x27; &#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="隐藏手号中间-4-位"><a href="#隐藏手号中间-4-位" class="headerlink" title="隐藏手号中间 4 位["></a>隐藏手号中间 4 位[</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pattern = <span class="regexp">/(\d&#123;3&#125;)\d&#123;4&#125;(\d&#123;4&#125;)/</span></span><br></pre></td></tr></table></figure><blockquote><p>举 🌰 ：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;15512341234&#x27;</span>.<span class="title function_">replace</span>(<span class="regexp">/(\d&#123;3&#125;)\d&#123;4&#125;(\d&#123;4&#125;)/</span>, <span class="string">&#x27;$1****$2&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="数字千分位格式化"><a href="#数字千分位格式化" class="headerlink" title="数字千分位格式化"></a>数字千分位格式化</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pattern = <span class="regexp">/(\d)(?=(\d&#123;3&#125;)+\.)/g</span></span><br></pre></td></tr></table></figure><blockquote><p>举 🌰 ：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;5201314.1314&#x27;</span>.<span class="title function_">replace</span>(<span class="regexp">/(\d)(?=(\d&#123;3&#125;)+\.)/g</span>, <span class="string">&#x27;$1,&#x27;</span>) <span class="comment">// &#x27;5,201,314.1314&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>保留两位小数</strong>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pattern = <span class="regexp">/(\d)(?=(\d&#123;3&#125;)+\.)/g</span></span><br></pre></td></tr></table></figure><blockquote><p>举 🌰 ：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;(<span class="number">5201314.1314</span>).<span class="title function_">toFixed</span>(<span class="number">2</span>).<span class="title function_">replace</span>(<span class="regexp">/\B(?=(\d&#123;3&#125;)+\b)/g</span>, <span class="string">&#x27;,&#x27;</span>) <span class="comment">// &#x27;5,201,314.13&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 正则表达式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP</title>
      <link href="/2023/09/13/HTTP/"/>
      <url>/2023/09/13/HTTP/</url>
      
        <content type="html"><![CDATA[<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP">HTTP</a> 全称为 HyperText Transfer Protocol，即超文本传输协议，是一个用于传输超媒体文档(例如 <code>HTML</code>)的应用层协议</p><h4 id="HTTP-协议的主要特点"><a href="#HTTP-协议的主要特点" class="headerlink" title="HTTP 协议的主要特点"></a>HTTP 协议的主要特点</h4><ul><li>是一个应用层协议</li><li><strong>遵循经典的“客户端-服务端”模型</strong>(客户端发送请求，服务器返回响应)</li><li>灵活可扩展<ul><li>语义上的自由，只规定了报文的基本格式，报文里的各个组成部分可以由开发者任意定制</li><li>传输格式的多样性</li></ul></li><li><strong>无连接</strong>: 每完成一个请求就断开连接(HTTP&#x2F;1.1 后默认开启长连接)</li><li><strong>无状态</strong>: HTTP 协议对于事务处理没有记忆能力(每个请求之间、浏览器和服务器之间都是相互独立毫无关联的)</li><li><strong>可靠传输</strong>: HTTP 协议是一个可靠的传输协议(基于 TCP&#x2F;IP 协议)</li><li><strong>明文传输</strong>: 协议里的报文直接使用文本形式传输(HTTP&#x2F;2.0 后改为二进制传输)</li></ul><h2 id="HTTP-协议的演变"><a href="#HTTP-协议的演变" class="headerlink" title="HTTP 协议的演变"></a>HTTP 协议的演变</h2><p><a href="https://mp.weixin.qq.com/s/RuHaKgwpCMvPQeEwe31k2A">HTTP 协议演进与各版本特性</a></p><h3 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP&#x2F;0.9"></a>HTTP&#x2F;0.9</h3><blockquote><p>1990 年问世</p></blockquote><p>功能简陋，只有一个 <code>GET</code> 方法，且只支持纯文本内容</p><h3 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP&#x2F;1.0"></a>HTTP&#x2F;1.0</h3><blockquote><p>1996 年 5 月正式发布</p></blockquote><ul><li>任何格式的内容都可以发送</li><li>请求和响应增加了头信息</li><li>新增方法：<code>POST HEAD</code></li><li>添加了状态码、多字符集支持、权限、缓存、内容编码等功能</li></ul><h3 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP&#x2F;1.1"></a>HTTP&#x2F;1.1</h3><blockquote><p>1997 年 1 月发布，是<strong>目前主流的 HTTP 协议版本</strong></p></blockquote><ul><li><strong>长连接</strong>：TCP 连接默认不关闭可以被多个请求复用</li><li><strong>管道机制</strong>：在同一个 TCP 链接里面，客户端可以同时发送多个请求</li><li><strong>分块传输编码</strong></li><li>缓存处理：<code>Cache-Control</code> 和 <code>Etag/If-None-Match</code></li><li>断点续传</li><li>增加了 <code>TLS</code> 支持：支持 <code>HTTPS</code> 传输</li><li>新增方法：<code>PUT PATCH OPTIONS DELETE</code></li></ul><p>HTTP&#x2F;1.1 缺点</p><ul><li>单路连接请求低效：每个 TCP 连接只能对应一个 HTTP 请求</li><li>队头阻塞：当顺序发送的请求序列中的一个请求因为某种原因被阻塞时，在后面排队的所有请求也一并被阻塞，会导致客户端迟迟收不到数据。</li><li>头信息冗余</li><li>只允许由客户端主动发起请求</li><li>明文传输</li></ul><h3 id="HTTP-2-0"><a href="#HTTP-2-0" class="headerlink" title="HTTP&#x2F;2.0"></a>HTTP&#x2F;2.0</h3><blockquote><p>2015 年发布，主要基于 SPDY 协议（2009 年谷歌公开了自行研发的 SPDY 协议，主要解决 HTTP&#x2F;1.1 效率不高的问题）</p></blockquote><ul><li><strong>二进制传输</strong>：头信息和数据体都是二进制</li><li><strong>多路复用&#x2F;二进制分帧</strong>：在一个 TCP 连接中可以同时发送多个请求</li><li><strong>头部压缩</strong>（使用 HPACK 算法进行压缩）</li><li><strong>服务器推送</strong>：允许服务器未经请求主动向客户端发送资源</li><li><strong>请求优先级</strong></li></ul><p>HTTP&#x2F;2.0 缺点</p><ul><li>建立连接时间长（本质上是 TCP 的问题）</li><li>没有彻底解决队头阻塞问题</li><li>弱网环境表现不佳</li></ul><h3 id="HTTP-3-0"><a href="#HTTP-3-0" class="headerlink" title="HTTP&#x2F;3.0"></a>HTTP&#x2F;3.0</h3><p>HTTP&#x2F;3.0 又称为 HTTP Over QUIC，其弃用 TCP 协议，改为使用基于 UDP 协议的 QUIC 协议来实现</p><ul><li>实现了类似 TCP 的流量控制、传输可靠性的功能</li><li>实现了快速握手功能</li><li>集成了 TLS 加密功能</li><li>多路复用，彻底解决 TCP 中队头阻塞的问题</li></ul><h2 id="HTTP-状态码"><a href="#HTTP-状态码" class="headerlink" title="HTTP 状态码"></a>HTTP 状态码</h2><p><code>HTTP</code> 状态码的职责是当客户端向服务器端发送请求时，描述返回的请求结果。借助状态码，用户可以知道服务器端是正常处理了请求，还是出现了错误。</p><p>主要有以下 <code>5</code> 响应类别的状态码</p><ul><li><code>1XX</code> 是信息性状态码，表示接收的请求正在处理</li><li><code>2XX</code> 是成功状态码，表示请求正常处理完毕</li><li><code>3XX</code> 是重定向状态码，表示需要进行附加操作以完成请求</li><li><code>4XX</code> 是客户端错误状态码，表示服务器无法处理请求</li><li><code>5XX</code> 是服务器错误状态码，表示服务器处理请求出错</li></ul><h3 id="2XX-成功"><a href="#2XX-成功" class="headerlink" title="2XX 成功"></a>2XX 成功</h3><ul><li><code>200 OK</code> 表示从客户端发来的请求在服务器端被正常处理</li><li><code>204 No Content</code> 表示请求成功但在返回的响应报文中不含实体的主体部分</li><li><code>206 Partial Content</code> 表示客户端进行了范围请求</li></ul><h3 id="3XX-重定向"><a href="#3XX-重定向" class="headerlink" title="3XX 重定向"></a>3XX 重定向</h3><ul><li><code>301 Moved Permanently</code> 永久性重定向，表示资源已被分配了新的 <code>URL</code></li><li><code>302 Found</code> 临时性重定向，表示资源临时被分配了新的 <code>URL</code></li><li><code>303 See Other</code> 表示资源存在着另一个 <code>URL</code>，应使用 <code>GET</code> 方法定向获取请求的资源</li><li><code>304 Not Modified</code> 表示客户端发送附带条件的请求时，服务器端允许请求访问资源但未满足条件的情况</li><li><code>307 Temporary Redirect</code> 临时重定向，和 <code>302 Found</code> 有着相同的含义</li></ul><h3 id="4XX-客户端错误"><a href="#4XX-客户端错误" class="headerlink" title="4XX 客户端错误"></a>4XX 客户端错误</h3><ul><li><code>400 Bad Request</code> 表示请求报文中存在语法错误</li><li><code>401 Unauthorized</code> 表示发送的请求需要有通过 <code>HTTP</code> 认证的认证信息</li><li><code>403 Forbidden</code> 表示对请求资源的访问被服务器拒绝</li><li><code>404 Not Found</code> 表示服务器上无法找到请求的资源</li></ul><h3 id="5XX-服务器错误"><a href="#5XX-服务器错误" class="headerlink" title="5XX 服务器错误"></a>5XX 服务器错误</h3><ul><li><code>500 Internal Server Error</code> 表示服务器端在执行请求时发生了错误</li><li><code>503 Service Unavailable</code> 表示服务器暂时处于超负载或正在进行停机维护，现在无法处理请求</li></ul><h2 id="GET-和-POST-的区别"><a href="#GET-和-POST-的区别" class="headerlink" title="GET 和 POST 的区别"></a>GET 和 POST 的区别</h2><blockquote><p>安全是指请求方法不会破坏服务器上的资源</p><p>幂等是指多次执行相同的操作，其结果都是相同的</p></blockquote><ul><li><p>语义上</p><p>（最本质的区别）</p><ul><li><code>GET</code> 是从服务器获取指定的资源，<code>GET</code> 方法是安全、幂等、可被缓存的</li><li><code>POST</code> 是根据请求负荷（报文 body）对指定的资源做出处理，具体的处理方式视资源类型而不同。<code>POST</code> 不安全、不幂等、（大部分实现）不可缓存。</li></ul></li></ul><p>在实际过程中开发者不一定会按照 RFC 规范定义的语义来实现 <code>GET</code> 和 <code>POST</code> 方法</p><ul><li>可以用 <code>GET</code> 方法实现新增或删除数据的请求，这样实现的 <code>GET</code> 方法自然就不是安全和幂等；</li><li>可以用 <code>POST</code> 方法实现查询数据的请求，这样实现的 <code>POST</code> 方法自然就是安全和幂等</li></ul><p>GET 请求可以带 body 吗？</p><p>RFC 规范并没有规定 <code>GET</code> 请求不能带 body。只是因为 RFC 规范定义的 <code>GET</code> 请求是获取资源，所以根据这个语义不需要用到 body。<br><strong>理论上任何 HTTP 请求都可以带 body，任何 HTTP 请求的 URL 也可以携带查询参数</strong></p>]]></content>
      
      
      <categories>
          
          <category> 浏览器与网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP</title>
      <link href="/2023/09/13/TCP/"/>
      <url>/2023/09/13/TCP/</url>
      
        <content type="html"><![CDATA[<p>TCP（Transmission Control Protocol 传输控制协议）是一个<strong>面向连接的</strong>、<strong>可靠的</strong>、<strong>基于字节流</strong>的传输层通信协议</p><p>TCP 连接</p><p>TCP 连接是用于保证可靠性和流量控制维护的某些状态信息的组合，这些信息包括 Socket、序列号和窗口大小</p><ul><li><strong>Socket</strong>：由 IP 地址和端口号组成</li><li><strong>序列号</strong>：用来解决乱序问题等</li><li><strong>窗口大小</strong>：用来做流量控制</li></ul><p>TCP 四元组</p><ul><li>源地址</li><li>源端口</li><li>目的地址</li><li>目的端口</li></ul><p>TCP 四元组可以唯一的确定一个连接</p><h2 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h2><blockquote><p>TCP 连接建立</p></blockquote><p><strong>三次握手</strong>是指在建立一个 TCP 连接时客户端和服务器总共要<strong>发送 3 个数据包以确认连接的建立</strong></p><p>三次握手的过程如下图所示：</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/tcp-three-handshakes.dd478e65.png" alt="TCP 三次握手"></p><p>最开始时客户端和服务器都处于 <code>CLOSED</code> 状态。然后服务器主动监听某个端口（此时处于 <code>LISTEN</code> 状态）</p><h3 id="第一次握手"><a href="#第一次握手" class="headerlink" title="第一次握手"></a>第一次握手</h3><blockquote><p><strong>由客户端发起</strong></p></blockquote><p>客户端会随机初始化一个序列号（<code>client_isn</code>）然后发送一个带有 <code>SYN</code> <code>seq = client_isn</code> 信息的数据包。发送完成后客户端进入 <code>SYN_SEND</code> 状态（连接发送状态）</p><ul><li><code>SYN</code> 是一个标志位，为 1 时表示希望建立连接</li><li><code>seq = client_isn</code> 是客户端随机初始化的序列号（一个 32 位的无符号数）</li></ul><h3 id="第二次握手"><a href="#第二次握手" class="headerlink" title="第二次握手"></a>第二次握手</h3><blockquote><p><strong>由服务器发起</strong></p></blockquote><p>服务器收到客户端的 <code>SYN</code> 报文后，首先会随机初始化自己的序列号（<code>server_isn</code>）然后发送一个带有 <code>SYN</code> <code>ACK</code> <code>seq = server_isn</code> <code>ack = client_isn + 1</code> 信息的数据包。发送完成后服务器进入 <code>SYN_RCVD</code> 状态（连接收到状态）</p><ul><li><code>ACK</code> 是一个标志位，表示收到了请求</li><li><code>seq = server_isn</code> 是服务器随机初始化的序列号（一个 32 位的无符号数）</li><li><code>ack = client_isn + 1</code> 是一个确认应答号，值为<strong>客户端序列号 + 1</strong></li></ul><h3 id="第三次握手"><a href="#第三次握手" class="headerlink" title="第三次握手"></a>第三次握手</h3><blockquote><p><strong>由客户端发起</strong></p></blockquote><p>客户端收到服务器报文后，会再发送一个带有 <code>ACK</code> <code>ack = server_isn + 1</code> 信息的数据包。发送完成后客户端进入 <code>ESTABLISHED</code> 状态（连接成功状态）服务器收到客户端发送的应答报文包后也会进入 <code>ESTABLISHED</code> 状态</p><ul><li><code>ack = server_isn + 1</code> 是一个确认应答号，值为<strong>服务器序列号 + 1</strong></li></ul><p>三次握手可以保证客户端和服务器能够确认双方的接收和发送能力是否正常</p><ul><li><p>第一次握手：客户端发送</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYN</span><br></pre></td></tr></table></figure><p>报文给服务器，服务器接收该报文</p><ul><li>客户端什么都不能确认</li><li>服务器确认：自己接收正常，对方发送正常</li></ul></li><li><p>第二次握手：服务器发送</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYN + ACK</span><br></pre></td></tr></table></figure><p>报文给客户端，客户端接收该报文</p><ul><li>客户端确认：自己发送正常、接收正常，对方发送正常、接收正常</li><li>服务器确认：自己接收正常，对方发送正常</li></ul></li><li><p>第三次握手：客户端发送</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ACK</span><br></pre></td></tr></table></figure><p>报文给服务器</p><ul><li>客户端在第二次握手时已经完成确认</li><li>服务器确认：自己发送正常，接收正常，对方发送正常、接收正常</li></ul></li></ul><h3 id="三次握手的作用？"><a href="#三次握手的作用？" class="headerlink" title="三次握手的作用？"></a>三次握手的作用？</h3><ol><li>防止旧的重复连接初始化造成混乱</li><li>同步双方初始序列号（序列号能够保证数据包不重复、不丢弃和按序传输）</li><li>避免资源浪费</li></ol><h3 id="为什么不是两次握手"><a href="#为什么不是两次握手" class="headerlink" title="为什么不是两次握手?"></a>为什么不是两次握手?</h3><p>两次握手无法防止历史连接的建立，会造成双方资源的浪费，也无法可靠的同步双方序列号</p><h3 id="为什么不是四次握手"><a href="#为什么不是四次握手" class="headerlink" title="为什么不是四次握手?"></a>为什么不是四次握手?</h3><p>因为通过前三次已经可以建立一个可靠的连接，如果再发送第四次确认消息会浪费资源，所以不需要使用更多的通信次数</p><h3 id="三次握手过程中，可以携带数据吗？"><a href="#三次握手过程中，可以携带数据吗？" class="headerlink" title="三次握手过程中，可以携带数据吗？"></a>三次握手过程中，可以携带数据吗？</h3><p>第一次、第二次握手不可以携带数据，第三次握手可以携带数据，因为在第三次握手时客户端已经处于连接状态，已经知道服务器的接收、发送能力是正常的</p><h2 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h2><blockquote><p>TCP 连接断开</p></blockquote><p><strong>四次挥手</strong>是指断开一个 TCP 连接时客户端和服务器总共<strong>发送 4 个包以确认连接的断开</strong><br><strong>客户端和服务器双方都可以主动断开连接</strong></p><p>四次挥手的过程如下图所示：</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/tcp-four-waves.3c9d16cd.png" alt="TCP 四次挥手"></p><p>最开始时客户端和服务器都处于 <code>ESTABLISHED</code> 状态</p><h3 id="第一次挥手"><a href="#第一次挥手" class="headerlink" title="第一次挥手"></a>第一次挥手</h3><p>客户端先发送一个带有 <code>FIN=1</code> 信息的数据包，然后客户端进入 <code>FIN_WAIT_1</code> 状态</p><h3 id="第二次挥手"><a href="#第二次挥手" class="headerlink" title="第二次挥手"></a>第二次挥手</h3><p>服务器收到客户端的 <code>FIN</code> 报文后，就向客户端发送 <code>ACK</code> 应答报文，然后服务器进入 <code>CLOSED_WAIT</code> 状态<br>当客户端收到服务器的 <code>ACK</code> 应答报文后会进入 <code>FIN_WAIT_2</code> 状态</p><h3 id="第三次挥手"><a href="#第三次挥手" class="headerlink" title="第三次挥手["></a>第三次挥手[</h3><p>当服务器处理完数据后，会向客户端发送 <code>FIN</code> 报文，之后服务器进入 <code>LAST_ACK</code> 状态</p><h3 id="第四次挥手"><a href="#第四次挥手" class="headerlink" title="第四次挥手"></a>第四次挥手</h3><p>服务器收到服务器的 <code>FIN</code> 报文后，会回复一个 <code>ACK</code> 应答报文，之后进入 <code>TIME_WAIT</code> 状态<br>服务器收到了 <code>ACK</code> 应答报文后，就进入了 <code>CLOSED</code> 状态（<strong>服务器完成连接的关闭</strong>）<br>客户端在经过 <code>2MSL</code> 一段时间后会自动进入 <code>CLOSED</code> 状态（<strong>客户端完成连接的关闭</strong>）</p><p>什么是 MSL</p><p><code>MSL</code> 是 Maximum Segment Lifetime（<strong>报文最大生存时间</strong>）是任何报文在网络上存在的最长时间，超过这个时间报文将会被丢弃</p><p><code>2MSL</code> 的时间是从客户端接收到 <code>FIN</code> 后发送 <code>ACK</code> 开始计时的。如果在 <code>TIME-WAIT</code> 时间内，因为客户端的 <code>ACK</code> 没有传输到服务器，客户端又接收到了服务器重发的 <code>FIN</code> 报文，那么 <code>2MSL</code> 时间将重新计时</p><h3 id="为什么挥手需要四次？"><a href="#为什么挥手需要四次？" class="headerlink" title="为什么挥手需要四次？"></a>为什么挥手需要四次？</h3><ul><li>在关闭连接时客户端向服务器发送 <code>FIN</code> 时，仅表示客户端不再发送数据了但是还能接收数据；</li><li>当服务器在收到客户端的 <code>FIN</code> 报文时，会先回一个 <code>ACK</code> 应答报文，而服务器可能还有数据需要处理和发送，等服务器不再发送数据时，才发送 <code>FIN</code> 报文给客户端来表示同意现在关闭连接。</li></ul><h3 id="为什么需要-TIME-WAIT-状态？"><a href="#为什么需要-TIME-WAIT-状态？" class="headerlink" title="为什么需要 TIME_WAIT 状态？"></a>为什么需要 TIME_WAIT 状态？</h3><blockquote><p>主动发起关闭连接的一方才有 <code>TIME-WAIT</code> 状态</p></blockquote><ol><li>防止历史连接中的数据，被后面相同四元组的连接错误的接收；</li><li>保证<strong>被动关闭连接</strong>的一方，能被正确的关闭；</li></ol><h3 id="为什么-TIME-WAIT-等待的时间是-2MSL？"><a href="#为什么-TIME-WAIT-等待的时间是-2MSL？" class="headerlink" title="为什么 TIME_WAIT 等待的时间是 2MSL？"></a>为什么 TIME_WAIT 等待的时间是 2MSL？</h3><ol><li>保证服务器能收到最后的 <code>ACK</code> 应答报文</li><li>让此次 TCP 连接中的所有报文在网络中消失，从而避免前后两个使用相同四元组的连接中的前一个连接的报文干扰后一个连接</li></ol><p>假如客户端在送 <code>ACK</code> 后，这个 <code>ACK</code> 在 <code>1MSL</code> 时到达服务器，此时服务器在收到这个 <code>ACK</code> 的前一刹那，一直在重传 <code>FIN</code>，这个 <code>FIN</code> 最坏会在 <code>1MSL</code> 时间内消失。因此从客户端发送 <code>ACK</code> 的那一刹那开始，等待 <code>2MSL</code> 可以保证客户端发送的最后一个 <code>ACK</code> 和服务器发送的最后一个 <code>FIN</code> 都在网络中消失</p><h2 id="TCP-和-UDP"><a href="#TCP-和-UDP" class="headerlink" title="TCP 和 UDP"></a>TCP 和 UDP</h2><h3 id="TCP-和-UDP-的区别"><a href="#TCP-和-UDP-的区别" class="headerlink" title="TCP 和 UDP 的区别"></a>TCP 和 UDP 的区别</h3><ul><li><ol><li><strong>连接</strong></li></ol><ul><li>TCP 是面向连接的传输层协议，传输数据前先要建立连接；</li><li>UDP 是不需要连接，即刻传输数据。</li></ul></li><li><ol><li><strong>服务对象</strong></li></ol><ul><li>TCP 是一对一的两点服务，即一条连接只有两个端点；</li><li>UDP 支持一对一、一对多、多对多的交互通信。</li></ul></li><li><ol><li><strong>可靠性</strong></li></ol><ul><li>TCP 是可靠交付数据的，数据可以无差错、不丢失、不重复、按需到达；</li><li>UDP 是尽最大努力交付，不保证可靠交付数据。</li></ul></li><li><ol><li><strong>拥塞控制、流量控制</strong></li></ol><ul><li>TCP 有拥塞控制和流量控制机制，保证数据传输的安全性；</li><li>UDP 没有拥塞控制、流量控制，即使网络非常拥堵了，也不会影响 UDP 的发送速率。</li></ul></li><li><ol><li><strong>首部开销</strong></li></ol><ul><li>TCP 首部长度较长会有一定的开销，首部在没有使用“选项”字段时是 20 个字节，如果使用了“选项”字段则会变长的；</li><li>UDP 首部只有 8 个字节，并且是固定不变的，开销较小。</li></ul></li><li><ol><li><strong>传输方式</strong></li></ol><ul><li>TCP 是流式传输，没有边界，但保证顺序和可靠；</li><li>UDP 是一个包一个包的发送，是有边界的，但可能会丢包和乱序。</li></ul></li><li><ol><li><strong>分片不同</strong></li></ol><ul><li>TCP 的数据大小如果大于 MSS 大小，则会在传输层进行分片，目标主机收到后，也同样在传输层组装 TCP 数据包，如果中途丢失了一个分片，只需要传输丢失的这个分片。</li><li>UDP 的数据大小如果大于 MTU 大小，则会在 IP 层进行分片，目标主机收到后，在 IP 层组装完数据，接着再传给传输层。</li></ul></li></ul><blockquote><p>MSS（Maximum Segment Siz）最大分段大小：一个网络包中除去 IP 和 TCP 头部之后所能容纳的 TCP 数据的最大长度 MTU（Maximum Transmission Unit）最大传输单元：一个网络包的最大长度（以太网中一般为 1500 字节）</p></blockquote><h3 id="TCP-和-UDP-的应用场景"><a href="#TCP-和-UDP-的应用场景" class="headerlink" title="TCP 和 UDP 的应用场景"></a>TCP 和 UDP 的应用场景</h3><ul><li>TCP 面向连接，能保证数据的可靠性交付，因此经常用于：<ul><li>FTP 文件传输</li><li>HTTP &#x2F; HTTPS</li></ul></li><li>UDP 面向无连接，可随时发送数据，其本身的处理既简单又高效，因此经常用于：<ul><li>包总量较少的通信，如 DNS 、SNMP 等</li><li>视频、音频等多媒体通信</li><li>广播通信</li></ul></li></ul><h3 id="TCP-和-UDP-可以同时绑定相同的端口吗？"><a href="#TCP-和-UDP-可以同时绑定相同的端口吗？" class="headerlink" title="TCP 和 UDP 可以同时绑定相同的端口吗？"></a>TCP 和 UDP 可以同时绑定相同的端口吗？</h3><p>传输层的<strong>端口号</strong>是用于识别同一计算机中同时通信的不同应用程序，而 TCP 和 UDP 是两个不同的传输层协议，其在内核中是两个完全独立的软件模块。<br>当主机收到数据包后，可以在 IP 包头的<strong>协议号</strong>字段知道该数据包是 TCP 还是 UDP，所以可以根据这个信息确定送给哪个模块 (TCP&#x2F;UDP) 处理，送给 TCP&#x2F;UDP 模块的报文根据<strong>端口号</strong>确定送给哪个应用程序处理。<br>因此 TCP 和 UDP 各自的端口号是相互独立的，如 TCP 有一个 80 号端口，UDP 也可以有一个 80 号端口，二者并不冲突。</p><h2 id="TCP-相关学习文章"><a href="#TCP-相关学习文章" class="headerlink" title="TCP 相关学习文章"></a>TCP 相关学习文章</h2><p><a href="https://xiaolincoding.com/network/3_tcp/tcp_interview.html">TCP 三次握手与四次挥手面试题 —— 小林 coding</a></p>]]></content>
      
      
      <categories>
          
          <category> 浏览器与网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浏览器知识</title>
      <link href="/2023/09/13/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9F%A5%E8%AF%86/"/>
      <url>/2023/09/13/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="线程和进程"><a href="#线程和进程" class="headerlink" title="线程和进程"></a>线程和进程</h3><blockquote><p>进程（process）和线程（thread）是操作系统的基本概念</p></blockquote><p>进程是 CPU 资源分配的最小单位（是能拥有资源和独立运行的最小单位）<br>线程是 CPU 调度的最小单位（是建立在进程基础上的一次程序运行单位）</p><p><strong>一个进程就是一个程序的运行实例</strong>：启动一个程序时，操作系统会为该程序创建一块内存，用来存放代码、运行中的数据和一个执行任务的主线程，我们把这样的一个运行环境叫<strong>进程</strong></p><p><strong>线程是进程内的一个执行单元</strong>：线程是不能单独存在的，是依附于进程并由进程来启动和管理的</p><p>进程和线程的关系特点</p><ul><li>进程是拥有资源的基本单位；线程是调度和分配的基本单位（是进程内的一个执行单元，也是进程内的可调度实体）</li><li>进程之间相互隔离，互不干扰</li><li>一个进程中可以并发执行多个线程</li><li>一个线程只能隶属于一个进程，而一个进程是可以拥有多个线程的（但至少有一个主线程）</li><li>同一进程的所有线程共享该进程的所有数据</li><li>进程中的任意一线程执行出错，都会导致整个进程的崩溃</li><li>当一个进程关闭之后，操作系统会回收进程所占用的内存</li></ul><h3 id="Chrome-打开一个页面会有几个进程？"><a href="#Chrome-打开一个页面会有几个进程？" class="headerlink" title="Chrome 打开一个页面会有几个进程？"></a>Chrome 打开一个页面会有几个进程？</h3><blockquote><p>最新的 Chrome 多进程架构图</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/chrome-framework.5e7e4a3d.png" alt="Chrome 多进程架构图"></p><ul><li><p><strong>浏览器主进程</strong>：负责界面显示、用户交互、子进程管理，同时提供存储等功能</p></li><li><p>渲染进程</p><p>：负责将</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTML</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CSS</span><br></pre></td></tr></table></figure><p>和</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JavaScript</span><br></pre></td></tr></table></figure><p>转换为用户可以与之交互的网页</p><ul><li>排版引擎 Blink 和 JavaScript 引擎 V8 都是运行在该进程中</li><li>默认情况下 Chrome 会为每个 Tab 标签创建一个渲染进程</li><li>出于安全考虑渲染进程都是运行在沙箱模式下</li></ul></li><li><p><strong>GPU 进程</strong>：负责网页、Chrome 的 UI 界面的绘制</p></li><li><p><strong>网络进程</strong>：负责页面的网络资源加载（之前是作为一个模块运行在浏览器进程）</p></li><li><p><strong>插件进程</strong>：负责插件的运行（因为插件易崩溃所以需要通过插件进程来隔离，以保证插件崩溃不会对浏览器和页面造成影响）</p></li></ul><p><a href="https://time.geekbang.org/column/article/113513">Chrome 架构：仅仅打开了 1 个页面，为什么有 4 个进程？—— 浏览器工作原理与实践</a></p><h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><p>跨域的原因 —— 浏览器的同源策略</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy">同源策略</a>是浏览器一个重要的安全策略，它用于限制一个 <code>origin</code> 的文档或者它加载的脚本如何能与另一个源的资源进行交互。它能帮助阻隔恶意文档，减少可能被攻击的媒介</p><p>同源的定义是两个 <code>URL</code> 的 <strong>协议</strong>、<strong>域名</strong>(子域名 + 主域名)、<strong>端口号</strong> 都相同，否则就会出现跨域</p><p>同源策略的限制范围</p><ol><li>限制跨源网络访问: <code>AJAX</code> 请求不能发送</li><li>限制跨源脚本 <code>API</code> 访问: <code>DOM</code> 无法获得</li><li>限制跨源数据存储访问: <code>Cookie</code> <code>LocalStorage</code> 和 <code>IndexDB</code> 无法读取</li></ol><p>一般常说的跨域指网络跨域</p><h3 id="常用的跨域解决方案"><a href="#常用的跨域解决方案" class="headerlink" title="常用的跨域解决方案"></a>常用的跨域解决方案</h3><p>常用的跨域解决方案</p><ol><li><strong>CORS</strong></li><li><strong>JSONP</strong></li><li>Nginx 反向代理</li><li>WebSocket</li><li>postMessage</li><li>document.domain</li></ol><h3 id="CORS-跨源资源共享"><a href="#CORS-跨源资源共享" class="headerlink" title="CORS 跨源资源共享"></a>CORS 跨源资源共享</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS">CORS (跨源资源共享)</a> 是 <a href="https://developer.mozilla.org/zh-CN/docs/Glossary/HTTP">HTTP</a> 的一部分，它允许浏览器向跨源服务器发出 <code>XMLHttpRequest</code> 请求，从而解决了 <code>AJAX</code> 只能同源使用的限制。</p><blockquote><p><code>CORS</code> 需要浏览器和服务器同时支持，目前所有浏览器均已支持，只需服务器配置即可使用</p></blockquote><p>浏览器将 <code>CORS</code> 请求分成两类: <strong>简单请求</strong>和<strong>非简单请求</strong></p><h4 id="简单请求"><a href="#简单请求" class="headerlink" title="简单请求"></a>简单请求</h4><p>简单请求必须同时满足以下条件</p><blockquote><p>日常开发只会关注前两点</p></blockquote><ul><li><p>请求方法是以下三种方法之一</p><ul><li><code>HEAD</code></li><li><code>GET</code></li><li><code>POST</code></li></ul></li><li><p>只使用了如下的安全首部字段，不得人为设置其他首部字段</p><ul><li><p><code>Accept</code></p></li><li><p><code>Accept-Language</code></p></li><li><p><code>Content-Language</code></p></li><li><pre><code>Content-Type<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    仅限以下三种</span><br><span class="line"></span><br><span class="line">    - `application/x-www-form-urlencoded`</span><br><span class="line">    - `multipart/form-data`</span><br><span class="line">    - `text/plain`</span><br><span class="line"></span><br><span class="line">- 请求中的任意 `XMLHttpRequestUpload` 对象均没有注册任何事件监听器(使用 `XMLHttpRequest.upload` 属性访问`XMLHttpRequestUpload` 对象)</span><br><span class="line"></span><br><span class="line">- 请求中没有使用 `ReadableStream` 对象</span><br><span class="line"></span><br><span class="line">##### 简单请求基本流程</span><br><span class="line"></span><br><span class="line">1. 浏览器会直接发出 `CORS` 请求并在请求头信息之中增加一个 `Origin` 字段(用来说明本次请求来自哪个源(协议 + 域名 + 端口))</span><br><span class="line"></span><br><span class="line">2. 服务器判断</span><br><span class="line"></span><br></pre></td></tr></table></figure> Origin <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   字段决定是否同意这次请求</span><br><span class="line"></span><br><span class="line">   1. 通过请求会在响应头增加 `CORS` 相关的字段(以`Access-Control-`开头)</span><br><span class="line">   2. 拒绝请求时不会增加 `CORS` 相关的字段，浏览器会抛出异常</span><br><span class="line"></span><br><span class="line">简单请求响应头中的 CORS 字段</span><br><span class="line"></span><br><span class="line">- `Access-Control-Allow-Origin`: 只能是 `*`(接受任意域名的请求)或者是请求时 `Origin` 字段的值</span><br><span class="line">- `Access-Control-Allow-Credentials`(可选): 是一个布尔值,表示是否允许发送 `Cookie`</span><br><span class="line">- `Access-Control-Expose-Headers`(可选): `CORS` 请求时 `XMLHttpRequest` 对象的 `getResponseHeader()` 方法只能拿到 6 个基本字段：`Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma`。如果想拿到其他字段就必须在 `Access-Control-Expose-Headers` 里面指定</span><br><span class="line"></span><br><span class="line">CORS 中的 Cookie 设置</span><br><span class="line"></span><br><span class="line">`CORS` 请求默认不发送 `Cookie`，如果需要发送需要满足如下条件</span><br><span class="line"></span><br><span class="line">- 服务器必须设置 `Access-Control-Allow-Credentials: true`</span><br><span class="line">- `Access-Control-Allow-Origin` 字段不能为 `*`</span><br><span class="line">- `AJAX` 请求的配置项需设置 `withCredentials = true`</span><br><span class="line"></span><br><span class="line">#### 非简单请求</span><br><span class="line"></span><br><span class="line">非简单请求是那种对服务器有特殊要求的请求，如请求方法是 `PUT` 或 `DELETE`，或者 `Content-Type` 字段的类型是 `application/json`。</span><br><span class="line">非简单请求会在正式通信之前增加一次 `HTTP` 查询请求，称为**预检请求**，用于获取服务器是否允许该实际请求，同时避免跨域请求对服务器的用户数据产生预期之外的影响</span><br><span class="line"></span><br><span class="line">预检请求</span><br><span class="line"></span><br><span class="line">预检请求用的请求方法是 `OPTIONS` 表示这个请求是用来询问的</span><br><span class="line"></span><br><span class="line">- 在预检请求请求头信息里会包含如下字段</span><br><span class="line">  - `Origin`: 表示本次请求来自哪个源</span><br><span class="line">  - `Access-Control-Request-Method`: 用于列出浏览器的 `CORS` 请求会用到哪些 `HTTP` 方法</span><br><span class="line">  - `Access-Control-Request-Headers`(可选): 指定浏览器 `CORS` 请求会额外发送的头信息字段</span><br><span class="line">- 服务器通过后会在预检请求响应头中设置如下字段</span><br><span class="line">  - `Access-Control-Allow-Origin`</span><br><span class="line">  - `Access-Control-Allow-Credentials`(可选)</span><br><span class="line">  - `Access-Control-Allow-Methods`: 表示服务器支持的所有跨域请求的方法(为了避免多次预检请求)</span><br><span class="line">  - `Access-Control-Allow-Headers`: 表示服务器支持的所有头信息字段，不限于浏览器在预检中请求的字段</span><br><span class="line">  - `Access-Control-Max-Age`(可选): 用来指定本次预检请求的有效期单位为秒，在有效期内将不发出另一条预检请求</span><br><span class="line"></span><br><span class="line">一旦服务器通过了预检请求，以后每次浏览器正常的 `CORS` 请求，就都跟简单请求一样会有一个 `Origin` 头信息字段。服务器的回应也都会有一个 `Access-Control-Allow-Origin` 头信息字段</span><br><span class="line"></span><br><span class="line">&lt;details class=&quot;details custom-block&quot; style=&quot;box-sizing: border-box; border-width: 1px; border-style: solid; border-color: var(--vp-custom-block-details-border); border-image: initial; border-radius: 8px; padding: 16px 16px 8px; line-height: 24px; font-size: var(--vp-custom-block-font-size); color: var(--vp-custom-block-details-text); background-color: var(--vp-custom-block-details-bg); margin: 16px 0px;&quot;&gt;&lt;summary style=&quot;box-sizing: border-box; touch-action: manipulation; margin: 0px 0px 8px; font-weight: 700; cursor: pointer;&quot;&gt;CORS 请求过程&lt;/summary&gt;&lt;p style=&quot;box-sizing: border-box; margin: 8px 0px; overflow-wrap: break-word; line-height: 24px;&quot;&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20230913230220.png&quot; alt=&quot;CORS 请求过程&quot; class=&quot;medium-zoom-image&quot; style=&quot;box-sizing: border-box; display: block; max-width: 100%; height: auto; cursor: zoom-in; transition: transform 0.3s cubic-bezier(0.2, 0, 0.2, 1) 0s !important;&quot;&gt;&lt;/p&gt;&lt;/details&gt;</span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line">相关资料</span><br><span class="line"></span><br><span class="line">[跨域资源共享 CORS 详解](http://www.ruanyifeng.com/blog/2016/04/cors.html)</span><br><span class="line"></span><br><span class="line">### JSONP</span><br><span class="line"></span><br><span class="line">`JSONP` 是利用 `&lt;script&gt;` 标签没有跨域限制的漏洞，当前源可以得到从其他来源动态产生的 `JSON` 数据</span><br><span class="line"></span><br><span class="line">**`JSONP` 请求过程流程**</span><br><span class="line"></span><br><span class="line">1. 前端定义一个解析的回调函数</span><br><span class="line">2. 创建 `script` 标签，其 `src` 指向接口地址并拼接好参数和回调函数名</span><br><span class="line">3. 后端处理数据并将其拼接到前端传入的回调函数中(拼接好的数据必须是一个合法的 `JavaScript` 脚本 )</span><br><span class="line">4. 浏览器执行后端返回的 `JavaScript` 脚本代码(调用定义好的回调函数)并删除刚创建的 `script` 标签</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">function normalizeParams(params) &#123;</span><br><span class="line">  if (!params) &#123;</span><br><span class="line">    return &#x27;&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  return Object.keys(params)</span><br><span class="line">    .map((key) =&gt; `$&#123;key&#125;=$&#123;params[key]&#125;`)</span><br><span class="line">    .join(&#x27;&amp;&#x27;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function jsonp(url, params) &#123;</span><br><span class="line">  return new Promise((resolve) =&gt; &#123;</span><br><span class="line">    const callback = `jsonp_$&#123;Date.now()&#125;`</span><br><span class="line">    window[callback] = function (data) &#123;</span><br><span class="line">      resolve(data)</span><br><span class="line">      document.body.removeChild(scriptEle)</span><br><span class="line">    &#125;</span><br><span class="line">    params.cb = callback</span><br><span class="line">    const scriptEle = document.createElement(&#x27;script&#x27;)</span><br><span class="line">    scriptEle.src = `$&#123;url&#125;$&#123;url.includes(&#x27;?&#x27;) ? &#x27;&amp;&#x27; : &#x27;?&#x27;&#125;$&#123;normalizeParams(params)&#125;`</span><br><span class="line">    document.body.appendChild(scriptEle)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">jsonp(&#x27;https://www.baidu.com/sugrec&#x27;, &#123;</span><br><span class="line">  prod: &#x27;pc&#x27;,</span><br><span class="line">  wd: &#x27;跨域&#x27;</span><br><span class="line">&#125;).then((res) =&gt; &#123;</span><br><span class="line">  console.log(res)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></code></pre></li></ul></li></ul><p>JSONP 跨域优缺点</p><ul><li>优点: 实现简单，兼容性好</li><li>缺点<ul><li>只支持 <code>GET</code> 请求</li><li>容易遭受 <code>XSS</code> 攻击</li></ul></li></ul><p><a href="https://juejin.cn/post/6844904126246027278">了解更多跨域解决方案请点击 —— 10 种跨域解决方案</a></p><h2 id="浏览器缓存机制"><a href="#浏览器缓存机制" class="headerlink" title="浏览器缓存机制"></a>浏览器缓存机制</h2><ul><li><ol><li>浏览器在发送请求前先判断是否命中强缓存</li></ol><ul><li>命中则不发送请求直接使用缓存，否则进行下一步</li></ul></li><li><ol><li>浏览器发送请求后会由服务器判断是否命中协商缓存</li></ol><ul><li>命中则从缓存获取资源，否则进行下一步</li></ul></li><li><ol><li>浏览器直接使用服务器返回的资源并更新缓存</li></ol></li></ul><h3 id="强缓存（200-OK）"><a href="#强缓存（200-OK）" class="headerlink" title="强缓存（200 OK）"></a>强缓存（200 OK）</h3><ul><li><pre><code>Expires<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">是服务器告诉浏览器的缓存过期时间（值为</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br></pre></td></tr></table></figure>GMT<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">  时间，即格林尼治时间）</span><br><span class="line"></span><br><span class="line">  - `HTTP1.0` 的产物</span><br><span class="line">  - 受本地时间影响</span><br><span class="line">  - 设置的值为 `max-age=xxx`（xxx 是 秒）</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  Cache-Control</span><br></pre></td></tr></table></figure> 用于控制缓存的行为- 是 `HTTP1.1` 的产物- 取值  - `public`：允许被客户端和代理服务器缓存  - `private`：只允许被客户端缓存（默认值）  - `no-cache`：允许被客户端和代理服务器缓存，但在使用缓存时需要经过协商缓存来验证决定  - `no-store`：所有内容都不会被缓存，即不使用强制缓存也不使用协商缓存每次请求都会下载完整的资源  - `maxage=xxx`：设置客户端和代理服务器的缓存时间，表示缓存内容将在 xxx 秒后失效  - `s-maxage=xxx`：设置代理服务器的缓存时间（优先级比 `max-age` 高）</code></pre></li></ul><p>Cache-Control 注意点</p><p><code>no-cache</code> 名字存在误导，其并不是不缓存数据，只是在使用缓存时需要经过协商缓存来验证决定<br><code>max-age=0</code> 和 <code>no-cache</code> 效果一致</p><h4 id="缓存位置"><a href="#缓存位置" class="headerlink" title="缓存位置"></a>缓存位置</h4><ul><li>内存缓存（memory cache）<ul><li>快速读取（内存缓存将编译解析后的文件，直接存入该进程的内存中，占据该进程一定的内存资源，以方便下次运行使用时的快速读取）</li><li>进程关闭时数据会被清除</li><li>不请求网络资源，资源存在内存中一般 <code>JS</code> 和图片文件会存入内存</li><li>状态码：<code>200（from memory cache）</code></li></ul></li><li>硬盘缓存（disk cache）<ul><li>写入硬盘文件进行 <code>I/O</code> 操作</li><li>进程关闭时数据不会被清除</li><li>速度比 <code>memory cache</code> 慢</li><li>不请求网络资源，资源存在磁盘中一般非脚本会存在磁盘中，如 <code>css</code></li><li>状态码：<code>200（from disk cache）</code></li></ul></li><li>代理服务器缓存（server worker）<ul><li>可以拦截处理页面的所有网络请求</li><li>仅 <code>HTTPS</code> 下可用、存在兼容问题</li><li>状态码：<code>200（from service worker）</code></li></ul></li></ul><h3 id="协商缓存（304-Not-Modified）"><a href="#协商缓存（304-Not-Modified）" class="headerlink" title="协商缓存（304 Not Modified）"></a>协商缓存（304 Not Modified）</h3><h4 id="Last-Modified-和-If-Modified-Since"><a href="#Last-Modified-和-If-Modified-Since" class="headerlink" title="Last-Modified 和 If-Modified-Since"></a><code>Last-Modified</code> 和 <code>If-Modified-Since</code></h4><p><code>Last-Modified</code> 表示资源的最后修改时间，值为 <code>GMT</code> 格式时间字符串，精确到秒</p><ul><li><p>浏览器第一次请求时，服务器会在响应头中返回请求资源的上次更新时间 <code>Last-Modified</code></p></li><li><p>当浏览器再次请求时，会在请求头中携带 <code>If-Modified-Since</code> 值为上次请求返回的 <code>Last-Modified</code></p></li><li><p>服务器收到请求后，会根据请求头中的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If-Modified-Since</span><br></pre></td></tr></table></figure><p>和该资源在服务器的最后被修改时间做对比</p><ul><li>大于 <code>If-Modified-Since</code> 重新返回资源文件，状态码为 200</li><li>小于 <code>If-Modified-Since</code> 资源无更新继续使用缓存文件，状态码为 304</li></ul></li></ul><p>Last-Modified 存在的问题</p><ul><li>时间精度为秒级会出现误差情况，对文件修改精度有严格要求的场景不能满足</li><li>在集群服务器上各个服务器上的文件时间可能不同</li><li>如果用旧文件覆盖新文件，因为时间更前浏览器不会请求旧文件</li><li>编辑了文件但未修改，会导致缓存失效</li></ul><h4 id="ETag-和-If-None-Match"><a href="#ETag-和-If-None-Match" class="headerlink" title="ETag 和 If-None-Match"></a>ETag 和 If-None-Match</h4><p><code>ETag</code> 是服务器通过算法对资源内容计算出的一个唯一标识（文件 <code>hash</code>）其有强弱之分</p><ul><li><p>强</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Etag</span><br></pre></td></tr></table></figure><ul><li><code>ETag: &quot;&lt;etag_value&gt;&quot;</code></li><li>资源发生任何改变都会立刻更新</li><li>难生成，利于比较</li></ul></li><li><p>弱</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Etag</span><br></pre></td></tr></table></figure><p>（使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">W/</span><br></pre></td></tr></table></figure><p>标识）</p><ul><li><code>ETag: W/&quot;&lt;etag_value&gt;&quot;</code></li><li>只在资源发生本质变化时更新</li><li>易生成，不利于比较</li></ul></li></ul><h5 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h5><ul><li><p>浏览器第一次请求时，服务器会在响应头中返回当前资源文件的一个唯一标识 <code>ETag</code></p></li><li><p>当浏览器再次请求时，会在请求头中携带 <code>If-None-Match</code> 值为上次请求返回的 <code>ETag</code></p></li><li><p>通过接收的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ETag</span><br></pre></td></tr></table></figure><p>和服务器重新生成的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ETag</span><br></pre></td></tr></table></figure><p>进行对比</p><ul><li>不一致 重新返回资源文件，状态码为 200</li><li>一致 资源无更新继续使用缓存文件，状态码为 304</li></ul></li></ul><p>Last-Modified 和 Etag 对比</p><ul><li>精确度上：<code>Etag</code> 优于 <code>Last-Modified</code></li><li>性能上：<code>Etag &lt; Last-Modified</code> 每次生成 <code>ETag</code> 都需要进行读写操作，而 <code>Last-Modified</code> 只需要读取操作</li><li>优先级：服务器校验优先考虑 <code>Etag</code>（先判断 <code>Etag</code> 是否变化，如果 <code>Etag</code> 没有变化再判断 <code>Last-Modified</code>）</li></ul><h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><table><thead><tr><th align="left">强缓存</th><th align="left">协商缓存</th></tr></thead><tbody><tr><td align="left">不常变化的文件 带 hash 值的 css js 图片</td><td align="left">频繁变动的文件 html 文件</td></tr></tbody></table><h3 id="用户行为对缓存的影响"><a href="#用户行为对缓存的影响" class="headerlink" title="用户行为对缓存的影响"></a>用户行为对缓存的影响</h3><ul><li>地址栏输入<ul><li>查找 <code>disk cache</code>（磁盘缓存）中是否有匹配，有则使用缓存，没有则发送网络请求</li></ul></li><li>普通刷新（F5）<ul><li>因为浏览器 <code>tab</code> 标签并没有关闭，因此 <code>memory cache</code> （内存缓存）是可用的，会被优先使用，其次使用 <code>disk cache</code>（磁盘缓存）</li><li>跳过强缓存规则，直接走协商缓存</li></ul></li><li>强制刷新（Ctrl + F5）<ul><li>浏览器不使用缓存，因此发送的请求头部均带有 <code>Cache-control: no-cache</code> （为了兼容还带了 <code>Pragma: no-cache</code>）服务器直接返回 200 和最新内容。</li><li>跳过所有缓存规则</li></ul></li></ul><h2 id="浏览器存储"><a href="#浏览器存储" class="headerlink" title="浏览器存储"></a>浏览器存储</h2><h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p><code>Cookie</code>（也叫 <code>Web Cookie</code> 或浏览器 <code>Cookie</code>）是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。通常，它用于告知服务端两个请求是否来自同一浏览器，如保持用户的登录状态。<code>Cookie</code> 使基于无状态的 <code>HTTP</code> 协议记录稳定的状态信息成为了可能，<code>Cookie</code> 在存储时是以键值对的形式存在的</p><p><code>Cookie</code> 主要用于以下三个方面：</p><ul><li>会话状态管理（如用户登录状态、购物车、游戏分数或其它需要记录的信息）</li><li>个性化设置（如用户自定义设置、主题等）</li><li>浏览器行为跟踪（如跟踪分析用户行为等）</li></ul><p><code>Cookie</code> 的本职工作并非本地存储，而是“维持状态”，因当时并没有其它合适的存储办法而作为唯一的存储手段，所以会用其进行本地存储</p><h4 id="Cookie-的生成和使用"><a href="#Cookie-的生成和使用" class="headerlink" title="Cookie 的生成和使用"></a>Cookie 的生成和使用</h4><ul><li>服务器生成，通过 <code>http response header</code> 中的 <code>set-cookie</code></li><li>在 <code>JavaScript</code> 中使用 <code>document.cookie</code> 进行读写</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 读取 */</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 写入 */</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&#x27;name=maomao&#x27;</span></span><br></pre></td></tr></table></figure><p>Cookie 的缺点</p><ul><li><code>Cookie</code> 最大只能有 <code>4KB</code> 同时大多数浏览器对一个站点的 <code>Cookie</code> 个数也是有限制的</li><li>同一个域名下的所有请求都会携带 <code>Cookie</code> 从而带来不必要的开销和安全问题</li></ul><h3 id="Web-Storage"><a href="#Web-Storage" class="headerlink" title="Web Storage"></a>Web Storage</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Storage_API">Web Storage</a>是 <code>HTML5</code> 专门为浏览器存储而提供的数据存储机制，其大小限制为 <code>5MB ~ 10MB</code> (<a href="http://dev-test.nemikor.com/web-storage/support-test/">去查看当前浏览器下 Web Storage 的容量限制</a>)，数据仅保存在客户端不与服务器进行通信</p><p><code>Web Storage</code> 提供了两种机制供我们使用</p><ul><li><code>Local Storage</code>(本地存储)</li><li><code>Session Storage</code>(会话存储)</li></ul><p>LocalStorage</p><ul><li>保存的数据长期存在</li><li>在同源的所有标签页和窗口之间共享数据</li></ul><p>SessionStorage</p><ul><li>数据只存在于当前浏览器的标签页</li><li>在新标签或窗口打开一个页面时会复制顶级浏览会话的上下文作为新会话的上下文<ul><li>在当前标签中打开一个同域下的页面时会复制当前标签页中的 <code>SessionStorage</code> 数据</li><li>复制的 <code>SessionStorage</code> 数据是独立的，不会相互影响(类似深拷贝)</li></ul></li><li>重新加载或恢复页面仍会保持原来的数据</li><li>关闭对应浏览器标签或窗口后数据会被清除</li></ul><h4 id="API-使用"><a href="#API-使用" class="headerlink" title="API 使用"></a>API 使用</h4><blockquote><p>以 <code>localStorage</code> 为例</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 存储数据 setItem() */</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;maomao&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 读取数据 getItem() */</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 删除指定数据 removeItem() */</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 清空数据 clear() */</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">clear</span>()</span><br></pre></td></tr></table></figure><p>sessionStorage localStorage 和 cookie 的区别</p><ul><li>相同点<ul><li>都是在客户端保存数据</li><li>存储数据的类型都是字符串</li></ul></li><li>不同点<ul><li>生命周期<ul><li><code>Cookie</code>: 可以设置失效时间(默认是关闭浏览器后失效)</li><li><code>localStorage</code>: 除非被手动清除否则将会永久保存</li><li><code>sessionStorage</code>: 仅在当前浏览器的标签页下有效，关闭标签或窗口后就会被清除</li></ul></li><li>数据大小<ul><li><code>Cookie</code>: 4KB</li><li><code>localStorage</code> 和 <code>sessionStorage</code>: <code>5MB ~ 10MB</code></li></ul></li><li>http 请求<ul><li><code>Cookie</code>: 每次都会携带在 <code>HTTP</code> 请求头中</li><li><code>localStorage</code> 和 <code>sessionStorage</code>: 仅在客户储保存不会与服务器通信</li></ul></li></ul></li></ul><h3 id="IndexedDB"><a href="#IndexedDB" class="headerlink" title="IndexedDB"></a>IndexedDB</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API">IndexedDB</a> 是一个运行在浏览器上的非关系型数据库，用于<strong>在客户端存储大量结构化数据</strong></p><p>IndexedDB 的特点</p><ul><li>存储空间大(一般来说不少于 <code>250MB</code> 甚至没有上限)</li><li>支持存储二进制数据(<code>ArrayBuffer</code> 和 <code>Blob</code>)</li><li>键值对储存</li><li>同源限制</li><li>执行的操作是异步执行，以免阻塞应用程序</li><li>是一个事务型数据库系统</li></ul><h4 id="API-使用-1"><a href="#API-使用-1" class="headerlink" title="API 使用"></a>API 使用</h4><p>打开&#x2F;创建一个 IndexedDB 数据库，并指定数据库的版本号 (版本号只能为整数)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="variable language_">window</span>.<span class="property">indexedDB</span>.<span class="title function_">open</span>(<span class="string">&#x27;myDatabase&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">let</span> db</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功回调</span></span><br><span class="line">request.<span class="property">onsuccess</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="comment">// 获取 indexedDB 实例</span></span><br><span class="line">  db = event.<span class="property">target</span>.<span class="property">result</span></span><br><span class="line">  <span class="comment">// 也可以使用 request.result 获取 indexedDB 实例</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;连接 IndexedDB 成功&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 失败回调</span></span><br><span class="line">request.<span class="property">onerror</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;连接 IndexedDB 失败&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建一个对象仓库(类似于数据库中的表)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// upgradeneeded 事件会在初始化数据库或版本发生更新时被调用</span></span><br><span class="line">request.<span class="property">onupgradeneeded</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> db = event.<span class="property">target</span>.<span class="property">result</span></span><br><span class="line">  <span class="comment">// 创建对象仓库并指定主键</span></span><br><span class="line">  <span class="keyword">const</span> objectStore = db.<span class="title function_">createObjectStore</span>(<span class="string">&#x27;userInfo&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">keyPath</span>: <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">    <span class="attr">autoIncrement</span>: <span class="literal">false</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;创建对象仓库成功&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 定义存储对象的数据项</span></span><br><span class="line"><span class="comment">   * 第一个参数是创建的索引名称，可以为空</span></span><br><span class="line"><span class="comment">   * 第二个参数是索引使用的关键名称，可以为空</span></span><br><span class="line"><span class="comment">   * 第三个参数是可选配置参数，可以不传，常用参数之一就是 unique ，表示该字段是否唯一，不能重复</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  objectStore.<span class="title function_">createIndex</span>(<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;id&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">unique</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line">  objectStore.<span class="title function_">createIndex</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>添加数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建事务指并定表格名称和读写权限</span></span><br><span class="line"><span class="keyword">const</span> transaction = db.<span class="title function_">transaction</span>([<span class="string">&#x27;userInfo&#x27;</span>], <span class="string">&#x27;readwrite&#x27;</span>)</span><br><span class="line"><span class="comment">// 获取 Object Store 对象</span></span><br><span class="line"><span class="keyword">const</span> objectStore = transaction.<span class="title function_">objectStore</span>(<span class="string">&#x27;userInfo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 添加数据 */</span></span><br><span class="line">objectStore.<span class="title function_">add</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;test&#x27;</span> &#125;)</span><br></pre></td></tr></table></figure><p>获取数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> transaction = db.<span class="title function_">transaction</span>([<span class="string">&#x27;userInfo&#x27;</span>], <span class="string">&#x27;readonly&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> objectStore = transaction.<span class="title function_">objectStore</span>(<span class="string">&#x27;userInfo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> objectStoreRequest = objectStore.<span class="title function_">get</span>(<span class="number">1</span>)</span><br><span class="line">objectStoreRequest.<span class="property">onsuccess</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取数据&#x27;</span>, objectStoreRequest.<span class="property">result</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> transaction = db.<span class="title function_">transaction</span>([<span class="string">&#x27;userInfo&#x27;</span>], <span class="string">&#x27;readwrite&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> objectStore = transaction.<span class="title function_">objectStore</span>(<span class="string">&#x27;userInfo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> objectStoreRequest = objectStore.<span class="title function_">get</span>(<span class="number">1</span>)</span><br><span class="line">objectStoreRequest.<span class="property">onsuccess</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = objectStoreRequest.<span class="property">result</span></span><br><span class="line">  data.<span class="property">name</span> = <span class="string">&#x27;maomao&#x27;</span></span><br><span class="line">  objectStore.<span class="title function_">put</span>(data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>删除数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> transaction = db.<span class="title function_">transaction</span>([<span class="string">&#x27;userInfo&#x27;</span>], <span class="string">&#x27;readwrite&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> objectStore = transaction.<span class="title function_">objectStore</span>(<span class="string">&#x27;userInfo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> objectStoreRequest = objectStore.<span class="title function_">delete</span>(<span class="number">1</span>)</span><br><span class="line">objectStoreRequest.<span class="property">onsuccess</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;删除成功&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在日常开发中可以使用如下类库简化代码量</p><ul><li><a href="https://github.com/localForage/localForage">localForage</a> 一个提供 <code>name:value</code> 的简单语法的客户端数据存储垫片，基于 <code>IndexedDB</code> 实现，并在不持支 <code>IndexedDB</code> 的浏览器中自动回退到 <code>WebSQL</code> 和 <code>localStorage</code></li><li><a href="https://github.com/dexie/Dexie.js">Dexie.js</a> 对 <code>IndexedDB</code> 的封装，通过提供更友好和简单语法进行快速的编码开发</li><li><a href="https://github.com/pouchdb/pouchdb">PouchDB</a> 对 <code>IndexedDB</code> 的封装，通过提供更友好和简单语法进行快速的编码开发</li></ul>]]></content>
      
      
      <categories>
          
          <category> 浏览器与网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 浏览器知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 相关技巧</title>
      <link href="/2023/09/12/Git%20%E7%9B%B8%E5%85%B3%E6%8A%80%E5%B7%A7/"/>
      <url>/2023/09/12/Git%20%E7%9B%B8%E5%85%B3%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<p>相关资料</p><ul><li><a href="https://git-scm.com/">官网</a></li><li><a href="https://learngitbranching.js.org/?locale=zh_CN">Git 学习教程</a></li><li><a href="https://docs.github.com/cn/get-started/getting-started-with-git">Git 入门指南</a></li><li><a href="https://github.com/521xueweihan/git-tips">Git 的奇技淫巧</a></li><li><a href="https://github.com/tj/git-extras">Git Extras</a> git 命令行扩展工具</li><li><a href="https://docs.github.com/cn/get-started/getting-started-with-git/configuring-git-to-handle-line-endings">配置 Git 处理行结束符</a></li><li><a href="https://gitee.com/help/articles/4229">Git 配置多个 SSH-Key</a></li><li>下载相关<ul><li><a href="https://npmmirror.com/mirrors/git-for-windows/">Windows 版下载镜像</a></li><li><a href="https://github.com/maomao1996/daily-notes/issues/7">使用 jsdelivr 加速 Github 仓库资源</a></li></ul></li></ul><h2 id="常用-Git-命令"><a href="#常用-Git-命令" class="headerlink" title="常用 Git 命令"></a>常用 Git 命令</h2><blockquote><p><code>[xxx]</code> 均为可选参数</p></blockquote><h3 id="git-clone"><a href="#git-clone" class="headerlink" title="git clone"></a>git clone</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拷贝一个 Git 仓库到本地</span></span><br><span class="line">git <span class="built_in">clone</span> 仓库地址</span><br><span class="line">git <span class="built_in">clone</span> 仓库地址 --depth 1 <span class="comment"># 只克隆最近一次的 commit</span></span><br></pre></td></tr></table></figure><h3 id="git-配置"><a href="#git-配置" class="headerlink" title="git 配置"></a>git 配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前的 Git 配置</span></span><br><span class="line">git config --list</span><br><span class="line"><span class="comment"># 设置使用 Git 时的用户名称</span></span><br><span class="line">git config [--global] user.name <span class="string">&quot;名称&quot;</span></span><br><span class="line"><span class="comment"># 设置使用 Git 时的邮箱地址</span></span><br><span class="line">git config [--global] user.email <span class="string">&quot;邮箱&quot;</span></span><br></pre></td></tr></table></figure><h3 id="git-文件操作"><a href="#git-文件操作" class="headerlink" title="git 文件操作"></a>git 文件操作</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加所有文件到暂存区</span></span><br><span class="line">git add .</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提交暂存区到仓库区</span></span><br><span class="line">git commit -m <span class="string">&quot;提交信息&quot;</span></span><br><span class="line">git commit --amend <span class="comment"># 增补提交，使用上次的 commit 信息，不添加新的 commit 记录</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示变更的文件</span></span><br><span class="line">git status</span><br><span class="line">        -s <span class="comment"># 精简输出</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只暂存被追踪的文件</span></span><br><span class="line">git stash</span><br><span class="line">        save <span class="string">&#x27;说明信息&#x27;</span> <span class="comment"># 添加说明信息</span></span><br><span class="line">        -u <span class="comment"># 暂存所有文件</span></span><br><span class="line"><span class="comment"># 查看 stash 列表</span></span><br><span class="line">git stash list</span><br><span class="line"><span class="comment"># 取出最近一次的 stash</span></span><br><span class="line">git stash apply</span><br><span class="line"><span class="comment"># 取出并删除最近一次的 stash</span></span><br><span class="line">git stash pop</span><br><span class="line"><span class="comment"># 清空所有 stash</span></span><br><span class="line">git stash clear</span><br></pre></td></tr></table></figure><h3 id="git-分支操作"><a href="#git-分支操作" class="headerlink" title="git 分支操作"></a>git 分支操作</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出所有本地分支</span></span><br><span class="line">git branch</span><br><span class="line">        [分支名] <span class="comment"># 新建一个分支(停留在当前分支)</span></span><br><span class="line">        -r <span class="comment"># 列出所有远程分支</span></span><br><span class="line">        -a <span class="comment"># 列出所有本地分支和远程分支</span></span><br><span class="line">        -d [分支名] <span class="comment"># 删除分支</span></span><br><span class="line">        -D [分支名] <span class="comment"># 强制删除分支</span></span><br><span class="line">        -r <span class="comment"># 列出所有远程分支</span></span><br><span class="line"><span class="comment"># 新建一个空白分支</span></span><br><span class="line">git checkout --orphan [分支名]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除本地所有分支</span></span><br><span class="line">git branch | xargs git branch -d</span><br><span class="line"><span class="comment"># 批量删除包含指定字符的本地分支【以 dev 为例】</span></span><br><span class="line">git branch | grep <span class="string">&#x27;dev&#x27;</span> | xargs git branch -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前的分支名</span></span><br><span class="line">git symbolic-ref --short -q HEAD</span><br><span class="line">git rev-parse --abbrev-ref HEAD</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 合并指定分支到当前分支</span></span><br><span class="line">git merge [分支名]</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示所有远程仓库</span></span><br><span class="line">git remote -v</span><br><span class="line"><span class="comment"># 添加远程仓库</span></span><br><span class="line">git remote add [name] [url]</span><br><span class="line"><span class="comment"># 删除远程仓库</span></span><br><span class="line">git remote remove [name]</span><br><span class="line"><span class="comment"># 查看远程仓库地址</span></span><br><span class="line">git remote get-url [name]</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 取回远程仓库的变化，并与本地分支合并</span></span><br><span class="line">git pull [remote][branch]</span><br><span class="line"><span class="comment"># 上传本地指定分支到远程仓库</span></span><br><span class="line">git push [remote][branch]</span><br><span class="line"><span class="comment"># 强行推送当前分支到远程仓库，忽略冲突</span></span><br><span class="line">git push [remote] --force</span><br></pre></td></tr></table></figure><h3 id="git-日志"><a href="#git-日志" class="headerlink" title="git 日志"></a>git 日志</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看提交过的完整日志</span></span><br><span class="line">git <span class="built_in">log</span></span><br><span class="line">        --oneline <span class="comment"># 查看精简日志（精简版本号和提交信息）</span></span><br><span class="line">        --pretty=oneline <span class="comment"># 查看精简日志（完整版本号和提交信息）</span></span><br><span class="line"><span class="comment"># 查看所有分支的所有操作记录（包括被删除的 commit 记录和 reset 操作）</span></span><br><span class="line">git reflog</span><br></pre></td></tr></table></figure><h3 id="git-统计"><a href="#git-统计" class="headerlink" title="git 统计"></a>git 统计</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计作者提交的次数</span></span><br><span class="line">git shortlog -s -n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算存储库中的提交总数</span></span><br><span class="line">git rev-list --all --count</span><br><span class="line"><span class="comment"># 计算存储库中分支指定的提交总数</span></span><br><span class="line">git rev-list --count [分支名]</span><br></pre></td></tr></table></figure><h3 id="git-reset"><a href="#git-reset" class="headerlink" title="git reset"></a>git reset</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 撤销 commit 操作</span></span><br><span class="line">git reset --soft HEAD~1 <span class="comment"># git reset --soft commit_id</span></span><br><span class="line"><span class="comment"># 撤销 commit 和 add 操作</span></span><br><span class="line">git reset --mixed HEAD~1 <span class="comment"># git reset --mixed commit_id</span></span><br><span class="line"><span class="comment"># 撤销 commit 和 add 操作同时撤销本地已追踪内容的修改</span></span><br><span class="line">git reset --hard HEAD~1 <span class="comment"># git reset --hard commit_id</span></span><br></pre></td></tr></table></figure><p><a href="https://dont-sleep-so-late.github.io/2023/09/06/git/">查看完整版 Git 命令</a></p><p><a href="https://juejin.cn/post/6844904191203213326">三年 Git 使用心得 &amp; 常见问题整理</a></p><p><a href="https://github.com/521xueweihan/git-tips">git 命令大全 github</a></p><h2 id="删除-Git-中的所有提交历史记录"><a href="#删除-Git-中的所有提交历史记录" class="headerlink" title="删除 Git 中的所有提交历史记录"></a>删除 Git 中的所有提交历史记录</h2><p>以 <code>master</code> 分支为例</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建 orphan 分支（以 main 为例）</span></span><br><span class="line">git checkout --orphan main</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加需要上传文件</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交更改</span></span><br><span class="line">git commit -m <span class="string">&quot;Initial&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除需要清空提交记录的分支</span></span><br><span class="line">git branch -D master</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将当前分支重命名为需要清空提交记录的分支名</span></span><br><span class="line">git branch -m master</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制更新存储库</span></span><br><span class="line">git push -f origin master</span><br></pre></td></tr></table></figure><h2 id="同步-github-fork-项目上游更新"><a href="#同步-github-fork-项目上游更新" class="headerlink" title="同步 github fork 项目上游更新"></a>同步 github fork 项目上游更新</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 添加上游仓库</span></span><br><span class="line">git remote add upstream https://github.com/项目地址</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 拉取上游变动</span></span><br><span class="line">git fetch upstream</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 合并(以 master 位置为例)</span></span><br><span class="line">git rebase upstream/master</span><br><span class="line"><span class="comment"># OR</span></span><br><span class="line">git merge upstream/master</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 更新远程 fork 仓库分支(以 master 位置为例)</span></span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure><h2 id="将代码提交到-github-的-gh-pages-分支"><a href="#将代码提交到-github-的-gh-pages-分支" class="headerlink" title="将代码提交到 github 的 gh-pages 分支"></a>将代码提交到 github 的 gh-pages 分支</h2><ol><li>安装 <code>gh-pages</code></li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pnpm add -D gh-pages</span><br><span class="line"><span class="comment"># OR</span></span><br><span class="line">npm install -D gh-pages</span><br></pre></td></tr></table></figure><ol><li>在 <code>package.json</code> 中添加如下脚本</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;deploy&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gh-pages -d dist -m deploy&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;deploy:build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npm run build &amp;&amp; npm run deploy&quot;</span></span><br></pre></td></tr></table></figure><ol><li>运行 <code>deploy</code> 脚本</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pnpm deploy</span><br><span class="line"><span class="comment"># OR</span></span><br><span class="line">npm run deploy</span><br></pre></td></tr></table></figure><h2 id="使用-GitHub-Actions-自动部署"><a href="#使用-GitHub-Actions-自动部署" class="headerlink" title="使用 GitHub Actions 自动部署"></a>使用 GitHub Actions 自动部署</h2><p><a href="https://github.com/features/actions">GitHub Actions</a> 是 GitHub 的持续集成服务</p><h3 id="配置-Secrets"><a href="#配置-Secrets" class="headerlink" title="配置 Secrets"></a>配置 Secrets</h3><blockquote><p>Action 需要有操作仓库的权限</p></blockquote><p>GitHub 官方的帮助文档：<a href="https://help.github.com/cn/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line">创建用于命令行的个人访问令牌</a></p><p>打开需要配置 Actions 的仓库，进入 <code>Settings/Secrets</code> 页面，配置 <code>ACCESS_TOKEN</code> 变量，储存内容为刚刚创建的个人访问令牌</p><h3 id="编写-workflow-文件"><a href="#编写-workflow-文件" class="headerlink" title="编写 workflow 文件"></a>编写 <code>workflow</code> 文件</h3><ol><li>点击仓库的 <code>Actions</code> 按钮</li><li>点击 <code>Set up a workflow yourself</code> 按钮</li><li>复制如下内容</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">GitHub</span> <span class="string">Actions</span> <span class="string">Build</span> <span class="string">and</span> <span class="string">Deploy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发条件: push 到 master 分支后</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置上海时区</span></span><br><span class="line"><span class="attr">env:</span></span><br><span class="line">  <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 任务</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build-and-deploy:</span></span><br><span class="line">    <span class="comment"># 服务器环境：最新版 ubuntu</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># 拉取代码</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">persist-credentials:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 打包静态文件</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">&amp;&amp;</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># 部署</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@releases/v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="comment"># GitHub 密钥</span></span><br><span class="line">          <span class="attr">ACCESS_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ACCESS_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="comment"># GitHub Pages 读取的分支</span></span><br><span class="line">          <span class="attr">BRANCH:</span> <span class="string">gh-pages</span></span><br><span class="line">          <span class="comment"># 静态文件所在目录</span></span><br><span class="line">          <span class="attr">FOLDER:</span> <span class="string">dist</span></span><br></pre></td></tr></table></figure><hr><p>相关资料</p><ul><li><a href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html">GitHub Actions 入门教程 | 阮一峰</a></li><li><a href="https://docs.github.com/cn/actions/reference">GitHub Actions 中文文档</a></li></ul><h2 id="git-log-格式化"><a href="#git-log-格式化" class="headerlink" title="git log 格式化"></a><code>git log</code> 格式化</h2><h3 id="修改默认时间格式"><a href="#修改默认时间格式" class="headerlink" title="修改默认时间格式"></a>修改默认时间格式</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global log.date iso8601</span><br></pre></td></tr></table></figure><ul><li><code>relative</code>: 相对时间格式</li><li><code>local</code>: 本地格式</li><li><code>iso</code> OR <code>iso8601</code>: <code>ISO8601</code> 格式</li><li><code>rfc</code>: <code>RFC2822</code> 格式</li><li><code>short</code>: <code>YYYY-MM-DD</code> 格式</li><li><code>raw</code>: 时间戳格式</li><li><code>default</code>: 默认格式</li></ul><h3 id="自定义输出格式"><a href="#自定义输出格式" class="headerlink" title="自定义输出格式"></a>自定义输出格式</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式为: [commit hash] [提交时间] [提交信息] [branch tag 信息] [作者名称]</span></span><br><span class="line">git <span class="built_in">log</span> --pretty=<span class="string">&#x27;%C(yellow)%h%C(reset) %ad %C(green)%s%C(reset) %C(red)%d%C(reset) %C(bold blue)[%an]%C(reset)&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置别名</span></span><br><span class="line"><span class="built_in">alias</span> glogp=<span class="string">&quot;git log --pretty=&#x27;%C(yellow)%h%C(reset) %ad %C(green)%s%C(reset) %C(red)%d%C(reset) %C(bold blue)[%an]%C(reset)&#x27;&quot;</span></span><br></pre></td></tr></table></figure><ul><li><code>%C(颜色值)</code>: 修改输出颜色</li><li><code>%H</code>: 完整的 <code>commit hash</code></li><li><code>%h</code>: 缩写的 <code>commit hash</code></li><li><code>%ad</code>: 提交时间(绝对时间 可以使用 <code>-date=</code> 定制格式)</li><li><code>%ar</code>: 提交时间(相对时间 按多久之前显示)</li><li><code>%s</code>: <code>commit message</code></li><li><code>%d</code>: <code>branch tag</code> 信息</li><li><code>%an</code>: 作者名称</li><li><code>%ae</code>: 作者的邮箱地址</li></ul><h2 id="本地不同分支关联不同的远程仓库"><a href="#本地不同分支关联不同的远程仓库" class="headerlink" title="本地不同分支关联不同的远程仓库"></a>本地不同分支关联不同的远程仓库</h2><ol><li><code>clone</code> 仓库 <code>mm-notes</code>（默认的 <code>remote</code> 为 <code>origin</code>）</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/maomao1996/mm-notes</span><br></pre></td></tr></table></figure><ol><li>添加远程仓库 <code>daily-notes</code>（<code>remote</code> 取名为 <code>daily-notes</code>）</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add daily-notes http://github.com/maomao1996/daily-notes</span><br></pre></td></tr></table></figure><ol><li>拉取 <code>daily-notes</code> 的 <code>master</code> 分支到本地（本地分支名为 <code>notes</code>）</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git fetch daily-notes master:notes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 推送本地分支 notes 到远程仓库 daily-notes 的 master 分支</span></span><br><span class="line">git push daily-notes notes:master</span><br></pre></td></tr></table></figure><ol><li>关联分支（本地分支 <code>notes</code> 关联远程仓库 <code>daily-notes</code> 的 <code>master</code> 分支）</li></ol><blockquote><p>本地分支关联远程分支后，可直接使用 <code>git push</code> 和 <code>git pull</code> 命令</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch --set-upstream-to=daily-notes/master notes</span><br></pre></td></tr></table></figure><ol><li>提取 <code>master</code> 分支的指定提交到 <code>notes</code> 分支</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换到 notes 分支</span></span><br><span class="line">git checkout notes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 master 分支的 commit 信息</span></span><br><span class="line">git <span class="built_in">log</span> --oneline master</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取 master 分支的指定提交到 notes 分支</span></span><br><span class="line">git cherry-pick &lt;commit <span class="built_in">hash</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 推送到远程仓库</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Git仓库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于 json-server 工具，准备后端接口服务环境</title>
      <link href="/2023/09/12/%E5%9F%BA%E4%BA%8E-json-server-%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%87%86%E5%A4%87%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E6%9C%8D%E5%8A%A1%E7%8E%AF%E5%A2%83/"/>
      <url>/2023/09/12/%E5%9F%BA%E4%BA%8E-json-server-%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%87%86%E5%A4%87%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E6%9C%8D%E5%8A%A1%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<h1 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h1><ol><li><p>安装全局工具  <strong>json-server</strong> （全局工具仅需要安装一次）【<a href="https://www.npmjs.com/package/json-server">官网</a>】 </p><blockquote><p><strong>npm install -g json-server 或 cnpm install -g json-server</strong></p></blockquote></li><li><p>代码根目录新建一个 db 目录 </p></li><li><p>将资料 index.json 移入 db 目录 </p></li><li><p>进入 db 目录，执行命令，启动后端接口服务</p><blockquote><p><strong>json-server index.json</strong></p></blockquote></li></ol><p>推荐： json-server –watch index.json (可以实时监听 json 文件的修改)</p><p><img src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20230912154329.png"></p><h1 id="具体过程："><a href="#具体过程：" class="headerlink" title="具体过程："></a>具体过程：</h1><blockquote><p>在项目的初始阶段，后端提供的接口或数据可能是不完整的，作为一名前端开发工程师，不可避免的要使用mock的数据。如果此时的你不想使用简单的静态数据，而是想自己在本地启动一个server来模拟请求相关的操作，那么json-server是一个不错的选择。<br>json-serve可以帮助我们快速搭建一个mock-server本地服务，可以根据不同的后缀获取到不同的数据。</p></blockquote><h6 id="一、准备工作"><a href="#一、准备工作" class="headerlink" title="一、准备工作"></a>一、准备工作</h6><h6 id="1、安装Node"><a href="#1、安装Node" class="headerlink" title="1、安装Node"></a>1、安装<a href="https://so.csdn.net/so/search?q=Node&spm=1001.2101.3001.7020">Node</a></h6><p>由于json-server需要通过Node对其进行启动，所以首先要安装Node。Node可自行安装，在此不再进行演示。</p><h6 id="2、全局安装json-server"><a href="#2、全局安装json-server" class="headerlink" title="2、全局安装json-server"></a>2、全局安装json-server</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install json-server -g</span><br></pre></td></tr></table></figure><h6 id="3、查看版本"><a href="#3、查看版本" class="headerlink" title="3、查看版本"></a>3、查看版本</h6><p>在cmd控制台中输入以下命令，查看版本号。用于验证是否安装成功。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json-server -v</span><br></pre></td></tr></table></figure><h6 id="4、准备一份JSON文件"><a href="#4、准备一份JSON文件" class="headerlink" title="4、准备一份JSON文件"></a>4、准备一份JSON文件</h6><p>我这里准备的是一份名字为score.json的文件，用于存放虚拟数据。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;scoreList&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span><span class="string">&quot;张三&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">12</span><span class="punctuation">,</span><span class="attr">&quot;sex&quot;</span><span class="punctuation">:</span><span class="string">&quot;男&quot;</span><span class="punctuation">,</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;yuWen&quot;</span><span class="punctuation">:</span><span class="number">10</span><span class="punctuation">,</span><span class="attr">&quot;shuXue&quot;</span><span class="punctuation">:</span><span class="number">20</span><span class="punctuation">,</span><span class="attr">&quot;yingYu&quot;</span><span class="punctuation">:</span><span class="number">30</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span><span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span><span class="string">&quot;李四&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">21</span><span class="punctuation">,</span><span class="attr">&quot;sex&quot;</span><span class="punctuation">:</span><span class="string">&quot;女&quot;</span><span class="punctuation">,</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;yuWen&quot;</span><span class="punctuation">:</span><span class="number">12</span><span class="punctuation">,</span><span class="attr">&quot;shuXue&quot;</span><span class="punctuation">:</span><span class="number">45</span><span class="punctuation">,</span><span class="attr">&quot;yingYu&quot;</span><span class="punctuation">:</span><span class="number">37</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">3</span><span class="punctuation">,</span><span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span><span class="string">&quot;王五&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">56</span><span class="punctuation">,</span><span class="attr">&quot;sex&quot;</span><span class="punctuation">:</span><span class="string">&quot;男&quot;</span><span class="punctuation">,</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;yuWen&quot;</span><span class="punctuation">:</span><span class="number">12</span><span class="punctuation">,</span><span class="attr">&quot;shuXue&quot;</span><span class="punctuation">:</span><span class="number">20</span><span class="punctuation">,</span><span class="attr">&quot;yingYu&quot;</span><span class="punctuation">:</span><span class="number">30</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">,</span><span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span><span class="string">&quot;赵六&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">23</span><span class="punctuation">,</span><span class="attr">&quot;sex&quot;</span><span class="punctuation">:</span><span class="string">&quot;女&quot;</span><span class="punctuation">,</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;yuWen&quot;</span><span class="punctuation">:</span><span class="number">19</span><span class="punctuation">,</span><span class="attr">&quot;shuXue&quot;</span><span class="punctuation">:</span><span class="number">21</span><span class="punctuation">,</span><span class="attr">&quot;yingYu&quot;</span><span class="punctuation">:</span><span class="number">65</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">5</span><span class="punctuation">,</span><span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span><span class="string">&quot;严七&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">12</span><span class="punctuation">,</span><span class="attr">&quot;sex&quot;</span><span class="punctuation">:</span><span class="string">&quot;男&quot;</span><span class="punctuation">,</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;yuWen&quot;</span><span class="punctuation">:</span><span class="number">34</span><span class="punctuation">,</span><span class="attr">&quot;shuXue&quot;</span><span class="punctuation">:</span><span class="number">67</span><span class="punctuation">,</span><span class="attr">&quot;yingYu&quot;</span><span class="punctuation">:</span><span class="number">43</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">6</span><span class="punctuation">,</span><span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span><span class="string">&quot;沈八&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">43</span><span class="punctuation">,</span><span class="attr">&quot;sex&quot;</span><span class="punctuation">:</span><span class="string">&quot;女&quot;</span><span class="punctuation">,</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;yuWen&quot;</span><span class="punctuation">:</span><span class="number">56</span><span class="punctuation">,</span><span class="attr">&quot;shuXue&quot;</span><span class="punctuation">:</span><span class="number">76</span><span class="punctuation">,</span><span class="attr">&quot;yingYu&quot;</span><span class="punctuation">:</span><span class="number">30</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">7</span><span class="punctuation">,</span><span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span><span class="string">&quot;钱九&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">13</span><span class="punctuation">,</span><span class="attr">&quot;sex&quot;</span><span class="punctuation">:</span><span class="string">&quot;男&quot;</span><span class="punctuation">,</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;yuWen&quot;</span><span class="punctuation">:</span><span class="number">24</span><span class="punctuation">,</span><span class="attr">&quot;shuXue&quot;</span><span class="punctuation">:</span><span class="number">89</span><span class="punctuation">,</span><span class="attr">&quot;yingYu&quot;</span><span class="punctuation">:</span><span class="number">30</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">8</span><span class="punctuation">,</span><span class="attr">&quot;userName&quot;</span><span class="punctuation">:</span><span class="string">&quot;张十&quot;</span><span class="punctuation">,</span><span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">12</span><span class="punctuation">,</span><span class="attr">&quot;sex&quot;</span><span class="punctuation">:</span><span class="string">&quot;女&quot;</span><span class="punctuation">,</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;yuWen&quot;</span><span class="punctuation">:</span><span class="number">10</span><span class="punctuation">,</span><span class="attr">&quot;shuXue&quot;</span><span class="punctuation">:</span><span class="number">54</span><span class="punctuation">,</span><span class="attr">&quot;yingYu&quot;</span><span class="punctuation">:</span><span class="number">31</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h6 id="二、启动服务"><a href="#二、启动服务" class="headerlink" title="二、启动服务"></a>二、启动服务</h6><h6 id="1、常用命令选项："><a href="#1、常用命令选项：" class="headerlink" title="1、常用命令选项："></a>1、常用命令选项：</h6><ul><li>– watch：通过该命令可以实时监测score.json的变化，如果省略该命令，即使score.json发生变化，刷新、或重新发送请求，仍然会返回初次启动服务时的数据。简写形式为：-w</li><li>–port:指定服务的端口号，可省略，默认为3000。简写形式：-p</li><li>–host:设置域，可省略。简写形式：-H</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json-server --watch score.json --port 8090  --host 127.0.0.1</span><br></pre></td></tr></table></figure><p>上方命令可简写为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json-server score.json -w -p 8090 -H 127.0.0.1</span><br></pre></td></tr></table></figure><p>但，一般通过下面命令，即可完基本工作：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json-server -w score.json</span><br></pre></td></tr></table></figure><h6 id="2、工作场景建议"><a href="#2、工作场景建议" class="headerlink" title="2、工作场景建议"></a>2、工作场景建议</h6><p>如果你已知项目接口域名及端口号，为避免后续更改接口信息。我们可以这样做：</p><ul><li><p>假设项目接口域名为：<code>api.zhangpeiyue.com</code>,端口号为：<code>80</code></p></li><li><p>设置host映射：用记事本打开<code>C:\Windows\System32\drivers\etc</code>目录中的<code>hosts</code>文件。底部增加：<code>127.0.0.1 api.zhangpeiyue.com</code>，该文件如果不允许修改，增加相对应的权限即可。</p></li><li><p>启动服务命令：</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json-server --watch score.json --port 80  --host api.zhangpeiyue.com</span><br></pre></td></tr></table></figure><p>由于80是默认端口号，所以我们可以通过<code>api.zhangpeiyue.com</code>来对数据进行操作了。</p><h6 id="3、通过package-json文件启动项目"><a href="#3、通过package-json文件启动项目" class="headerlink" title="3、通过package.json文件启动项目"></a>3、通过<code>package.json</code>文件启动项目</h6><p>启动json-server时， 如果自定义配置的参数过多，容易出现命令敲错的现象。我们可以在创建一个名字为<code>package.json</code>的文件，内容为：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;score&quot;</span><span class="punctuation">:</span> <span class="string">&quot;json-server --watch score.json --port 80  --host api.zhangpeiyue.com&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>通过<code>npm run score</code>启动即可。</p><h6 id="4、自定义配置文件"><a href="#4、自定义配置文件" class="headerlink" title="4、自定义配置文件"></a>4、自定义配置文件</h6><p>json-server允许我们把所有的配置放到一个配置文件中，这个配置文件默认json-server.json。配置文件的主要内容如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="number">80</span><span class="punctuation">,</span>  <span class="comment">// 自定义服务监听端口</span></span><br><span class="line">  <span class="attr">&quot;watch&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// 服务监听</span></span><br><span class="line">  <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;api.zhangpeiyue.com&quot;</span><span class="punctuation">,</span><span class="comment">// 指定域</span></span><br><span class="line">  <span class="attr">&quot;static&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./public&quot;</span><span class="punctuation">,</span> <span class="comment">// 静态文件目录，可以将项目的HTML,JS,IMG等资源放在这里</span></span><br><span class="line">  <span class="attr">&quot;read-only&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span>  <span class="comment">// 是否只允许get请求</span></span><br><span class="line">  <span class="attr">&quot;no-cors&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> <span class="comment">// 是否允许跨域访问</span></span><br><span class="line">  <span class="attr">&quot;no-gzip&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> <span class="comment">// 是否可压缩</span></span><br><span class="line">  <span class="attr">&quot;routes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;route.json&quot;</span> <span class="comment">// 自定义路由，这个配置可以暂时省略，后续会有所涉及</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>可以通过<code>json-server --watch score.json</code>启动项目。</p><p>4、输出类似以下内容，说明启动成功。</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMjAxNTk3MC0wMmYxMDgwMDI1OTIxNjgzLnBuZw?x-oss-process=image/format,png" alt="img"></p><h6 id="5、其它相关启动参数"><a href="#5、其它相关启动参数" class="headerlink" title="5、其它相关启动参数"></a>5、其它相关启动参数</h6><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMjAxNTk3MC1lODk1MDc0ZjdlMTU2NWU1LnBuZw?x-oss-process=image/format,png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> json-server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 实现历史搜索记录</title>
      <link href="/2023/09/11/2023-09-11-Vue-%E6%90%9C%E7%B4%A2%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E7%AE%A1%E7%90%86/"/>
      <url>/2023/09/11/2023-09-11-Vue-%E6%90%9C%E7%B4%A2%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="搜索-历史记录管理"><a href="#搜索-历史记录管理" class="headerlink" title="搜索 - 历史记录管理"></a>搜索 - 历史记录管理</h1><p>1.搜索历史基本渲染<br>2.点击搜索(添加历史)<br>    点击 搜索按钮或底下历史记录，都能进行搜索<br>    ① 若之前 <strong>没有</strong> 相同搜索关键字，则直接<strong>追加到最前面</strong></p><p>​② 若之前 <strong>已有</strong> 相同搜索关键字，将该原有关键字移除，再追加</p><p>3.清空历史:添加清空图标，可以清空历史记录</p><h2 id="搜索-历史记录-基本管理"><a href="#搜索-历史记录-基本管理" class="headerlink" title="搜索 - 历史记录 - 基本管理"></a>搜索 - 历史记录 - 基本管理</h2><ol><li>data 中提供数据，和搜索框双向绑定 (实时获取用户内容)</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">search</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;van-search v-model=<span class="string">&quot;search&quot;</span> show-action placeholder=<span class="string">&quot;请输入搜索关键词&quot;</span> clearable&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">template</span> #<span class="attr">action</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line">&lt;/van-search&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>准备假数据，进行基本的历史纪录渲染</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="attr">history</span>: [<span class="string">&#x27;手机&#x27;</span>, <span class="string">&#x27;空调&#x27;</span>, <span class="string">&#x27;白酒&#x27;</span>, <span class="string">&#x27;电视&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">    </span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;search-history&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;history.length &gt; 0&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  ...</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;item in history&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;goSearch(item)&quot;</span> <span class="attr">class</span>=<span class="string">&quot;list-item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;&#123; item &#125;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ol start="3"><li>点击搜索，或者下面搜索历史按钮，都要进行搜索历史记录更新 (去重，新搜索的内容置顶)</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;div @click=<span class="string">&quot;goSearch(search)&quot;</span>&gt;搜索&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;item in history&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;goSearch(item)&quot;</span> <span class="attr">class</span>=<span class="string">&quot;list-item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#123; item &#125;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">goSearch (key) &#123;</span><br><span class="line">  <span class="keyword">const</span> index = <span class="variable language_">this</span>.<span class="property">history</span>.<span class="title function_">indexOf</span>(key)</span><br><span class="line">  <span class="keyword">if</span> (index !== -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">history</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">history</span>.<span class="title function_">unshift</span>(key)</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">`/searchlist?search=<span class="subst">$&#123;key&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>清空历史</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;van-icon @click=<span class="string">&quot;clear&quot;</span> name=<span class="string">&quot;delete-o&quot;</span> size=<span class="string">&quot;16&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">clear () &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">history</span> = []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="搜索-历史记录-持久化"><a href="#搜索-历史记录-持久化" class="headerlink" title="搜索 - 历史记录 - 持久化"></a>搜索 - 历史记录 - 持久化</h2><ol><li>持久化到本地 - 封装方法</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">HISTORY_KEY</span> = <span class="string">&#x27;hm_history_list&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取搜索历史</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getHistoryList</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="variable constant_">HISTORY_KEY</span>)</span><br><span class="line">  <span class="keyword">return</span> result ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(result) : []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置搜索历史</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">setHistoryList</span> = (<span class="params">arr</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="variable constant_">HISTORY_KEY</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(arr))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>页面中调用 - 实现持久化</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">data () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">search</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">history</span>: <span class="title function_">getHistoryList</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  goSearch (key) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="title function_">setHistoryList</span>(<span class="variable language_">this</span>.<span class="property">history</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">`/searchlist?search=<span class="subst">$&#123;key&#125;</span>`</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  clear () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">history</span> = []</span><br><span class="line">    <span class="title function_">setHistoryList</span>([])</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$toast</span>.<span class="title function_">success</span>(<span class="string">&#x27;清空历史成功&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库和身份认证</title>
      <link href="/2023/09/09/mysql/"/>
      <url>/2023/09/09/mysql/</url>
      
        <content type="html"><![CDATA[<h2 id="Node-操作-mysql"><a href="#Node-操作-mysql" class="headerlink" title="Node 操作 mysql"></a>Node 操作 mysql</h2><h3 id="配置-mysql-模块"><a href="#配置-mysql-模块" class="headerlink" title="配置 mysql 模块"></a>配置 mysql 模块</h3><ol><li>安装 mysql 模块</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mysql</span><br></pre></td></tr></table></figure><ol start="2"><li>建立连接</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">  <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">  <span class="attr">database</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="3"><li>测试是否正常工作</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(<span class="string">&#x27;select 1&#x27;</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(results)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="操作-mysql-数据库"><a href="#操作-mysql-数据库" class="headerlink" title="操作 mysql 数据库"></a>操作 mysql 数据库</h3><ol><li>查询数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(<span class="string">&#x27;select * from users&#x27;</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="2"><li>插入数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ? 表示占位符</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;insert into users values(?, ?)&#x27;</span></span><br><span class="line"><span class="comment">// 使用数组的形式为占位符指定具体的值</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [username, password], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;插入成功&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>向表中新增数据时，如果数据对象的每个属性和数据表的字段一一对应，则可以通过如下方式快速插入数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;<span class="attr">username</span>:<span class="string">&#x27;Bruce&#x27;</span>, <span class="attr">password</span>:<span class="string">&#x27;55520&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;insert into users set ?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, user, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="3"><li>更新数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;update users set username=?, password=? where id=?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [username, password, id], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>快捷方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;<span class="attr">id</span>:<span class="number">7</span>,<span class="attr">username</span>:<span class="string">&#x27;Bruce&#x27;</span>,<span class="attr">password</span>:<span class="string">&#x27;55520&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;update users set ? where id=?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [user, user.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>删除数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;delete from users where id=?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, id, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>使用 delete 语句会真正删除数据，保险起见，使用标记删除的形式，模拟删除的动作。即在表中设置状态字段，标记当前的数据是否被删除。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(<span class="string">&#x27;update users set status=1 where id=?&#x27;</span>, <span class="number">7</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="Web-开发模式"><a href="#Web-开发模式" class="headerlink" title="Web 开发模式"></a>Web 开发模式</h2><h3 id="服务端渲染"><a href="#服务端渲染" class="headerlink" title="服务端渲染"></a>服务端渲染</h3><p>服务器发送给客户端的 HTML 页面，是在服务器通过字符串的拼接动态生成的。因此客户端不需要使用 Ajax 额外请求页面的数据。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/index.html&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&#x27;Bruce&#x27;</span>, <span class="attr">age</span>: <span class="number">29</span> &#125;</span><br><span class="line">  <span class="keyword">const</span> html = <span class="string">`&lt;h1&gt;username:<span class="subst">$&#123;user.name&#125;</span>, age:<span class="subst">$&#123;user.age&#125;</span>&lt;/h1&gt;`</span></span><br><span class="line">  res.<span class="title function_">send</span>(html)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>优点：</p><ul><li>前端耗时短。浏览器只需直接渲染页面，无需额外请求数据。</li><li>有利于 SEO。服务器响应的是完整的 HTML 页面内容，有利于爬虫爬取信息。</li></ul><p>缺点：</p><ul><li>占用服务器资源。服务器需要完成页面内容的拼接，若请求比较多，会对服务器造成一定访问压力。</li><li>不利于前后端分离，开发效率低。</li></ul><h3 id="前后端分离"><a href="#前后端分离" class="headerlink" title="前后端分离"></a>前后端分离</h3><p>前后端分离的开发模式，依赖于 Ajax 技术的广泛应用。后端只负责提供 API 接口，前端使用 Ajax 调用接口。</p><p>优点：</p><ul><li>开发体验好。前端专业页面开发，后端专注接口开发。</li><li>用户体验好。页面局部刷新，无需重新请求页面。</li><li>减轻服务器的渲染压力。页面最终在浏览器里生成。</li></ul><p>缺点：</p><ul><li>不利于 SEO。完整的 HTML 页面在浏览器拼接完成，因此爬虫无法爬取页面的有效信息。Vue、React 等框架的 SSR（server side render）技术能解决 SEO 问题。</li></ul><h3 id="如何选择"><a href="#如何选择" class="headerlink" title="如何选择"></a>如何选择</h3><ul><li>企业级网站，主要功能是展示，没有复杂交互，且需要良好的 SEO，可考虑服务端渲染</li><li>后台管理项目，交互性强，无需考虑 SEO，可使用前后端分离</li><li>为同时兼顾首页渲染速度和前后端分离开发效率，可采用首屏服务器端渲染+其他页面前后端分离的开发模式</li></ul><h2 id="身份认证"><a href="#身份认证" class="headerlink" title="身份认证"></a>身份认证</h2><h3 id="Session-认证机制"><a href="#Session-认证机制" class="headerlink" title="Session 认证机制"></a>Session 认证机制</h3><p>服务端渲染推荐使用 Session 认证机制</p><h4 id="Session-工作原理"><a href="#Session-工作原理" class="headerlink" title="Session 工作原理"></a>Session 工作原理</h4><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/Session.png" alt="session"></p><h4 id="Express-中使用-Session-认证"><a href="#Express-中使用-Session-认证" class="headerlink" title="Express 中使用 Session 认证"></a>Express 中使用 Session 认证</h4><ol><li>安装 express-session 中间件</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express-session</span><br></pre></td></tr></table></figure><ol start="2"><li>配置中间件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(</span><br><span class="line">  <span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="attr">secret</span>: <span class="string">&#x27;Bruce&#x27;</span>, <span class="comment">// secret 的值为任意字符串</span></span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">saveUninitalized</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ol start="3"><li>向 session 中存数据</li></ol><p>中间件配置成功后，可通过 <code>req.session</code> 访问 session 对象，存储用户信息</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  req.<span class="property">session</span>.<span class="property">user</span> = req.<span class="property">body</span></span><br><span class="line">  req.<span class="property">session</span>.<span class="property">isLogin</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">0</span>, <span class="attr">msg</span>: <span class="string">&#x27;login done&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>从 session 取数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/username&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">isLogin</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">msg</span>: <span class="string">&#x27;fail&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">0</span>, <span class="attr">msg</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">user</span>.<span class="property">username</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="5"><li>清空 session</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/logout&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 清空当前客户端的session信息</span></span><br><span class="line">  req.<span class="property">session</span>.<span class="title function_">destroy</span>()</span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">0</span>, <span class="attr">msg</span>: <span class="string">&#x27;logout done&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="JWT-认证机制"><a href="#JWT-认证机制" class="headerlink" title="JWT 认证机制"></a>JWT 认证机制</h3><p>前后端分离推荐使用 JWT（JSON Web Token）认证机制，是目前最流行的跨域认证解决方案</p><h4 id="JWT-工作原理"><a href="#JWT-工作原理" class="headerlink" title="JWT 工作原理"></a>JWT 工作原理</h4><p>Session 认证的局限性：</p><ul><li>Session 认证机制需要配合 Cookie 才能实现。由于 Cookie 默认不支持跨域访问，所以，当涉及到前端跨域请求后端接口的时候，需要做很多额外的配置，才能实现跨域 Session 认证。</li><li>当前端请求后端接口不存在跨域问题的时候，推荐使用 Session 身份认证机制。</li><li>当前端需要跨域请求后端接口的时候，不推荐使用 Session 身份认证机制，推荐使用 JWT 认证机制</li></ul><p>JWT 工作原理图：</p><p>用户的信息通过 Token 字符串的形式，保存在客户端浏览器中。服务器通过还原 Token 字符串的形式来认证用户的身份。</p><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/JWT.png" alt="JWT"></p><p>JWT 组成部分：</p><ul><li>Header、Payload、Signature</li><li>Payload 是真正的用户信息，加密后的字符串</li><li>Header 和 Signature 是安全性相关部分，保证 Token 安全性</li><li>三者使用 <code>.</code> 分隔</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Header.Payload.Signature</span><br><span class="line"></span><br><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTcsInVzZXJuYW1lIjoiQnJ1Y2UiLCJwYXNzd29yZCI6IiIsIm5pY2tuYW1lIjoiaGVsbG8iLCJlbWFpbCI6InNjdXRAcXEuY29tIiwidXNlcl9waWMiOiIiLCJpYXQiOjE2NDE4NjU3MzEsImV4cCI6MTY0MTkwMTczMX0.bmqzAkNSZgD8IZxRGGyVlVwGl7EGMtWitvjGD-a5U5c</span><br></pre></td></tr></table></figure><p>JWT 使用方式：</p><ul><li>客户端会把 JWT 存储在 localStorage 或 sessionStorage 中</li><li>此后客户端与服务端通信需要携带 JWT 进行身份认证，将 JWT 存在 HTTP 请求头 Authorization 字段中</li><li>加上 Bearer 前缀</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Authorization: Bearer &lt;token&gt;</span><br></pre></td></tr></table></figure><h4 id="Express-使用-JWT"><a href="#Express-使用-JWT" class="headerlink" title="Express 使用 JWT"></a>Express 使用 JWT</h4><ol><li>安装</li></ol><ul><li>jsonwebtoken 用于生成 JWT 字符串</li><li>express-jwt 用于将 JWT 字符串解析还原成 JSON 对象</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jsonwebtoken express-jwt</span><br></pre></td></tr></table></figure><ol start="2"><li>定义 secret 密钥</li></ol><ul><li>为保证 JWT 字符串的安全性，防止其在网络传输过程中被破解，需定义用于加密和解密的 secret 密钥</li><li>生成 JWT 字符串时，使用密钥加密信息，得到加密好的 JWT 字符串</li><li>把 JWT 字符串解析还原成 JSON 对象时，使用密钥解密</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> expressJWT = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 密钥为任意字符串</span></span><br><span class="line"><span class="keyword">const</span> secretKey = <span class="string">&#x27;Bruce&#x27;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>生成 JWT 字符串</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;登录成功&#x27;</span>,</span><br><span class="line">    <span class="comment">// jwt.sign() 生成 JWT 字符串</span></span><br><span class="line">    <span class="comment">// 参数：用户信息对象、加密密钥、配置对象-token有效期</span></span><br><span class="line">    <span class="comment">// 尽量不保存敏感信息，因此只有用户名，没有密码</span></span><br><span class="line">    <span class="attr">token</span>: jwt.<span class="title function_">sign</span>(&#123;<span class="attr">username</span>: userInfo.<span class="property">username</span>&#125;, secretKey, &#123;<span class="attr">expiresIn</span>: <span class="string">&#x27;10h&#x27;</span>&#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>JWT 字符串还原为 JSON 对象</li></ol><ul><li>客户端访问有权限的接口时，需通过请求头的 <code>Authorization</code> 字段，将 Token 字符串发送到服务器进行身份认证</li><li>服务器可以通过 express-jwt 中间件将客户端发送过来的 Token 解析还原成 JSON 对象</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// unless(&#123; path: [/^\/api\//] &#125;) 指定哪些接口无需访问权限</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123; <span class="attr">secret</span>: secretKey &#125;).<span class="title function_">unless</span>(&#123; <span class="attr">path</span>: [<span class="regexp">/^\/api\//</span>] &#125;))</span><br></pre></td></tr></table></figure><ol start="5"><li>获取用户信息</li></ol><ul><li>当 express-jwt 中间件配置成功后，即可在那些有权限的接口中，使用 <code>req.user</code> 对象，来访问从 JWT 字符串中解析出来的用户信息</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/admin/getinfo&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">user</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;获取信息成功&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: req.<span class="property">user</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="6"><li>捕获解析 JWT 失败后产生的错误</li></ol><ul><li>当使用 express-jwt 解析 Token 字符串时，如果客户端发送过来的 Token 字符串过期或不合法，会产生一个解析失败的错误，影响项目的正常运行</li><li>通过 Express 的错误中间件，捕获这个错误并进行相关的处理</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">401</span>, <span class="attr">message</span>: <span class="string">&#x27;Invalid token&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">500</span>, <span class="attr">message</span>: <span class="string">&#x27;Unknown error&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nodejs </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大事件后台 API 项目</title>
      <link href="/2023/09/09/ev_api_server/"/>
      <url>/2023/09/09/ev_api_server/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://www.showdoc.cc/escook?page_id=3707158761215217">API 接口文档</a></p></blockquote><h2 id="1-项目初始化"><a href="#1-项目初始化" class="headerlink" title="1. 项目初始化"></a>1. 项目初始化</h2><h3 id="1-1-创建项目"><a href="#1-1-创建项目" class="headerlink" title="1.1 创建项目"></a>1.1 创建项目</h3><ol><li>新建 <code>api_server</code> 文件夹作为项目根目录，并在项目根目录中运行如下的命令，初始化包管理配置文件：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><ol start="2"><li>运行如下的命令，安装特定版本的 <code>express</code>：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express@4.17.1</span><br></pre></td></tr></table></figure><ol start="3"><li>在项目根目录中新建 <code>app.js</code> 作为整个项目的入口文件，并初始化如下的代码：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建 express 的服务器实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// write your code here...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用 app.listen 方法，指定端口号并启动web服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3007</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;api server running at http://127.0.0.1:3007&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="1-2-配置-cors-跨域"><a href="#1-2-配置-cors-跨域" class="headerlink" title="1.2 配置 cors 跨域"></a>1.2 配置 cors 跨域</h3><ol><li>运行如下的命令，安装 <code>cors</code> 中间件：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i cors@2.8.5</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>app.js</code> 中导入并配置 <code>cors</code> 中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br></pre></td></tr></table></figure><h3 id="1-3-配置解析表单数据的中间件"><a href="#1-3-配置解析表单数据的中间件" class="headerlink" title="1.3 配置解析表单数据的中间件"></a>1.3 配置解析表单数据的中间件</h3><ol><li>通过如下的代码，配置解析 <code>application/x-www-form-urlencoded</code> 格式的表单数据的中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br></pre></td></tr></table></figure><h3 id="1-4-初始化路由相关的文件夹"><a href="#1-4-初始化路由相关的文件夹" class="headerlink" title="1.4 初始化路由相关的文件夹"></a>1.4 初始化路由相关的文件夹</h3><ol><li>在项目根目录中，新建 <code>router</code> 文件夹，用来存放所有的<code>路由</code>模块</li></ol><blockquote><p>路由模块中，只存放客户端的请求与处理函数之间的映射关系</p></blockquote><ol start="2"><li>在项目根目录中，新建 <code>router_handler</code> 文件夹，用来存放所有的 <code>路由处理函数模块</code></li></ol><blockquote><p>路由处理函数模块中，专门负责存放每个路由对应的处理函数</p></blockquote><h3 id="1-5-初始化用户路由模块"><a href="#1-5-初始化用户路由模块" class="headerlink" title="1.5 初始化用户路由模块"></a>1.5 初始化用户路由模块</h3><ol><li>在 <code>router</code> 文件夹中，新建 <code>user.js</code> 文件，作为用户的路由模块，并初始化代码：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册新用户</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;reguser OK&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;login OK&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>app.js</code> 中，导入注册用户路由模块 ：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, userRouter)</span><br></pre></td></tr></table></figure><h3 id="1-6-抽离用户路由模块中的处理函数"><a href="#1-6-抽离用户路由模块中的处理函数" class="headerlink" title="1.6 抽离用户路由模块中的处理函数"></a>1.6 抽离用户路由模块中的处理函数</h3><blockquote><p>目的：为了保证 <code>路由模块</code> 的纯粹性，所有的 <code>路由处理函数</code>，必须抽离到对应的 <code>路由处理函数模块</code> 中</p></blockquote><ol><li>在 <code>/router_handler/user.js</code> 中，使用 <code>exports</code> 对象，分别向外共享如下两个 <code>路由处理函数</code> ：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在这里定义和用户相关的路由处理函数，供 /router/user.js 模块进行调用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册用户的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">regUser</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;reguser OK&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">login</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;login OK&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>将 <code>/router/user.js</code> 中的代码修改为如下结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入用户路由处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册新用户</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, userHandler.<span class="property">regUser</span>)</span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, userHandler.<span class="property">login</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h2 id="2-登录注册"><a href="#2-登录注册" class="headerlink" title="2. 登录注册"></a>2. 登录注册</h2><h3 id="2-1-新建-ev-users-表"><a href="#2-1-新建-ev-users-表" class="headerlink" title="2.1 新建 ev_users 表"></a>2.1 新建 ev_users 表</h3><ol><li>在 <code>test</code> 数据库中，新建 <code>ev_users</code> 表如下：</li></ol><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/ev_users.png" alt="ev_users表结构"></p><h3 id="2-2-安装并配置-mysql-模块"><a href="#2-2-安装并配置-mysql-模块" class="headerlink" title="2.2 安装并配置 mysql 模块"></a>2.2 安装并配置 mysql 模块</h3><blockquote><p>在 API 接口项目中，需要安装并配置 <code>mysql</code> 这个第三方模块，来连接和操作 MySQL 数据库</p></blockquote><ol><li>运行如下命令，安装 <code>mysql</code> 模块：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mysql@2.18.1</span><br></pre></td></tr></table></figure><ol start="2"><li>在项目根目录中新建 <code>/db/index.js</code> 文件，在此自定义模块中创建数据库的连接对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建数据库连接对象</span></span><br><span class="line"><span class="keyword">const</span> db = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">  <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&#x27;admin123&#x27;</span>,</span><br><span class="line">  <span class="attr">database</span>: <span class="string">&#x27;my_db_01&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享 db 数据库连接对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = db</span><br></pre></td></tr></table></figure><h3 id="2-3-注册"><a href="#2-3-注册" class="headerlink" title="2.3 注册"></a>2.3 注册</h3><h4 id="2-3-0-实现步骤"><a href="#2-3-0-实现步骤" class="headerlink" title="2.3.0 实现步骤"></a>2.3.0 实现步骤</h4><ol><li>检测表单数据是否合法</li><li>检测用户名是否被占用</li><li>对密码进行加密处理</li><li>插入新用户</li></ol><h4 id="2-3-1-检测表单数据是否合法"><a href="#2-3-1-检测表单数据是否合法" class="headerlink" title="2.3.1 检测表单数据是否合法"></a>2.3.1 检测表单数据是否合法</h4><ol><li>判断用户名和密码是否为空</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接收表单数据</span></span><br><span class="line"><span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br><span class="line"><span class="comment">// 判断数据是否合法</span></span><br><span class="line"><span class="keyword">if</span> (!userinfo.<span class="property">username</span> || !userinfo.<span class="property">password</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;用户名或密码不能为空！&#x27;</span> &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-3-2-检测用户名是否被占用"><a href="#2-3-2-检测用户名是否被占用" class="headerlink" title="2.3.2 检测用户名是否被占用"></a>2.3.2 检测用户名是否被占用</h4><ol><li>导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_users where username=?`</span></span><br></pre></td></tr></table></figure><ol start="3"><li>执行 SQL 语句并根据结果判断用户名是否被占用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [userinfo.<span class="property">username</span>], <span class="keyword">function</span> (<span class="params">err, results</span>) &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: err.<span class="property">message</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 用户名被占用</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;用户名被占用，请更换其他用户名！&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> 用户名可用，继续后续流程...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="2-3-3-对密码进行加密处理"><a href="#2-3-3-对密码进行加密处理" class="headerlink" title="2.3.3 对密码进行加密处理"></a>2.3.3 对密码进行加密处理</h4><blockquote><p>为了保证密码的安全性，不建议在数据库以 <code>明文</code> 的形式保存用户密码，推荐对密码进行 <code>加密存储</code></p></blockquote><hr><p>在当前项目中，使用 <code>bcryptjs</code> 对用户密码进行加密，优点：</p><ul><li>加密之后的密码，<strong>无法被逆向破解</strong></li><li>同一明文密码多次加密，得到的<strong>加密结果各不相同</strong>，保证了安全性</li></ul><hr><ol><li>运行如下命令，安装指定版本的 <code>bcryptjs</code> ：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i bcryptjs@2.4.3</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/user.js</code> 中，导入 <code>bcryptjs</code> ：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>在注册用户的处理函数中，确认用户名可用之后，调用 <code>bcrypt.hashSync(明文密码, 随机盐的长度)</code> 方法，对用户的密码进行加密处理：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对用户的密码,进行 bcrype 加密，返回值是加密之后的密码字符串</span></span><br><span class="line">userinfo.<span class="property">password</span> = bcrypt.<span class="title function_">hashSync</span>(userinfo.<span class="property">password</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure><h4 id="2-3-4-插入新用户"><a href="#2-3-4-插入新用户" class="headerlink" title="2.3.4 插入新用户"></a>2.3.4 插入新用户</h4><ol><li>定义插入用户的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;insert into ev_users set ?&#x27;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行 SQL 语句，插入新用户：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, &#123; <span class="attr">username</span>: userinfo.<span class="property">username</span>, <span class="attr">password</span>: userinfo.<span class="property">password</span> &#125;, <span class="keyword">function</span> (<span class="params">err, results</span>) &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: err.<span class="property">message</span> &#125;)</span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但影响行数不为 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;注册用户失败，请稍后再试！&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 注册成功</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">0</span>, <span class="attr">message</span>: <span class="string">&#x27;注册成功！&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-4-优化-res-send-代码"><a href="#2-4-优化-res-send-代码" class="headerlink" title="2.4 优化 res.send() 代码"></a>2.4 优化 res.send() 代码</h3><blockquote><p>在处理函数中，需要多次调用 <code>res.send()</code> 向客户端响应 <code>处理失败</code> 的结果，为了简化代码，可以手动封装一个 res.cc() 函数</p></blockquote><ol><li>在 <code>app.js</code> 中，所有路由之前，声明一个全局中间件，为 res 对象挂载一个 <code>res.cc()</code> 函数 ：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 响应数据的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// status = 0 为成功； status = 1 为失败； 默认将 status 的值设置为 1，方便处理失败的情况</span></span><br><span class="line">  res.<span class="property">cc</span> = <span class="keyword">function</span> (<span class="params">err, status = <span class="number">1</span></span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="comment">// 状态</span></span><br><span class="line">      status,</span><br><span class="line">      <span class="comment">// 状态描述，判断 err 是 错误对象 还是 字符串</span></span><br><span class="line">      <span class="attr">message</span>: err <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? err.<span class="property">message</span> : err,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-5-优化表单数据验证"><a href="#2-5-优化表单数据验证" class="headerlink" title="2.5 优化表单数据验证"></a>2.5 优化表单数据验证</h3><blockquote><p>表单验证的原则：前端验证为辅，后端验证为主，后端<strong>永远不要相信</strong>前端提交过来的<strong>任何内容</strong></p></blockquote><p>在实际开发中，前后端都需要对表单的数据进行合法性的验证，而且，<strong>后端做为数据合法性验证的最后一个关口</strong>，在拦截非法数据方面，起到了至关重要的作用。</p><p>单纯的使用 <code>if...else...</code> 的形式对数据合法性进行验证，效率低下、出错率高、维护性差。因此，推荐使用<strong>第三方数据验证模块</strong>，来降低出错率、提高验证的效率与可维护性，<strong>让后端程序员把更多的精力放在核心业务逻辑的处理上</strong>。</p><ol><li>安装 <code>joi</code> 包，为表单中携带的每个数据项，定义验证规则：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install joi</span><br></pre></td></tr></table></figure><ol start="2"><li>安装 <code>@escook/express-joi</code> 中间件，来实现自动对表单数据进行验证的功能：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @escook/express-joi</span><br></pre></td></tr></table></figure><ol start="3"><li>新建 <code>/schema/user.js</code> 用户信息验证规则模块，并初始化代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * string() 值必须是字符串</span></span><br><span class="line"><span class="comment"> * alphanum() 值只能是包含 a-zA-Z0-9 的字符串</span></span><br><span class="line"><span class="comment"> * min(length) 最小长度</span></span><br><span class="line"><span class="comment"> * max(length) 最大长度</span></span><br><span class="line"><span class="comment"> * required() 值是必填项，不能为 undefined</span></span><br><span class="line"><span class="comment"> * pattern(正则表达式) 值必须符合正则表达式的规则</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户名的验证规则</span></span><br><span class="line"><span class="keyword">const</span> username = joi.<span class="title function_">string</span>().<span class="title function_">alphanum</span>().<span class="title function_">min</span>(<span class="number">1</span>).<span class="title function_">max</span>(<span class="number">10</span>).required()</span><br><span class="line"><span class="comment">// 密码的验证规则</span></span><br><span class="line"><span class="keyword">const</span> password = joi</span><br><span class="line">  .<span class="title function_">string</span>()</span><br><span class="line">  .<span class="title function_">pattern</span>(<span class="regexp">/^[\S]&#123;6,12&#125;$/</span>)</span><br><span class="line">  .required()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册和登录表单的验证规则对象</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">reg_login_schema</span> = &#123;</span><br><span class="line">  <span class="comment">// 表示需要对 req.body 中的数据进行验证</span></span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    username,</span><br><span class="line">    password,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>修改 <code>/router/user.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入用户路由处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 导入验证表单数据的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. 导入需要的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; reg_login_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册新用户</span></span><br><span class="line"><span class="comment">// 3. 在注册新用户的路由中，声明局部中间件，对当前请求中携带的数据进行验证</span></span><br><span class="line"><span class="comment">// 3.1 数据验证通过后，会把这次请求流转给后面的路由处理函数</span></span><br><span class="line"><span class="comment">// 3.2 数据验证失败后，终止后续代码的执行，并抛出一个全局的 Error 错误，进入全局错误级别中间件中进行处理</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, <span class="title function_">expressJoi</span>(reg_login_schema), userHandler.<span class="property">regUser</span>)</span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, userHandler.<span class="property">login</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol start="5"><li>在 <code>app.js</code> 的全局错误级别中间件中，捕获验证失败的错误，并把验证失败的结果响应给客户端：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">err, req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// 数据验证失败</span></span><br><span class="line">  <span class="keyword">if</span> (err <span class="keyword">instanceof</span> joi.<span class="property">ValidationError</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="comment">// 未知错误</span></span><br><span class="line">  res.<span class="title function_">cc</span>(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-6-登录"><a href="#2-6-登录" class="headerlink" title="2.6 登录"></a>2.6 登录</h3><h4 id="2-6-0-实现步骤"><a href="#2-6-0-实现步骤" class="headerlink" title="2.6.0 实现步骤"></a>2.6.0 实现步骤</h4><ol><li>检测表单数据是否合法</li><li>根据用户名查询用户的数据</li><li>判断用户输入的密码是否正确</li><li>生成 JWT 的 Token 字符串</li></ol><h4 id="2-6-1-检测登录表单的数据是否合法"><a href="#2-6-1-检测登录表单的数据是否合法" class="headerlink" title="2.6.1 检测登录表单的数据是否合法"></a>2.6.1 检测登录表单的数据是否合法</h4><ol><li>将 <code>/router/user.js</code> 中 <code>登录</code> 的路由代码修改如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 登录的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="title function_">expressJoi</span>(reg_login_schema), userHandler.<span class="property">login</span>)</span><br></pre></td></tr></table></figure><h4 id="2-6-2-根据用户名查询用户的数据"><a href="#2-6-2-根据用户名查询用户的数据" class="headerlink" title="2.6.2 根据用户名查询用户的数据"></a>2.6.2 根据用户名查询用户的数据</h4><ol><li>接收表单数据：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br></pre></td></tr></table></figure><ol start="2"><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_users where username=?`</span></span><br></pre></td></tr></table></figure><ol start="3"><li>执行 SQL 语句，查询用户的数据：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, userinfo.<span class="property">username</span>, <span class="keyword">function</span> (<span class="params">err, results</span>) &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="comment">// 执行 SQL 语句成功，但是查询到数据条数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;登录失败！&#x27;</span>)</span><br><span class="line">  <span class="comment">// TODO：判断用户输入的登录密码是否和数据库中的密码一致</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="2-6-3-判断用户输入的密码是否正确"><a href="#2-6-3-判断用户输入的密码是否正确" class="headerlink" title="2.6.3 判断用户输入的密码是否正确"></a>2.6.3 判断用户输入的密码是否正确</h4><blockquote><p>核心实现思路：调用 <code>bcrypt.compareSync(用户提交的密码, 数据库中的密码)</code> 方法比较密码是否一致</p></blockquote><blockquote><p>返回值是布尔值（true 一致、false 不一致）</p></blockquote><p>具体的实现代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 拿着用户输入的密码,和数据库中存储的密码进行对比</span></span><br><span class="line"><span class="keyword">const</span> compareResult = bcrypt.<span class="title function_">compareSync</span>(userinfo.<span class="property">password</span>, results[<span class="number">0</span>].<span class="property">password</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果对比的结果等于 false, 则证明用户输入的密码错误</span></span><br><span class="line"><span class="keyword">if</span> (!compareResult) &#123;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;登录失败！&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO：登录成功，生成 Token 字符串</span></span><br></pre></td></tr></table></figure><h4 id="2-6-4-生成-JWT-的-Token-字符串"><a href="#2-6-4-生成-JWT-的-Token-字符串" class="headerlink" title="2.6.4 生成 JWT 的 Token 字符串"></a>2.6.4 生成 JWT 的 Token 字符串</h4><blockquote><p>核心注意点：在生成 Token 字符串的时候，一定要剔除 <strong>密码</strong> 和 <strong>头像</strong> 的值</p></blockquote><ol><li>通过 ES6 的高级语法，快速剔除 <code>密码</code> 和 <code>头像</code> 的值：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 剔除完毕之后，user 中只保留了用户的 id, username, nickname, email 这四个属性的值</span></span><br><span class="line"><span class="keyword">const</span> user = &#123; ...results[<span class="number">0</span>], <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>, <span class="attr">user_pic</span>: <span class="string">&#x27;&#x27;</span> &#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>运行如下的命令，安装生成 Token 字符串的包：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i jsonwebtoken@8.5.1</span><br></pre></td></tr></table></figure><ol start="3"><li>在 <code>/router_handler/user.js</code> 模块的头部区域，导入 <code>jsonwebtoken</code> 包：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用这个包来生成 Token 字符串</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="4"><li>创建 <code>config.js</code> 文件，并向外共享 <strong>加密</strong> 和 <strong>还原</strong> Token 的 <code>jwtSecretKey</code> 字符串：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">jwtSecretKey</span>: <span class="string">&#x27;Bruce&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>将用户信息对象加密成 Token 字符串：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入配置文件</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成 Token 字符串</span></span><br><span class="line"><span class="keyword">const</span> tokenStr = jwt.<span class="title function_">sign</span>(user, config.<span class="property">jwtSecretKey</span>, &#123;</span><br><span class="line">  <span class="attr">expiresIn</span>: <span class="string">&#x27;10h&#x27;</span>, <span class="comment">// token 有效期为 10 个小时</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="6"><li>将生成的 Token 字符串响应给客户端：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">send</span>(&#123;</span><br><span class="line">  <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">message</span>: <span class="string">&#x27;登录成功！&#x27;</span>,</span><br><span class="line">  <span class="comment">// 为了方便客户端使用 Token，在服务器端直接拼接上 Bearer 的前缀</span></span><br><span class="line">  <span class="attr">token</span>: <span class="string">&#x27;Bearer &#x27;</span> + tokenStr,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-7-配置解析-Token-的中间件"><a href="#2-7-配置解析-Token-的中间件" class="headerlink" title="2.7 配置解析 Token 的中间件"></a>2.7 配置解析 Token 的中间件</h3><ol><li>运行如下的命令，安装解析 Token 的中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express-jwt@<span class="number">5.3</span><span class="number">.3</span></span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>app.js</code> 中注册路由之前，配置解析 Token 的中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入配置文件</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;./config&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析 token 的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJWT = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 .unless(&#123; path: [/^\/api\//] &#125;) 指定哪些接口不需要进行 Token 的身份认证</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123; <span class="attr">secret</span>: config.<span class="property">jwtSecretKey</span> &#125;).<span class="title function_">unless</span>(&#123; <span class="attr">path</span>: [<span class="regexp">/^\/api\//</span>] &#125;))</span><br></pre></td></tr></table></figure><ol start="3"><li>在 <code>app.js</code> 中的 <code>错误级别中间件</code> 里面，捕获并处理 Token 认证失败后的错误：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">err, req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// 省略其它代码...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 捕获身份认证失败的错误</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;身份认证失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 未知错误...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="3-个人中心"><a href="#3-个人中心" class="headerlink" title="3. 个人中心"></a>3. 个人中心</h2><h3 id="3-1-获取用户的基本信息"><a href="#3-1-获取用户的基本信息" class="headerlink" title="3.1 获取用户的基本信息"></a>3.1 获取用户的基本信息</h3><h4 id="3-1-0-实现步骤"><a href="#3-1-0-实现步骤" class="headerlink" title="3.1.0 实现步骤"></a>3.1.0 实现步骤</h4><ol><li>初始化 <strong>路由</strong> 模块</li><li>初始化 <strong>路由处理函数</strong> 模块</li><li>获取用户的基本信息</li></ol><h4 id="3-1-1-初始化路由模块"><a href="#3-1-1-初始化路由模块" class="headerlink" title="3.1.1 初始化路由模块"></a>3.1.1 初始化路由模块</h4><ol><li>创建 <code>/router/userinfo.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取用户的基本信息</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/userinfo&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>app.js</code> 中导入并使用个人中心的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入并使用用户信息路由模块</span></span><br><span class="line"><span class="keyword">const</span> userinfoRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/userinfo&#x27;</span>)</span><br><span class="line"><span class="comment">// 注意：以 /my 开头的接口，都是有权限的接口，需要进行 Token 身份认证</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my&#x27;</span>, userinfoRouter)</span><br></pre></td></tr></table></figure><h4 id="3-1-2-初始化路由处理函数模块"><a href="#3-1-2-初始化路由处理函数模块" class="headerlink" title="3.1.2 初始化路由处理函数模块"></a>3.1.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/userinfo.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取用户基本信息的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>修改 <code>/router/userinfo.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入用户信息的处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> userinfo_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/userinfo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取用户的基本信息</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/userinfo&#x27;</span>, userinfo_handler.<span class="property">getUserInfo</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h4 id="3-1-3-获取用户的基本信息"><a href="#3-1-3-获取用户的基本信息" class="headerlink" title="3.1.3 获取用户的基本信息"></a>3.1.3 获取用户的基本信息</h4><ol><li>在 <code>/router_handler/userinfo.js</code> 头部导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入数据库操作模块</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据用户的 id，查询用户的基本信息</span></span><br><span class="line"><span class="comment">// 注意：为了防止用户的密码泄露，需要排除 password 字段</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select id, username, nickname, email, user_pic from ev_users where id=?`</span></span><br></pre></td></tr></table></figure><ol start="3"><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注意：req 对象上的 user 属性，是 Token 解析成功，express-jwt 中间件帮我们挂载上去的</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">user</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. 执行 SQL 语句成功，但是查询到的数据条数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;获取用户信息失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 将用户信息响应给客户端</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;获取用户基本信息成功！&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results[<span class="number">0</span>],</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-2-更新用户的基本信息"><a href="#3-2-更新用户的基本信息" class="headerlink" title="3.2 更新用户的基本信息"></a>3.2 更新用户的基本信息</h3><h4 id="3-2-0-实现步骤"><a href="#3-2-0-实现步骤" class="headerlink" title="3.2.0 实现步骤"></a>3.2.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现更新用户基本信息的功能</li></ol><h4 id="3-2-1-定义路由和处理函数"><a href="#3-2-1-定义路由和处理函数" class="headerlink" title="3.2.1 定义路由和处理函数"></a>3.2.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>更新用户基本信息</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新用户的基本信息</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/userinfo&#x27;</span>, userinfo_handler.<span class="property">updateUserInfo</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>更新用户基本信息</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新用户基本信息的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2-2-验证表单数据"><a href="#3-2-2-验证表单数据" class="headerlink" title="3.2.2 验证表单数据"></a>3.2.2 验证表单数据</h4><ol><li>在 <code>/schema/user.js</code> 验证规则模块中，定义 <code>id</code>，<code>nickname</code>，<code>email</code> 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 id, nickname, emial 的验证规则</span></span><br><span class="line"><span class="keyword">const</span> id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).required()</span><br><span class="line"><span class="keyword">const</span> nickname = joi.<span class="title function_">string</span>().required()</span><br><span class="line"><span class="keyword">const</span> email = joi.<span class="title function_">string</span>().<span class="title function_">email</span>().required()</span><br></pre></td></tr></table></figure><ol start="2"><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 验证规则对象 - 更新用户基本信息</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_userinfo_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">    nickname,</span><br><span class="line">    email,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 <code>/router/userinfo.js</code> 模块中，导入验证数据合法性的中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入验证数据合法性的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="4"><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入需要的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_userinfo_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="5"><li>在 <code>/router/userinfo.js</code> 模块中，修改 <code>更新用户的基本信息</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新用户的基本信息</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/userinfo&#x27;</span>, <span class="title function_">expressJoi</span>(update_userinfo_schema), userinfo_handler.<span class="property">updateUserInfo</span>)</span><br></pre></td></tr></table></figure><h4 id="3-2-3-实现更新用户基本信息的功能"><a href="#3-2-3-实现更新用户基本信息的功能" class="headerlink" title="3.2.3 实现更新用户基本信息的功能"></a>3.2.3 实现更新用户基本信息的功能</h4><ol><li>定义待执行的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_users set ? where id=?`</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行 SQL 语句并传参：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>, req.<span class="property">body</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行 SQL 语句成功，但影响行数不为 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;修改用户基本信息失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 修改用户信息成功</span></span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;修改用户基本信息成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-3-重置密码"><a href="#3-3-重置密码" class="headerlink" title="3.3 重置密码"></a>3.3 重置密码</h3><h4 id="3-3-0-实现步骤"><a href="#3-3-0-实现步骤" class="headerlink" title="3.3.0 实现步骤"></a>3.3.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现重置密码的功能</li></ol><h4 id="3-3-1-定义路由和处理函数"><a href="#3-3-1-定义路由和处理函数" class="headerlink" title="3.3.1 定义路由和处理函数"></a>3.3.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>重置密码</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 重置密码的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatepwd&#x27;</span>, userinfo_handler.<span class="property">updatePassword</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>重置密码</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 重置密码的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updatePassword</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-2-验证表单数据"><a href="#3-3-2-验证表单数据" class="headerlink" title="3.3.2 验证表单数据"></a>3.3.2 验证表单数据</h4><blockquote><p>核心验证思路：旧密码与新密码，必须符合密码的验证规则，并且新密码不能与旧密码一致！</p></blockquote><ol><li>在 <code>/schema/user.js</code> 模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 验证规则对象 - 重置密码</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_password_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    <span class="comment">// 使用 password 这个规则，验证 req.body.oldPwd 的值</span></span><br><span class="line">    <span class="attr">oldPwd</span>: password,</span><br><span class="line">    <span class="comment">// 使用 joi.not(joi.ref(&#x27;oldPwd&#x27;)).concat(password) 规则，验证 req.body.newPwd 的值</span></span><br><span class="line">    <span class="comment">// 解读：</span></span><br><span class="line">    <span class="comment">// 1. joi.ref(&#x27;oldPwd&#x27;) 表示 newPwd 的值必须和 oldPwd 的值保持一致</span></span><br><span class="line">    <span class="comment">// 2. joi.not(joi.ref(&#x27;oldPwd&#x27;)) 表示 newPwd 的值不能等于 oldPwd 的值</span></span><br><span class="line">    <span class="comment">// 3. .concat() 用于合并 joi.not(joi.ref(&#x27;oldPwd&#x27;)) 和 password 这两条验证规则</span></span><br><span class="line">    <span class="attr">newPwd</span>: joi.<span class="title function_">not</span>(joi.<span class="title function_">ref</span>(<span class="string">&#x27;oldPwd&#x27;</span>)).<span class="title function_">concat</span>(password),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入需要的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_userinfo_schema, update_password_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>并在 <code>重置密码的路由</code> 中，使用 <code>update_password_schema</code> 规则验证表单的数据，示例代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatepwd&#x27;</span>, <span class="title function_">expressJoi</span>(update_password_schema), userinfo_handler.<span class="property">updatePassword</span>)</span><br></pre></td></tr></table></figure><h4 id="3-3-3-实现重置密码的功能"><a href="#3-3-3-实现重置密码的功能" class="headerlink" title="3.3.3 实现重置密码的功能"></a>3.3.3 实现重置密码的功能</h4><ol><li>根据 <code>id</code> 查询用户是否存在：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义根据 id 查询用户数据的 SQL 语句</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_users where id=?`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 SQL 语句查询用户是否存在</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">user</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查指定 id 的用户是否存在</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;用户不存在！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODO：判断提交的旧密码是否正确</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="2"><li>判断提交的 <strong>旧密码</strong> 是否正确：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在头部区域导入 bcryptjs 后，</span></span><br><span class="line"><span class="comment">// 即可使用 bcrypt.compareSync(提交的密码，数据库中的密码) 方法验证密码是否正确</span></span><br><span class="line"><span class="comment">// compareSync() 函数的返回值为布尔值，true 表示密码正确，false 表示密码错误</span></span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断提交的旧密码是否正确</span></span><br><span class="line"><span class="keyword">const</span> compareResult = bcrypt.<span class="title function_">compareSync</span>(req.<span class="property">body</span>.<span class="property">oldPwd</span>, results[<span class="number">0</span>].<span class="property">password</span>)</span><br><span class="line"><span class="keyword">if</span> (!compareResult) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;原密码错误！&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>对新密码进行 <code>bcrypt</code> 加密之后，更新到数据库中：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义更新用户密码的 SQL 语句</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_users set password=? where id=?`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对新密码进行 bcrypt 加密处理</span></span><br><span class="line"><span class="keyword">const</span> newPwd = bcrypt.<span class="title function_">hashSync</span>(req.<span class="property">body</span>.<span class="property">newPwd</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 SQL 语句，根据 id 更新用户的密码</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [newPwd, req.<span class="property">user</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// SQL 语句执行失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;更新密码失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新密码成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;更新密码成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-4-更新用户头像"><a href="#3-4-更新用户头像" class="headerlink" title="3.4 更新用户头像"></a>3.4 更新用户头像</h3><h4 id="3-4-0-实现步骤"><a href="#3-4-0-实现步骤" class="headerlink" title="3.4.0 实现步骤"></a>3.4.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现更新用户头像的功能</li></ol><h4 id="3-4-1-定义路由和处理函数"><a href="#3-4-1-定义路由和处理函数" class="headerlink" title="3.4.1 定义路由和处理函数"></a>3.4.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>更新用户头像</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新用户头像的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/update/avatar&#x27;</span>, userinfo_handler.<span class="property">updateAvatar</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>更新用户头像</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新用户头像的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateAvatar</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-4-2-验证表单数据"><a href="#3-4-2-验证表单数据" class="headerlink" title="3.4.2 验证表单数据"></a>3.4.2 验证表单数据</h4><ol><li>在 <code>/schema/user.js</code> 验证规则模块中，定义 <code>avatar</code> 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dataUri() 指的是如下格式的字符串数据：</span></span><br><span class="line"><span class="comment">// data:image/png;base64,VE9PTUFOWVNFQ1JFVFM=</span></span><br><span class="line"><span class="keyword">const</span> avatar = joi.<span class="title function_">string</span>().<span class="title function_">dataUri</span>().required()</span><br></pre></td></tr></table></figure><ol start="2"><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 验证规则对象 - 更新头像</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_avatar_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    avatar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; update_avatar_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="4"><li>在 <code>/router/userinfo.js</code> 模块中，修改 <code>更新用户头像</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/update/avatar&#x27;</span>, <span class="title function_">expressJoi</span>(update_avatar_schema), userinfo_handler.<span class="property">updateAvatar</span>)</span><br></pre></td></tr></table></figure><h4 id="3-4-3-实现更新用户头像的功能"><a href="#3-4-3-实现更新用户头像的功能" class="headerlink" title="3.4.3 实现更新用户头像的功能"></a>3.4.3 实现更新用户头像的功能</h4><ol><li>定义更新用户头像的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;update ev_users set user_pic=? where id=?&#x27;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行 SQL 语句，更新对应用户的头像：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">avatar</span>, req.<span class="property">user</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行 SQL 语句成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;更新头像失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新用户头像成功</span></span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;更新头像成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="4-文章分类管理"><a href="#4-文章分类管理" class="headerlink" title="4. 文章分类管理"></a>4. 文章分类管理</h2><h3 id="4-1-新建-ev-article-cate-表"><a href="#4-1-新建-ev-article-cate-表" class="headerlink" title="4.1 新建 ev_article_cate 表"></a>4.1 新建 ev_article_cate 表</h3><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/ev_article_cate.png" alt="文章分类表结构"></p><h3 id="4-2-获取文章分类列表"><a href="#4-2-获取文章分类列表" class="headerlink" title="4.2 获取文章分类列表"></a>4.2 获取文章分类列表</h3><h4 id="4-2-0-实现步骤"><a href="#4-2-0-实现步骤" class="headerlink" title="4.2.0 实现步骤"></a>4.2.0 实现步骤</h4><ol><li>初始化路由模块</li><li>初始化路由处理函数模块</li><li>获取文章分类列表数据</li></ol><h4 id="4-2-1-初始化路由模块"><a href="#4-2-1-初始化路由模块" class="headerlink" title="4.2.1 初始化路由模块"></a>4.2.1 初始化路由模块</h4><ol><li>创建 <code>/router/artcate.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取文章分类的列表数据</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>app.js</code> 中导入并使用文章分类的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入并使用文章分类路由模块</span></span><br><span class="line"><span class="keyword">const</span> artCateRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/artcate&#x27;</span>)</span><br><span class="line"><span class="comment">// 为文章分类的路由挂载统一的访问前缀 /my/article</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my/article&#x27;</span>, artCateRouter)</span><br></pre></td></tr></table></figure><h4 id="4-2-2-初始化路由处理函数模块"><a href="#4-2-2-初始化路由处理函数模块" class="headerlink" title="4.2.2 初始化路由处理函数模块"></a>4.2.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/artcate.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取文章分类列表数据的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getArticleCates</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>修改 <code>/router/artcate.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入文章分类的路由处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> artcate_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取文章分类的列表数据</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates&#x27;</span>, artcate_handler.<span class="property">getArticleCates</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h4 id="4-2-3-获取文章分类列表数据"><a href="#4-2-3-获取文章分类列表数据" class="headerlink" title="4.2.3 获取文章分类列表数据"></a>4.2.3 获取文章分类列表数据</h4><ol><li>在 <code>/router_handler/artcate.js</code> 头部导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入数据库操作模块</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据分类的状态，获取所有未被删除的分类列表数据</span></span><br><span class="line"><span class="comment">// is_delete 为 0 表示没有被 标记为删除 的数据</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;select * from ev_article_cate where is_delete=0 order by id asc&#x27;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. 执行 SQL 语句成功</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;获取文章分类列表成功！&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="4-3-新增文章分类"><a href="#4-3-新增文章分类" class="headerlink" title="4.3 新增文章分类"></a>4.3 新增文章分类</h3><h4 id="4-3-0-实现步骤"><a href="#4-3-0-实现步骤" class="headerlink" title="4.3.0 实现步骤"></a>4.3.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>查询 <code>分类名称</code> 与 <code>分类别名</code> 是否被占用</li><li>实现新增文章分类的功能</li></ol><h4 id="4-3-1-定义路由和处理函数"><a href="#4-3-1-定义路由和处理函数" class="headerlink" title="4.3.1 定义路由和处理函数"></a>4.3.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>新增文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新增文章分类的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/addcates&#x27;</span>, artcate_handler.<span class="property">addArticleCates</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>新增文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新增文章分类的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticleCates</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-3-2-验证表单数据"><a href="#4-3-2-验证表单数据" class="headerlink" title="4.3.2 验证表单数据"></a>4.3.2 验证表单数据</h4><ol><li>创建 <code>/schema/artcate.js</code> 文章分类数据验证模块，并定义如下的验证规则：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入定义验证规则的模块</span></span><br><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 分类名称 和 分类别名 的校验规则</span></span><br><span class="line"><span class="keyword">const</span> name = joi.<span class="title function_">string</span>().required()</span><br><span class="line"><span class="keyword">const</span> alias = joi.<span class="title function_">string</span>().<span class="title function_">alphanum</span>().required()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 校验规则对象 - 添加分类</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">add_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    name,</span><br><span class="line">    alias,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router/artcate.js</code> 模块中，使用 <code>add_cate_schema</code> 对数据进行验证：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入验证数据的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入文章分类的验证模块</span></span><br><span class="line"><span class="keyword">const</span> &#123; add_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新增文章分类的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/addcates&#x27;</span>, <span class="title function_">expressJoi</span>(add_cate_schema), artcate_handler.<span class="property">addArticleCates</span>)</span><br></pre></td></tr></table></figure><h4 id="4-3-3-查询分类名称与别名是否被占用"><a href="#4-3-3-查询分类名称与别名是否被占用" class="headerlink" title="4.3.3 查询分类名称与别名是否被占用"></a>4.3.3 查询分类名称与别名是否被占用</h4><ol><li>定义查重的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义查询 分类名称 与 分类别名 是否被占用的 SQL 语句</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where name=? or alias=?`</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行查重的操作：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行查重操作</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">name</span>, req.<span class="property">body</span>.<span class="property">alias</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断 分类名称 和 分类别名 是否被占用</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">2</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类名称与别名被占用，请更换后重试！&#x27;</span>)</span><br><span class="line">  <span class="comment">// 分别判断 分类名称 和 分类别名 是否被占用</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">name</span> === req.<span class="property">body</span>.<span class="property">name</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类名称被占用，请更换后重试！&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">alias</span> === req.<span class="property">body</span>.<span class="property">alias</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类别名被占用，请更换后重试！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODO：新增文章分类</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="4-3-4-实现新增文章分类的功能"><a href="#4-3-4-实现新增文章分类的功能" class="headerlink" title="4.3.4 实现新增文章分类的功能"></a>4.3.4 实现新增文章分类的功能</h4><ol><li>定义新增文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`insert into ev_article_cate set ?`</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行新增文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">body</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// SQL 语句执行失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;新增文章分类失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 新增文章分类成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;新增文章分类成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="4-4-根据-Id-删除文章分类"><a href="#4-4-根据-Id-删除文章分类" class="headerlink" title="4.4 根据 Id 删除文章分类"></a>4.4 根据 Id 删除文章分类</h3><h4 id="4-4-0-实现步骤"><a href="#4-4-0-实现步骤" class="headerlink" title="4.4.0 实现步骤"></a>4.4.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现删除文章分类的功能</li></ol><h4 id="4-4-1-定义路由和处理函数"><a href="#4-4-1-定义路由和处理函数" class="headerlink" title="4.4.1 定义路由和处理函数"></a>4.4.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>删除文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除文章分类的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/deletecate/:id&#x27;</span>, artcate_handler.<span class="property">deleteCateById</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>删除文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除文章分类的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">deleteCateById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-2-验证表单数据"><a href="#4-4-2-验证表单数据" class="headerlink" title="4.4.2 验证表单数据"></a>4.4.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，定义 id 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 分类Id 的校验规则</span></span><br><span class="line"><span class="keyword">const</span> id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).required()</span><br></pre></td></tr></table></figure><ol start="2"><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 校验规则对象 - 删除分类</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">delete_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入删除分类的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; delete_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除文章分类的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/deletecate/:id&#x27;</span>, <span class="title function_">expressJoi</span>(delete_cate_schema), artcate_handler.<span class="property">deleteCateById</span>)</span><br></pre></td></tr></table></figure><h4 id="4-4-3-实现删除文章分类的功能"><a href="#4-4-3-实现删除文章分类的功能" class="headerlink" title="4.4.3 实现删除文章分类的功能"></a>4.4.3 实现删除文章分类的功能</h4><ol><li>定义删除文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_article_cate set is_delete=1 where id=?`</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行删除文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">params</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;删除文章分类失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 删除文章分类成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;删除文章分类成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="4-5-根据-Id-获取文章分类数据"><a href="#4-5-根据-Id-获取文章分类数据" class="headerlink" title="4.5 根据 Id 获取文章分类数据"></a>4.5 根据 Id 获取文章分类数据</h3><h4 id="4-5-0-实现步骤"><a href="#4-5-0-实现步骤" class="headerlink" title="4.5.0 实现步骤"></a>4.5.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现获取文章分类的功能</li></ol><h4 id="4-5-1-定义路由和处理函数"><a href="#4-5-1-定义路由和处理函数" class="headerlink" title="4.5.1 定义路由和处理函数"></a>4.5.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>根据 Id 获取文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates/:id&#x27;</span>, artcate_handler.<span class="property">getArticleById</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>根据 Id 获取文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据 Id 获取文章分类的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getArticleById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-5-2-验证表单数据"><a href="#4-5-2-验证表单数据" class="headerlink" title="4.5.2 验证表单数据"></a>4.5.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 校验规则对象 - 根据 Id 获取分类</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">get_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入根据 Id 获取分类的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; get_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 Id 获取文章分类的路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates/:id&#x27;</span>, <span class="title function_">expressJoi</span>(get_cate_schema), artcate_handler.<span class="property">getArticleById</span>)</span><br></pre></td></tr></table></figure><h4 id="4-5-3-实现获取文章分类的功能"><a href="#4-5-3-实现获取文章分类的功能" class="headerlink" title="4.5.3 实现获取文章分类的功能"></a>4.5.3 实现获取文章分类的功能</h4><ol><li>定义根据 Id 获取文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where id=?`</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">params</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是没有查询到任何数据</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;获取文章分类数据失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 把数据响应给客户端</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;获取文章分类数据成功！&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results[<span class="number">0</span>],</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="4-6-根据-Id-更新文章分类数据"><a href="#4-6-根据-Id-更新文章分类数据" class="headerlink" title="4.6 根据 Id 更新文章分类数据"></a>4.6 根据 Id 更新文章分类数据</h3><h4 id="4-6-0-实现步骤"><a href="#4-6-0-实现步骤" class="headerlink" title="4.6.0 实现步骤"></a>4.6.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>查询 <code>分类名称</code> 与 <code>分类别名</code> 是否被占用</li><li>实现更新文章分类的功能</li></ol><h4 id="4-6-1-定义路由和处理函数"><a href="#4-6-1-定义路由和处理函数" class="headerlink" title="4.6.1 定义路由和处理函数"></a>4.6.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>更新文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新文章分类的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatecate&#x27;</span>, artcate_handler.<span class="property">updateCateById</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>更新文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新文章分类的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateCateById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-6-2-验证表单数据"><a href="#4-6-2-验证表单数据" class="headerlink" title="4.6.2 验证表单数据"></a>4.6.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 校验规则对象 - 更新分类</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    <span class="title class_">Id</span>: id,</span><br><span class="line">    name,</span><br><span class="line">    alias,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入更新文章分类的验证规则对象</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新文章分类的路由</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatecate&#x27;</span>, <span class="title function_">expressJoi</span>(update_cate_schema), artcate_handler.<span class="property">updateCateById</span>)</span><br></pre></td></tr></table></figure><h4 id="4-5-4-查询分类名称与别名是否被占用"><a href="#4-5-4-查询分类名称与别名是否被占用" class="headerlink" title="4.5.4 查询分类名称与别名是否被占用"></a>4.5.4 查询分类名称与别名是否被占用</h4><ol><li>定义查重的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义查询 分类名称 与 分类别名 是否被占用的 SQL 语句</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where Id&lt;&gt;? and (name=? or alias=?)`</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行查重的操作：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行查重操作</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">Id</span>, req.<span class="property">body</span>.<span class="property">name</span>, req.<span class="property">body</span>.<span class="property">alias</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断 分类名称 和 分类别名 是否被占用</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">2</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类名称与别名被占用，请更换后重试！&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">name</span> === req.<span class="property">body</span>.<span class="property">name</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类名称被占用，请更换后重试！&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">alias</span> === req.<span class="property">body</span>.<span class="property">alias</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;分类别名被占用，请更换后重试！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODO：更新文章分类</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="4-5-5-实现更新文章分类的功能"><a href="#4-5-5-实现更新文章分类的功能" class="headerlink" title="4.5.5 实现更新文章分类的功能"></a>4.5.5 实现更新文章分类的功能</h4><ol><li>定义更新文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_article_cate set ? where Id=?`</span></span><br></pre></td></tr></table></figure><ol start="2"><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>, req.<span class="property">body</span>.<span class="property">Id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL 语句执行成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;更新文章分类失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新文章分类成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;更新文章分类成功！&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="5-文章管理"><a href="#5-文章管理" class="headerlink" title="5. 文章管理"></a>5. 文章管理</h2><h3 id="5-1-新建-ev-articles-表"><a href="#5-1-新建-ev-articles-表" class="headerlink" title="5.1 新建 ev_articles 表"></a>5.1 新建 ev_articles 表</h3><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/ev_articles.png" alt="ev_articles表结构"></p><h3 id="5-2-发布新文章"><a href="#5-2-发布新文章" class="headerlink" title="5.2 发布新文章"></a>5.2 发布新文章</h3><h4 id="5-2-0-实现步骤"><a href="#5-2-0-实现步骤" class="headerlink" title="5.2.0 实现步骤"></a>5.2.0 实现步骤</h4><ol><li>初始化路由模块</li><li>初始化路由处理函数模块</li><li>使用 multer 解析表单数据</li><li>验证表单数据</li><li>实现发布文章的功能</li></ol><h4 id="5-2-1-初始化路由模块"><a href="#5-2-1-初始化路由模块" class="headerlink" title="5.2.1 初始化路由模块"></a>5.2.1 初始化路由模块</h4><ol><li>创建 <code>/router/article.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布新文章</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>app.js</code> 中导入并使用文章的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入并使用文章路由模块</span></span><br><span class="line"><span class="keyword">const</span> articleRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/article&#x27;</span>)</span><br><span class="line"><span class="comment">// 为文章的路由挂载统一的访问前缀 /my/article</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my/article&#x27;</span>, articleRouter)</span><br></pre></td></tr></table></figure><h4 id="5-2-2-初始化路由处理函数模块"><a href="#5-2-2-初始化路由处理函数模块" class="headerlink" title="5.2.2 初始化路由处理函数模块"></a>5.2.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/article.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发布新文章的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>修改 <code>/router/article.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入文章的路由处理函数模块</span></span><br><span class="line"><span class="keyword">const</span> article_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/article&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布新文章</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, article_handler.<span class="property">addArticle</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h4 id="5-2-3-使用-multer-解析表单数据"><a href="#5-2-3-使用-multer-解析表单数据" class="headerlink" title="5.2.3 使用 multer 解析表单数据"></a>5.2.3 使用 multer 解析表单数据</h4><blockquote><p>注意：使用 <code>express.urlencoded()</code> 中间件无法解析 <code>multipart/form-data</code> 格式的请求体数据。</p></blockquote><blockquote><p>当前项目，推荐使用 multer 来解析 <code>multipart/form-data</code> 格式的表单数据。<a href="https://www.npmjs.com/package/multer">https://www.npmjs.com/package/multer</a></p></blockquote><ol><li>运行如下的终端命令，在项目中安装 <code>multer</code>：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i multer@1.4.2</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router_handler/article.js</code> 模块中导入并配置 <code>multer</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入解析 formdata 格式表单数据的包</span></span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">&#x27;multer&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入处理路径的核心模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 multer 的实例对象，通过 dest 属性指定文件的存放路径</span></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123; <span class="attr">dest</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;../uploads&#x27;</span>) &#125;)</span><br></pre></td></tr></table></figure><ol start="3"><li>修改 <code>发布新文章</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发布新文章的路由</span></span><br><span class="line"><span class="comment">// upload.single() 是一个局部生效的中间件，用来解析 FormData 格式的表单数据</span></span><br><span class="line"><span class="comment">// 将文件类型的数据，解析并挂载到 req.file 属性中</span></span><br><span class="line"><span class="comment">// 将文本类型的数据，解析并挂载到 req.body 属性中</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, upload.<span class="title function_">single</span>(<span class="string">&#x27;cover_img&#x27;</span>), article_handler.<span class="property">addArticle</span>)</span><br></pre></td></tr></table></figure><ol start="4"><li>在 <code>/router_handler/article.js</code> 模块中的 <code>addArticle</code> 处理函数中，将 <code>multer</code> 解析出来的数据进行打印：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发布新文章的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>) <span class="comment">// 文本类型的数据</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------分割线----------&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">file</span>) <span class="comment">// 文件类型的数据</span></span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="5-2-4-验证表单数据"><a href="#5-2-4-验证表单数据" class="headerlink" title="5.2.4 验证表单数据"></a>5.2.4 验证表单数据</h4><blockquote><p>实现思路：通过 express-joi <strong>自动验证</strong> req.body 中的文本数据；通过 if 判断<strong>手动验证</strong> req.file 中的文件数据；</p></blockquote><ol><li>创建 <code>/schema/article.js</code> 验证规则模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入定义验证规则的模块</span></span><br><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 标题、分类Id、内容、发布状态 的验证规则</span></span><br><span class="line"><span class="keyword">const</span> title = joi.<span class="title function_">string</span>().required()</span><br><span class="line"><span class="keyword">const</span> cate_id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).required()</span><br><span class="line"><span class="keyword">const</span> content = joi.<span class="title function_">string</span>().required().<span class="title function_">allow</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> state = joi.<span class="title function_">string</span>().<span class="title function_">valid</span>(<span class="string">&#x27;已发布&#x27;</span>, <span class="string">&#x27;草稿&#x27;</span>).required()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 验证规则对象 - 发布文章</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">add_article_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    title,</span><br><span class="line">    cate_id,</span><br><span class="line">    content,</span><br><span class="line">    state,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 <code>/router/article.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入验证数据的中间件</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入文章的验证模块</span></span><br><span class="line"><span class="keyword">const</span> &#123; add_article_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/article&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布新文章的路由</span></span><br><span class="line"><span class="comment">// 注意：在当前的路由中，先后使用了两个中间件：</span></span><br><span class="line"><span class="comment">//       先使用 multer 解析表单数据</span></span><br><span class="line"><span class="comment">//       再使用 expressJoi 对解析的表单数据进行验证</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, upload.<span class="title function_">single</span>(<span class="string">&#x27;cover_img&#x27;</span>), <span class="title function_">expressJoi</span>(add_article_schema), article_handler.<span class="property">addArticle</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>在 <code>/router_handler/article.js</code> 模块中的 <code>addArticle</code> 处理函数中，通过 <code>if</code> 判断客户端是否提交了 <code>封面图片</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发布新文章的处理函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 手动判断是否上传了文章封面</span></span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">file</span> || req.<span class="property">file</span>.<span class="property">fieldname</span> !== <span class="string">&#x27;cover_img&#x27;</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;文章封面是必选参数！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODO：表单数据合法，继续后面的处理流程...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="5-2-5-实现发布文章的功能"><a href="#5-2-5-实现发布文章的功能" class="headerlink" title="5.2.5 实现发布文章的功能"></a>5.2.5 实现发布文章的功能</h4><ol><li>整理要插入数据库的文章信息对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入处理路径的 path 核心模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> articleInfo = &#123;</span><br><span class="line">  <span class="comment">// 标题、内容、状态、所属的分类Id</span></span><br><span class="line">  ...req.<span class="property">body</span>,</span><br><span class="line">  <span class="comment">// 文章封面在服务器端的存放路径</span></span><br><span class="line">  <span class="attr">cover_img</span>: path.<span class="title function_">join</span>(<span class="string">&#x27;/uploads&#x27;</span>, req.<span class="property">file</span>.<span class="property">filename</span>),</span><br><span class="line">  <span class="comment">// 文章发布时间</span></span><br><span class="line">  <span class="attr">pub_date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">  <span class="comment">// 文章作者的Id</span></span><br><span class="line">  <span class="attr">author_id</span>: req.<span class="property">user</span>.<span class="property">id</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>定义发布文章的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`insert into ev_articles set ?`</span></span><br></pre></td></tr></table></figure><ol start="3"><li>调用 <code>db.query()</code> 执行发布文章的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入数据库操作模块</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 SQL 语句</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, articleInfo, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 执行 SQL 语句失败</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行 SQL 语句成功，但是影响行数不等于 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;发布文章失败！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 发布文章成功</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;发布文章成功&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>在 <code>app.js</code> 中，使用 <code>express.static()</code> 中间件，将 <code>uploads</code> 目录中的图片托管为静态资源：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 托管静态资源文件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/uploads&#x27;</span>, express.<span class="title function_">static</span>(<span class="string">&#x27;./uploads&#x27;</span>))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Express</title>
      <link href="/2023/09/09/express/"/>
      <url>/2023/09/09/express/</url>
      
        <content type="html"><![CDATA[<p> <a href="https://www.expressjs.com.cn/">Express</a> 基于 Node.js 平台，快速、开放、极简的 Web 开发框架</p><p>用于快速创建服务器的第三方模块。</p><h2 id="Express-初体验"><a href="#Express-初体验" class="headerlink" title="Express 初体验"></a>Express 初体验</h2><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>安装 Express：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express</span><br></pre></td></tr></table></figure><p>创建服务器，监听客户端请求，并返回内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建 web 服务器</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听客户端的 GET 和 POST 请求，并向客户端响应具体的内容</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span>, <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;请求成功&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 通过 req.query 可以获取到客户端发送过来的查询参数</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">query</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(req.<span class="property">query</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里的 :id 是一个动态的参数</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user/:ids/:username&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// req.params 是动态匹配到的 URL 参数，默认是一个空对象</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">params</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(req.<span class="property">params</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;express server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="托管静态资源"><a href="#托管静态资源" class="headerlink" title="托管静态资源"></a>托管静态资源</h3><ul><li>通过 <code>express.static()</code> 方法可创建静态资源服务器，向外开放访问静态资源。</li><li>Express 在指定的静态目录中查找文件，并对外提供资源的访问路径，存放静态文件的目录名不会出现在 URL 中</li><li>访问静态资源时，会根据托管顺序查找文件</li><li>可为静态资源访问路径添加前缀</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>))</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;files&#x27;</span>))</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/bruce&#x27;</span>, express.<span class="title function_">static</span>(<span class="string">&#x27;bruce&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">可直接访问 public, files 目录下的静态资源</span></span><br><span class="line"><span class="comment">http://localhost:3000/images/bg.jpg</span></span><br><span class="line"><span class="comment">http://localhost:3000/css/style.css</span></span><br><span class="line"><span class="comment">http://localhost:3000/js/login.js</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">通过带有 /bruce 前缀的地址访问 bruce 目录下的文件</span></span><br><span class="line"><span class="comment">http://localhost:8080/bruce/images/logo.png</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="Express-路由"><a href="#Express-路由" class="headerlink" title="Express 路由"></a>Express 路由</h2><p>创建路由模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 挂载具体路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/user/list&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Get user list.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/user/add&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Add new user.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外导出路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><p>注册路由模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./router&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册路由模块，添加访问前缀</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, router)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="Express-中间件"><a href="#Express-中间件" class="headerlink" title="Express 中间件"></a>Express 中间件</h2><ul><li>中间件是指流程的中间处理环节</li><li>服务器收到请求后，可先调用中间件进行预处理</li><li>中间件是一个函数，包含 <code>req, res, next</code> 三个参数，<code>next()</code> 参数把流转关系交给下一个中间件或路由</li></ul><p>中间件注意事项；</p><ul><li>在注册路由之前注册中间件（错误级别中间件除外）</li><li>中间件可连续调用多个</li><li>别忘记调用 <code>next()</code> 函数</li><li><code>next()</code> 函数后别写代码</li><li>多个中间件共享 <code>req</code>、 <code>res</code>对象</li></ul><h3 id="全局中间件"><a href="#全局中间件" class="headerlink" title="全局中间件"></a>全局中间件</h3><ul><li>通过 <code>app.use()</code> 定义的中间件为全局中间件</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义第一个全局中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;调用了第1个全局中间件&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 定义第二个全局中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;调用了第2个全局中间件&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;User page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="局部中间件"><a href="#局部中间件" class="headerlink" title="局部中间件"></a>局部中间件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义中间件函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw1</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;调用了第一个局部生效的中间件&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw2</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;调用了第二个局部生效的中间件&#x27;</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 两种定义局部中间件的方式</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/hello&#x27;</span>, mw2, mw1, <span class="function">(<span class="params">req, res</span>) =&gt;</span> res.<span class="title function_">send</span>(<span class="string">&#x27;hello page.&#x27;</span>))</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/about&#x27;</span>, [mw1, mw2], <span class="function">(<span class="params">req, res</span>) =&gt;</span> res.<span class="title function_">send</span>(<span class="string">&#x27;about page.&#x27;</span>))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> res.<span class="title function_">send</span>(<span class="string">&#x27;User page.&#x27;</span>))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="中间件分类"><a href="#中间件分类" class="headerlink" title="中间件分类"></a>中间件分类</h3><ol><li>应用级别的中间件</li></ol><ul><li>通过 <code>app.use()</code> 或 <code>app.get()</code> 或 <code>app.post()</code> ，绑定到 <code>app</code> 实例上的中间件</li></ul><ol start="2"><li>路由级别的中间件</li></ol><ul><li>绑定到 <code>express.Router()</code> 实例上的中间件，叫做路由级别的中间件。用法和应用级别中间件没有区别。应用级别中间件是绑定到 <code>app</code> 实例上，路由级别中间件绑定到 <code>router</code> 实例上。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/&#x27;</span>, router)</span><br></pre></td></tr></table></figure><ol start="3"><li>错误级别的中间件</li></ol><ul><li>用来捕获整个项目中发生的异常错误，从而防止项目异常崩溃的问题</li><li>错误级别中间件的处理函数中，必须有 4 个形参，形参顺序从前到后分别是 <code>(err, req, res, next)</code> 。</li><li>错误级别的中间件必须注册在所有路由之后</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;服务器内部发生了错误！&#x27;</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Home page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义错误级别的中间件，捕获整个项目的异常错误，从而防止程序的崩溃</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;发生了错误！&#x27;</span> + err.<span class="property">message</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Error：&#x27;</span> + err.<span class="property">message</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="4"><li>Express 内置中间件</li></ol><p>自 Express 4.16.0 版本开始，Express 内置了 3 个常用的中间件，极大的提高了 Express 项目的开发效率和体验：</p><ul><li><code>express.static</code> 快速托管静态资源的内置中间件，例如： HTML 文件、图片、CSS 样式等（无兼容性）</li><li><code>express.json</code> 解析 JSON 格式的请求体数据（有兼容性，仅在 4.16.0+ 版本中可用）</li><li><code>express.urlencoded</code> 解析 URL-encoded 格式的请求体数据（有兼容性，仅在 4.16.0+ 版本中可用）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br></pre></td></tr></table></figure><ol start="5"><li>第三方中间件</li></ol><h2 id="CORS-跨域资源共享"><a href="#CORS-跨域资源共享" class="headerlink" title="CORS 跨域资源共享"></a>CORS 跨域资源共享</h2><h3 id="cors-中间件解决跨域"><a href="#cors-中间件解决跨域" class="headerlink" title="cors 中间件解决跨域"></a>cors 中间件解决跨域</h3><ul><li>安装中间件：<code>npm install cors</code></li><li>导入中间件：<code>const cors = require(&#39;cors&#39;)</code></li><li>配置中间件：<code>app.use(cors())</code></li></ul><h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><ul><li>CORS（Cross-Origin Resource Sharing，跨域资源共享）解决跨域，是通过 HTTP 响应头决定浏览器是否阻止前端 JS 代码跨域获取资源</li><li>浏览器的同源安全策略默认会阻止网页“跨域”获取资源。但如果接口服务器配置了 CORS 相关的 HTTP 响应头，就可解除浏览器端的跨域访问限制</li><li>CORS 主要在服务器端进行配置。客户端浏览器无须做任何额外的配置，即可请求开启了 CORS 的接口。</li><li>CORS 在浏览器中有兼容性。只有支持 XMLHttpRequest Level2 的浏览器，才能正常访问开启了 CORS 的服务端接口（例如：IE10+、Chrome4+、FireFox3.5+）。</li></ul><h3 id="CORS-常见响应头"><a href="#CORS-常见响应头" class="headerlink" title="CORS 常见响应头"></a>CORS 常见响应头</h3><ul><li><code>Access-Control-Allow-Origin</code>：制定了允许访问资源的外域 URL</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;http://bruceblog.io&#x27;</span>)</span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li><code>Access-Control-Allow-Headers</code></li><li>默认情况下，CORS 仅支持客户端向服务器发送如下的 9 个请求头：<code>Accept、Accept-Language、Content-Language、DPR、Downlink、Save-Data、Viewport-Width、Width 、Content-Type （值仅限于 text/plain、multipart/form-data、application/x-www-form-urlencoded 三者之一）</code></li><li>如果客户端向服务器发送了额外的请求头信息，则需要在服务器端，通过 A<code>ccess-Control-Allow-Headers</code> 对额外的请求头进行声明，否则这次请求会失败！</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;Content-Type, X-Custom-Header&#x27;</span>)</span><br></pre></td></tr></table></figure><ul><li><code>Access-Control-Allow-Methods</code></li><li>默认情况下，CORS 仅支持客户端发起 GET、POST、HEAD 请求。如果客户端希望通过 PUT、DELETE 等方式请求服务器的资源，则需要在服务器端，通过 <code>Access-Control-Alow-Methods</code> 来指明实际请求所允许使用的 HTTP 方法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;POST, GET, DELETE, HEAD&#x27;</span>)</span><br><span class="line">res.<span class="title function_">setHEader</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="CORS-请求分类"><a href="#CORS-请求分类" class="headerlink" title="CORS 请求分类"></a>CORS 请求分类</h3><h4 id="简单请求"><a href="#简单请求" class="headerlink" title="简单请求"></a>简单请求</h4><ul><li>请求方式：GET、POST、HEAD 三者之一</li><li>HTTP 头部信息不超过以下几种字段：无自定义头部字段、<code>Accept</code>、<code>Accept-Language</code>、<code>Content-Language</code>、<code>DPR</code>、<code>Downlink</code>、<code>Save-Data</code>、<code>Viewport-Width</code>、<code>Width</code> 、<code>Content-Type</code>（只有三个值 <code>application/x-www-formurlencoded</code>、<code>multipart/form-data</code>、<code>text/plain</code>）</li></ul><h4 id="预检请求"><a href="#预检请求" class="headerlink" title="预检请求"></a>预检请求</h4><ul><li>请求方式为 GET、POST、HEAD 之外的请求 Method 类型</li><li>请求头中包含自定义头部字段</li><li>向服务器发送了 application&#x2F;json 格式的数据</li></ul><p>在浏览器与服务器正式通信之前，浏览器会先发送 OPTION 请求进行预检，以获知服务器是否允许该实际请求，所以这一次的 OPTION 请求称为“预检请求”。服务器成功响应预检请求后，才会发送真正的请求，并且携带真实数据</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Express </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodejs基础</title>
      <link href="/2023/09/09/node_basis/"/>
      <url>/2023/09/09/node_basis/</url>
      
        <content type="html"><![CDATA[<p><a href="https://nodejs.org/en/">官网传送门</a></p><h2 id="初识-Nodejs"><a href="#初识-Nodejs" class="headerlink" title="初识 Nodejs"></a>初识 Nodejs</h2><p>tip Node.js®<br>Node.js® is a JavaScript runtime built on Chrome’s V8 JavaScript engine</p><p>Node.js® 是一个基于 Chrome V8 引擎 的 JavaScript 运行时环境</p><ul><li>基于 <a href="http://www.expressjs.com.cn/">Express 框架</a>，可以快速构建 Web 应用</li><li>基于 <a href="https://electronjs.org/">Electron 框架</a>，可以构建跨平台的桌面应用</li><li>基于 <a href="http://restify.com/">restify 框架</a>，可以快速构建 API 接口项目</li><li>读写和操作数据库、创建实用的命令行工具辅助前端开发、etc…</li></ul><h2 id="Buffer-缓冲区"><a href="#Buffer-缓冲区" class="headerlink" title="Buffer 缓冲区"></a>Buffer 缓冲区</h2><blockquote><p><a href="http://nodejs.cn/api/buffer.html">Buffer 缓冲区文档</a></p></blockquote><ul><li>Buffer 的结构与数组类似，操作方法也与数组类似</li><li>数组不能存储二进制文件，Buffer 是专门存储二进制数据的</li><li>Buffer 存储的是二进制数据，显示时以 16 进制的形式显示</li><li>Buffer 每一个元素范围是 00<del>ff，即 0</del>255、00000000~11111111</li><li>每一个元素占用一个字节内存</li><li>Buffer 是对底层内存的直接操作，因此大小一旦确定就不能修改</li></ul><p>Buffer 常用方法：</p><ul><li><code>Buffer.from(str[, encoding])</code>：将一个字符串转换为 Buffer</li><li><code>Buffer.alloc(size)</code>：创建指定大小的 Buffer</li><li><code>Buffer.alloUnsafe(size)</code>：创建指定大小的 Buffer，可能包含敏感数据（分配内存时不会清除内存残留的数据）</li><li><code>buf.toString()</code>：将 Buffer 数据转为字符串</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;Hello前端&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> buf = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(str)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 占用内存的大小，一个汉字3字节 13</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(buf.<span class="property">length</span>)</span><br><span class="line"><span class="comment">// 字符串的长度 7</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="property">length</span>)</span><br><span class="line"><span class="comment">// 8进制输出第一个元素 145</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(buf[<span class="number">1</span>].<span class="title function_">toString</span>(<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个10个字节的buffer</span></span><br><span class="line"><span class="keyword">var</span> buf2 = <span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">10</span>)</span><br><span class="line"><span class="comment">//通过索引，来操作buf中的元素</span></span><br><span class="line">buf2[<span class="number">0</span>] = <span class="number">88</span></span><br><span class="line">buf2[<span class="number">1</span>] = <span class="number">255</span></span><br><span class="line">buf2[<span class="number">2</span>] = <span class="number">0xaa</span></span><br><span class="line">buf2[<span class="number">3</span>] = <span class="number">255</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> buf3 = <span class="title class_">Buffer</span>.<span class="title function_">allocUnsafe</span>(<span class="number">10</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(buf3)</span><br></pre></td></tr></table></figure><h2 id="fs-文件系统模块"><a href="#fs-文件系统模块" class="headerlink" title="fs 文件系统模块"></a>fs 文件系统模块</h2><ul><li>fs 模块中所有的操作都有两种形式可供选择:同步和异步</li><li>同步文件系统会阻塞程序的执行，也就是除非操作完毕，否则不会向下执行代码</li><li>异步文件系统不会阻塞程序的执行，而是在操作完成时，通过回调函数将结果返回</li><li>实际开发很少用同步方式，因此只介绍异步方式</li></ul><p>打开模式：</p><table><thead><tr><th>模式</th><th>说明</th></tr></thead><tbody><tr><td>r</td><td>读取文件，文件不存在抛异常</td></tr><tr><td>r+</td><td>读写文件，文件不存在抛异常</td></tr><tr><td>rs</td><td>同步模式下打开文件用于读取</td></tr><tr><td>rs+</td><td>同步模式下打开文件用于读写</td></tr><tr><td>w</td><td>写文件，不存在则创建，存在则覆盖原有内容</td></tr><tr><td>wx</td><td>写文件，文件存在打开失败</td></tr><tr><td>w+</td><td>读写文件，不存在创建，存在截断</td></tr><tr><td>wx+</td><td>读写，存在打开失败</td></tr><tr><td>a</td><td>追加，不存在创建</td></tr><tr><td>ax</td><td>追加，存在失败</td></tr><tr><td>a+</td><td>追加和读取，不存在创建</td></tr><tr><td>ax+</td><td>追加和读取，存在失败</td></tr></tbody></table><h3 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h3><h4 id="简单文件读取"><a href="#简单文件读取" class="headerlink" title="简单文件读取"></a>简单文件读取</h4><p>语法格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(path[, options], callback)</span><br></pre></td></tr></table></figure><ul><li><code>path</code>：文件路径</li><li><code>options</code>：配置选项，若是字符串则指定编码格式<ul><li><code>encoding</code>：编码格式</li><li><code>flag</code>：打开方式</li></ul></li><li><code>callback</code>：回调函数<ul><li><code>err</code>：错误信息</li><li><code>data</code>：读取的数据，如果未指定编码格式则返回一个 Buffer</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>, <span class="keyword">function</span>(<span class="params">err, data</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span>(err) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;failed!&#x27;</span> + err.<span class="property">message</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;content:&#x27;</span> + data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 复制文件内容</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&quot;C:/Users/笔记.mp3&quot;</span>, <span class="keyword">function</span>(<span class="params">err, data</span>) &#123;</span><br><span class="line"><span class="keyword">if</span>(!err) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line"><span class="comment">// 将data写入到文件中</span></span><br><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&quot;C:/Users/hello.jpg&quot;</span>, data, <span class="keyword">function</span>(<span class="params">err</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(!err)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;文件写入成功&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125; );</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="流式文件读取"><a href="#流式文件读取" class="headerlink" title="流式文件读取"></a>流式文件读取</h4><ul><li>简单文件读取的方式会一次性读取文件内容到内存中，若文件较大，会占用过多内存影响系统性能，且读取速度慢</li><li>大文件适合用流式文件读取，它会分多次将文件读取到内存中</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个可读流</span></span><br><span class="line"><span class="keyword">var</span> rs = fs.<span class="title function_">createReadStream</span>(<span class="string">&#x27;C:/Users/笔记.mp3&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建一个可写流</span></span><br><span class="line"><span class="keyword">var</span> ws = fs.<span class="title function_">createWriteStream</span>(<span class="string">&#x27;a.mp3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听流的开启和关闭</span></span><br><span class="line"><span class="comment">// 这几个监听不是必须的</span></span><br><span class="line">rs.<span class="title function_">once</span>(<span class="string">&#x27;open&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;可读流打开了~~&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">rs.<span class="title function_">once</span>(<span class="string">&#x27;close&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;可读流关闭了~~&#x27;</span>)</span><br><span class="line">  <span class="comment">//数据读取完毕，关闭可写流</span></span><br><span class="line">  ws.<span class="title function_">end</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">once</span>(<span class="string">&#x27;open&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;可写流打开了~~&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">once</span>(<span class="string">&#x27;close&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;可写流关闭了~~&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//要读取一个可读流中的数据，要为可读流绑定一个data事件，data事件绑定完毕自动开始读取数据</span></span><br><span class="line">rs.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">  <span class="comment">//将读取到的数据写入到可写流中</span></span><br><span class="line">  ws.<span class="title function_">write</span>(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>简便方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rs = fs.<span class="title function_">createReadStream</span>(<span class="string">&#x27;C:/Users/lilichao/Desktop/笔记.mp3&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> ws = fs.<span class="title function_">createWriteStream</span>(<span class="string">&#x27;b.mp3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// pipe()可以将可读流中的内容，直接输出到可写流中</span></span><br><span class="line">rs.<span class="title function_">pipe</span>(ws)</span><br></pre></td></tr></table></figure><h3 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h3><h4 id="简单文件写入"><a href="#简单文件写入" class="headerlink" title="简单文件写入"></a>简单文件写入</h4><p>语法格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">writeFile</span>(file, data[, options], callback)</span><br></pre></td></tr></table></figure><ul><li><code>file</code>：文件路径</li><li><code>data</code>：写入内容</li><li><code>options</code>：配置选项，包含 <code>encoding, mode, flag</code>；若是字符串则指定编码格式</li><li><code>callback</code>：回调函数</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;Hello Nodejs&#x27;</span>, <span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;failed!&#x27;</span> + err.<span class="property">message</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;success!&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&#x27;C:/Users/hello.txt&#x27;</span>, <span class="string">&#x27;通过 writeFile 写入的内容&#x27;</span>, &#123; <span class="attr">flag</span>: <span class="string">&#x27;w&#x27;</span> &#125;, <span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;写入成功！&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="流式文件写入"><a href="#流式文件写入" class="headerlink" title="流式文件写入"></a>流式文件写入</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同步、异步、简单文件的写入都不适合大文件的写入，性能较差，容易导致内存溢出</span></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个可写流</span></span><br><span class="line"><span class="keyword">var</span> ws = fs.<span class="title function_">createWriteStream</span>(<span class="string">&#x27;hello3.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">once</span>(<span class="string">&#x27;open&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;流打开了~~&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">ws.<span class="title function_">once</span>(<span class="string">&#x27;close&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;流关闭了~~&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过ws向文件中输出内容</span></span><br><span class="line">ws.<span class="title function_">write</span>(<span class="string">&#x27;通过可写流写入文件的内容&#x27;</span>)</span><br><span class="line">ws.<span class="title function_">write</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">ws.<span class="title function_">write</span>(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">ws.<span class="title function_">write</span>(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">ws.<span class="title function_">write</span>(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭流</span></span><br><span class="line">ws.<span class="title function_">end</span>()</span><br></pre></td></tr></table></figure><h3 id="路径动态拼接问题-dirname"><a href="#路径动态拼接问题-dirname" class="headerlink" title="路径动态拼接问题 __dirname"></a>路径动态拼接问题 <code>__dirname</code></h3><ul><li>在使用 fs 模块操作文件时，如果提供的操作路径是以 <code>./</code> 或 <code>../</code> 开头的相对路径时，容易出现路径动态拼接错误的问题</li><li>原因：代码在运行的时候，会以执行 node 命令时所处的目录，动态拼接出被操作文件的完整路径</li><li>解决方案：在使用 fs 模块操作文件时，直接提供完整的路径，从而防止路径动态拼接的问题</li><li><code>__dirname</code> 获取文件所处的绝对路径</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(__dirname + <span class="string">&#x27;/files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>, <span class="keyword">function</span>(<span class="params">err, data</span>) &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="其它操作"><a href="#其它操作" class="headerlink" title="其它操作"></a>其它操作</h3><p>验证路径是否存在：</p><ul><li><code>fs.exists(path, callback)</code></li><li><code>fs.existsSync(path)</code></li></ul><p>获取文件信息：</p><ul><li><code>fs.stat(path, callback)</code></li><li><code>fs.stat(path)</code></li></ul><p>删除文件：</p><ul><li><code>fs.unlink(path, callback)</code></li><li><code>fs.unlinkSync(path)</code></li></ul><p>列出文件：</p><ul><li><code>fs.readdir(path[,options], callback)</code></li><li><code>fs.readdirSync(path[, options])</code></li></ul><p>截断文件：</p><ul><li><code>fs.truncate(path, len, callback)</code></li><li><code>fs.truncateSync(path, len)</code></li></ul><p>建立目录：</p><ul><li><code>fs.mkdir(path[, mode], callback)</code></li><li><code>fs.mkdirSync(path[, mode])</code></li></ul><p>删除目录：</p><ul><li><code>fs.rmdir(path, callback)</code></li><li><code>fs.rmdirSync(path)</code></li></ul><p>重命名文件和目录：</p><ul><li><code>fs.rename(oldPath, newPath, callback)</code></li><li><code>fs.renameSync(oldPath, newPath)</code></li></ul><p>监视文件更改：</p><ul><li><code>fs.watchFile(filename[, options], listener)</code></li></ul><h2 id="path-路径模块"><a href="#path-路径模块" class="headerlink" title="path 路径模块"></a>path 路径模块</h2><p>path 模块是 Node.js 官方提供的、用来处理路径的模块。它提供了一系列的方法和属性，用来满足用户对路径的处理需求。</p><h3 id="路径拼接-path-join"><a href="#路径拼接-path-join" class="headerlink" title="路径拼接 path.join()"></a>路径拼接 <code>path.join()</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意 ../ 会抵消前面的路径</span></span><br><span class="line"><span class="comment">// ./ 会被忽略</span></span><br><span class="line"><span class="keyword">const</span> pathStr = path.<span class="title function_">join</span>(<span class="string">&#x27;/a&#x27;</span>, <span class="string">&#x27;/b/c&#x27;</span>, <span class="string">&#x27;../../&#x27;</span>, <span class="string">&#x27;./d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(pathStr) <span class="comment">// \a\d\e</span></span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">readFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;./files/1.txt&#x27;</span>), <span class="string">&#x27;utf8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, dataStr</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(dataStr)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="获取路径中文件名-path-basename"><a href="#获取路径中文件名-path-basename" class="headerlink" title="获取路径中文件名 path.basename()"></a>获取路径中文件名 <code>path.basename()</code></h3><p>使用 <code>path.basename()</code> 方法，可以获取路径中的最后一部分，常通过该方法获取路径中的文件名</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.<span class="title function_">basename</span>(path[, ext])</span><br></pre></td></tr></table></figure><ul><li>path: 文件路径</li><li>ext: 文件扩展名</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义文件的存放路径</span></span><br><span class="line"><span class="keyword">const</span> fpath = <span class="string">&#x27;/a/b/c/index.html&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fullName = path.<span class="title function_">basename</span>(fpath)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fullName) <span class="comment">// index.html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nameWithoutExt = path.<span class="title function_">basename</span>(fpath, <span class="string">&#x27;.html&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(nameWithoutExt) <span class="comment">// index</span></span><br></pre></td></tr></table></figure><h3 id="获取路径中文件扩展名-path-extname"><a href="#获取路径中文件扩展名-path-extname" class="headerlink" title="获取路径中文件扩展名 path.extname()"></a>获取路径中文件扩展名 <code>path.extname()</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fpath = <span class="string">&#x27;/a/b/c/index.html&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fext = path.<span class="title function_">extname</span>(fpath)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fext) <span class="comment">// .html</span></span><br></pre></td></tr></table></figure><h2 id="http-模块"><a href="#http-模块" class="headerlink" title="http 模块"></a>http 模块</h2><p>http 模块是 Node.js 官方提供的、用来创建 web 服务器的模块。</p><h3 id="创建基本-Web-服务器"><a href="#创建基本-Web-服务器" class="headerlink" title="创建基本 Web 服务器"></a>创建基本 Web 服务器</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 web 服务器实例</span></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为服务器实例绑定 request 事件，监听客户端的请求</span></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> url = req.<span class="property">url</span></span><br><span class="line">  <span class="keyword">const</span> method = req.<span class="property">method</span></span><br><span class="line">  <span class="keyword">const</span> str = <span class="string">`Your request url is <span class="subst">$&#123;url&#125;</span>, and request method is <span class="subst">$&#123;method&#125;</span>`</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(str)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置 Content-Type 响应头，解决中文乱码的问题</span></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>)</span><br><span class="line">  <span class="comment">// 向客户端响应内容</span></span><br><span class="line">  res.<span class="title function_">end</span>(str)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">8080</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;server running at http://127.0.0.1:8080&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="实现简陋路由效果"><a href="#实现简陋路由效果" class="headerlink" title="实现简陋路由效果"></a>实现简陋路由效果</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>()</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> url = req.<span class="property">url</span></span><br><span class="line">  <span class="comment">// 设置默认的响应内容为 404 Not found</span></span><br><span class="line">  <span class="keyword">let</span> content = <span class="string">&#x27;&lt;h1&gt;404 Not found!&lt;/h1&gt;&#x27;</span></span><br><span class="line">  <span class="comment">// 判断用户请求的是否为 / 或 /index.html 首页</span></span><br><span class="line">  <span class="comment">// 判断用户请求的是否为 /about.html 关于页面</span></span><br><span class="line">  <span class="keyword">if</span> (url === <span class="string">&#x27;/&#x27;</span> || url === <span class="string">&#x27;/index.html&#x27;</span>) &#123;</span><br><span class="line">    content = <span class="string">&#x27;&lt;h1&gt;首页&lt;/h1&gt;&#x27;</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (url === <span class="string">&#x27;/about.html&#x27;</span>) &#123;</span><br><span class="line">    content = <span class="string">&#x27;&lt;h1&gt;关于页面&lt;/h1&gt;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/html; charset=utf-8&#x27;</span>)</span><br><span class="line">  res.<span class="title function_">end</span>(content)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h2><h3 id="模块化概念"><a href="#模块化概念" class="headerlink" title="模块化概念"></a>模块化概念</h3><ul><li>模块化是指解决一个复杂问题时，自顶向下逐层把系统划分为若干模块的过程，模块是可组合、分解和更换的单元。</li><li>模块化可提高代码的复用性和可维护性，实现按需加载。</li><li>模块化规范是对代码进行模块化拆分和组合时需要遵守的规则，如使用何种语法格式引用模块和向外暴露成员。</li></ul><h3 id="Node-js-中模块的分类"><a href="#Node-js-中模块的分类" class="headerlink" title="Node.js 中模块的分类"></a>Node.js 中模块的分类</h3><ul><li>内置模块</li><li>自定义模块</li><li>第三方模块</li></ul><h3 id="Node-js-中的模块作用域"><a href="#Node-js-中的模块作用域" class="headerlink" title="Node.js 中的模块作用域"></a>Node.js 中的模块作用域</h3><ul><li>和函数作用域类似，在自定义模块中定义的变量、方法等成员，只能在当前模块内被访问，这种模块级别的访问限制，叫做模块作用域</li><li>防止全局变量污染</li></ul><h3 id="模块作用域的成员"><a href="#模块作用域的成员" class="headerlink" title="模块作用域的成员"></a>模块作用域的成员</h3><ul><li>自定义模块中都有一个 <code>module</code> 对象，存储了和当前模块有关的信息</li><li>在自定义模块中，可以使用 <code>module.exports</code> 对象，将模块内的成员共享出去，供外界使用。导入自定义模块时，得到的就是 <code>module.exports</code> 指向的对象。</li><li>默认情况下，<code>exports</code> 和 <code>module.exports</code> 指向同一个对象。最终共享的结果，以 <code>module.exports</code> 指向的对象为准。</li></ul><h3 id="CommonJS-模块化规范"><a href="#CommonJS-模块化规范" class="headerlink" title="CommonJS 模块化规范"></a>CommonJS 模块化规范</h3><ul><li>每个模块内部，<code>module</code> 变量代表当前模块</li><li><code>module</code> 变量是一个对象，<code>module.exports</code> 是对外的接口</li><li>加载某个模块即加载该模块的 <code>module.exports</code> 属性</li></ul><h3 id="模块加载机制"><a href="#模块加载机制" class="headerlink" title="模块加载机制"></a>模块加载机制</h3><p>模块第一次加载后会被缓存，即多次调用 <code>require()</code> 不会导致模块的代码被执行多次，提高模块加载效率。</p><h4 id="内置模块加载"><a href="#内置模块加载" class="headerlink" title="内置模块加载"></a>内置模块加载</h4><p>内置模块加载优先级最高。</p><h4 id="自定义模块加载"><a href="#自定义模块加载" class="headerlink" title="自定义模块加载"></a>自定义模块加载</h4><p>加载自定义模块时，路径要以 <code>./</code> 或 <code>../</code> 开头，否则会作为内置模块或第三方模块加载。</p><p>导入自定义模块时，若省略文件扩展名，则 Node.js 会按顺序尝试加载文件：</p><ul><li>按确切的文件名加载</li><li>补全 <code>.js</code> 扩展名加载</li><li>补全 <code>.json</code> 扩展名加载</li><li>补全 <code>.node</code> 扩展名加载</li><li>报错</li></ul><h4 id="第三方模块加载"><a href="#第三方模块加载" class="headerlink" title="第三方模块加载"></a>第三方模块加载</h4><ul><li>若导入第三方模块， Node.js 会从<strong>当前模块的父目录</strong>开始，尝试从 <code>/node_modules</code> 文件夹中加载第三方模块。</li><li>如果没有找到对应的第三方模块，则移动到再<strong>上一层父目录</strong>中，进行加载，直到<strong>文件系统的根目录</strong>。</li></ul><p>例如，假设在 <code>C:\Users\bruce\project\foo.js</code> 文件里调用了 <code>require(&#39;tools&#39;)</code>，则 Node.js 会按以下顺序查找：</p><ul><li><code>C:\Users\bruce\project\node_modules\tools</code></li><li><code>C:\Users\bruce\node_modules\tools</code></li><li><code>C:\Users\node_modules\tools</code></li><li><code>C:\node_modules\tools</code></li></ul><h4 id="目录作为模块加载"><a href="#目录作为模块加载" class="headerlink" title="目录作为模块加载"></a>目录作为模块加载</h4><p>当把目录作为模块标识符进行加载的时候，有三种加载方式：</p><ul><li>在被加载的目录下查找 <code>package.json</code> 的文件，并寻找 <code>main</code> 属性，作为 <code>require()</code> 加载的入口</li><li>如果没有 <code>package.json</code> 文件，或者 <code>main</code> 入口不存在或无法解析，则 Node.js 将会试图加载目录下的 <code>index.js</code> 文件。</li><li>若失败则报错</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>var that =this 的用法详解</title>
      <link href="/2023/09/08/var%20that%20=%20this%E7%9A%84%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
      <url>/2023/09/08/var%20that%20=%20this%E7%9A%84%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>在小程序开发中，var that &#x3D;this的声明很常见。举个例子，代码如下！<br>示例代码1</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js  </span></span><br><span class="line"><span class="title class_">Page</span>(&#123;  </span><br><span class="line">   </span><br><span class="line"> <span class="attr">data</span>: &#123;  </span><br><span class="line"> <span class="attr">toastHidden</span>: <span class="literal">true</span>,  </span><br><span class="line"> &#125;,  </span><br><span class="line">   </span><br><span class="line"> <span class="attr">loadData</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;  </span><br><span class="line">  <span class="keyword">var</span> that = <span class="variable language_">this</span><span class="comment">//这里声明了that；将this存在that里面  </span></span><br><span class="line">  wx.<span class="title function_">request</span>(&#123;  </span><br><span class="line">   <span class="attr">url</span>: <span class="string">&#x27;test.php&#x27;</span>,  </span><br><span class="line">   <span class="attr">data</span>: &#123;<span class="attr">a</span>: <span class="string">&#x27;a&#x27;</span>, <span class="attr">b</span>: <span class="string">&#x27;b&#x27;</span>&#125;,  </span><br><span class="line">   <span class="attr">header</span>: &#123;  </span><br><span class="line">   <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> </span><br><span class="line">   &#125;,  </span><br><span class="line">   <span class="title function_">success</span>(<span class="params">res</span>) &#123;  </span><br><span class="line">     that.<span class="title function_">setData</span>(&#123; <span class="attr">toastHidden</span>: <span class="literal">false</span> &#125;) <span class="comment">//这里使用了that，这样就可以获取Page(&#123;&#125;)对象  </span></span><br><span class="line">   &#125;,  </span><br><span class="line">  &#125;)  </span><br><span class="line"> &#125;  </span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在代码中第9行声明了var that &#x3D;this；第17行使用了that。</p><p>如果不声明var that &#x3D;this，且that改成this，代码如下！</p><p>示例代码2</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js  </span></span><br><span class="line"> <span class="title class_">Page</span>(&#123;  </span><br><span class="line">  </span><br><span class="line"> <span class="attr">data</span>: &#123;  </span><br><span class="line">  <span class="attr">toastHidden</span>: <span class="literal">true</span>,  </span><br><span class="line"> &#125;,  </span><br><span class="line">  </span><br><span class="line"> <span class="attr">loadData</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;  </span><br><span class="line">  wx.<span class="title function_">request</span>(&#123;  </span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;test.php&#x27;</span>,  </span><br><span class="line">  <span class="attr">data</span>: &#123;<span class="attr">a</span>: <span class="string">&#x27;a&#x27;</span>, <span class="attr">b</span>: <span class="string">&#x27;b&#x27;</span>&#125;,  </span><br><span class="line">  <span class="attr">header</span>: &#123;  </span><br><span class="line">   <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> </span><br><span class="line">  &#125;,  </span><br><span class="line">  <span class="title function_">success</span>(<span class="params">res</span>) &#123;  </span><br><span class="line">   <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123; <span class="attr">toastHidden</span>: <span class="literal">false</span> &#125;)  </span><br><span class="line">   &#125;,  </span><br><span class="line">  &#125;)  </span><br><span class="line"> &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>此时运行代码就会报以下错误！</p><p><img src="https://img-blog.csdnimg.cn/20200418225150295.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMyNTM0NDQx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>从报错中得知setData这个属性读不到，为何读不到？这跟this关键字的作用域有关！</p><p>this作用域分析：</p><p>1.在Page({})里面，this关键字指代Page({})整个对象</p><p>2.因此可以通过this关键字访问或者重新设置Page({})里data的变量</p><p>3.然而在loadData函数中使用了wx.request({})API这个方法导致在wx.request({})里没办法使用this来获取Page({})对象</p><p>4.虽然在wx.request({})里没法使用this获取Page({})对象，但是可以在wx.request({})外面先把this存在某个变量中，所以就有了var that &#x3D;this 这个声明。此时that指代Page({})整个对象，这样子就可以在wx.request({})里使用that访问或者重新设置Page({})里data的变量</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 微信小程序 </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信小程序更新数组数据，页面展示未刷新问题</title>
      <link href="/2023/09/08/2023-09-08-%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%9B%B4%E6%96%B0%E6%95%B0%E7%BB%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%E6%9C%AA%E5%88%B7%E6%96%B0%E9%97%AE%E9%A2%98/"/>
      <url>/2023/09/08/2023-09-08-%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%9B%B4%E6%96%B0%E6%95%B0%E7%BB%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%E6%9C%AA%E5%88%B7%E6%96%B0%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="微信小程序更新数组数据，页面展示未刷新问题"><a href="#微信小程序更新数组数据，页面展示未刷新问题" class="headerlink" title="微信小程序更新数组数据，页面展示未刷新问题"></a>微信小程序更新数组数据，页面展示未刷新问题</h2><p>在微信小程序中，数组 arraylist 里面有八个元素（每个元素是对象）；使用this.setData({}) 想向该数组里面添加或者修改一个元素；更改元素后数组 arraylist 是改变了，但是页面没有重新渲染，具体原因可能与vue中改变数组页面不渲染的情况类似；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取数组</span></span><br><span class="line"> <span class="keyword">let</span> arraylist = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">arraylist</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改数据</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">arraylist</span>[index].<span class="property">type</span>=res</span><br><span class="line"> </span><br><span class="line"><span class="comment">//新建一个数组，在进行setData</span></span><br><span class="line"><span class="keyword">var</span> newArraylist = <span class="variable language_">this</span>.<span class="property">arraylist</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 使用setData重新渲染页面，改变视图层</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">    <span class="attr">leaveWordList</span>: newArraylist</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 微信小程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>axios介绍与使用说明</title>
      <link href="/2023/09/08/axios%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/"/>
      <url>/2023/09/08/axios%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<h2 id="axios介绍与使用说明-axios中文文档"><a href="#axios介绍与使用说明-axios中文文档" class="headerlink" title="axios介绍与使用说明 axios中文文档"></a>axios介绍与使用说明 axios中文文档</h2><p>本周在做一个使用vuejs的前端项目，访问后端服务使用axios库，这里对照官方文档，简单记录下，也方便大家参考。</p><p>Axios 是一个基于 <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a> 的 HTTP 库，可以用在浏览器和 node.js 中。github开源地址<a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://github.com/axios/axios">https://github.com/axios/axios</a></p><h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ul><li>在浏览器中创建 <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest">XMLHttpRequests</a></li><li>在 node.js 则创建 <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=http://nodejs.org/api/http.html">http</a> 请求</li><li>支持 <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a> API</li><li>支持拦截请求和响应</li><li>转换请求和响应数据</li><li>取消请求</li><li>自动转换 JSON 数据</li><li>客户端支持防御 <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=http://en.wikipedia.org/wiki/Cross-site_request_forgery">XSRF</a></li></ul><h2 id="浏览器支持"><a href="#浏览器支持" class="headerlink" title="浏览器支持"></a>浏览器支持</h2><p>支持Chrome、火狐、Edge、IE8+等浏览器</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>使用 npm安装:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install axios</span><br></pre></td></tr></table></figure><p>复制</p><p>使用 bower:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bower install axios</span><br></pre></td></tr></table></figure><p>复制</p><p>或者直接使用 cdn:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;https://unpkg.com/axios/dist/axios.min.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>复制</p><h2 id="使用举例"><a href="#使用举例" class="headerlink" title="使用举例"></a>使用举例</h2><p>执行 <code>GET</code> 请求</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为给定 ID 的 user 创建请求</span></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;/user?ID=12345&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET 参数可以放到params里（推荐）</span></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">      <span class="attr">ID</span>: <span class="number">12345</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 还可以使用ECMAScript 2017里的async/await，添加 `async` keyword to your outer function/method.</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;/user?ID=12345&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制</p><blockquote><p> async&#x2F;await 是 ECMAScript 2017新提供的功能 ，Internet Explorer 和一些旧的浏览器并不支持 </p></blockquote><p>执行 <code>POST</code> 请求</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">firstName</span>: <span class="string">&#x27;Fred&#x27;</span>,</span><br><span class="line">    <span class="attr">lastName</span>: <span class="string">&#x27;Flintstone&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>复制</p><p>执行多个并发请求</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getUserAccount</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;/user/12345&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUserPermissions</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;/user/12345/permissions&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">axios.<span class="title function_">all</span>([<span class="title function_">getUserAccount</span>(), <span class="title function_">getUserPermissions</span>()])</span><br><span class="line">  .<span class="title function_">then</span>(axios.<span class="title function_">spread</span>(<span class="keyword">function</span> (<span class="params">acct, perms</span>) &#123;</span><br><span class="line">    <span class="comment">// 两个请求现在都执行完成</span></span><br><span class="line">  &#125;));</span><br></pre></td></tr></table></figure><p>复制</p><h2 id="axios-API"><a href="#axios-API" class="headerlink" title="axios API"></a>axios API</h2><p>可以通过向 <code>axios</code> 传递相关配置来创建请求</p><h5 id="axios-config"><a href="#axios-config" class="headerlink" title="axios(config)"></a>axios(config)</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发送 POST 请求</span></span><br><span class="line"><span class="title function_">axios</span>(&#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;/user/12345&#x27;</span>,</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">firstName</span>: <span class="string">&#x27;Fred&#x27;</span>,</span><br><span class="line">    <span class="attr">lastName</span>: <span class="string">&#x27;Flintstone&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//  GET 请求远程图片</span></span><br><span class="line"><span class="title function_">axios</span>(&#123;</span><br><span class="line">  <span class="attr">method</span>:<span class="string">&#x27;get&#x27;</span>,</span><br><span class="line">  <span class="attr">url</span>:<span class="string">&#x27;http://bit.ly/2mTM3nY&#x27;</span>,</span><br><span class="line">  <span class="attr">responseType</span>:<span class="string">&#x27;stream&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">response</span>) &#123;</span><br><span class="line">  response.<span class="property">data</span>.<span class="title function_">pipe</span>(fs.<span class="title function_">createWriteStream</span>(<span class="string">&#x27;ada_lovelace.jpg&#x27;</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>复制</p><h5 id="axios-url-config"><a href="#axios-url-config" class="headerlink" title="axios(url[, config])"></a>axios(url[, config])</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发送 GET 请求（默认的方法）</span></span><br><span class="line"><span class="title function_">axios</span>(<span class="string">&#x27;/user/12345&#x27;</span>);</span><br></pre></td></tr></table></figure><p>复制</p><h3 id="请求方法的别名"><a href="#请求方法的别名" class="headerlink" title="请求方法的别名"></a>请求方法的别名</h3><p>为方便使用，官方为所有支持的请求方法提供了别名，可以直接使用别名来发起请求：</p><h5 id="axios-request-config"><a href="#axios-request-config" class="headerlink" title="axios.request(config)"></a>axios.request(config)</h5><h5 id="axios-get-url-config"><a href="#axios-get-url-config" class="headerlink" title="axios.get(url[, config])"></a>axios.get(url[, config])</h5><h5 id="axios-delete-url-config"><a href="#axios-delete-url-config" class="headerlink" title="axios.delete(url[, config])"></a>axios.delete(url[, config])</h5><h5 id="axios-head-url-config"><a href="#axios-head-url-config" class="headerlink" title="axios.head(url[, config])"></a>axios.head(url[, config])</h5><h5 id="axios-post-url-data-config"><a href="#axios-post-url-data-config" class="headerlink" title="axios.post(url[, data[, config]])"></a>axios.post(url[, data[, config]])</h5><h5 id="axios-put-url-data-config"><a href="#axios-put-url-data-config" class="headerlink" title="axios.put(url[, data[, config]])"></a>axios.put(url[, data[, config]])</h5><h5 id="axios-patch-url-data-config"><a href="#axios-patch-url-data-config" class="headerlink" title="axios.patch(url[, data[, config]])"></a>axios.patch(url[, data[, config]])</h5><h6 id="NOTE"><a href="#NOTE" class="headerlink" title="NOTE"></a>NOTE</h6><p>在使用别名方法时， <code>url</code>、<code>method</code>、<code>data</code> 这些属性都不必在配置中指定。</p><h3 id="并发"><a href="#并发" class="headerlink" title="并发"></a>并发</h3><p>处理并发请求的助手函数</p><h5 id="axios-all-iterable"><a href="#axios-all-iterable" class="headerlink" title="axios.all(iterable)"></a>axios.all(iterable)</h5><h5 id="axios-spread-callback"><a href="#axios-spread-callback" class="headerlink" title="axios.spread(callback)"></a>axios.spread(callback)</h5><h3 id="创建实例"><a href="#创建实例" class="headerlink" title="创建实例"></a>创建实例</h3><p>可以使用自定义配置新建一个 axios 实例</p><h5 id="axios-create-config"><a href="#axios-create-config" class="headerlink" title="axios.create([config])"></a>axios.create([config])</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;https://some-domain.com/api/&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;<span class="string">&#x27;X-Custom-Header&#x27;</span>: <span class="string">&#x27;foobar&#x27;</span>&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>复制</p><h3 id="实例方法"><a href="#实例方法" class="headerlink" title="实例方法"></a>实例方法</h3><p>以下是可用的实例方法。指定的配置将与实例的配置合并</p><h5 id="axios-request-config-1"><a href="#axios-request-config-1" class="headerlink" title="axios#request(config)"></a>axios#request(config)</h5><h5 id="axios-get-url-config-1"><a href="#axios-get-url-config-1" class="headerlink" title="axios#get(url[, config])"></a>axios#get(url[, config])</h5><h5 id="axios-delete-url-config-1"><a href="#axios-delete-url-config-1" class="headerlink" title="axios#delete(url[, config])"></a>axios#delete(url[, config])</h5><h5 id="axios-head-url-config-1"><a href="#axios-head-url-config-1" class="headerlink" title="axios#head(url[, config])"></a>axios#head(url[, config])</h5><h5 id="axios-post-url-data-config-1"><a href="#axios-post-url-data-config-1" class="headerlink" title="axios#post(url[, data[, config]])"></a>axios#post(url[, data[, config]])</h5><h5 id="axios-put-url-data-config-1"><a href="#axios-put-url-data-config-1" class="headerlink" title="axios#put(url[, data[, config]])"></a>axios#put(url[, data[, config]])</h5><h5 id="axios-patch-url-data-config-1"><a href="#axios-patch-url-data-config-1" class="headerlink" title="axios#patch(url[, data[, config]])"></a>axios#patch(url[, data[, config]])</h5><h2 id="请求配置项"><a href="#请求配置项" class="headerlink" title="请求配置项"></a>请求配置项</h2><p>下面是创建请求时可用的配置选项，注意只有 <code>url</code> 是必需的。如果没有指定 <code>method</code>，请求将默认使用 <code>get</code> 方法。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// `url` 是用于请求的服务器 URL</span></span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;/user&quot;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `method` 是创建请求时使用的方法</span></span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;get&quot;</span>, <span class="comment">// 默认是 get</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// `baseURL` 将自动加在 `url` 前面，除非 `url` 是一个绝对 URL。</span></span><br><span class="line">  <span class="comment">// 它可以通过设置一个 `baseURL` 便于为 axios 实例的方法传递相对 URL</span></span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&quot;https://some-domain.com/api/&quot;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `transformRequest` 允许在向服务器发送前，修改请求数据</span></span><br><span class="line">  <span class="comment">// 只能用在 &quot;PUT&quot;, &quot;POST&quot; 和 &quot;PATCH&quot; 这几个请求方法</span></span><br><span class="line">  <span class="comment">// 后面数组中的函数必须返回一个字符串，或 ArrayBuffer，或 Stream</span></span><br><span class="line">  <span class="attr">transformRequest</span>: [<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="comment">// 对 data 进行任意转换处理</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `transformResponse` 在传递给 then/catch 前，允许修改响应数据</span></span><br><span class="line">  <span class="attr">transformResponse</span>: [<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="comment">// 对 data 进行任意转换处理</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `headers` 是即将被发送的自定义请求头</span></span><br><span class="line">  <span class="attr">headers</span>: &#123;<span class="string">&quot;X-Requested-With&quot;</span>: <span class="string">&quot;XMLHttpRequest&quot;</span>&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `params` 是即将与请求一起发送的 URL 参数</span></span><br><span class="line">  <span class="comment">// 必须是一个无格式对象(plain object)或 URLSearchParams 对象</span></span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    <span class="attr">ID</span>: <span class="number">12345</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `paramsSerializer` 是一个负责 `params` 序列化的函数</span></span><br><span class="line">  <span class="comment">// (e.g. https://www.npmjs.com/package/qs, http://api.jquery.com/jquery.param/)</span></span><br><span class="line">  <span class="attr">paramsSerializer</span>: <span class="keyword">function</span>(<span class="params">params</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Qs</span>.<span class="title function_">stringify</span>(params, &#123;<span class="attr">arrayFormat</span>: <span class="string">&quot;brackets&quot;</span>&#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `data` 是作为请求主体被发送的数据</span></span><br><span class="line">  <span class="comment">// 只适用于这些请求方法 &quot;PUT&quot;, &quot;POST&quot;, 和 &quot;PATCH&quot;</span></span><br><span class="line">  <span class="comment">// 在没有设置 `transformRequest` 时，必须是以下类型之一：</span></span><br><span class="line">  <span class="comment">// - string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams</span></span><br><span class="line">  <span class="comment">// - 浏览器专属：FormData, File, Blob</span></span><br><span class="line">  <span class="comment">// - Node 专属： Stream</span></span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">firstName</span>: <span class="string">&quot;Fred&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `timeout` 指定请求超时的毫秒数(0 表示无超时时间)</span></span><br><span class="line">  <span class="comment">// 如果请求话费了超过 `timeout` 的时间，请求将被中断</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `withCredentials` 表示跨域请求时是否需要使用凭证</span></span><br><span class="line">  <span class="attr">withCredentials</span>: <span class="literal">false</span>, <span class="comment">// 默认的</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// `adapter` 允许自定义处理请求，以使测试更轻松</span></span><br><span class="line">  <span class="comment">// 返回一个 promise 并应用一个有效的响应 (查阅 [response docs](#response-api)).</span></span><br><span class="line">  <span class="attr">adapter</span>: <span class="keyword">function</span> (<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `auth` 表示应该使用 HTTP 基础验证，并提供凭据</span></span><br><span class="line">  <span class="comment">// 这将设置一个 `Authorization` 头，覆写掉现有的任意使用 `headers` 设置的自定义 `Authorization`头</span></span><br><span class="line">  <span class="attr">auth</span>: &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&quot;janedoe&quot;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&quot;s00pers3cret&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `responseType` 表示服务器响应的数据类型，可以是 &quot;arraybuffer&quot;, &quot;blob&quot;, &quot;document&quot;, &quot;json&quot;, &quot;text&quot;, &quot;stream&quot;</span></span><br><span class="line">  <span class="attr">responseType</span>: <span class="string">&quot;json&quot;</span>, <span class="comment">// 默认的</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// `xsrfCookieName` 是用作 xsrf token 的值的cookie的名称</span></span><br><span class="line">  <span class="attr">xsrfCookieName</span>: <span class="string">&quot;XSRF-TOKEN&quot;</span>, <span class="comment">// default</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// `xsrfHeaderName` 是承载 xsrf token 的值的 HTTP 头的名称</span></span><br><span class="line">  <span class="attr">xsrfHeaderName</span>: <span class="string">&quot;X-XSRF-TOKEN&quot;</span>, <span class="comment">// 默认的</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// `onUploadProgress` 允许为上传处理进度事件</span></span><br><span class="line">  <span class="attr">onUploadProgress</span>: <span class="keyword">function</span> (<span class="params">progressEvent</span>) &#123;</span><br><span class="line">    <span class="comment">// 对原生进度事件的处理</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `onDownloadProgress` 允许为下载处理进度事件</span></span><br><span class="line">  <span class="attr">onDownloadProgress</span>: <span class="keyword">function</span> (<span class="params">progressEvent</span>) &#123;</span><br><span class="line">    <span class="comment">// 对原生进度事件的处理</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `maxContentLength` 定义允许的响应内容的最大尺寸</span></span><br><span class="line">  <span class="attr">maxContentLength</span>: <span class="number">2000</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `validateStatus` 定义对于给定的HTTP 响应状态码是 resolve 或 reject  promise 。如果 `validateStatus` 返回 `true` (或者设置为 `null` 或 `undefined`)，promise 将被 resolve; 否则，promise 将被 rejecte</span></span><br><span class="line">  <span class="attr">validateStatus</span>: <span class="keyword">function</span> (<span class="params">status</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> status &amp;gt;= <span class="number">200</span> &amp;amp;&amp;amp; status &amp;lt; <span class="number">300</span>; <span class="comment">// 默认的</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `maxRedirects` 定义在 node.js 中 follow 的最大重定向数目</span></span><br><span class="line">  <span class="comment">// 如果设置为0，将不会 follow 任何重定向</span></span><br><span class="line">  <span class="attr">maxRedirects</span>: <span class="number">5</span>, <span class="comment">// 默认的</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// `httpAgent` 和 `httpsAgent` 分别在 node.js 中用于定义在执行 http 和 https 时使用的自定义代理。允许像这样配置选项：</span></span><br><span class="line">  <span class="comment">// `keepAlive` 默认没有启用</span></span><br><span class="line">  <span class="attr">httpAgent</span>: <span class="keyword">new</span> http.<span class="title class_">Agent</span>(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</span><br><span class="line">  <span class="attr">httpsAgent</span>: <span class="keyword">new</span> https.<span class="title class_">Agent</span>(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// &quot;proxy&quot; 定义代理服务器的主机名称和端口</span></span><br><span class="line">  <span class="comment">// `auth` 表示 HTTP 基础验证应当用于连接代理，并提供凭据</span></span><br><span class="line">  <span class="comment">// 这将会设置一个 `Proxy-Authorization` 头，覆写掉已有的通过使用 `header` 设置的自定义 `Proxy-Authorization` 头。</span></span><br><span class="line">  <span class="attr">proxy</span>: &#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">9000</span>,</span><br><span class="line">    <span class="attr">auth</span>: : &#123;</span><br><span class="line">      <span class="attr">username</span>: <span class="string">&quot;mikeymike&quot;</span>,</span><br><span class="line">      <span class="attr">password</span>: <span class="string">&quot;rapunz3l&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `cancelToken` 指定用于取消请求的 cancel token</span></span><br><span class="line">  <span class="comment">// （查看后面的 Cancellation 这节了解更多）</span></span><br><span class="line">  <span class="attr">cancelToken</span>: <span class="keyword">new</span> <span class="title class_">CancelToken</span>(<span class="keyword">function</span> (<span class="params">cancel</span>) &#123;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制</p><h2 id="响应结构"><a href="#响应结构" class="headerlink" title="响应结构"></a>响应结构</h2><p>axios请求的响应包含以下信息：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// `data` 由服务器提供的响应</span></span><br><span class="line">  <span class="attr">data</span>: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `status`  HTTP 状态码</span></span><br><span class="line">  <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `statusText` 来自服务器响应的 HTTP 状态信息</span></span><br><span class="line">  <span class="attr">statusText</span>: <span class="string">&quot;OK&quot;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `headers` 服务器响应的头</span></span><br><span class="line">  <span class="attr">headers</span>: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `config` 是为请求提供的配置信息</span></span><br><span class="line">  <span class="attr">config</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制</p><p>使用 <code>then</code> 时，会接收下面这样的响应：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;/user/12345&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">data</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">status</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">statusText</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">headers</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">config</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>复制</p><p>在使用 <code>catch</code> 时，或传递 <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then">rejection callback</a> 作为 <code>then</code> 的第二个参数时，响应可以通过 <code>error</code> 对象可被使用，正如在<a href="https://cloud.tencent.com/developer/tools/blog-entry?target=http://www.cnblogs.com/%23handling-errors">错误处理</a>这一节所讲。</p><h2 id="配置的默认值-defaults"><a href="#配置的默认值-defaults" class="headerlink" title="配置的默认值&#x2F;defaults"></a>配置的默认值&#x2F;defaults</h2><p>你可以指定将被用在各个请求的配置默认值</p><h3 id="全局的-axios-默认值"><a href="#全局的-axios-默认值" class="headerlink" title="全局的 axios 默认值"></a>全局的 axios 默认值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&quot;https://api.example.com&quot;</span>;</span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">headers</span>.<span class="property">common</span>[<span class="string">&quot;Authorization&quot;</span>] = <span class="variable constant_">AUTH_TOKEN</span>;</span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">headers</span>.<span class="property">post</span>[<span class="string">&quot;Content-Type&quot;</span>] = <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>;</span><br></pre></td></tr></table></figure><p>复制</p><h3 id="自定义实例默认值"><a href="#自定义实例默认值" class="headerlink" title="自定义实例默认值"></a>自定义实例默认值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建实例时设置配置的默认值</span></span><br><span class="line"><span class="keyword">var</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&quot;https://api.example.com&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在实例已创建后修改默认值</span></span><br><span class="line">instance.<span class="property">defaults</span>.<span class="property">headers</span>.<span class="property">common</span>[<span class="string">&quot;Authorization&quot;</span>] = <span class="variable constant_">AUTH_TOKEN</span>;</span><br></pre></td></tr></table></figure><p>复制</p><h3 id="配置的优先级"><a href="#配置的优先级" class="headerlink" title="配置的优先级"></a>配置的优先级</h3><p>配置会以一个优先顺序进行合并。</p><p>请求的config &gt; 实例的 <code>defaults</code> 属性 &gt; 库默认值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用由库提供的配置的默认值来创建实例</span></span><br><span class="line"><span class="comment">// 此时超时配置的默认值是 `0`</span></span><br><span class="line"><span class="keyword">var</span> instance = axios.<span class="title function_">create</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 覆写库的超时默认值</span></span><br><span class="line"><span class="comment">// 现在，在超时前，所有请求都会等待 2.5 秒</span></span><br><span class="line">instance.<span class="property">defaults</span>.<span class="property">timeout</span> = <span class="number">2500</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为已知需要花费很长时间的请求覆写超时设置</span></span><br><span class="line">instance.<span class="title function_">get</span>(<span class="string">&quot;/longRequest&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>复制</p><h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><p>可以自定义拦截器，在在请求或响应被 <code>then</code> 或 <code>catch</code> 处理前拦截它们。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加请求拦截器</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="comment">// 在发送请求之前做些什么</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;, <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="comment">// 对请求错误做些什么</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加响应拦截器</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="comment">// 对响应数据做点什么</span></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;, <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="comment">// 对响应错误做点什么</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>复制</p><p>如果你想在稍后移除拦截器，可以这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myInterceptor = axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="comment">/*...*/</span>&#125;);</span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">eject</span>(myInterceptor);</span><br></pre></td></tr></table></figure><p>复制</p><p>可以为自定义 axios 实例添加拦截器</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> instance = axios.<span class="title function_">create</span>();</span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="comment">/*...*/</span>&#125;);</span><br></pre></td></tr></table></figure><p>复制</p><h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;/user/12345&quot;</span>)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (error.<span class="property">response</span>) &#123;</span><br><span class="line">      <span class="comment">// 请求已发出，但服务器响应的状态码不在 2xx 范围内</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">response</span>.<span class="property">data</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">response</span>.<span class="property">status</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">response</span>.<span class="property">headers</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// Something happened in setting up the request that triggered an Error</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error&quot;</span>, error.<span class="property">message</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">config</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>复制</p><p>可以使用 <code>validateStatus</code> 配置选项定义一个自定义 HTTP 状态码的错误范围。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;/user/12345&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">validateStatus</span>: <span class="keyword">function</span> (<span class="params">status</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> status &lt; <span class="number">500</span>; <span class="comment">// 状态码在大于或等于500时才会 reject</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>复制</p><h2 id="取消请求"><a href="#取消请求" class="headerlink" title="取消请求"></a>取消请求</h2><p>使用 <em>cancel token</em> 取消请求</p><blockquote><p> Axios 的 cancel token API 基于<a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://github.com/tc39/proposal-cancelable-promises">cancelable promises proposal</a> </p></blockquote><p>可以使用 <code>CancelToken.source</code> 工厂方法创建 cancel token，像这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">CancelToken</span> = axios.<span class="property">CancelToken</span>;</span><br><span class="line"><span class="keyword">const</span> source = <span class="title class_">CancelToken</span>.<span class="title function_">source</span>();</span><br><span class="line"></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;/user/12345&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">cancelToken</span>: source.<span class="property">token</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">thrown</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (axios.<span class="title function_">isCancel</span>(thrown)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Request canceled&#x27;</span>, thrown.<span class="property">message</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// handle error</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;/user/12345&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;new name&#x27;</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">cancelToken</span>: source.<span class="property">token</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// cancel the request (the message parameter is optional)</span></span><br><span class="line">source.<span class="title function_">cancel</span>(<span class="string">&#x27;Operation canceled by the user.&#x27;</span>);</span><br></pre></td></tr></table></figure><p>复制</p><p>还可以通过传递一个 executor 函数到 <code>CancelToken</code> 的构造函数来创建 cancel token：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">CancelToken</span> = axios.<span class="property">CancelToken</span>;</span><br><span class="line"><span class="keyword">var</span> cancel;</span><br><span class="line"></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;/user/12345&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">cancelToken</span>: <span class="keyword">new</span> <span class="title class_">CancelToken</span>(<span class="keyword">function</span> <span class="title function_">executor</span>(<span class="params">c</span>) &#123;</span><br><span class="line">    <span class="comment">// executor 函数接收一个 cancel 函数作为参数</span></span><br><span class="line">    cancel = c;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取消请求</span></span><br><span class="line"><span class="title function_">cancel</span>();</span><br></pre></td></tr></table></figure><p>复制</p><p>Note : 可以使用同一个 cancel token 取消多个请求</p><h2 id="请求时使用-application-x-www-form-urlencoded"><a href="#请求时使用-application-x-www-form-urlencoded" class="headerlink" title="请求时使用 application&#x2F;x-www-form-urlencoded"></a>请求时使用 application&#x2F;x-www-form-urlencoded</h2><p>axios会默认序列化 JavaScript 对象为 JSON. 如果想使用 application&#x2F;x-www-form-urlencoded 格式，你可以使用下面的配置.</p><h3 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h3><p>在浏览器环境，你可以使用 URLSearchParams API ：:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>();</span><br><span class="line">params.<span class="title function_">append</span>(<span class="string">&#x27;param1&#x27;</span>, <span class="string">&#x27;value1&#x27;</span>);</span><br><span class="line">params.<span class="title function_">append</span>(<span class="string">&#x27;param2&#x27;</span>, <span class="string">&#x27;value2&#x27;</span>);</span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;/foo&#x27;</span>, params);</span><br></pre></td></tr></table></figure><p>复制</p><blockquote><p> URLSearchParams不是所有的浏览器均支持 </p></blockquote><p>除此之外，你可以使用qs库来编码数据:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">&#x27;qs&#x27;</span>);</span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;/foo&#x27;</span>, qs.<span class="title function_">stringify</span>(&#123; <span class="string">&#x27;bar&#x27;</span>: <span class="number">123</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Or in another way (ES6),</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> data = &#123; <span class="string">&#x27;bar&#x27;</span>: <span class="number">123</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123; <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span> &#125;,</span><br><span class="line">  <span class="attr">data</span>: qs.<span class="title function_">stringify</span>(data),</span><br><span class="line">  url,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">axios</span>(options);</span><br></pre></td></tr></table></figure><p>复制</p><h3 id="Node-js环境"><a href="#Node-js环境" class="headerlink" title="Node.js环境"></a>Node.js环境</h3><p>在 node.js里, 可以使用 querystring module:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>);</span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;http://something.com/&#x27;</span>, querystring.<span class="title function_">stringify</span>(&#123; <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span> &#125;));</span><br></pre></td></tr></table></figure><p>复制</p><p>当然，同浏览器一样，你还可以使用 qs library.</p><h2 id="Promises"><a href="#Promises" class="headerlink" title="Promises"></a>Promises</h2><p>axios 依赖原生的 ES6 Promise 实现而<a href="https://cloud.tencent.com/developer/tools/blog-entry?target=http://caniuse.com/promises">被支持</a>. 如果你的环境不支持 ES6 Promise，你可以使用 <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https://github.com/jakearchibald/es6-promise">polyfill</a>.</p><h2 id="TypeScript支持"><a href="#TypeScript支持" class="headerlink" title="TypeScript支持"></a>TypeScript支持</h2><p>axios 包含 <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=http://typescriptlang.org/">TypeScript</a> definitions.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;/user?ID=12345&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> axios </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue 组件之间传递数据</title>
      <link href="/2023/09/08/vue%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/"/>
      <url>/2023/09/08/vue%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="vue组件间通信"><a href="#vue组件间通信" class="headerlink" title="vue组件间通信"></a>vue组件间通信</h1><p>组件是 vue.js 最强大的功能之一，而组件实例的作用域是相互独立的，这就意味着不同组件之间的数据无法相互引用。如何传递数据也成了组件的重要知识点之一。</p><h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>组件与组件之间，还存在着不同的关系。父子关系与兄弟关系（不是父子的都暂称为兄弟吧）。</p><h3 id="父子组件"><a href="#父子组件" class="headerlink" title="父子组件"></a>父子组件</h3><p>父子关系即是组件 A 在它的模板中使用了组件 B，那么组件 A 就是父组件，组件 B 就是子组件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注册一个子组件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;child&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">data</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">text</span>: <span class="string">&#x27;我是father的子组件！&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&#x27;&lt;span&gt;&#123;&#123; text &#125;&#125;&lt;/span&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 注册一个父组件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;father&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&#x27;&lt;div&gt;&lt;child&gt;&lt;/child&gt;&lt;/div&gt;&#x27;</span>  <span class="comment">// 在模板中使用了child组件</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>直接使用 father 组件的时候：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">father</span>&gt;</span><span class="tag">&lt;/<span class="name">father</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>页面中就会渲染出 ：我是father的子组件！</p><p>father 组件在模板中使用了 child 组件，所以它就是父组件，child 组件被使用，所以 child 组件就是子组件。</p><h3 id="兄弟组件"><a href="#兄弟组件" class="headerlink" title="兄弟组件"></a>兄弟组件</h3><p>两个组件互不引用，则为兄弟组件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;brother1&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&#x27;&lt;div&gt;我是大哥&lt;/div&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;brother2&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&#x27;&lt;div&gt;我是小弟&lt;/div&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>使用组件的时候：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">brother1</span>&gt;</span><span class="tag">&lt;/<span class="name">brother1</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">brother2</span>&gt;</span><span class="tag">&lt;/<span class="name">brother2</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>页面中就会渲染出 ：</p><p>我是大哥</p><p>我是小弟</p><h2 id="Prop-父传子"><a href="#Prop-父传子" class="headerlink" title="Prop(父传子)"></a>Prop(父传子)</h2><p>子组件想要使用父组件的数据，我们需要通过子组件的 props 选项来获得父组件传过来的数据。以下我使用在 .vue 文件中的格式来写例子。</p><h3 id="如何传递数据"><a href="#如何传递数据" class="headerlink" title="如何传递数据"></a>如何传递数据</h3><p>在父组件 father.vue 中引用子组件 child.vue，把 name 的值传给 child 组件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">        // message 定义在子组件的 props 中</span><br><span class="line">        &lt;child :message=&quot;name&quot;&gt;&lt;/child&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import child from &#x27;./child.vue&#x27;;</span><br><span class="line">    export default &#123;</span><br><span class="line">        components: &#123;</span><br><span class="line">            child</span><br><span class="line">        &#125;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                name: &#x27;linxin&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>在子组件 child.vue 中的 props 选项中声明它期待获得的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;span&gt;Hello &#123;&#123;message&#125;&#125;&lt;/span&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        // 在 props 中声明获取父组件的数据通过 message 传过来</span><br><span class="line">        props: [&#x27;message&#x27;]</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>那么页面中就会渲染出：Hello linxin</p><h3 id="单向数据流"><a href="#单向数据流" class="headerlink" title="单向数据流"></a>单向数据流</h3><p>当父组件的 name 发生改变，子组件也会自动地更新视图。但是在子组件中，我们不要去修改 prop。如果你必须要修改到这些数据，你可以使用以下方法：</p><p>方法一：把 prop 赋值给一个局部变量，然后需要修改的话就修改这个局部变量，而不影响 prop</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">newMessage</span>: <span class="literal">null</span></span><br><span class="line">        &#125; </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">props</span>: [<span class="string">&#x27;message&#x27;</span>],</span><br><span class="line">    <span class="title function_">created</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">newMessage</span> = <span class="variable language_">this</span>.<span class="property">message</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方法二：在计算属性中对 prop 进行处理</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">props</span>: [<span class="string">&#x27;message&#x27;</span>],</span><br><span class="line">    <span class="attr">computed</span>: &#123;</span><br><span class="line">        <span class="title function_">newMessage</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">newMessage</span> + <span class="string">&#x27; 哈哈哈&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="自定义事件-emit-子传父"><a href="#自定义事件-emit-子传父" class="headerlink" title="自定义事件$emit(子传父)"></a>自定义事件$emit(子传父)</h2><p>prop 是单向绑定的：当父组件的属性变化时，将传导给子组件，但是不会反过来。修改子组件的 prop 值，是不会传回给父组件去更新视图的。那么子组件要如何去与父组件通讯呢？</p><p>那就是自定义事件。通过在父组件 $on(eventName) 监听自定义事件，当子组件里 $emit(eventName) 触发该自定义事件的时候，父组件执行相应的操作。</p><ul><li>$emit 绑定一个自定义事件，当这个事件被执行的时候就会将参数传递给父组件，而父组件通过v-on监听并接收参数</li></ul><p>比如在父组件中控制一个弹框子组件的显示，在子组件中按下关闭之后，告诉父组件去隐藏它，然后父组件就执行操作隐藏弹框。</p><p>父组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">        // hide 为自定义事件，名字可以自己随便起，不能有大写字母，可以使用短横线</span><br><span class="line">        // @hide 监听子组件触发 hide 事件，则会执行 hideDialog 方法</span><br><span class="line">        &lt;dialog :is-show=&quot;show&quot; @hide=&quot;hideDialog&quot;&gt;&lt;/dialog&gt;</span><br><span class="line">        &lt;button @click=&quot;showDialog&quot;&gt;显示弹框&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import dialog from &#x27;./dialog.vue&#x27;;</span><br><span class="line">    export default &#123;</span><br><span class="line">        components: &#123; dialog &#125;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                show: false</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            showDialog() &#123;</span><br><span class="line">                this.show = true;</span><br><span class="line">            &#125;,</span><br><span class="line">            hideDialog() &#123;</span><br><span class="line">                this.show = false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>在子组件 dialog.vue 中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;dialog&quot; v-show=&quot;isShow&quot;&gt;</span><br><span class="line">        &lt;p&gt;这里是弹框子组件&lt;/p&gt;</span><br><span class="line">        &lt;button @click=&quot;toHide&quot;&gt;关闭弹框&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        // 驼峰式命名的 prop 需要转换为相对应的短横线隔开式 is-show</span><br><span class="line">        props: [&#x27;isShow&#x27;],</span><br><span class="line">        methods: &#123;</span><br><span class="line">            toHide()&#123;</span><br><span class="line">                // $emit 方法触发父组件的监听事件</span><br><span class="line">                this.$emit(&#x27;hideDialog&#x27;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>这样就实现了父子组件之间的相互通讯。</p><h2 id="ref-refs"><a href="#ref-refs" class="headerlink" title="ref &#x2F; $refs"></a>ref &#x2F; $refs</h2><p>这种方式也是实现父子组件之间的通信</p><p>ref：这个属性用在子组件上，它的用用就指向了子组件的实例，可以通过实例来访问组件的数据和方法</p><p><strong>用法：</strong></p><p>在子组件中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;JavaScript&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    sayHello () &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>在父组件中：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">child</span> <span class="attr">ref</span>=<span class="string">&quot;child&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component-a</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">import</span> child <span class="keyword">from</span> <span class="string">&#x27;./child.vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">components</span>: &#123; child &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    mounted () &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">child</span>.<span class="property">name</span>);  <span class="comment">// JavaScript</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">child</span>.<span class="title function_">sayHello</span>();  <span class="comment">// hello</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Event-Bus（-emit-on）"><a href="#Event-Bus（-emit-on）" class="headerlink" title="Event Bus（$emit &#x2F; $on）"></a>Event Bus（$emit &#x2F; $on）</h2><p><strong>一种可以在任意组件间通信的方式</strong>，本质上就是一个对象，它必须满足以下条件</p><ol><li>所有的组件对象都必须能看见他 </li><li>这个对象必须能够使用 <strong>$on</strong> <strong>$emit</strong> <strong>$off</strong> 方法去绑定、触发和解绑事件</li></ol><p>eventBus 事件总线适用于<strong>父子组件、非父子组件</strong>等之间的通信，使用步骤如下：</p><p>使用步骤</p><ol><li>定义全局事件总线</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建vm</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line"><span class="attr">el</span>:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line"><span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line"><span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$bus</span> = <span class="variable language_">this</span> <span class="comment">//安装全局事件总线</span></span><br><span class="line">&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol><li>使用事件总线 </li><li>a.接收数据：A组件想接收数据，则在A组件中给 <strong>$bus</strong> 绑定自定义事件，事件的回调留在A组件自身</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line"><span class="title function_">methods</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="title function_">demo</span>(<span class="params">data</span>)&#123;...&#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$bus</span>.$on(<span class="string">&#x27;xxx&#x27;</span>,<span class="variable language_">this</span>.<span class="property">demo</span>) <span class="comment">//子组件</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>​b. 提供数据：this.$bus.$emit(‘事件名’,返回的数据) &#x2F;&#x2F;父组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line"><span class="title function_">sendStudentName</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$bus</span>.$emit(<span class="string">&#x27;hello&#x27;</span>,data)</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>​最好在 <strong>beforeDestroy</strong> 钩子中，用 $off(‘事件名’) 去解绑当前组件所用到的事件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$bus</span>.$off(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h2><ul><li><p>state：用于数据的存储，是store中的唯一数据源</p></li><li><p>getters：如vue中的计算属性一样，基于state数据的二次包装，常用于数据的筛选和多个数据的相关性计算</p></li><li><p>mutations：类似函数，改变state数据的唯一途径，且不能用于处理异步事件</p></li><li><p>actions：类似于mutation，用于提交mutation来改变状态，而不直接变更状态，可以包含任意异步操作</p></li><li><p>modules：类似于命名空间，用于项目中将各个模块的状态分开定义和操作，便于维护</p></li><li><h3 id="Vuex使用步骤："><a href="#Vuex使用步骤：" class="headerlink" title="Vuex使用步骤："></a><strong>Vuex使用步骤：</strong></h3><h4 id="（1）这里我们先新建-store文件夹，-对Vuex进行一些封装处理"><a href="#（1）这里我们先新建-store文件夹，-对Vuex进行一些封装处理" class="headerlink" title="（1）这里我们先新建 store文件夹， 对Vuex进行一些封装处理"></a><strong>（1）这里我们先新建 store文件夹， 对Vuex进行一些封装处理</strong></h4><p>在 store 文件夹下添加 index.js 文件(src&#x2F;store&#x2F;index.js)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//引入Vue核心库</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//引入Vuex</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="comment">//应用Vuex插件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"><span class="comment">//准备actions对象——响应组件中用户的动作</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;&#125;</span><br><span class="line"><span class="comment">//准备mutations对象——修改state中的数据</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;&#125;</span><br><span class="line"><span class="comment">//准备state对象——保存具体的数据</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;&#125;</span><br><span class="line"><span class="comment">//创建并暴露store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    actions,</span><br><span class="line">    mutations,</span><br><span class="line">    state</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="（2）在-store-文件夹下添加-module-文件夹，在module文件夹再新建-user-js-文件"><a href="#（2）在-store-文件夹下添加-module-文件夹，在module文件夹再新建-user-js-文件" class="headerlink" title="（2）在 store 文件夹下添加 module 文件夹，在module文件夹再新建 user.js 文件"></a><strong>（2）在 store 文件夹下添加 <code>module</code> 文件夹，在module文件夹再新建 <code>user.js</code> 文件</strong></h4><p>​初始化数据、配置actions、配置mutations，操作文件store.js</p></li></ul><ol><li><p>组件中读取vuex中的数据：$store.state.sum</p></li><li><p>组件中修改vuex中的数据：$store.dispatch(‘action中的方法名’,数据)或 $store.commit(‘mutations中的方法名’,数据)</p></li><li><p>备注：若没有网络请求或其他业务逻辑，组件中也可以越过actions，即不写dispatch，直接编写commit</p></li></ol><h4 id="3-在main-js中创建vm时传入store配置项"><a href="#3-在main-js中创建vm时传入store配置项" class="headerlink" title="**(3) 在main.js中创建vm时传入store配置项 **"></a>**(3) 在main.js中创建vm时传入store配置项 **</h4>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入store</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line">......</span><br><span class="line"><span class="comment">//创建vm</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">    <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">    store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h4><p>  <strong>commit  是操作  mutations</strong></p><p>  <strong>dispatch  是操作  actions</strong></p><h4 id="例子："><a href="#例子：" class="headerlink" title="例子："></a><strong>例子：</strong></h4><p>  <strong>（1）src&#x2F;store&#x2F;index.js</strong></p>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//该文件用于创建Vuex中最为核心的store</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//引入Vuex</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="comment">//应用Vuex插件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"><span class="comment">//准备actions——用于响应组件中的动作</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    <span class="comment">/* jia(context,value)&#123;</span></span><br><span class="line"><span class="comment">        console.log(&#x27;actions中的jia被调用了&#x27;)</span></span><br><span class="line"><span class="comment">        context.commit(&#x27;JIA&#x27;,value)</span></span><br><span class="line"><span class="comment">    &#125;,</span></span><br><span class="line"><span class="comment">    jian(context,value)&#123;</span></span><br><span class="line"><span class="comment">        console.log(&#x27;actions中的jian被调用了&#x27;) </span></span><br><span class="line"><span class="comment">        context.commit(&#x27;JIAN&#x27;,value)</span></span><br><span class="line"><span class="comment">  &#125;, */</span></span><br><span class="line">    <span class="title function_">jiaOdd</span>(<span class="params">context,value</span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;actions中的jiaOdd被调用了&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>(context.<span class="property">state</span>.<span class="property">sum</span> % <span class="number">2</span>)&#123;</span><br><span class="line">            context.<span class="title function_">commit</span>(<span class="string">&#x27;JIA&#x27;</span>,value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">jiaWait</span>(<span class="params">context,value</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;actions中的jiaWait被调用了&#x27;</span>)</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            context.<span class="title function_">commit</span>(<span class="string">&#x27;JIA&#x27;</span>,value)</span><br><span class="line">        &#125;,<span class="number">500</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//准备mutations——用于操作数据（state）</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="title function_">JIA</span>(<span class="params">state,value</span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;mutations中的JIA被调用了&#x27;</span>)</span><br><span class="line">        state.<span class="property">sum</span> += value</span><br><span class="line">  &#125;,</span><br><span class="line">    <span class="title function_">JIAN</span>(<span class="params">state,value</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;mutations中的JIAN被调用了&#x27;</span>)</span><br><span class="line">        state.<span class="property">sum</span> -= value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//准备state——用于存储数据</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">    <span class="attr">sum</span>:<span class="number">0</span> <span class="comment">//当前的和</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//创建并暴露store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    actions,</span><br><span class="line">    mutations,</span><br><span class="line">    state,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>  <strong>（2）Count.vue</strong></p>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>当前求和为：&#123;&#123;$store.state.sum&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model.number</span>=<span class="string">&quot;n&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;decrement&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;incrementOdd&quot;</span>&gt;</span>当前求和为奇数再加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;incrementWait&quot;</span>&gt;</span>等一等再加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">name</span>:<span class="string">&#x27;Count&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">n</span>:<span class="number">1</span>, <span class="comment">//用户选择的数字</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title function_">increment</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// commit 是操作 mutations</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;JIA&#x27;</span>,<span class="variable language_">this</span>.<span class="property">n</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title function_">decrement</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// commit 是操作 mutations</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;JIAN&#x27;</span>,<span class="variable language_">this</span>.<span class="property">n</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title function_">incrementOdd</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// dispatch 是操作 actions</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;jiaOdd&#x27;</span>,<span class="variable language_">this</span>.<span class="property">n</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title function_">incrementWait</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// dispatch 是操作 actions</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;jiaWait&#x27;</span>,<span class="variable language_">this</span>.<span class="property">n</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Count&#x27;</span>,<span class="variable language_">this</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;css&quot;</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-tag">button</span>&#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        <span class="attribute">margin-left</span>: <span class="number">5px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="localStorage-sessionStorage"><a href="#localStorage-sessionStorage" class="headerlink" title="localStorage &#x2F; sessionStorage"></a>localStorage &#x2F; sessionStorage</h2><p>这种通信比较简单,缺点是数据和状态比较混乱,不太容易维护。</p><ul><li>通过<code>window.localStorage.getItem(key)</code>获取数据</li><li>通过<code>window.localStorage.setItem(key,value)</code>存储数据</li></ul><p><strong>注意用<code>JSON.parse()</code> &#x2F; <code>JSON.stringify()</code> 做数据格式转换， localStorage &#x2F; sessionStorage可以结合vuex, 实现<code>数据的持久保存</code>,同时使用vuex解决数据和状态混乱问题.</strong></p><h2 id="自己实现简单的-Store-模式"><a href="#自己实现简单的-Store-模式" class="headerlink" title="自己实现简单的 Store 模式"></a>自己实现简单的 Store 模式</h2><p>对于小型的项目，通信十分简单，这时使用 Vuex 反而会显得冗余和繁琐，这种情况最好不要使用 Vuex，可以自己在项目中实现简单的 Store。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="keyword">const</span> store = &#123;</span><br><span class="line">  <span class="attr">debug</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">author</span>: <span class="string">&#x27;yushihu!&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  setAuthorAction (newValue) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">debug</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;setAuthorAction triggered with&#x27;</span>, newValue)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">author</span> = newValue</span><br><span class="line">  &#125;,</span><br><span class="line">  deleteAuthorAction () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">debug</span>) <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;deleteAuthorAction triggered&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">author</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue组件间通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 葵花宝典</title>
      <link href="/2023/09/06/git/"/>
      <url>/2023/09/06/git/</url>
      
        <content type="html"><![CDATA[<h2 id="账户配置"><a href="#账户配置" class="headerlink" title="账户配置"></a>账户配置</h2><ol><li>配置全局账户，对所有 Git 仓库有效</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&#x27;Your Name&#x27;</span></span><br><span class="line">git config --global user.email <span class="string">&#x27;Your Email&#x27;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>配置局部账户，只对当前 Git 仓库有效</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="built_in">local</span> user.name <span class="string">&#x27;Your Name&#x27;</span></span><br><span class="line">git config --<span class="built_in">local</span> user.email <span class="string">&#x27;Your Email&#x27;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>查看全局配置</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global --list</span><br></pre></td></tr></table></figure><ol start="4"><li>查看局部配置</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="built_in">local</span> --list</span><br></pre></td></tr></table></figure><h2 id="生成ssh-密钥"><a href="#生成ssh-密钥" class="headerlink" title="生成ssh 密钥"></a>生成ssh 密钥</h2><p>连接到github仓库，公钥文件存放在C:&#x2F;用户文件夹&#x2F;.ssh&#x2F;id_rsa.pub</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;你的邮箱&quot;</span></span><br><span class="line">ssh -T git@github.com   //测试连接命令</span><br></pre></td></tr></table></figure><h2 id="本地基本操作"><a href="#本地基本操作" class="headerlink" title="本地基本操作"></a>本地基本操作</h2><h3 id="初始化本地库"><a href="#初始化本地库" class="headerlink" title="初始化本地库"></a>初始化本地库</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><h3 id="查看状态"><a href="#查看状态" class="headerlink" title="查看状态"></a>查看状态</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><h3 id="添加暂存区-git-add"><a href="#添加暂存区-git-add" class="headerlink" title="添加暂存区 git add"></a>添加暂存区 git add</h3><ul><li>将当前目录及其子目录下所有变更添加到暂存区</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure><ul><li>将本地库所有变更添加到暂存区</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add -A</span><br></pre></td></tr></table></figure><ul><li>指定文件添加暂存区</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add file1 file2 ...</span><br></pre></td></tr></table></figure><h3 id="提交本地库-git-commit"><a href="#提交本地库-git-commit" class="headerlink" title="提交本地库 git commit"></a>提交本地库 git commit</h3><ul><li>提交所有变更</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git commit</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">git commit -m <span class="string">&#x27;日志信息&#x27;</span> -a</span><br></pre></td></tr></table></figure><ul><li>提交当前目录及其子目录的变更</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&#x27;日志信息&#x27;</span> .</span><br></pre></td></tr></table></figure><ul><li>提交指定文件</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&#x27;日志信息&#x27;</span> fileName</span><br></pre></td></tr></table></figure><h2 id="比较差异-git-diff"><a href="#比较差异-git-diff" class="headerlink" title="比较差异 git diff"></a>比较差异 git diff</h2><ol><li>比较工作区和暂存区的所有差异，只能查看旧文件的变更（包括修改和删除），不能查看新文件（因为新文件还为被 git 追踪）</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff</span><br></pre></td></tr></table></figure><ol start="2"><li>比较指定文件工作区和暂存区的差异</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff fileName</span><br></pre></td></tr></table></figure><ol start="3"><li>比较暂存区和 HEAD 的所有差异</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff --cached</span><br></pre></td></tr></table></figure><ol start="4"><li>比较指定文件暂存区和 HEAD 的差异</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff --cached fileName</span><br></pre></td></tr></table></figure><ol start="5"><li>比较两个版本的差异</li></ol><ul><li>以前者为基准看后者的变化</li><li>HEAD 表示最后一次 commit 对应的版本，HEAD~1 往前一个版本</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff 版本号1 版本号2</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git diff HEAD~1 HEAD</span><br><span class="line">git diff HEAD~2 HEAD</span><br></pre></td></tr></table></figure><ol start="6"><li>比较两个分支指定文件的差异</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff 分支1 分支2 fileName</span><br></pre></td></tr></table></figure><h2 id="查看日志信息-git-log"><a href="#查看日志信息-git-log" class="headerlink" title="查看日志信息 git log"></a>查看日志信息 git log</h2><ol><li>查看简要日志信息</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reflog</span><br></pre></td></tr></table></figure><ol start="2"><li>查看详细日志信息</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure><ol start="3"><li>查看极简日志信息</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --oneline</span><br></pre></td></tr></table></figure><ol start="4"><li>查看最近 n 次的版本信息</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> -n</span><br></pre></td></tr></table></figure><ol start="5"><li>查看所有分支的版本历史</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --all</span><br></pre></td></tr></table></figure><ol start="6"><li>以图形形式展示版本历史</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --graph</span><br></pre></td></tr></table></figure><ol start="7"><li>查看涉及到指定文件的 commit 记录</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> fileName</span><br></pre></td></tr></table></figure><ol start="8"><li>查看指定文件每一行修改对应的 commit 记录和作者</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git blame fileName</span><br></pre></td></tr></table></figure><h2 id="分支命令"><a href="#分支命令" class="headerlink" title="分支命令"></a>分支命令</h2><h3 id="创建分支"><a href="#创建分支" class="headerlink" title="创建分支"></a>创建分支</h3><ul><li>基于当前分支创建分支</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch 新分支</span><br></pre></td></tr></table></figure><ul><li>基于指定分支创建分支</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch 新分支 已有分支</span><br></pre></td></tr></table></figure><ul><li>基于某个 commit 创建分支</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch 新分支 commitID</span><br></pre></td></tr></table></figure><ul><li>基于当前分支创建分支并切换到新分支</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b 新分支</span><br></pre></td></tr></table></figure><ul><li>基于远程分支创建新分支</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b 新分支 别名/远程分支名</span><br><span class="line">git checkout -b test_2023 origin/test_2023</span><br></pre></td></tr></table></figure><h3 id="查看本地分支"><a href="#查看本地分支" class="headerlink" title="查看本地分支"></a>查看本地分支</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -v</span><br></pre></td></tr></table></figure><h3 id="删除分支"><a href="#删除分支" class="headerlink" title="删除分支"></a>删除分支</h3><ul><li>安全删除本地分支</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d 分支</span><br></pre></td></tr></table></figure><ul><li>强制删除本地分支</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -D 分支</span><br></pre></td></tr></table></figure><h3 id="切换分支"><a href="#切换分支" class="headerlink" title="切换分支"></a>切换分支</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout 分支名</span><br></pre></td></tr></table></figure><h2 id="合并分支"><a href="#合并分支" class="headerlink" title="合并分支"></a>合并分支</h2><h3 id="合并本地分支"><a href="#合并本地分支" class="headerlink" title="合并本地分支"></a>合并本地分支</h3><p><code>merge</code> 和 <code>rebase</code>的区别有待学习实践 :worried:</p><ol><li>将 A 分支合并到当前分支，且为 merge 创建 commit</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge A</span><br></pre></td></tr></table></figure><ol start="2"><li>将 A 分支合并到 B 分支，且为 merge 创建 commit</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge A B</span><br></pre></td></tr></table></figure><ol start="3"><li>把当前分⽀基于 B 分⽀做 rebase，以便把 B 分⽀合⼊到当前分⽀</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase B</span><br></pre></td></tr></table></figure><ol start="4"><li>把 A 分⽀基于 B 分⽀做 rebase，以便把 B 分⽀合⼊到 A 分⽀</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase B A</span><br></pre></td></tr></table></figure><h3 id="合并远程仓库分支"><a href="#合并远程仓库分支" class="headerlink" title="合并远程仓库分支"></a>合并远程仓库分支</h3><ol><li>将远程指定分支与本地当前分支合并。可用于在合并到团队公共分支之前解决冲突问题，在本地合并公共分支先解决掉冲突。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge --no-ff origin/develop_2023-03-12</span><br></pre></td></tr></table></figure><h2 id="版本穿梭与回滚"><a href="#版本穿梭与回滚" class="headerlink" title="版本穿梭与回滚"></a>版本穿梭与回滚</h2><ol><li>工作区指定文件恢复成和暂存区一样</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git checkout file1 file2 ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># tips in the Git sh</span></span><br><span class="line"><span class="comment"># use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory</span></span><br><span class="line">git restore file1 file2 ...</span><br></pre></td></tr></table></figure><ol start="2"><li>暂存区指定文件恢复成和 HEAD 一样</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git reset file1 file2 ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># tips in the Git sh</span></span><br><span class="line"><span class="comment"># use &quot;git restore --staged &lt;file&gt;...&quot; to unstage</span></span><br><span class="line">git restore --staged file1 file2 ...</span><br></pre></td></tr></table></figure><ol start="3"><li>工作区和暂存区所有文件恢复成和 HEAD 一样</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard</span><br></pre></td></tr></table></figure><ol start="4"><li>工作区和暂存区所有文件恢复成和指定版本一样</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard 版本号</span><br></pre></td></tr></table></figure><h2 id="修改-commit-记录"><a href="#修改-commit-记录" class="headerlink" title="修改 commit 记录"></a>修改 commit 记录</h2><ol><li>往最后一次 commit 追加记录，而不新建 commit - <a href="https://segmentfault.com/a/1190000038535534">reference</a></li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit --amend</span><br></pre></td></tr></table></figure><ol start="2"><li>合并 commit 记录 - <a href="https://www.jianshu.com/p/4a8f4af4e803">reference</a></li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i HEAD~2</span><br></pre></td></tr></table></figure><h2 id="远程仓库交互"><a href="#远程仓库交互" class="headerlink" title="远程仓库交互"></a>远程仓库交互</h2><h3 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h3><ol><li>查看所有远程仓库地址别名</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote -v</span><br></pre></td></tr></table></figure><ol start="2"><li>为远程仓库起别名</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add 别名 地址</span><br></pre></td></tr></table></figure><ol start="3"><li>删除远程仓库别名</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote remove 别名</span><br></pre></td></tr></table></figure><ol start="4"><li>修改别名</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote rename 旧名 新名</span><br></pre></td></tr></table></figure><h3 id="git-clone"><a href="#git-clone" class="headerlink" title="git clone"></a>git clone</h3><ol><li>克隆远程仓库到本地</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> 地址</span><br></pre></td></tr></table></figure><ol start="2"><li>克隆远程仓库指定分支到本地</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b 远程仓库分支名 地址</span><br></pre></td></tr></table></figure><h3 id="git-pull"><a href="#git-pull" class="headerlink" title="git pull"></a>git pull</h3><ol><li>拉取远程分支，并与本地分支合并</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull 别名 分支名</span><br></pre></td></tr></table></figure><h3 id="git-push"><a href="#git-push" class="headerlink" title="git push"></a>git push</h3><ol><li>推送本地指定分支到仓库指定分支</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push 别名 本地分支:远程分支</span><br></pre></td></tr></table></figure><ol start="2"><li>如果远程分支被省略，表示将本地分支推送到与之存在追踪关系的远程分支（通常两者同名），如果该远程分支不存在，则会被新建</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure><ol start="3"><li>如果省略本地分支名，等同于推送一个空的本地分支到远程分支，表示删除指定的远程分支，等同于</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git push origin :master</span><br><span class="line"><span class="comment"># 等同于</span></span><br><span class="line">git push origin --delete master</span><br></pre></td></tr></table></figure><ol start="4"><li>强制推送</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push --force origin master</span><br></pre></td></tr></table></figure><ol start="5"><li>直接使用仓库地址推送，无需起别名</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push git@github.com:&lt;USERNAME&gt;/&lt;REPO&gt;.git master:main</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Git仓库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue3</title>
      <link href="/2023/09/06/vue3/"/>
      <url>/2023/09/06/vue3/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue3"><a href="#Vue3" class="headerlink" title="Vue3 "></a>Vue3 <img src="images/onepiece.png" style="width:30px;display:inline-block;position:relative;top:2px" /></h1><p><a href="https://v3.cn.vuejs.org/">官网传送门</a></p><h2 id="Vue3-的变化"><a href="#Vue3-的变化" class="headerlink" title="Vue3 的变化"></a>Vue3 的变化</h2><p><strong><em>性能的提升</em></strong></p><ul><li>打包大小减少 41%</li><li>初次渲染快 55%, 更新渲染快 133%</li><li>内存减少 54%</li></ul><p><strong><em>源码的升级</em></strong></p><ul><li>使用 Proxy 代替 defineProperty 实现响应式</li><li>重写虚拟 DOM 的实现和 Tree-Shaking</li></ul><p><strong><em>拥抱 TypeScript</em></strong></p><ul><li>Vue3 可以更好的支持 TypeScript</li></ul><p><strong><em>新的特性</em></strong></p><ol><li>Composition API（组合 API）</li></ol><ul><li>setup 配置</li><li>ref 与 reactive</li><li>watch 与 watchEffect</li><li>provide 与 inject</li><li>……</li></ul><ol start="2"><li>新的内置组件</li></ol><ul><li>Fragment</li><li>Teleport</li><li>Suspense</li></ul><ol start="3"><li>其他改变</li></ol><ul><li>新的生命周期钩子</li><li>data 选项应始终被声明为一个函数</li><li>移除 keyCode 支持作为 v-on 的修饰符</li><li>……</li></ul><h2 id="创建-Vue3-工程"><a href="#创建-Vue3-工程" class="headerlink" title="创建 Vue3 工程"></a>创建 Vue3 工程</h2><h3 id="vite-和-vue-cli-对比"><a href="#vite-和-vue-cli-对比" class="headerlink" title="vite 和 vue-cli 对比"></a>vite 和 vue-cli 对比</h3><table><thead><tr><th></th><th>vite</th><th>vue-cli</th></tr></thead><tbody><tr><td>支持的 vue 版本</td><td>仅支持 vue3.x</td><td>支持 2.x 和 3.x</td></tr><tr><td>是否基于 webpack</td><td>否</td><td>是</td></tr><tr><td>运行速度</td><td>快</td><td>较慢</td></tr><tr><td>功能完整度</td><td>小而巧</td><td>大而全</td></tr><tr><td>是否建议企业级开发使用</td><td>暂不建议</td><td>建议</td></tr></tbody></table><h3 id="使用-vue-cli-创建"><a href="#使用-vue-cli-创建" class="headerlink" title="使用 vue-cli 创建"></a>使用 vue-cli 创建</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 查看 @vue/cli 版本，确保 @vue/cli 版本在4.5.0以上</span></span><br><span class="line">vue --version</span><br><span class="line"><span class="comment">### 安装或者升级 @vue/cli</span></span><br><span class="line">npm install -g @vue/cli</span><br><span class="line"><span class="comment">### 创建</span></span><br><span class="line">vue create vue_test</span><br><span class="line"><span class="comment">### 启动</span></span><br><span class="line"><span class="built_in">cd</span> vue_test</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure><h3 id="使用-vite-创建"><a href="#使用-vite-创建" class="headerlink" title="使用 vite 创建"></a>使用 vite 创建</h3><ul><li><a href="https://vitejs.cn/">vite</a>：新一代前端构建工具</li><li>优势：<ul><li>开发环境中，无需打包操作，可快速冷启动（webpack 每次运行项目都要打包）</li><li>轻量快速的热重载 HMR（更改代码局部刷新，webpack 也行，但 vite 更轻量）</li><li>真正的按需编译，无需等待整个应用编译完成</li></ul></li><li>传统构建 与 vite 构建对比（vite 现用现分析，按需导入，因此项目启动更快）</li></ul><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/bundle.png" alt="Bundle"></p><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/ESM.png" alt="ESM"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm init vite-app 项目名称</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> 项目名称</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h2 id="Vue3-项目结构"><a href="#Vue3-项目结构" class="headerlink" title="Vue3 项目结构"></a>Vue3 项目结构</h2><p>Vue3 中 <code>main.js</code> 代码有所改变：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不再引入 Vue 构造函数，而是引入 createApp 工厂函数</span></span><br><span class="line"><span class="comment">// createApp函数：创建 vue 的 SPA 实例</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建应用实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><p>Vue3 支持定义多个根节点，组件的 <code>&lt;template&gt;</code> 支持定义多个根节点：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>根节点<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>根节点<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="常用-Composition-API"><a href="#常用-Composition-API" class="headerlink" title="常用 Composition API"></a>常用 Composition API</h2><h3 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h3><ul><li>setup 是 Vue3 中一个新的配置项，值为函数</li><li>组件中使用的数据、方法等都要配置在 setup 中</li><li>setup 函数两种返回值：<ul><li>返回一个对象，对象中的属性、方法可在模板中直接使用</li><li>返回一个渲染函数，可自定义渲染内容</li></ul></li><li>setup 函数的参数：<ul><li>props：值为对象，包含了组件外部传进来，且组件内部声明接收的属性</li><li>context：上下文对象<ul><li><code>attrs</code>：值为对象，包含了组件外部传进来，且组件内部没有声明接收的属性，相当于 <code>this.$attrs</code></li><li><code>slots</code>：收到的插槽内容，相当于 <code>this.$slots</code></li><li><code>emit</code>：触发自定义事件的函数，相当于 <code>this.$emit</code></li></ul></li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 没错，渲染函数就叫 h</span></span><br><span class="line"><span class="keyword">import</span> &#123; h &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="attr">props</span>: [<span class="string">&#x27;title&#x27;</span>],</span><br><span class="line">  <span class="comment">// Vue3 需要声明自定义事件，虽然不声明也能运行</span></span><br><span class="line">  <span class="attr">emits</span>: [<span class="string">&#x27;changeCount&#x27;</span>],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回函数</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  setup() &#123;</span></span><br><span class="line"><span class="comment">    return () =&gt; h(&#x27;h1&#x27;, &#x27;Hello&#x27;)</span></span><br><span class="line"><span class="comment">  &#125;,</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 返回对象</span></span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props, context</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="string">&#x27;Vue3&#x27;</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">      context.<span class="title function_">emit</span>(<span class="string">&#x27;changeCount&#x27;</span>, <span class="number">888</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      name,</span><br><span class="line">      sayHello,</span><br><span class="line">      test,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>setup 在 <code>beforeCreate</code> 钩子之前执行，<code>this</code> 为 <code>undefined</code></li><li>setup 不要和 Vue2 配置混用。Vue2 的配置可以访问到 setup 的属性方法，反过来不行；如有重名，setup 优先</li><li>setup 不能是 async 函数，因为 async 函数返回的是 promise 不是对象，会导致模板无法访问属性方法</li><li>若要返回 promise 实例，需要 <code>Suspense</code> 和异步组件的配合</li></ul><h3 id="ref-函数"><a href="#ref-函数" class="headerlink" title="ref 函数"></a>ref 函数</h3><p>作用：定义响应式数据</p><p>语法：<code>const name = ref(initValue)</code></p><ul><li><code>ref</code> 函数返回一个 <code>RefImpl</code>(reference implement) 实例对象，全称引用实现的实例对象</li><li>它包含响应式数据，简称引用对象、reference 对象、ref 对象</li><li>JS 访问数据：<code>name.value</code></li><li>模板访问数据：<code>&lt;div&gt;&#123;&#123; name &#125;&#125;&lt;/div&gt;</code></li></ul><p>注意事项：</p><ul><li><code>ref</code> 函数可以接收基本数据类型和引用数据类型</li><li>基本类型数据的响应式还是靠 <code>Object.defineProperty()</code> 完成</li><li>对象类型数据使用 ES6 的 Proxy 实现响应式，Vue3 把相关操作封装在 <code>reactive</code> 函数中</li><li>按照之前的办法，对于对象数据，应该遍历每一层的属性添加 <code>getter</code> 、<code>setter</code>，但 Vue3 使用 Proxy 把内部数据一口气监测了</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123; name &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; jobInfo.type &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="title function_">ref</span>(<span class="string">&#x27;Vue3&#x27;</span>)</span><br><span class="line">    <span class="keyword">let</span> jobInfo = <span class="title function_">ref</span>(&#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;frontend&#x27;</span>,</span><br><span class="line">      <span class="attr">salary</span>: <span class="string">&#x27;40w&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">changeInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">      name.<span class="property">value</span> = <span class="string">&#x27;鱿鱼丝&#x27;</span></span><br><span class="line">      <span class="comment">// jobInfo 是 RefImpl 实例</span></span><br><span class="line">      <span class="comment">// jobInfo.value 是 Proxy 实例对象</span></span><br><span class="line">      jobInfo.<span class="property">value</span>.<span class="property">salary</span> = <span class="string">&#x27;50w&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      name,</span><br><span class="line">      jobInfo,</span><br><span class="line">      changeInfo,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="reactive-函数"><a href="#reactive-函数" class="headerlink" title="reactive 函数"></a>reactive 函数</h3><ul><li>定义引用类型的响应式数据，不可用于 jibenleixingshuju</li><li><code>const 代理对象 = reactive(源对象)</code> 接收对象或数组，返回代理对象（Proxy 的实例对象）</li><li><code>reactive</code> 的响应式是深度的</li><li>基于 ES6 的 Proxy 实现，通过代理对象操作源对象内部数据</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> person = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;Vue3&#x27;</span>,</span><br><span class="line">      <span class="attr">sex</span>: <span class="string">&#x27;unknown&#x27;</span>,</span><br><span class="line">      <span class="attr">info</span>: &#123;</span><br><span class="line">        <span class="attr">school</span>: <span class="string">&#x27;Oxford&#x27;</span>,</span><br><span class="line">        <span class="attr">major</span>: <span class="string">&#x27;computer&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> color = <span class="title function_">reactive</span>([<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">changeInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">      person.<span class="property">info</span>.<span class="property">major</span> = <span class="string">&#x27;art&#x27;</span></span><br><span class="line">      color[<span class="number">0</span>] = <span class="string">&#x27;yellow&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      person,</span><br><span class="line">      color,</span><br><span class="line">      changeInfo,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ref-VS-reactive"><a href="#ref-VS-reactive" class="headerlink" title="ref VS reactive"></a>ref VS reactive</h3><p>定义数据：</p><ul><li>ref 用于定义基本类型数据</li><li>reactive 用于定义对象或数组类型数据</li><li>ref 也可定义对象或数组类型数据，内部通过 reactive 转为代理对象</li><li>一般使用 reactive 函数，可以把所有数据封装为一个对象</li></ul><p>原理：</p><ul><li>ref 通过 <code>Object.defineProperty()</code> 实现响应式</li><li>reactive 通过 Proxy 实现响应式，Reflect 操作源对象数据</li></ul><p>使用角度：</p><ul><li>ref 定义数据，访问数据需要 <code>.value</code>，模板中不需要</li><li>reactive 定义的数据，都不需要</li></ul><h3 id="Vue3-响应式原理"><a href="#Vue3-响应式原理" class="headerlink" title="Vue3 响应式原理"></a>Vue3 响应式原理</h3><ul><li>通过 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy">Proxy</a> 代理，拦截对对象属性的操作，包括增删改查</li><li>通过 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect">Reflect</a> 反射，对源对象的属性进行操作</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> originPerson = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Lily&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">22</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">Proxy</span>(originPerson, &#123;</span><br><span class="line">  <span class="comment">// 拦截增加和查询操作</span></span><br><span class="line">  <span class="title function_">get</span>(<span class="params">target, prop</span>) &#123;</span><br><span class="line">    <span class="comment">// 读取源对象的属性</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">get</span>(originPerson, prop)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 拦截修改操作</span></span><br><span class="line">  <span class="title function_">set</span>(<span class="params">target, prop, value</span>) &#123;</span><br><span class="line">    <span class="comment">// 修改源对象的属性</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">set</span>(target, prop, value)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 拦截删除操作</span></span><br><span class="line">  <span class="title function_">deleteProperty</span>(<span class="params">target, prop</span>) &#123;</span><br><span class="line">    <span class="comment">// 删除源对象的属性</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">deleteProperty</span>(target, prop)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>)</span><br><span class="line">person.<span class="property">age</span> = <span class="number">33</span></span><br><span class="line">person.<span class="property">sex</span> = <span class="string">&#x27;unknown&#x27;</span></span><br><span class="line"><span class="keyword">delete</span> person.<span class="property">age</span></span><br></pre></td></tr></table></figure><h3 id="computed-函数"><a href="#computed-函数" class="headerlink" title="computed 函数"></a>computed 函数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> person = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">      <span class="attr">firstName</span>: <span class="string">&#x27;Cai&#x27;</span>,</span><br><span class="line">      <span class="attr">lastName</span>: <span class="string">&#x27;QP&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算属性简写形式</span></span><br><span class="line">    person.<span class="property">fullName</span> = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> person.<span class="property">firstName</span> + <span class="string">&#x27;-&#x27;</span> + person.<span class="property">lastName</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算属性完整形式</span></span><br><span class="line">    person.<span class="property">fullName</span> = <span class="title function_">computed</span>(&#123;</span><br><span class="line">      <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> person.<span class="property">firstName</span> + <span class="string">&#x27;-&#x27;</span> + person.<span class="property">lastName</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">set</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> arr = value.<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        person.<span class="property">firstName</span> = arr[<span class="number">0</span>]</span><br><span class="line">        person.<span class="property">lastName</span> = arr[<span class="number">1</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      person,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="watch-函数"><a href="#watch-函数" class="headerlink" title="watch 函数"></a>watch 函数</h3><p>:::tip Vue3 <code>watch</code> 能侦听的东西<br>A watch source can only be a getter&#x2F;effect function, a ref, a reactive object, or an array of these types<br>:::</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, reactive, watch &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据</span></span><br><span class="line"><span class="keyword">let</span> sum = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">let</span> msg = <span class="title function_">ref</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> person = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Vue3&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">info</span>: &#123;</span><br><span class="line">    <span class="attr">job</span>: &#123;</span><br><span class="line">      <span class="attr">salary</span>: <span class="number">40</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong><em>侦听 ref 定义的响应式数据：</em></strong></p><ul><li>注意不要写成 <code>sum.value</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 参数：侦听的数据，回调，其他配置</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  sum,</span><br><span class="line">  <span class="function">(<span class="params">newVal, oldVal</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(newVal, oldVal)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">immediate</span>: <span class="literal">true</span> &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong><em>侦听多个 ref 定义的响应式数据：</em></strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// newVal，oldVal 也是数组</span></span><br><span class="line"><span class="title function_">watch</span>([sum, msg], <span class="function">(<span class="params">newVal, oldVal</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(newVal, oldVal)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong><em>侦听 ref 定义的对象类型数据：</em></strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用 ref 定义对象类型数据</span></span><br><span class="line"><span class="keyword">let</span> person = <span class="title function_">ref</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Vue3&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">info</span>: &#123;</span><br><span class="line">    <span class="attr">job</span>: &#123;</span><br><span class="line">      <span class="attr">salary</span>: <span class="number">40</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启深度监听才有效，此时监听的是 RefImpl 实例</span></span><br><span class="line"><span class="comment">// Ref 实例的 value 是 Proxy 对象，存的是地址</span></span><br><span class="line"><span class="comment">// 因此无法监听 person 内部属性的变化</span></span><br><span class="line"><span class="title function_">watch</span>(person, <span class="function">(<span class="params">newVal, oldVal</span>) =&gt;</span> &#123; ... &#125;, &#123; <span class="attr">deep</span>:<span class="literal">true</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个和 “侦听 reactive 函数直接返回的那一整坨响应式数据” 效果一致</span></span><br><span class="line"><span class="title function_">watch</span>(person.<span class="property">value</span>, <span class="function">(<span class="params">newVal, oldVal</span>) =&gt;</span> &#123;...&#125;)</span><br></pre></td></tr></table></figure><p><strong><em>侦听 reactive 函数直接返回的那一整坨响应式数据：</em></strong></p><ul><li>oldVal 是错误的！和 newVal 的值一样</li><li>强制开启了深度侦听，<code>deep</code> 配置不生效！</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  person,</span><br><span class="line">  <span class="function">(<span class="params">newVal, oldVal</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(newVal, oldVal)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">immediate</span>: <span class="literal">true</span>, <span class="attr">deep</span>: <span class="literal">false</span> &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong><em>侦听 reactive 定义的响应式数据某个属性：</em></strong></p><ul><li>如果是 <code>() =&gt; person.info</code> oldVal 也是错误的！</li><li><code>() =&gt; person.name</code> oldVal 是正确的，何时对何时错自己琢磨吧！</li><li>此处没有强制开启深度监听</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果监视的属性还是对象，则需要开启深度监听</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> person.<span class="property">info</span>,</span><br><span class="line">  <span class="function">(<span class="params">newVal, oldVal</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(newVal, oldVal)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong><em>侦听 reactive 定义的响应式数据多个属性：</em></strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  [<span class="function">() =&gt;</span> person.<span class="property">name</span>, <span class="function">() =&gt;</span> person.<span class="property">info</span>],</span><br><span class="line">  <span class="function">(<span class="params">newVal, oldVal</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(newVal, oldVal)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="watchEffect-函数"><a href="#watchEffect-函数" class="headerlink" title="watchEffect 函数"></a>watchEffect 函数</h3><ul><li><code>watchEffect</code> 不需要指明监听哪个属性，回调里用到哪个属性，就自动监听哪个属性</li><li><code>computed</code> 注重计算的值，即回调函数的返回值，因此必须有返回值</li><li><code>watchEffect</code> 更注重过程，即回调函数的函数体，因此可没有返回值</li><li><code>watchEffect</code> 没有开启深度监听，也不能开启深度监听！</li><li><code>watchEffect</code> 内部自行修改数据，不会重新调用回调，因此不会出现递归调用</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 回调中用到的数据只要发生变化，则直接重新执行回调</span></span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> total = sum.<span class="property">value</span></span><br><span class="line">  <span class="keyword">let</span> p = person</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;watchEffect...&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p>注意和 <code>vue2.x</code> 的生命周期图作对比，<code>beforeDestroy</code> 和 <code>destroyed</code> 变为 <code>beforeUnmount</code> 和 <code>unmounted</code> 。</p><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/lifecycle.svg" alt="vu3-lifecycle"></p><p>Vue3 也提供了 Composition API 形式的生命周期钩子，与 Vue2 中钩子对应关系如下：</p><ul><li><code>beforeCreate</code>&#x3D;&#x3D;&#x3D;&gt;<code>setup()</code></li><li><code>created</code>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>setup()</code></li><li><code>beforeMount</code> &#x3D;&#x3D;&#x3D;&gt;<code>onBeforeMount</code></li><li><code>mounted</code>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onMounted</code></li><li><code>beforeUpdate</code>&#x3D;&#x3D;&#x3D;&gt;<code>onBeforeUpdate</code></li><li><code>updated</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onUpdated</code></li><li><code>beforeUnmount</code> &#x3D;&#x3D;&gt;<code>onBeforeUnmount</code></li><li><code>unmounted</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onUnmounted</code></li></ul><p>若和配置项生命钩子一起使用，则组合式会比配置项的先执行，如 <code>onBeforeMount</code> 先于 <code>beforeMount</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---setup---&#x27;</span>)</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//通过组合式API的形式去使用生命周期钩子</span></span><br><span class="line">  <span class="title function_">onBeforeMount</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---onBeforeMount---&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---onMounted---&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="title function_">onBeforeUpdate</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---onBeforeUpdate---&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="title function_">onUpdated</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---onUpdated---&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="title function_">onBeforeUnmount</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---onBeforeUnmount---&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="title function_">onUnmounted</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---onUnmounted---&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;sum&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="hook-函数"><a href="#hook-函数" class="headerlink" title="hook 函数"></a>hook 函数</h3><ul><li>hook 是一个函数，把 setup 函数的 Composition API 进行了封装</li><li>类似 Vue2 的 Mixin，能复用代码，让 setup 里的逻辑更清晰</li><li>hook 放在 hooks 文件夹中，一个文件对应一个功能模块，以 <code>useXxx</code> 命名</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hooks/usePoint.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; reactive, onMounted, onBeforeUnmount &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">//实现鼠标“打点”相关的数据</span></span><br><span class="line">  <span class="keyword">let</span> point = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//实现鼠标“打点”相关的方法</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">savePoint</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    point.<span class="property">x</span> = event.<span class="property">pageX</span></span><br><span class="line">    point.<span class="property">y</span> = event.<span class="property">pageY</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//实现鼠标“打点”相关的生命周期钩子</span></span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, savePoint)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onBeforeUnmount</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, savePoint)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> point</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 hook</span></span><br><span class="line"><span class="keyword">import</span> usePoint <span class="keyword">from</span> <span class="string">&#x27;../hooks/usePoint.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> point = <span class="title function_">usePoint</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; point &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="toRef-函数"><a href="#toRef-函数" class="headerlink" title="toRef 函数"></a>toRef 函数</h3><ul><li>创建一个 RefImpl 实例对象，其 value 值指向另一个对象的某个属性，修改 value 值会修改源对象对应的属性</li><li>应用：需要把响应式对象的某个属性单独提供给外部使用</li><li>批量创建：<code>toRefs</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;reactive, toRef, toRefs&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> person = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Vue3&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">info</span>: &#123;</span><br><span class="line">      <span class="attr">job</span>: &#123;</span><br><span class="line">        <span class="attr">salary</span>: <span class="number">40</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 注意不能写成 ref(person.name)，这和源对象是割裂开的</span></span><br><span class="line">    <span class="attr">name</span>: <span class="title function_">toRef</span>(person, <span class="string">&#x27;name&#x27;</span>),</span><br><span class="line">    <span class="attr">salary</span>: <span class="title function_">toRef</span>(person.<span class="property">info</span>.<span class="property">job</span>, <span class="string">&#x27;salary&#x27;</span>)</span><br><span class="line">    <span class="comment">// or</span></span><br><span class="line">    ...<span class="title function_">toRefs</span>(person)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="其它-Composition-API"><a href="#其它-Composition-API" class="headerlink" title="其它 Composition API"></a>其它 Composition API</h2><h3 id="shallowReactive-shallowRef"><a href="#shallowReactive-shallowRef" class="headerlink" title="shallowReactive &amp; shallowRef"></a>shallowReactive &amp; shallowRef</h3><ul><li><code>shallowReactive</code>：只处理对象最外层属性的响应式，即浅响应式</li><li><code>shallowRef</code>：基本数据类型和 <code>ref</code> 相同，对象数据不再会调用 <code>reactive</code>，因此只有对象引用改变了才是响应式的</li><li>若一个对象数据，结构很深，但只有最外层属性变化，可用 <code>shallowReactive</code></li><li>若一个对象数据，属性不会改变，而是使用新对象替换，可用 <code>shallowRef</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowReactive, shallowRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> person = <span class="title function_">shallowReactive</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Vue3&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">21</span>,</span><br><span class="line">    <span class="attr">info</span>: &#123;</span><br><span class="line">      <span class="attr">job</span>: &#123;</span><br><span class="line">        <span class="attr">salary</span>: <span class="number">22</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">let</span> x = <span class="title function_">shallowRef</span>(&#123;</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    person,</span><br><span class="line">    x</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="readonly-shallowReadonly"><a href="#readonly-shallowReadonly" class="headerlink" title="readonly &amp; shallowReadonly"></a>readonly &amp; shallowReadonly</h3><ul><li><code>readonly</code>: 让一个响应式数据变为只读的（深只读）</li><li><code>shallowReadonly</code>：让一个响应式数据变为只读的（浅只读）</li><li>应用场景: 不希望数据被修改时，如你用了别人的响应式数据，但是别人不希望你修改时</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">let</span> person = <span class="title function_">reactive</span>(&#123;...&#125;)</span><br><span class="line"></span><br><span class="line">  sum = <span class="title function_">readonly</span>(sum)</span><br><span class="line">  person = <span class="title function_">shallowReadonly</span>(person)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    sum,</span><br><span class="line">    person</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="toRaw-markRaw"><a href="#toRaw-markRaw" class="headerlink" title="toRaw &amp; markRaw"></a>toRaw &amp; markRaw</h3><p><code>toRaw</code>：</p><ul><li>将一个由 <code>reactive</code> 生成的响应式对象转为普通对象</li><li>用于读取响应式对象对应的普通对象，对该普通对象的操作不会引起页面更新</li></ul><p><code>markRaw</code>：</p><ul><li>标记一个对象，让其不成为响应式对象</li><li>有些值不应设置为响应式，比如复杂的第三方库</li><li>当渲染复杂且不变的数据时，跳过响应式转换可提高性能</li></ul><p>注意：仅仅让数据变为非响应式的，数据变的依旧变，只是没引起页面更新</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">showRawPerson</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> p = <span class="title function_">toRaw</span>(person);</span><br><span class="line">    p.<span class="property">age</span>++;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(p);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(person);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">addCar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> car = &#123; <span class="attr">name</span>: <span class="string">&quot;奔驰&quot;</span>, <span class="attr">price</span>: <span class="number">40</span> &#125;;</span><br><span class="line">    person.<span class="property">car</span> = <span class="title function_">markRaw</span>(car);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="customRef"><a href="#customRef" class="headerlink" title="customRef"></a>customRef</h3><p>创建一个自定义的 ref，并对其依赖项跟踪和更新触发进行显式控制</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;keyword&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123; keyword &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, customRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Demo&#x27;</span>,</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 自定义 myRef</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">myRef</span>(<span class="params">value, delay</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> timer</span><br><span class="line">      <span class="comment">// 通过customRef去实现自定义</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">customRef</span>(<span class="function">(<span class="params">track, trigger</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">//告诉Vue这个value值是需要被“追踪”的</span></span><br><span class="line">            <span class="title function_">track</span>()</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="title function_">set</span>(<span class="params">newValue</span>) &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              value = newValue</span><br><span class="line">              <span class="comment">// 告诉Vue去更新界面</span></span><br><span class="line">              <span class="title function_">trigger</span>()</span><br><span class="line">            &#125;, delay)</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> keyword = <span class="title function_">myRef</span>(<span class="string">&#x27;hello&#x27;</span>, <span class="number">500</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      keyword,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="provide-inject"><a href="#provide-inject" class="headerlink" title="provide &#x2F; inject"></a>provide &#x2F; inject</h3><p>实现祖先组件与后代组件之间通信。</p><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/provide-inject.png" alt="provide-inject"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 祖先组件传递数据</span></span><br><span class="line"><span class="keyword">import</span> &#123; provide, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> car = <span class="title function_">reactive</span>(&#123;...&#125;)</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">provide</span>(<span class="string">&#x27;sum&#x27;</span>, sum)</span><br><span class="line">  <span class="title function_">provide</span>(<span class="string">&#x27;car&#x27;</span>, car)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 后代组件接收数据</span></span><br><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> car = <span class="title function_">inject</span>(<span class="string">&#x27;car&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> sum = <span class="title function_">inject</span>(<span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> &#123; car, sum &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="响应式数据的判断"><a href="#响应式数据的判断" class="headerlink" title="响应式数据的判断"></a>响应式数据的判断</h3><ul><li><code>isRef</code>: 检查一个值是否为一个 <code>ref</code> 对象</li><li><code>isReactive</code>: 检查一个对象是否是由 <code>reactive</code> 创建的响应式代理</li><li><code>isReadonly</code>: 检查一个对象是否是由 <code>readonly</code> 创建的只读代理</li><li><code>isProxy</code>: 检查一个对象是否是由 <code>reactive</code> 或者 <code>readonly</code> 方法创建的代理</li></ul><h2 id="Compositon-API-的优势"><a href="#Compositon-API-的优势" class="headerlink" title="Compositon API 的优势"></a>Compositon API 的优势</h2><p><strong><em>Options API 存在的问题</em></strong></p><p>使用传统 Options API 中，新增或者修改一个需求，就需要分别在 data，methods，computed 等地方修改。</p><div style="display:flex;">    <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f84e4e2c02424d9a99862ade0a2e4114~tplv-k3u1fbpfcp-watermark.image" style="zoom:45%;" />    &nbsp;    <img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ac7e20d1784887a826f6360768a368~tplv-k3u1fbpfcp-watermark.image" style="zoom:50%;" /></div><p><strong><em>Composition API 的优势</em></strong></p><p>可以更加优雅地组织代码、函数，让相关功能的代码更加有序的组织在一起。说白了就是让同一个功能的代码整合到一起，日后修改代码直接找对应的功能模块。</p><div style="display:flex;margin-left: -30px">    <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc0be8211fc54b6c941c036791ba4efe~tplv-k3u1fbpfcp-watermark.image" style="zoom:50%;" />    &nbsp;    <img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cc55165c0e34069a75fe36f8712eb80~tplv-k3u1fbpfcp-watermark.image" style="zoom:50%;" /></div><h2 id="新的组件"><a href="#新的组件" class="headerlink" title="新的组件"></a>新的组件</h2><h3 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h3><ul><li>在 Vue2 中: 组件必须有一个根标签</li><li>在 Vue3 中: 组件可以没有根标签, 内部会将多个标签包含在一个 <code>Fragment</code> 虚拟元素中</li><li>好处: 减少标签层级, 减小内存占用</li></ul><h3 id="Teleport"><a href="#Teleport" class="headerlink" title="Teleport"></a>Teleport</h3><ul><li>将包裹的 HTML 结构移动到指定元素的末尾</li><li><code>to</code> 属性为 CSS 选择器</li></ul><p>简易的模态框效果：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;#root&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;isShow&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mask&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;dialog&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我是一个弹窗<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;isShow = false&quot;</span>&gt;</span>关闭弹窗<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">teleport</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.mask</span> &#123;</span><br><span class="line">  <span class="comment">/* 遮罩层铺满窗口 */</span></span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.dialog</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Suspense"><a href="#Suspense" class="headerlink" title="Suspense"></a>Suspense</h3><p>等待异步组件时渲染额外内容，让用户体验更好</p><p>异步引入组件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineAsyncComponent &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Child</span> = <span class="title function_">defineAsyncComponent</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./components/Child.vue&#x27;</span>))</span><br></pre></td></tr></table></figure><p>使用 <code>Suspense</code> 包裹组件，实际上是往插槽填充内容，<code>default</code> 插槽填充组件内容，<code>fallback</code> 插槽填充组件加载时显示的内容：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Suspense</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:default</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Child</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:fallback</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>加载中，请稍等...<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span><br></pre></td></tr></table></figure><p>另外，若 <code>Child</code> 组件的 <code>setup</code> 函数返回一个 Promise 对象，也能渲染 <code>fallback</code> 里的内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> sum = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(&#123;sum&#125;)</span><br><span class="line">    &#125;, <span class="number">3000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="其他改变"><a href="#其他改变" class="headerlink" title="其他改变"></a>其他改变</h2><ul><li>全局 API 的转移</li></ul><p>Vue3 将全局的 API，即：<code>Vue.xxx</code> 调整到应用实例 <code>app</code> 上：</p><table><thead><tr><th>Vue2 全局 API</th><th>Vue3 实例 API</th></tr></thead><tbody><tr><td>Vue.config.xxx</td><td>app.config.xxx</td></tr><tr><td>Vue.config.productionTip</td><td>移除</td></tr><tr><td>Vue.component</td><td>app.component</td></tr><tr><td>Vue.directive</td><td>app.directive</td></tr><tr><td>Vue.mixin</td><td>app.mixin</td></tr><tr><td>Vue.use</td><td>app.use</td></tr><tr><td>Vue.prototype</td><td>app.config.globalProperties</td></tr></tbody></table><ul><li><p><code>data</code> 选项应始终被声明为一个函数</p></li><li><p>过渡类名的更改：</p></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Vue2 */</span></span><br><span class="line"><span class="selector-class">.v-enter</span>,</span><br><span class="line"><span class="selector-class">.v-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.v-leave</span>,</span><br><span class="line"><span class="selector-class">.v-enter-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Vue3 */</span></span><br><span class="line"><span class="selector-class">.v-enter-from</span>,</span><br><span class="line"><span class="selector-class">.v-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.v-leave-from</span>,</span><br><span class="line"><span class="selector-class">.v-enter-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>移除 <code>keyCode</code> 作为 <code>v-on</code> 的修饰符，同时也不再支持 <code>config.keyCodes</code></li><li>移除 <code>v-on.native</code>修饰符，子组件没有在 <code>emits: [&#39;close&#39;]</code> 声明的自定义事件作为原生事件处理</li><li>移除过滤器 <code>filter</code></li><li>…</li></ul><h2 id="组件上的-v-model"><a href="#组件上的-v-model" class="headerlink" title="组件上的 v-model"></a>组件上的 v-model</h2><p>当需要维护组件内外数据的同步时，可以在组件上使用 <code>v-model</code> 指令。</p><p>父组件传值：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件传值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">my-counter</span> <span class="attr">v-model:number</span>=<span class="string">&quot;count&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-counter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>子组件在 <code>emits</code> 节点声明自定义事件，格式为 <code>update:xxx</code> ，调用 <code>$emit</code> 触发自定义事件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: [<span class="string">&#x27;number&#x27;</span>],</span><br><span class="line">  <span class="attr">emits</span>: [<span class="string">&#x27;update:number&#x27;</span>],</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">add</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;update:number&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>++)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意，在 <code>vue3</code> 中 <code>props</code> 属性同样是只读的，上面 <code>this.number++</code> 并没有修改 <code>number</code> 的值。</p><p>其实通过 <code>v-bind</code> 传值和监听自定义事件的方式能实现和 <code>v-model</code> 相同的效果。</p><h2 id="EventBus"><a href="#EventBus" class="headerlink" title="EventBus"></a>EventBus</h2><p>借助于第三方的包 <code>mitt</code> 来创建 <code>eventBus</code> 对象，从而实现兄弟组件之间的数据共享。</p><p>安装 <code>mitt</code> 依赖包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mitt@2.1.0</span><br></pre></td></tr></table></figure><p>创建公共的 <code>eventBus</code> 模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&#x27;mitt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 EventBus 实例对象</span></span><br><span class="line"><span class="keyword">const</span> bus = <span class="title function_">mitt</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> bus</span><br></pre></td></tr></table></figure><p>数据接收方调用 <code>bus.on()</code> 监听自定义事件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bus <span class="keyword">from</span> <span class="string">&#x27;./eventBus.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    bus.<span class="title function_">on</span>(<span class="string">&#x27;countChange&#x27;</span>, <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span> = count</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>数据接发送方调用 <code>bus.emit()</code> 触发事件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bus <span class="keyword">from</span> <span class="string">&#x27;./eventBus.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">cout</span>: <span class="number">0</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">addCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">      bus.<span class="title function_">emit</span>(<span class="string">&#x27;countChange&#x27;</span>, <span class="variable language_">this</span>.<span class="property">count</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="vue-3-x-全局配置-axios"><a href="#vue-3-x-全局配置-axios" class="headerlink" title="vue 3.x 全局配置 axios"></a>vue 3.x 全局配置 axios</h2><p>实际项目开发中，几乎每个组件中都会使用 <code>axios</code> 发起数据请求。此时会遇到如下两个问题：</p><ul><li>每个组件中都需要导入 <code>axios</code>（代码臃肿）</li><li>每次发请求都需要填写完整的请求路径（不利于后期的维护）</li></ul><p>在 <code>main.js</code> 文件中进行配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置请求根路径</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;http://api.com&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将 axios 挂载为 app 全局自定义属性</span></span><br><span class="line"><span class="comment">// 每个组件可通过 this.$http 访问到 axios</span></span><br><span class="line">app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$http</span> = axios</span><br></pre></td></tr></table></figure><p>组件调用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue Router</title>
      <link href="/2023/09/06/vue_router/"/>
      <url>/2023/09/06/vue_router/</url>
      
        <content type="html"><![CDATA[<p><a href="https://router.vuejs.org/zh/">官网传送门</a></p><h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><h3 id="何为路由"><a href="#何为路由" class="headerlink" title="何为路由"></a>何为路由</h3><ul><li>一组路由即一组映射关系（key-value）</li><li>key 为路径，value 可能是 function 或 component</li></ul><h3 id="前端路由"><a href="#前端路由" class="headerlink" title="前端路由"></a>前端路由</h3><p>前端路由即地址和组件之间的对应关系（以下已哈希模式为例）。</p><p>前端路由简易工作方式：</p><ol><li>用户点击了页面上的路由链接</li><li>URL 地址的 Hash 值发生变化</li><li>前端路由监听到 Hash 值的变化</li><li>前端路由渲染 Hash 地址对应的组件</li></ol><p>实现简易的前端路由：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- a 链接添加对应 Hash 值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/home&quot;</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/movie&quot;</span>&gt;</span>Movie<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/about&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 动态渲染组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;compName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">compName</span>: <span class="string">&#x27;Home&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 监听 Hash 地址改变，切换组件</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">onhashchange</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">switch</span>(location.<span class="property">hash</span>) &#123;</span><br><span class="line">        <span class="attr">case</span>: <span class="string">&#x27;#/home&#x27;</span>:</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">compName</span> = <span class="string">&#x27;Home&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="attr">case</span>: <span class="string">&#x27;#/movie&#x27;</span>:</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">compName</span> = <span class="string">&#x27;Movie&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="attr">case</span>: <span class="string">&#x27;#/about&#x27;</span>:</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">compName</span> = <span class="string">&#x27;About&#x27;</span></span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="后端路由"><a href="#后端路由" class="headerlink" title="后端路由"></a>后端路由</h3><ul><li>后端路由是指请求方式、请求地址与 <code>function</code> 处理函数之间的对应关系</li><li>服务器收到一个请求，根据请求方式、路径匹配对应的函数处理请求，返回响应数据</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/userlist&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;...&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h2 id="单页面应用程序-SPA"><a href="#单页面应用程序-SPA" class="headerlink" title="单页面应用程序 SPA"></a>单页面应用程序 SPA</h2><p>单页面应用程序将所有的功能局限于一个 web 页面中，仅在该 web 页面初始化时加载相应的资源（ HTML、JavaScript 和 CSS）。<br>一旦页面加载完成了，SPA 不会因为用户的操作而进行页面的重新加载或跳转。而是利用 JavaScript 动态地变换 HTML 的内容，从而实现页面与用户的交互。</p><p>SPA 的优点：</p><ul><li>良好的交互体验<ul><li>内容的改变不需要重新加载整个页面</li><li>数据通过 <code>Ajax</code> 异步获取</li><li>没有页面跳转，不会出现白屏现象</li></ul></li><li>良好的前后盾工作分离模式<ul><li>后端专注于提供 API 接口，更易实现接口复用</li><li>前端专注页面渲染，更利于前端工程化发展</li></ul></li><li>减轻服务器压力<ul><li>服务器只提供数据，不负责页面的合成与逻辑处理，吞吐能力会提高</li></ul></li></ul><p>SPA 的缺点：</p><ul><li>首屏加载慢：可使用路由懒加载、代码压缩、CDN 加速、网络传输压缩</li><li>不利于 SEO ：SSR 服务器端渲染</li></ul><h2 id="vue-router-初体验"><a href="#vue-router-初体验" class="headerlink" title="vue-router 初体验"></a>vue-router 初体验</h2><p>安装 <code>vue-router</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router@3.5.2 -S</span><br></pre></td></tr></table></figure><p>创建路由模块，在 <code>src</code> 源代码目录下，新建 <code>router/index.js</code> 路由模块，初始化代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueRouter</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/component/Home.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&#x27;@/component/About.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Movie</span> <span class="keyword">from</span> <span class="string">&#x27;@/component/Movie.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 把 VueRouter 安装为 Vue 的插件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">VueRouter</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 路由匹配规则</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Home</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/about&#x27;</span>, <span class="attr">component</span>: <span class="title class_">About</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/movie&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Movie</span> &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建路由实例对象</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">  routes,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><p>在 <code>main.js</code> 文件中导入并挂载路由模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router/index.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  router,</span><br><span class="line">  <span class="attr">render</span>: <span class="function">(<span class="params">h</span>) =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><p>在组件中声明路由链接和占位符：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;app-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 路由链接 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>关于<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/movie&quot;</span>&gt;</span>电影<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 路由出口 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意事项：</p><ul><li>组件分为路由组件和一般组件，前者放在 <code>pages(或views)</code> 文件夹，后者放在 <code>components</code> 文件夹</li><li>每个组件都有 <code>$route</code> 属性，存储着组件的路由规则信息</li><li><code>$router</code> 是路由器对象，整个 SPA 只有一个</li></ul><h2 id="声明式导航"><a href="#声明式导航" class="headerlink" title="声明式导航"></a>声明式导航</h2><p><code>&lt;router-link&gt;</code> 4 个常用属性：</p><ol><li><code>to</code> 属性</li></ol><ul><li>用于指定跳转路由</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li><code>tag</code> 属性</li></ol><ul><li>指明 <code>&lt;router-link&gt;</code> 最终被渲染为何种标签，默认是 a 标签</li><li>渲染为其他标签也会监听点击，触发导航</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">tag</span>=<span class="string">&quot;li&quot;</span>&gt;</span>tag<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>tag<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li><code>replace</code> 属性</li></ol><ul><li>路由跳转不会增加新的历史记录，而是替换当前历史记录</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">replace</span>&gt;</span>About<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li><code>active-class</code> 属性</li></ol><ul><li>指明路由被激活时添加的类名，默认为 <code>router-link-active</code></li><li>详见<a href="#%E8%B7%AF%E7%94%B1%E9%AB%98%E4%BA%AE">路由高亮</a></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">active-class</span>=<span class="string">&quot;active&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="路由高亮"><a href="#路由高亮" class="headerlink" title="路由高亮"></a>路由高亮</h2><p>被激活的路由链接，默认会添加 <code>router-link-active</code> 的类名。可据此为激活的路由链接设置高亮的样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.router-link-active</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>定义路由模块时可以自定义路由链接被激活时添加的类名：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">  <span class="comment">// 默认的 router-link-active 会被覆盖</span></span><br><span class="line">  <span class="attr">linkActiveClass</span>: <span class="string">&#x27;active-hello&#x27;</span>,</span><br><span class="line">  routes,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>声明路由链接时也可用 <code>active-class</code> 属性自定义激活类名：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- router-link-active 会被覆盖为 active --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">active-class</span>=<span class="string">&quot;active&quot;</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="路由重定向"><a href="#路由重定向" class="headerlink" title="路由重定向"></a>路由重定向</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// 访问 / 跳转到 /home</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>, <span class="attr">redirect</span>: <span class="string">&#x27;/home&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>, <span class="attr">component</span>: <span class="string">&#x27;Home&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/about&#x27;</span>, <span class="attr">component</span>: <span class="string">&#x27;About&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/movie&#x27;</span>, <span class="attr">component</span>: <span class="string">&#x27;Movie&#x27;</span> &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">  routes,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><h2 id="嵌套路由"><a href="#嵌套路由" class="headerlink" title="嵌套路由"></a>嵌套路由</h2><p><code>About</code> 组件中声明子路由链接和子路由占位符：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;about-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 要把父路由寫上 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about/tab1&quot;</span>&gt;</span>tab1<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about/tab2&quot;</span>&gt;</span>tab2<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>通过 <code>children</code> 属性声明子路由规则：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      <span class="comment">// 注意不要写成 /tab1</span></span><br><span class="line">      &#123; <span class="attr">path</span>: <span class="string">&#x27;tab1&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Tab1</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">path</span>: <span class="string">&#x27;tab2&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Tab2</span> &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="编程式导航"><a href="#编程式导航" class="headerlink" title="编程式导航"></a>编程式导航</h2><p>声明式导航：</p><ul><li>通过点击链接实现导航</li><li>如普通网页点击 <code>a</code> 链接，<code>vue</code> 点击 <code>&lt;router-link&gt;</code></li></ul><p>编程式导航：</p><ul><li>通过调用 API 实现导航</li><li>普通网页通过 <code>location.href</code> 的方式跳转页面也是编程式导航</li></ul><p><code>vue-router</code> 中实现编程式导航的 API ：</p><ul><li><code>this.$router.push(&#39;hash地址&#39;)</code> ：跳转到指定页面，并增加一条历史记录</li><li><code>this.$router.replace(&#39;hash地址&#39;)</code> ：跳转页面，但不会新增历史记录，而是替换当前的历史记录</li><li><code>this.$router.go(数值)</code> ：历史记录前进或后退，相当于点击浏览器前进后退箭头</li><li><code>this.$router.forward()</code> ：前进一步</li><li><code>this.$router.back()</code> ：后退一步</li></ul><h2 id="命名路由"><a href="#命名路由" class="headerlink" title="命名路由"></a>命名路由</h2><p>给路由命名，某些情况可简化路由跳转写法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;about&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">About</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;&#123; name: &#x27;about&#x27;&#125; &quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;&#123; name: &#x27;about&#x27;, query: &#123; id: 1, title: &#x27;hello&#x27; &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h2><h3 id="query-参数"><a href="#query-参数" class="headerlink" title="query 参数"></a>query 参数</h3><p>传递参数：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 字符串写法 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;`/home/detail?id=$&#123;id&#125;&amp;title=$&#123;title&#125;`&quot;</span>&gt;</span>字符串写法<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 对象写法 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:to</span>=<span class="string">&quot;&#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">    path: &#x27;/home/detail&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">    query: &#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">      id: 1,</span></span></span><br><span class="line"><span class="string"><span class="tag">      title: &#x27;hello&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">    &#125;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  对象写法</span><br><span class="line"><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">`/home/detail?id=<span class="subst">$&#123;id&#125;</span>&amp;title=<span class="subst">$&#123;title&#125;</span>`</span>)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/home/detail&#x27;</span>, <span class="attr">query</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">title</span>: <span class="string">&#x27;query&#x27;</span> &#125; &#125;)</span><br></pre></td></tr></table></figure><p>接收参数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$route</span>.<span class="property">query</span>.<span class="property">id</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$route</span>.<span class="property">query</span>.<span class="property">title</span></span><br></pre></td></tr></table></figure><h3 id="params-参数（动态路由）"><a href="#params-参数（动态路由）" class="headerlink" title="params 参数（动态路由）"></a>params 参数（动态路由）</h3><p>动态路由是把 Hash 地址中可变的部分定义为参数项，从而提高路由规则的复用性。</p><p>声明 params 参数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义动态路由参数</span></span><br><span class="line">&#123; <span class="attr">path</span>: <span class="string">&#x27;/movie/:id/:age&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Movie</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下类似的路由规则都能合并为上述规则，复用性得到提高</span></span><br><span class="line">&#123; <span class="attr">path</span>: <span class="string">&#x27;/movie/1/21&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Movie</span> &#125;</span><br><span class="line">&#123; <span class="attr">path</span>: <span class="string">&#x27;/movie/2/22&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Movie</span> &#125;</span><br><span class="line">&#123; <span class="attr">path</span>: <span class="string">&#x27;/movie/3/23&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Movie</span> &#125;</span><br></pre></td></tr></table></figure><p>传递 params 参数：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;/movie/1/21&quot;</span>&gt;</span>字符串写法<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 对象写法只能和 name 搭配使用，不能和 path 搭配 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:to</span>=<span class="string">&quot;&#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">  name: &#x27;movie&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">  params: &#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">    id: 1,</span></span></span><br><span class="line"><span class="string"><span class="tag">    age: 21</span></span></span><br><span class="line"><span class="string"><span class="tag">  &#125;</span></span></span><br><span class="line"><span class="string"><span class="tag">&#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  对象写法</span><br><span class="line"><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- query 和 params 可以一起用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;`/movie/1/21?id=$&#123;id&#125;`&quot;</span>&gt;</span>字符串写法<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:to</span>=<span class="string">&quot;&#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">    name:&#x27;movie&#x27;, </span></span></span><br><span class="line"><span class="string"><span class="tag">    params: &#123;id:1, age:21&#125;, </span></span></span><br><span class="line"><span class="string"><span class="tag">    query: &#123;school: &#x27;love&#x27;&#125;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  对象写法</span><br><span class="line"><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">`/movie/1/21?id=<span class="subst">$&#123;id&#125;</span>`</span>)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;movie&#x27;</span>, <span class="attr">params</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">age</span>: <span class="number">21</span> &#125;, <span class="attr">query</span>: &#123; <span class="attr">school</span>: <span class="string">&#x27;love&#x27;</span> &#125; &#125;)</span><br></pre></td></tr></table></figure><p>接收 params 参数：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;movie-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Movie组件，参数值：&#123;&#123; this.$route.params.id &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="路由的-props-配置"><a href="#路由的-props-配置" class="headerlink" title="路由的 props 配置"></a>路由的 props 配置</h3><p>简化路由组件接收参数。</p><p>在路由规则中开启 <code>props</code> 传参，组件可以使用 <code>props</code> 接收路由参数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/movie/:id/:title&#x27;</span>,</span><br><span class="line">  <span class="attr">component</span>: <span class="title class_">Movie</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方式一：该对象中的所有 key-value 都会以 props 的形式传给组件</span></span><br><span class="line">  <span class="comment">// 该方式是写死的，少用</span></span><br><span class="line">  <span class="attr">props</span>: &#123;<span class="attr">id</span>: <span class="number">666</span>, <span class="attr">title</span>: <span class="string">&#x27;hello&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方式二：把 params 参数以 props 的形式传给组件</span></span><br><span class="line">  <span class="comment">// 只能接收 params 参数</span></span><br><span class="line">  <span class="attr">props</span>: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方式三：函数写法，啥都能传</span></span><br><span class="line">  <span class="title function_">props</span>(<span class="params">$route</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">id</span>: $route.<span class="property">query</span>.<span class="property">id</span>,</span><br><span class="line">      <span class="attr">title</span>: $route.<span class="property">params</span>.<span class="property">title</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">21</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>组件接收参数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// 使用 props 接收路由规则的参数项</span></span><br><span class="line">  <span class="attr">props</span>: [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;title&#x27;</span>],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Movie组件，参数值：&#123;&#123; id &#125;&#125;，题目：&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="路由传参注意事项"><a href="#路由传参注意事项" class="headerlink" title="路由传参注意事项"></a>路由传参注意事项</h3><ol><li>path 不能和 params 一起使用。path+query、name+query&#x2F;params 都行</li><li>如何指定 params 参数可传可不传？</li></ol><ul><li>若声明了 params 参数 <code>path: &#39;/movie/:title&#39;</code>，默认是必须要传递 params 参数的，否则 URL 会出现问题</li><li>指定 params 参数可不传：<code>path: &#39;/movie/:title?&#39;</code></li></ul><ol start="3"><li>已指明 params 参数可传可不传，但如果传递空串，如何解决？</li></ol><ul><li>传递空串，URL 也会出现问题</li><li>方法：使用 <code>undefined</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;search&#x27;</span>, <span class="attr">params</span>: &#123; <span class="attr">keyword</span>: <span class="string">&#x27;&#x27;</span> &#125;, <span class="attr">query</span>: &#123; <span class="attr">key</span>: <span class="variable language_">this</span>.<span class="property">key</span> &#125; &#125;)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;search&#x27;</span>, <span class="attr">params</span>: &#123; <span class="attr">keyword</span>: <span class="string">&#x27;&#x27;</span> || <span class="literal">undefined</span> &#125;, <span class="attr">query</span>: &#123; <span class="attr">key</span>: <span class="variable language_">this</span>.<span class="property">key</span> &#125; &#125;)</span><br></pre></td></tr></table></figure><h2 id="路由元信息-meta"><a href="#路由元信息-meta" class="headerlink" title="路由元信息 meta"></a>路由元信息 meta</h2><p>在 <code>meta</code> 中可以为路由添加自定义信息：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;about&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">About</span>,</span><br><span class="line">    <span class="attr">meta</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;hello&#x27;</span>, <span class="attr">isAuth</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="路由守卫"><a href="#路由守卫" class="headerlink" title="路由守卫"></a>路由守卫</h2><p>:::tip 路由守卫<br>作用：对路由进行权限控制。</p><p>分类：全局守卫、独享守卫、组件内守卫<br>:::</p><h3 id="全局守卫"><a href="#全局守卫" class="headerlink" title="全局守卫"></a>全局守卫</h3><ul><li>全局前置守卫：<code>beforeEach()</code></li><li>全局后置守卫：<code>afterEach()</code></li></ul><p>守卫回调函数 3 个形参：</p><ul><li><code>to</code> ：将要访问的路由的信息对象，即 <code>$route</code></li><li><code>from</code> ：将要离开的路由的信息对象</li><li><code>next</code> ：放行函数（后置守卫没有）</li></ul><p><code>next</code> 函数 3 种调用方式：</p><ul><li>直接放行：<code>next()</code></li><li>强制跳转到其他路由：<code>next(/login)</code></li><li>阻止本次跳转：<code>next(false)</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;...&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(to.<span class="property">path</span> === <span class="string">&#x27;/main&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(token) &#123;</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">(<span class="params">to,<span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(to.<span class="property">meta</span>.<span class="property">title</span>) &#123;</span><br><span class="line">    <span class="comment">// 修改网页标题</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = to.<span class="property">meta</span>.<span class="property">title</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;vue_test&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="独享路由守卫"><a href="#独享路由守卫" class="headerlink" title="独享路由守卫"></a>独享路由守卫</h3><ul><li>某一条路由规则独享的守卫</li><li>独享守卫只一个</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;about&#x27;</span>,</span><br><span class="line">  <span class="attr">component</span>: <span class="title class_">About</span>,</span><br><span class="line">  <span class="title function_">beforeEnter</span>(<span class="params">to, <span class="keyword">from</span> ,next</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="组件内路由守卫"><a href="#组件内路由守卫" class="headerlink" title="组件内路由守卫"></a>组件内路由守卫</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 进入守卫：通过路由规则，进入该组件时被调用</span></span><br><span class="line">  <span class="title function_">beforeRouteEnter</span>(<span class="params">to, <span class="keyword">from</span>, next</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 离开守卫：通过路由规则，离开该组件时被调用</span></span><br><span class="line">  beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="各个守卫执行顺序"><a href="#各个守卫执行顺序" class="headerlink" title="各个守卫执行顺序"></a>各个守卫执行顺序</h3><p>从 <code>About</code> 组件通过路由规则进入 <code>Home</code> 组件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">About-beforeRouteLeave</span><br><span class="line">beforeEach</span><br><span class="line">Home-beforeEnter</span><br><span class="line">Home-beforeRouteEnter</span><br><span class="line">afterEach</span><br><span class="line">Home组件生命周期开始</span><br></pre></td></tr></table></figure><h2 id="vue-router-4-x"><a href="#vue-router-4-x" class="headerlink" title="vue-router 4.x"></a>vue-router 4.x</h2><p>目前 <code>vue-router</code> 有 <code>3.x</code> 和 <code>4.x</code> 两个版本，前者只能在 <code>vue2.x</code> 中使用，后者只能在 <code>vue3.x</code> 中使用。</p><p>下面是 <code>vue-router 4.x</code> 初体验：</p><p>安装 <code>vue-router 4.x</code> ：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router@next -S</span><br></pre></td></tr></table></figure><p>创建路由模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从 vue-router 按需导入两个方法</span></span><br><span class="line"><span class="comment">// createRouter：创建路由实例对象</span></span><br><span class="line"><span class="comment">// createWebHashHistory：指定路由工作模式为 hash 模式</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHashHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHashHistory</span>(),</span><br><span class="line">  <span class="attr">routes</span>: [&#123; <span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Home</span> &#125;],</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><p><code>main.js</code> 导入并挂载路由模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Router </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vuex</title>
      <link href="/2023/09/06/vuex/"/>
      <url>/2023/09/06/vuex/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vuex.vuejs.org/zh/">官网传送门</a></p><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>何为 Vuex ？</p><p>Vuex 专门在 Vue 中实现集中式状态（数据）管理的一个 Vue 插件，对 Vue 应用中多个组件的共享状态进行集中式的管理，也是一种组件间通信的方式，适用于任意组件间通信</p><p>何时用 Vuex ？</p><ul><li>多个组件依赖于同一状态</li><li>来自不同组件的行为需要变更同一状态</li></ul><p>Vuex 工作原理图：</p><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/vuex.png" alt="Vuex工作原理"></p><p>官方 Vuex 项目结构示例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── index.html</span><br><span class="line">├── main.js</span><br><span class="line">├── api</span><br><span class="line">│   └── ... # 抽取出API请求</span><br><span class="line">├── components</span><br><span class="line">│   ├── App.vue</span><br><span class="line">│   └── ...</span><br><span class="line">└── store</span><br><span class="line">    ├── index.js          # 组装模块并导出 store 的地方</span><br><span class="line">    ├── actions.js        # 根级别的 action</span><br><span class="line">    ├── mutations.js      # 根级别的 mutation</span><br><span class="line">    └── modules</span><br><span class="line">        ├── cart.js       # 购物车模块</span><br><span class="line">        └── products.js   # 产品模块</span><br></pre></td></tr></table></figure><h2 id="Vuex-核心概念"><a href="#Vuex-核心概念" class="headerlink" title="Vuex 核心概念"></a>Vuex 核心概念</h2><h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><ul><li>Vuex 管理的状态对象</li><li>唯一的</li></ul><h3 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h3><ul><li>值为一个对象，包含多个响应用户动作的回调函数</li><li>通过 <code>commit()</code>触发 mutation 中函数的调用，间接更新 state</li><li>可包含异步代码</li></ul><h3 id="mutations"><a href="#mutations" class="headerlink" title="mutations"></a>mutations</h3><ul><li>值为一个对象，包含多个直接更新 state 的方法</li><li>不能写异步代码，只能单纯地操作 state</li></ul><h3 id="getters"><a href="#getters" class="headerlink" title="getters"></a>getters</h3><ul><li>值为一个对象，包含多个用于返回数据的函数</li><li>类似于计算属性，getters 返回的数据依赖于 state 的数据</li></ul><h3 id="modules"><a href="#modules" class="headerlink" title="modules"></a>modules</h3><ul><li>一个 module 是一个 store 的配置对象，与一个组件对应</li></ul><h2 id="搭建-Vuex-环境"><a href="#搭建-Vuex-环境" class="headerlink" title="搭建 Vuex 环境"></a>搭建 Vuex 环境</h2><p>安装 Vuex：<code>npm install vuex@3 --save</code></p><p>:::warning<br>注意：Vue2 安装 Vuex3，Vue3 安装 Vuex4，版本需对应。<br>:::</p><p>创建文件 <code>src/store/index.js</code> ：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> state = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  actions,</span><br><span class="line">  mutations,</span><br><span class="line">  state,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><code>main.js</code> 配置 <code>store</code> ：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  store,</span><br><span class="line">  <span class="attr">render</span>: <span class="function">(<span class="params">h</span>) =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><p>组件实例与 <code>Actions</code> 和 <code>Mutations</code> 对话：</p><ul><li>若没有网络请求或其他业务逻辑，组件中也可以越过 <code>actions</code> ，即不写<code>dispatch</code>，直接编写<code>commit</code>：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;ADD&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">incrementOdd</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;addOdd&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">incrementAsync</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;addAsync&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>定义 <code>Actions</code> 和 <code>Mutations</code>：</p><ul><li><code>context</code> 是一个迷你版的 <code>store</code>，可访问 <code>dispatch</code>, <code>commit</code> 方法和 <code>state</code></li><li><code>mutations</code> 的动作类型一般用大写，与 <code>actions</code> 区分</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// context 是一个迷你版的 store</span></span><br><span class="line">  <span class="comment">// 可访问 dispatch, commit 方法和 state</span></span><br><span class="line">  <span class="title function_">addOdd</span>(<span class="params">context, value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (context.<span class="property">state</span>.<span class="property">sum</span> % <span class="number">2</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&#x27;ADD&#x27;</span>, value)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">addAsync</span>(<span class="params">context, value</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&#x27;ADD&#x27;</span>, value)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  <span class="comment">// mutations 的动作类型一般用大写，与 actions 区分</span></span><br><span class="line">  <span class="title function_">ADD</span>(<span class="params">state, value</span>) &#123;</span><br><span class="line">    state.<span class="property">sum</span> += value</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  <span class="attr">sum</span>: <span class="number">0</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  actions,</span><br><span class="line">  mutations,</span><br><span class="line">  state,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>组件访问 Vuex 的数据：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; $store.state.sum &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="getters-的使用"><a href="#getters-的使用" class="headerlink" title="getters 的使用"></a>getters 的使用</h2><ul><li>当 <code>state</code> 中的数据需要经过加工后再使用时，可以使用 <code>getters</code> 加工</li><li>它不是必须的，当加工逻辑复杂且需要复用时，可以考虑使用</li><li><code>state</code> 与 <code>getters</code> 的关系有点像 <code>data</code> 和 <code>computed</code> 的关系</li><li>组件读取：<code>$store.getters.bigSum</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">  <span class="title function_">bigSum</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> state.<span class="property">sum</span> * <span class="number">10</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  actions,</span><br><span class="line">  mutations,</span><br><span class="line">  state,</span><br><span class="line">  getters</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="四个-mapXxx-方法"><a href="#四个-mapXxx-方法" class="headerlink" title="四个 mapXxx 方法"></a>四个 mapXxx 方法</h2><h3 id="mapState"><a href="#mapState" class="headerlink" title="mapState()"></a>mapState()</h3><ul><li>将 <code>state</code> 状态映射为计算属性</li><li>对象写法：键为自取的计算属性名，值为对应的状态（必须为字符串）</li><li>数组写法：当键值同名，可直接写状态名（字符串）</li><li>函数返回一个对象：<code>&#123;sum: f, price: f&#125;</code></li><li>注意对象的 <code>...&#123;&#125;</code> 展开写法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  <span class="comment">// 手动写法</span></span><br><span class="line">  <span class="title function_">sum</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">sum</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">price</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">price</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对象写法</span></span><br><span class="line">  ...<span class="title function_">mapState</span>(&#123;<span class="attr">sum</span>: <span class="string">&#x27;sum&#x27;</span>, <span class="attr">price</span>: <span class="string">&#x27;price&#x27;</span>&#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数组写法</span></span><br><span class="line">  ...<span class="title function_">mapState</span>([<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;price&#x27;</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="mapGetters"><a href="#mapGetters" class="headerlink" title="mapGetters"></a>mapGetters</h3><ul><li>将 <code>getters</code> 的数据映射为计算属性</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  <span class="title function_">bigSum</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>.<span class="property">bigSum</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">double</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>.<span class="property">double</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对象写法</span></span><br><span class="line">  ...<span class="title function_">mapGetters</span>(&#123;<span class="attr">bigSum</span>: <span class="string">&#x27;bigSum&#x27;</span>, <span class="attr">double</span>: <span class="string">&#x27;double&#x27;</span>&#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数组写法</span></span><br><span class="line">  ...<span class="title function_">mapGetters</span>([<span class="string">&#x27;bigSum&#x27;</span>, <span class="string">&#x27;double&#x27;</span>]),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="mapActions"><a href="#mapActions" class="headerlink" title="mapActions"></a>mapActions</h3><ul><li>生成与 <code>actions</code> 对话的函数，即包含 <code>$store.dispatch()</code></li><li><code>mapActions</code> 生成的函数不会传入参数，需要在调用时手动传入数据，不传参默认传入 <code>$event</code></li><li>数组写法要注意函数名和 <code>actions</code> 动作类型同名，调用时勿写错</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapActions &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="comment">// 手动写法</span></span><br><span class="line">  <span class="title function_">incrementOdd</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;addOdd&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">incrementAsync</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;addAsync&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对象写法</span></span><br><span class="line">  ...<span class="title function_">mapActions</span>(&#123;<span class="attr">incrementOdd</span>: <span class="string">&#x27;addOdd&#x27;</span>, <span class="attr">incrementAsync</span>: <span class="string">&#x27;addAsync&#x27;</span>&#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数组写法</span></span><br><span class="line">  ...<span class="title function_">mapActions</span>([<span class="string">&#x27;addOdd&#x27;</span>, <span class="string">&#x27;addAsync&#x27;</span>]),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;incrementOdd(number)&quot;</span>&gt;</span>奇数+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="mapMutations"><a href="#mapMutations" class="headerlink" title="mapMutations"></a>mapMutations</h3><ul><li>生成与 <code>mutations</code> 对话的函数，即包含 <code>$store.commit()</code></li><li>同样注意传递参数，以及数组形式函数名的问题</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;ADD&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">decrement</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;SUB&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对象写法</span></span><br><span class="line">  ...<span class="title function_">mapMutations</span>(&#123;<span class="attr">increment</span>: <span class="string">&#x27;ADD&#x27;</span>, <span class="attr">decrement</span>: <span class="string">&#x27;SUB&#x27;</span>&#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数组写法</span></span><br><span class="line">  ...<span class="title function_">mapMutations</span>([<span class="string">&#x27;ADD&#x27;</span>, <span class="string">&#x27;SUB&#x27;</span>]),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Vuex-模块化-命名空间"><a href="#Vuex-模块化-命名空间" class="headerlink" title="Vuex 模块化&amp;命名空间"></a>Vuex 模块化&amp;命名空间</h2><p>让代码更好维护，让多种数据分类更加明确，每一类数据及其相关操作对应一个 <code>store</code> 。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/index.js</span></span><br><span class="line"><span class="keyword">const</span> countAbout = &#123;</span><br><span class="line">  <span class="comment">// 开启命名空间</span></span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">sum</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;...&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;...&#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">bigSum</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">sum</span> * <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> personAbout = &#123;</span><br><span class="line">  <span class="comment">// 开启命名空间</span></span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">personList</span>: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;...&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;...&#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;...&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    countAbout,</span><br><span class="line">    personAbout</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>开启命名空间后，组件中读取 <code>state</code> 数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接读取</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">personAbout</span>.<span class="property">personList</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// mapState 读取</span></span><br><span class="line">...<span class="title function_">mapState</span>(<span class="string">&#x27;countAbout&#x27;</span>,[<span class="string">&#x27;sum&#x27;</span>,<span class="string">&#x27;school&#x27;</span>]),</span><br></pre></td></tr></table></figure><p>开启命名空间后，组件中读取 <code>getters</code> 数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接读取</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[<span class="string">&#x27;countAbout/bigSum&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// mapGetters 读取：</span></span><br><span class="line">...<span class="title function_">mapGetters</span>(<span class="string">&#x27;countAbout&#x27;</span>,[<span class="string">&#x27;bigSum&#x27;</span>])</span><br></pre></td></tr></table></figure><p>开启命名空间后，组件中调用 <code>dispatch</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接 dispatch</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;countAbout/addODdd&#x27;</span>, <span class="variable language_">this</span>.<span class="property">number</span>)</span><br><span class="line"><span class="comment">// 借助 mapActions</span></span><br><span class="line">...<span class="title function_">mapActions</span>(<span class="string">&#x27;countAbout&#x27;</span>, &#123;<span class="attr">incrementOdd</span>:<span class="string">&#x27;addOdd&#x27;</span>, <span class="attr">incrementWait</span>:<span class="string">&#x27;addAsync&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><p>开启命名空间后，组件中调用 <code>commit</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接 commit</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;personAbout/ADD_PERSON&#x27;</span>, person)</span><br><span class="line"><span class="comment">// 借助 mapMutations</span></span><br><span class="line">...<span class="title function_">mapMutations</span>(<span class="string">&#x27;countAbout&#x27;</span>,&#123;<span class="attr">increment</span>:<span class="string">&#x27;ADD&#x27;</span>,<span class="attr">decrement</span>:<span class="string">&#x27;SUB&#x27;</span>&#125;),</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vuex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 网络请求</title>
      <link href="/2023/09/06/vue_network_request/"/>
      <url>/2023/09/06/vue_network_request/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue-网络请求"><a href="#Vue-网络请求" class="headerlink" title="Vue 网络请求"></a>Vue 网络请求</h1><h2 id="Vue-脚手架配置代理"><a href="#Vue-脚手架配置代理" class="headerlink" title="Vue 脚手架配置代理"></a>Vue 脚手架配置代理</h2><h3 id="配置单个代理"><a href="#配置单个代理" class="headerlink" title="配置单个代理"></a>配置单个代理</h3><p>在 <code>vue.config.js</code> 中添加如下配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devServer</span>: &#123;</span><br><span class="line">  <span class="attr">proxy</span>: <span class="string">&#x27;http://localhost:5000&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>优点：配置简单，请求资源时直接发给前端（8080）即可。</li><li>缺点：不能配置多个代理，不能灵活的控制请求是否走代理。</li><li>工作方式：若按照上述配置代理，当请求了前端不存在的资源时，那么该请求会转发给服务器 （优先匹配前端资源）</li></ul><h3 id="配置多个代理"><a href="#配置多个代理" class="headerlink" title="配置多个代理"></a>配置多个代理</h3><p>编写 <code>vue.config.js</code> 配置具体代理规则：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api1&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment">// 匹配所有以 &#x27;/api1&#x27;开头的请求路径</span></span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://localhost:5000&#x27;</span>, <span class="comment">// 代理目标的基础路径</span></span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 把路径的 /api1 替换为空串</span></span><br><span class="line">        <span class="attr">pathRewrite</span>: &#123; <span class="string">&#x27;^/api1&#x27;</span>: <span class="string">&#x27;&#x27;</span> &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&#x27;/api2&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment">// 匹配所有以 &#x27;/api2&#x27;开头的请求路径</span></span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://localhost:5001&#x27;</span>,</span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">pathRewrite</span>: &#123; <span class="string">&#x27;^/api2&#x27;</span>: <span class="string">&#x27;&#x27;</span> &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">changeOrigin 设置为 true 时，服务器收到的请求头中的 host：localhost:5000</span></span><br><span class="line"><span class="comment">changeOrigin 设置为 false 时，服务器收到的请求头中的 host：localhost:8080</span></span><br><span class="line"><span class="comment">changeOrigin 默认为 true</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><ul><li>优点：可以配置多个代理，且可以灵活的控制请求是否走代理。</li><li>缺点：配置略微繁琐，请求资源时必须加前缀</li></ul><h2 id="vue-2-x-全局配置-axios"><a href="#vue-2-x-全局配置-axios" class="headerlink" title="vue 2.x 全局配置 axios"></a>vue 2.x 全局配置 axios</h2><p>实际项目开发中，几乎每个组件中都会使用 <code>axios</code> 发起数据请求。此时会遇到如下两个问题：</p><ul><li>每个组件中都需要导入 <code>axios</code>（代码臃肿）</li><li>每次发请求都需要填写完整的请求路径（不利于后期的维护）</li></ul><p>在 <code>main.js</code> 文件中进行配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置请求根路径</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;http://api.com&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 把 axios 挂载到 Vue 原型上</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$http</span> = aixos</span><br></pre></td></tr></table></figure><p>优点：每个组件可以通过 <code>this.$http.get</code> 直接发起请求，无需再导入 <code>axios</code> ；若根路径发生改变，只需修改 <code>axios.defaults.baseURL</code> ，有利于代码维护。</p><p>缺点：无法实现 <code>API</code> 的复用。即多个组件需要对同一个接口发起请求，那么每个组件都需要重复书写 <code>this.$http.get(&#39;/users&#39;)</code> 类似的代码，造成冗余。（视频上的说法，个人认为真正的缺点是如果存在多个根路径，这种方式无法解决，所以才会有下面的改进方式。）</p><p>改进：对于每一个根路径，独立封装一个 <code>request.js</code> 模块，组件导入所需根路径对应的 <code>axios</code> 进行使用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 axios 实例</span></span><br><span class="line"><span class="keyword">const</span> request = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;http://api.taobao.com&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> request</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue网络请求 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 脚手架</title>
      <link href="/2023/09/06/vue_cli/"/>
      <url>/2023/09/06/vue_cli/</url>
      
        <content type="html"><![CDATA[<p><a href="https://cli.vuejs.org/zh/">官网传送门</a></p><h2 id="创建-Vue-项目"><a href="#创建-Vue-项目" class="headerlink" title="创建 Vue 项目"></a>创建 Vue 项目</h2><ul><li>全局安装 vue 脚手架：<code>npm i -g @vue/cli</code></li><li>创建项目：<code>vue create project-name</code></li><li>运行项目：<code>npm run serve</code></li><li>暴露 webpack 配置：<code>vue inspect &gt; output.js</code></li></ul><h2 id="Vue-脚手架项目结构"><a href="#Vue-脚手架项目结构" class="headerlink" title="Vue 脚手架项目结构"></a>Vue 脚手架项目结构</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── node_modules</span><br><span class="line">├── public</span><br><span class="line">│ ├── favicon.ico: 页签图标</span><br><span class="line">│ └── index.html: 主页面</span><br><span class="line">├── src</span><br><span class="line">│ ├── assets: 存放静态资源</span><br><span class="line">│ │ └── logo.png</span><br><span class="line">│ │── component: 存放组件</span><br><span class="line">│ │ └── HelloWorld.vue</span><br><span class="line">│ │── App.vue: 汇总所有组件</span><br><span class="line">│ │── main.js: 入口文件</span><br><span class="line">├── .gitignore: git 版本管制忽略的配置</span><br><span class="line">├── babel.config.js: babel 的配置文件</span><br><span class="line">├── package.json: 应用包配置文件</span><br><span class="line">├── README.md: 应用描述文件</span><br><span class="line">├── package-lock.json：包版本控制文件</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/vue-cli.png" alt="Vue脚手架项目结构"></p><p><code>index.html</code> 代码分析：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 针对IE浏览器的一个特殊配置，含义是让IE浏览器以最高的渲染级别渲染页面 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 开启移动端的理想视口 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width,initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;%= BASE_URL %&gt; 表示 public 文件夹路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 拿 package-lock.json 的 name 作为标题 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 当浏览器不支持js时noscript中的元素就会被渲染 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">strong</span>&gt;</span>We&#x27;re sorry but &lt;%= htmlWebpackPlugin.options.title %&gt; doesn&#x27;t work properly without JavaScript enabled. Please enable it to continue.<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 容器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- built files will be auto injected --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="不同版本的-Vue-与-render-函数"><a href="#不同版本的-Vue-与-render-函数" class="headerlink" title="不同版本的 Vue 与 render 函数"></a>不同版本的 Vue 与 <code>render</code> 函数</h2><ol><li><code>vue.js</code> 与 <code>vue.runtime.xxx.js</code> 的区别：</li></ol><ul><li><code>import Vue from &#39;vue&#39;</code> 默认导入 <code>vue.runtime.esm.js</code></li><li><code>vue.js</code> 是完整版的 Vue，包含：核心功能 + 模板解析器</li><li><code>vue.runtime.xxx.js</code> 是运行版的 Vue，只包含：核心功能；没有模板解析器</li></ul><ol start="2"><li><code>vue.runtime.xxx.js</code> 没有模板解析器，故不能使用 <code>template</code> 配置项，需使用 <code>render</code> 函数接收到的 <code>createElement</code> 函数去指定具体内容</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.js&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// render()</span></span><br><span class="line"><span class="attr">render</span>: <span class="keyword">function</span>(<span class="params">createElement</span>) &#123;</span><br><span class="line">  <span class="comment">// 创建元素</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">createElement</span>(<span class="string">&#x27;h1&#x27;</span>, <span class="string">&#x27;Hello Vue&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="attr">render</span>: <span class="function"><span class="params">createElement</span> =&gt;</span> <span class="title function_">createElement</span>(<span class="title class_">App</span>)</span><br></pre></td></tr></table></figure><h2 id="vue-config-js-配置文件"><a href="#vue-config-js-配置文件" class="headerlink" title="vue.config.js 配置文件"></a>vue.config.js 配置文件</h2><ol><li>使用 <code>vue inspect &gt; output.js</code> 可以查看到 Vue 脚手架的默认配置。</li><li>使用 <code>vue.config.js</code> 可以对脚手架进行个性化定制，<a href="https://cli.vuejs.org/zh/config/">详情</a></li></ol><h2 id="TodoList-案例总结"><a href="#TodoList-案例总结" class="headerlink" title="TodoList 案例总结"></a>TodoList 案例总结</h2><ol><li>组件化编码流程：</li></ol><ul><li>拆分静态组件：组件要按照功能点拆分，命名不要与 html 元素冲突。</li><li>实现动态组件：考虑好数据的存放位置，数据是一个组件在用，还是一些组件在用：<ul><li>一个组件在用：放在组件自身即可</li><li>一些组件在用：放在他们共同的父组件上（状态提升）</li></ul></li><li>实现交互：从绑定事件开始。</li></ul><ol start="2"><li><code>props</code> 适用于：</li></ol><ul><li>父 &#x3D;&#x3D;&gt; 子</li><li>子 &#x3D;&#x3D;&gt; 父（要求父先给子一个函数）</li></ul><ol start="3"><li><p><code>v-model</code> 绑定的值不能是 <code>props</code> 传过来的值，因为 <code>props</code> 是不可以修改的！</p></li><li><p><code>props</code> 传过来的若是对象类型的值，修改对象中的属性时 Vue 不会报错，但不推荐</p></li></ol><h2 id="一些第三方包"><a href="#一些第三方包" class="headerlink" title="一些第三方包"></a>一些第三方包</h2><ul><li><a href="https://gitee.com/mirrors/nanoid#nano-id">nanoid</a></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install nanoid</span><br><span class="line"></span><br><span class="line">import &#123; nanoid &#125; from nanoid</span><br><span class="line"></span><br><span class="line">model.id = nanoid()</span><br></pre></td></tr></table></figure><ul><li><a href="https://dayjs.fenxianglu.cn/">dayjs</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue脚手架 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 组件进阶</title>
      <link href="/2023/09/06/vue_component_advanced/"/>
      <url>/2023/09/06/vue_component_advanced/</url>
      
        <content type="html"><![CDATA[<h2 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h2><p>vue 提供了内置的 <code>&lt;component&gt;</code> 组件用于动态切换组件。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 通过 is 属性指定要渲染的组件，传递的是字符串 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;comName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;comName = &#x27;Left&#x27;&quot;</span>&gt;</span>展示Left组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;comName = &#x27;Right&#x27;&quot;</span>&gt;</span>展示Right组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h2><p>默认情况下，切换动态组件时无法保持组件的状态。此时可以使用 vue 内置的 <code>&lt;keep-alive&gt;</code> 组件保持动态组件的状态，对被包裹的组件进行状态缓存。</p><p>被 <code>&lt;keep-alive&gt;</code> 包裹的组件会多出两个生命周期函数：当组件被激活时，触发 <code>activated</code> 钩子；当组件被缓存时，触发 <code>deactivated</code> 钩子。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;comName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;keep-alive&gt;</code> 的 <code>include</code> 和 <code>exclude</code> 属性，分别用于指明哪些组件要缓存、哪些组件不要缓存。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span> <span class="attr">include</span>=<span class="string">&quot;Left, Right&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;comName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span> <span class="attr">:include</span>=<span class="string">&quot;[&#x27;News&#x27;, &#x27;Message&#x27;]&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h2><h3 id="何为插槽"><a href="#何为插槽" class="headerlink" title="何为插槽"></a>何为插槽</h3><p>插槽可以理解为组件封装期间，为用户预留的<strong>内容占位符</strong>。它是 vue 为组件封装者提供的能力，允许开发者在封装组件时，把<strong>不确定的、希望由用户指定的部分</strong>定义为插槽。</p><h3 id="插槽基本用法"><a href="#插槽基本用法" class="headerlink" title="插槽基本用法"></a>插槽基本用法</h3><p>基础使用：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件中预留插槽 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;contianer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 父组件使用子组件时，向插槽填充内容 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">child-comp</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>填充到插槽的内容<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">child-comp</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果子组件没有预留插槽，那么父组件填充给子组件的自定义内容会被丢弃：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件没有预留插槽 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;contianer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 父组件的自定义内容会被丢弃 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">child-comp</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>这段自定义内容会被丢弃<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">child-comp</span>&gt;</span></span><br></pre></td></tr></table></figure><p>子组件可以为插槽提供<strong>后备内容</strong>，当父组件没有提供自定义内容时，后备内容就会生效。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件提供后备内容 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;contianer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span>这是后备内容，父组件没有提供自定义内容就会生效<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 父组件没有提供自定义内容 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">child-comp</span>&gt;</span> <span class="tag">&lt;/<span class="name">child-comp</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="具名插槽"><a href="#具名插槽" class="headerlink" title="具名插槽"></a>具名插槽</h3><p>组件在预留插槽时可以设置 <code>name</code> 属性，为插槽指定名称，这种有具体名称的插槽就叫具名插槽。<br>没有设置 <code>name</code> 名称的插槽默认名称为 <code>default</code> 。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件预留多个具名插槽 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;contianer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span>title 具名插槽<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span>&gt;</span>content 具名插槽<span class="tag">&lt;/<span class="name">slot</span>&gt;</span>&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span>没有设置 name 名称则默认为 default<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;default&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>父组件向具名插槽提供自定义内容</p><ul><li>新的写法：包裹一个 <code>&lt;template&gt;</code> 标签，同时在 <code>&lt;template&gt;</code> 中通过 <code>v-slot:名称</code> 指明插槽的名称。简写形式为 <code>#名称</code> ，且 <code>v-slot</code> 只能使用在 <code>&lt;template&gt;</code> 和组件标签上，普通 HTML 标签不行</li><li>旧的写法：<code>slot=&quot;名称&quot;</code> 指明插槽名称</li><li>如果不指定插槽名称，那么自定义内容会被填充到所有的 <code>default</code> 插槽当中</li><li>同一插槽填充多个内容，是追加不是覆盖</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件向具名插槽提供自定义内容 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">child-comp</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">slot</span>=<span class="string">&quot;title&quot;</span>&gt;</span>《赠汪伦》<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>《静夜思》<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 简写形式 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>床前明月光，疑是地上霜。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>举头望明月，低头思故乡。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>这段内容没有指定名称，会被填充到所有 default 插槽中。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">child-comp</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="作用域插槽"><a href="#作用域插槽" class="headerlink" title="作用域插槽"></a>作用域插槽</h3><ul><li>组件可以为插槽绑定自定义属性 <code>props</code> ，这种插槽叫作用域插槽</li><li>理解：数据在组件的自身，但根据数据生成的结构需要组件的使用者来决定</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件为插槽绑定 props 数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">v-for</span>=<span class="string">&quot;item in list&quot;</span> <span class="attr">:user</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">list</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;Lily&#x27;</span>,</span><br><span class="line">          <span class="attr">state</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="number">2</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;Ben&#x27;</span>,</span><br><span class="line">          <span class="attr">state</span>: <span class="literal">false</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="number">3</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;Water&#x27;</span>,</span><br><span class="line">          <span class="attr">state</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>父组件向插槽提供自定义内容时，可以接收作用域插槽提供的数据：</p><ul><li>旧写法：<code>scope=&quot;scope&quot;</code> 、<code>slot-scope=&quot;scope&quot;</code></li><li>新写法：<code>v-slot:default=&quot;scope&quot;</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">child-comp</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>作用域插槽提供的数据：&#123;&#123; scope &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span> <span class="attr">slot</span>=<span class="string">&quot;default&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; scope &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">child-comp</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其中接收到的数据 <code>scope</code> 是一个对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// scope 的内容</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&#x27;user&#x27;</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Lily&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;state&#x27;</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在接收作用域插槽提供的数据时可以使用解构赋值。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">child-comp</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123;user&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>id：&#123;&#123; user.id &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>name：&#123;&#123; user.name &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>state：&#123;&#123; user.state &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">child-comp</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h2><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><ul><li>私有自定义指令：在组件的 <code>directives</code> 节点声明</li><li>全局自定义指令：在 <code>main.js</code> 文件中声明</li></ul><h3 id="完整写法"><a href="#完整写法" class="headerlink" title="完整写法"></a>完整写法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-focus</span>=<span class="string">&quot;content&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">content</span>: <span class="number">666</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">directives</span>: &#123;</span><br><span class="line">  <span class="attr">focus</span>: &#123;</span><br><span class="line">    <span class="comment">// 指令与元素成功绑定时执行，执行一次</span></span><br><span class="line">    <span class="title function_">bind</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">      el.<span class="property">value</span> = binding.<span class="property">value</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 指令所在元素插入页面时执行，执行一次</span></span><br><span class="line">    <span class="title function_">inserted</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">      <span class="comment">// 一进入页面输入框获得焦点</span></span><br><span class="line">      el.<span class="title function_">focus</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 指令所在元素重新解析（个人觉得不应是渲染，而是解析，重新解析不一定重新渲染）时执行，执行 0+N 次</span></span><br><span class="line">    <span class="title function_">update</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">      el.<span class="property">value</span> = binding.<span class="property">value</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局写法</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">directive</span>(<span class="string">&#x27;focus&#x27;</span>, &#123;</span><br><span class="line">  <span class="title function_">bind</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">    el.<span class="property">value</span> = binding.<span class="property">value</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">inserted</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">    el.<span class="title function_">focus</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">update</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">    el.<span class="property">value</span> = binding.<span class="property">value</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="简写形式"><a href="#简写形式" class="headerlink" title="简写形式"></a>简写形式</h3><ul><li>当 <code>bind</code> 函数和 <code>update</code> 函数里的逻辑完全相同时，可以简写</li><li>不需要定义 <code>inserted</code> 函数才使用简写形式</li><li>因此简写形式的调用时机：初次绑定和 DOM 更新（指令所在模板被重新解析）</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-color</span>=<span class="string">&quot;&#x27;red&#x27;&quot;</span>&gt;</span>简写形式<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">directives</span>: &#123;</span><br><span class="line">  <span class="title function_">color</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">    el.<span class="property">style</span>.<span class="property">color</span> = binding.<span class="property">value</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局写法</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">directive</span>(<span class="string">&#x27;color&#x27;</span>, <span class="function">(<span class="params">el, binding</span>) =&gt;</span> &#123;</span><br><span class="line">  el.<span class="property">style</span>.<span class="property">color</span> = binding.<span class="property">value</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>自定义指令使用时需要添加 <code>v-</code> 前缀</li><li>指令名如果是多个单词，要使用 <code>kebab-case</code> 短横线命名方式，不要用 <code>camelCase</code> 驼峰命名</li><li>自定义指令三个函数里的 <code>this</code> 指向 <code>window</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-big-number</span>=<span class="string">&quot;n&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">n</span>: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">directives</span>: &#123;</span><br><span class="line">  <span class="comment">// 添加引号才是对象键名完整写法</span></span><br><span class="line">  <span class="comment">// 平时不加引号都是简写形式</span></span><br><span class="line">  <span class="comment">// 遇到短横线的键名就必须添加引号</span></span><br><span class="line">  <span class="string">&#x27;big-number&#x27;</span>: &#123;</span><br><span class="line">    <span class="title function_">bind</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// Window</span></span><br><span class="line">      el.<span class="property">innerText</span> = binding.<span class="property">value</span> * <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Mixin-混入"><a href="#Mixin-混入" class="headerlink" title="Mixin 混入"></a>Mixin 混入</h2><ul><li>Mixin 可以把多个组件共用的配置提取成一个混入对象</li><li>混入和组件自身的配置会合并</li><li><code>data</code> 、<code>methods</code> 若冲突以自身为准</li><li>对于生命周期钩子，执行动作会合并，且先执行 Mixin 里的动作</li></ul><p>定义混入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mixin.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mixin = &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">showName</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello mixin&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mixin2 = &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">x</span>: <span class="number">100</span>,</span><br><span class="line">      <span class="attr">y</span>: <span class="number">200</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用局部混入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mixin, mixin2 &#125; <span class="keyword">from</span> <span class="string">&#x27;../mixin.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;School&#x27;</span>,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">schoolName</span>: <span class="string">&#x27;北大&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mixins</span>: [mixin, mixin2],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用全局混入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; mixin, mixin2 &#125; <span class="keyword">from</span> <span class="string">&#x27;./mixin.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">mixin</span>(mixin)</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">mixin</span>(mixin2)</span><br></pre></td></tr></table></figure><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><ul><li>用于增强 Vue</li><li>本质是包含 <code>install</code> 方法的一对象，<code>install</code> 第一个参数是 Vue 构造函数，第二个以后的参数是插件使用者传递的数据</li></ul><p>定义插件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// plugins.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">Vue, ...rest</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(rest)</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">filter</span>(...)</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">directive</span>(...)</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">mixin</span>(...)</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myProperty</span> = <span class="string">&#x27;plugins&#x27;</span></span><br><span class="line">    <span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myMethod</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用插件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> plugins <span class="keyword">from</span> <span class="string">&#x27;./plugins.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(plugins, <span class="number">1</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure><h2 id="nextTick"><a href="#nextTick" class="headerlink" title="$nextTick"></a>$nextTick</h2><ul><li>语法：<code>this.$nextTick(回调函数)</code></li><li>作用：在下一次 DOM 更新结束后执行其指定的回调</li><li>什么时候用：当改变数据后，要基于更新后的 DOM 进行操作时，要在 <code>nextTick</code> 指定的回调函数中执行</li><li>组件的 <code>$nextTick(cb)</code> 方法，会把 cb 回调推迟到下一个 DOM 更新周期之后执行，即在 DOM 更新完成后再执行回调，从而保证 cb 回调可以获取最新的 DOM 元素</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">showInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">inputVisible</span> = <span class="literal">true</span></span><br><span class="line">    <span class="comment">// 对输入框的操作推迟到 DOM 更新完成之后</span></span><br><span class="line">    <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">input</span>.<span class="title function_">focus</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue组件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 组件化编程</title>
      <link href="/2023/09/06/vue_component_coding/"/>
      <url>/2023/09/06/vue_component_coding/</url>
      
        <content type="html"><![CDATA[<p>:::tip 组件<br>实现应用局部功能代码和资源的集合<br>:::</p><h2 id="非单文件组件"><a href="#非单文件组件" class="headerlink" title="非单文件组件"></a>非单文件组件</h2><p>非单文件组件即所有组件写在同一个文件里。</p><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>定义组件：</p><ul><li>使用 <code>Vue.extend(options)</code> 创建，和 <code>new Vue(options)</code> 的区别；<ul><li><code>el</code> 不写，最终所有的组件都要经过 vm 的管理，由 vm 的 <code>el</code> 决定服务哪个容器</li><li><code>data</code> 必须写成函数，避免组件被复用时，数据存在引用关系</li><li>使用 <code>template</code> 节点可配置组件结构</li></ul></li></ul><p>注册组件；</p><ul><li>局部注册：<code>components</code> 选项</li><li>全局注册：<code>Vue.component(&#39;组件名&#39;,组件)</code></li></ul><p>使用组件：<code>&lt;school&gt;&lt;/school&gt;</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hello</span>&gt;</span><span class="tag">&lt;/<span class="name">hello</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">school</span>&gt;</span><span class="tag">&lt;/<span class="name">school</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建 student 组件</span></span><br><span class="line"><span class="keyword">const</span> student = <span class="title class_">Vue</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">      &lt;h2&gt;学生姓名：&#123;&#123;studentName&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">studentName</span>: <span class="string">&#x27;张三&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 hello 组件</span></span><br><span class="line"><span class="keyword">const</span> hello = <span class="title class_">Vue</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">      &lt;h2&gt;&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;Tom&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 school 组件</span></span><br><span class="line"><span class="keyword">const</span> school = <span class="title class_">Vue</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;school&#x27;</span>,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">      &lt;h2&gt;学校名称：&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span></span><br><span class="line"><span class="string">      &lt;student&gt;&lt;/student&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;北京大学&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 组件嵌套</span></span><br><span class="line">  <span class="attr">components</span>: &#123;</span><br><span class="line">    student,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局注册</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;hello&#x27;</span>, hello)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&#x27;#root&#x27;</span>,</span><br><span class="line">  <span class="comment">// 局部注册</span></span><br><span class="line">  <span class="attr">components</span>: &#123;</span><br><span class="line">    school,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>注意事项：</p><ol><li>组件名</li></ol><ul><li>一个单词：school, School</li><li>多个单词：my-school, MySchool(需要 vue-cli 支持)</li></ul><ol start="2"><li>使用组件</li></ol><ul><li><code>&lt;school&gt;&lt;/school&gt;</code></li><li><code>&lt;school /&gt;</code> (需要 vue-cli 支持)</li></ul><ol start="3"><li><code>const school = Vue.extend(options)</code> 可简写为 <code>const school = options</code>。这是脚手架里 <code>&lt;script&gt;</code> 代码的简写来源。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">HelloWorld</span> <span class="keyword">from</span> <span class="string">&#x27;./components/HelloWorld.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="attr">components</span>: &#123;</span><br><span class="line">    <span class="title class_">HelloWorld</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 完整写法</span></span><br><span class="line"><span class="keyword">const</span> vc = <span class="title class_">Vue</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">  <span class="attr">components</span>: &#123;</span><br><span class="line">    <span class="title class_">HelloWorld</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> vc</span><br></pre></td></tr></table></figure><h3 id="关于-VueComponent-构造函数"><a href="#关于-VueComponent-构造函数" class="headerlink" title="关于 VueComponent 构造函数"></a>关于 VueComponent 构造函数</h3><ol><li>组件本质是一个名为 <code>VueComponent</code> 的构造函数，不是程序员定义的，是 <code>Vue.extend</code> 生成的</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> school = <span class="title class_">Vue</span>.<span class="title function_">extend</span>(&#123;...&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(school) <span class="comment">//ƒ VueComponent (options)</span></span><br></pre></td></tr></table></figure><ol start="2"><li><p>使用组件时，Vue 自动创建组件实例对象，即 <code>new VueComponent(options)</code> 是 Vue 做的</p></li><li><p>每次调用 <code>Vue.extend</code>，返回的都是一个全新的 <code>VueComponent</code> 构造函数</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> school = <span class="title class_">Vue</span>.<span class="title function_">extend</span>(&#123;...&#125;)</span><br><span class="line"><span class="keyword">const</span> student = <span class="title class_">Vue</span>.<span class="title function_">extend</span>(&#123;...&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(school === student) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><ol start="4"><li><p>组件的 <code>this</code> 指向 <code>VueComponent</code> 实例对象，而非 Vue 实例对象</p></li><li><p>重要的内置关系：<code>VueComponent.prototype.__proto__ === Vue.prototype</code> ，这个改动使得组件实例对象得以访问 Vue 原型上的属性方法</p></li></ol><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/VueComponent.png" alt="VueComponent"></p><h2 id="单文件组件"><a href="#单文件组件" class="headerlink" title="单文件组件"></a>单文件组件</h2><p>单文件组件即 <code>.vue</code> 文件</p><h2 id="scoped-解决样式冲突"><a href="#scoped-解决样式冲突" class="headerlink" title="scoped 解决样式冲突"></a>scoped 解决样式冲突</h2><ul><li>原理：为当前组件所有 DOM 元素分配唯一的自定义属性，写样式时使用属性选择器防止样式冲突问题</li><li><code>scoped</code> 只给子组件最外层的 div 添加了自定义属性 <code>[data-v-xxx]</code> ，子组件内部的标签并没有添加。因此父组件只能修改子组件最外层的 div 样式，修改子组件内层元素的样式是不可行的</li><li>若想让某些样式对子组件生效，需使用 <code>/deep/</code> 深度选择器</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 细细品味 */</span></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="comment">/* 不加 /deep/，选择器格式为 .title[data-v-052242de] */</span></span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/deep/ <span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="comment">/* 加 /deep/，选择器格式为 [data-v-052242de] .title */</span></span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h2 id="组件通信"><a href="#组件通信" class="headerlink" title="组件通信"></a>组件通信</h2><h3 id="自定义属性-props"><a href="#自定义属性-props" class="headerlink" title="自定义属性 props"></a>自定义属性 props</h3><blockquote><p>父传子、子传父</p></blockquote><p><code>props</code> 验证：</p><ul><li>基础类型检查：<code>String, Number, Boolean, Array, Object, Date, Function, Symbol</code></li><li>多个可能的类型</li><li>必填项检查</li><li><a href="https://www.cnblogs.com/mmzuo-798/p/15188014.html">默认值</a></li><li>自定义验证函数 <code>validator</code></li><li><code>props</code> 是只读的，若是对象，对象内部的修改不报错，但不推荐。若需修改，则把 <code>props</code> 内容拷贝一份到 <code>data</code> 进行修改</li></ul><p><strong><em>父传子：</em></strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 若 props 属性使用驼峰命名法，可使用驼峰形式或短横线分隔形式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">:num</span>=<span class="string">&quot;count&quot;</span> <span class="attr">:msg</span>=<span class="string">&quot;message&quot;</span> <span class="attr">:pub-time</span>=<span class="string">&quot;time&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>父组件传过来的值：&#123;&#123; num &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>父组件传过来的值：&#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组形式</span></span><br><span class="line"><span class="attr">props</span>: [<span class="string">&#x27;num&#x27;</span>, <span class="string">&#x27;msg&#x27;</span>, <span class="string">&#x27;pubTime&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 仅限制类型</span></span><br><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">  <span class="attr">num</span>: <span class="title class_">Number</span>,</span><br><span class="line">  <span class="attr">msg</span>: <span class="title class_">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象形式</span></span><br><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">  <span class="attr">num</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">default</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">msg</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: [<span class="title class_">String</span>, <span class="title class_">Number</span>],</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="title function_">validator</span>(<span class="params">value</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> value === <span class="string">&#x27;hello&#x27;</span> || value === <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">default</span>: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><em>子传父：</em></strong></p><ul><li>父组件通过 <code>props</code> 给子组件传递函数，子组件调用该函数即可修改父组件的数据</li><li>组件 <code>methods</code> 里函数的 this 始终指向该组件实例，可理解为 Vue 底层对这些函数做了<code>bind</code>处理</li><li>通过<code>bind</code>修改 this 指向后的新函数，其 this 指向不能再次修改。<a href="https://v2.cn.vuejs.org/v2/api/#methods">官网说明</a></li><li><a href="https://segmentfault.com/q/1010000015951625">思否文章</a></li><li>不推荐该方式进行子传父，推荐使用自定义事件</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">:addCount</span>=<span class="string">&quot;addCount&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">addCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: [<span class="string">&#x27;addCount&#x27;</span>],</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">add</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">addCount</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a>自定义事件</h3><blockquote><p>自定义事件可用于实现子传父</p></blockquote><p>子组件触发自定义事件，并传递数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">add</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span> += <span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.$emit(<span class="string">&#x27;count-change&#x27;</span>, <span class="variable language_">this</span>.<span class="property">count</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>父组件监听子组件的自定义事件，并调用回调函数处理数据：</p><ul><li>父组件通过 <code>this.$refs.xxx.$on(&#39;事件名称&#39;,回调)</code> 监听子组件自定义事件时，回调函数要么配置在 <code>methods</code> 中，要么用箭头函数，否则 this 指向会出问题</li><li>组件上也可以绑定原生 DOM 事件，需要使用 <code>native</code> 修饰符</li><li>若想让自定义事件只触发一次，可以使用 <code>once</code> 修饰符，或 <code>$once</code> 方法</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 方式一 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> @<span class="attr">count-change</span>=<span class="string">&quot;getNewCount&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> @<span class="attr">count-change.once</span>=<span class="string">&quot;getNewCount&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 方式二 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">ref</span>=<span class="string">&quot;sonRef&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 监听子组件原生 DOM 事件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> @<span class="attr">click.native</span>=<span class="string">&quot;handleClick&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">father</span>: <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">getNewCount</span>(<span class="params">val</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">father</span> = val</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 方式二</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">sonRef</span>.$on(<span class="string">&#x27;count-change&#x27;</span>, <span class="variable language_">this</span>.<span class="property">getNewCount</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">sonRef</span>.$once(<span class="string">&#x27;count-change&#x27;</span>, <span class="variable language_">this</span>.<span class="property">getNewCount</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 或</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">sonRef</span>.$on(<span class="string">&#x27;count-change&#x27;</span>, <span class="function">(<span class="params">val</span>) =&gt;</span> (<span class="variable language_">this</span>.<span class="property">father</span> = val))</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解绑自定义事件<code>this.$off()</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解绑单个自定义事件</span></span><br><span class="line"><span class="variable language_">this</span>.$off(<span class="string">&#x27;count-change&#x27;</span>)</span><br><span class="line"><span class="comment">// 解绑多个自定义事件</span></span><br><span class="line"><span class="variable language_">this</span>.$off([<span class="string">&#x27;count-change&#x27;</span>, <span class="string">&#x27;add&#x27;</span>])</span><br><span class="line"><span class="comment">// 解绑所有自定义事件</span></span><br><span class="line"><span class="variable language_">this</span>.$off()</span><br></pre></td></tr></table></figure><h3 id="EventBus-全局事件总线"><a href="#EventBus-全局事件总线" class="headerlink" title="EventBus 全局事件总线"></a>EventBus 全局事件总线</h3><p>:::tip 思想<br>弄一个所有组件实例都能访问到的 Vue 实例对象，Vue 原型上包含事件处理的相关方法，包括 <code>$on, $emit, $off, $once</code><br>:::</p><p><strong><em>方式一</em></strong></p><p>安装全局事件总线：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$bus</span> = <span class="variable language_">this</span></span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>数据接收方为自定义事件绑定回调函数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handleData</span>(<span class="params"></span>) &#123;...&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$bus</span>.$on(<span class="string">&#x27;share&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleData</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 组件销毁，解绑事件</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$bus</span>.$off(<span class="string">&#x27;share&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>数据发送方触发自定义事件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">sendData</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$bus</span>.$emit(<span class="string">&#x27;share&#x27;</span>, <span class="number">666</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><em>方式二</em></strong></p><p>创建 eventBus.js 模块，并向外共享一个 Vue 的实例对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eventBus.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vue</span>()</span><br></pre></td></tr></table></figure><p>在数据发送方，调用 <code>bus.$emit(&#39;事件名称&#39;, 要发送的数据)</code> 方法触发自定义事件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据发送方</span></span><br><span class="line"><span class="keyword">import</span> bus <span class="keyword">from</span> <span class="string">&#x27;./eventBus.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">sendData</span>(<span class="params"></span>) &#123;</span><br><span class="line">      bus.$emit(<span class="string">&#x27;share&#x27;</span>, <span class="variable language_">this</span>.<span class="property">message</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在数据接收方，通过 <code>bus.$on(&#39;事件名称&#39;, 事件处理函数)</code> 为自定义事件注册事件处理函数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据接收方</span></span><br><span class="line"><span class="keyword">import</span> bus <span class="keyword">from</span> <span class="string">&#x27;./eventBus.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">msg</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 细节1：在 created 钩子中注册函数</span></span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 细节2：使用箭头函数，则 this 指向该组件而非 bus</span></span><br><span class="line">    bus.$on(<span class="string">&#x27;share&#x27;</span>, <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">msg</span> = val</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="消息订阅与发布"><a href="#消息订阅与发布" class="headerlink" title="消息订阅与发布"></a>消息订阅与发布</h3><p>:::tip<br>与全局事件总线很相似，因此一般用事件总线，不用这个<br>:::</p><p>安装第三方库 <code>PubSubJS</code> ：<code>npm install -S pubsub.js</code></p><p>订阅消息：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pubsub <span class="keyword">from</span> <span class="string">&#x27;pubsub-js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handleData</span>(<span class="params">messageName, data</span>) &#123;...&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pubId</span> = pubsub.<span class="title function_">subscribe</span>(<span class="string">&#x27;share&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleData</span>)</span><br><span class="line">    <span class="comment">// or</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pubId</span> = pubsub.<span class="title function_">subscribe</span>(<span class="string">&#x27;share&#x27;</span>, <span class="function">(<span class="params">messageName, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 组件销毁，取消订阅</span></span><br><span class="line">    pubsub.<span class="title function_">unsubscribe</span>(<span class="variable language_">this</span>.<span class="property">pubId</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发布消息：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pubsub <span class="keyword">from</span> <span class="string">&#x27;pubsub-js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">sendData</span>(<span class="params"></span>) &#123;</span><br><span class="line">      pubsub.<span class="title function_">publish</span>(<span class="string">&#x27;share&#x27;</span>, <span class="number">666</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ref-refs"><a href="#ref-refs" class="headerlink" title="ref &#x2F; $refs"></a>ref &#x2F; $refs</h3><p><code>ref</code> 用于给 DOM 元素或子组件注册引用信息。每个 vue 实例都有 <code>$refs</code> 对象，里面存储着 DOM 元素或子组件的引用。通过该方式可以获取到 DOM 元素或子组件实例。</p><blockquote><p>可以父传子，也能子传父。子传父要和自定义事件搭配使用。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引用 DOM 元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">ref</span>=<span class="string">&quot;pp&quot;</span>&gt;</span>这是段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;getRef&quot;</span>&gt;</span>获取 DOM 元素<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 引用子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">son</span> <span class="attr">ref</span>=<span class="string">&quot;sonRef&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">son</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;getComponent&quot;</span>&gt;</span>获取子组件实例引用<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">getRef</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 获取元素的引用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">pp</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">pp</span>.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">getComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">sonRef</span>)</span><br><span class="line">    <span class="comment">// 可以访问子组件的数据和方法</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">sonRef</span>.<span class="property">count</span> = <span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">sonRef</span>.<span class="title function_">add</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>组件的 <code>$nextTick(cb)</code> 方法，会把 cb 回调推迟到下一个 DOM 更新周期之后执行，即在 DOM 更新完成后再执行回调，从而保证 cb 回调可以获取最新的 DOM 元素。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">showInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">inputVisible</span> = <span class="literal">true</span></span><br><span class="line">    <span class="comment">// 对输入框的操作推迟到 DOM 更新完成之后</span></span><br><span class="line">    <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">input</span>.<span class="title function_">focus</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue组件化编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 核心基础</title>
      <link href="/2023/09/06/vue_core_basis/"/>
      <url>/2023/09/06/vue_core_basis/</url>
      
        <content type="html"><![CDATA[<p><a href="https://v2.cn.vuejs.org/">官网传送门</a></p><h1 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h1><p>Vue 是动态构建用户界面的渐进式 JavaScript 框架 <br><br>Vue 借鉴 Angular 的模板和数据绑定技术，React 的组件化和虚拟 DOM 技术</p><h2 id="数据代理"><a href="#数据代理" class="headerlink" title="数据代理"></a>数据代理</h2><h3 id="Object-defineProperty-的使用"><a href="#Object-defineProperty-的使用" class="headerlink" title="Object.defineProperty() 的使用"></a><code>Object.defineProperty()</code> 的使用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Vue&#x27;</span>,</span><br><span class="line">  <span class="attr">sex</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> number = <span class="number">19</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置一</span></span><br><span class="line"><span class="comment">// 参数：对象、属性名、配置</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(person, <span class="string">&#x27;age&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">// 属性值</span></span><br><span class="line">  <span class="attr">value</span>: <span class="number">21</span>,</span><br><span class="line">  <span class="comment">// 属性是否可修改</span></span><br><span class="line">  <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 属性是否可枚举（遍历）</span></span><br><span class="line">  <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 属性是否可删除</span></span><br><span class="line">  <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(person)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置二</span></span><br><span class="line"><span class="comment">// getter、setter 不能和 value、writable 同时指定</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(person, <span class="string">&#x27;age&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">enumberable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;age 属性被读取&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> number</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">set</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;age 属性被修改&#x27;</span>, value)</span><br><span class="line">    number = value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="何为数据代理"><a href="#何为数据代理" class="headerlink" title="何为数据代理"></a>何为数据代理</h3><p>数据代理：通过一个对象对另一个对象的属性进行操作</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: <span class="number">21</span> &#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123; <span class="attr">b</span>: <span class="number">10</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj2, <span class="string">&#x27;a&#x27;</span>, &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> obj.<span class="property">a</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">set</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    obj.<span class="property">a</span> = value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">obj2.<span class="property">a</span> <span class="comment">// 21</span></span><br><span class="line">obj2.<span class="property">a</span> = <span class="number">1000</span></span><br><span class="line">obj.<span class="property">a</span> <span class="comment">// 1000</span></span><br></pre></td></tr></table></figure><h3 id="Vue-中的数据代理"><a href="#Vue-中的数据代理" class="headerlink" title="Vue 中的数据代理"></a>Vue 中的数据代理</h3><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86.png" alt="数据代理"></p><p>Vue 中通过 vm 实例对象代理对 data 对象属性的操作，让我们更方便操作 data 中的数据。</p><p>data 中的数据实际上被存在 <code>vm._data</code> 属性上，如果不进行代理，使用起来很不方便。</p><p>通过 <code>Object.defineProperty()</code> 给 vm 添加属性，并且指定 getter 和 setter，通过 getter 和 setter 访问和修改 data 对应是属性。</p><h2 id="Vue-监测数据的原理"><a href="#Vue-监测数据的原理" class="headerlink" title="Vue 监测数据的原理"></a>Vue 监测数据的原理</h2><p>:::info 监测数据<br>监测数据，即 Vue 是如何监听数据发生变化，从而重新解析模板渲染页面的。Vue 会监测 data 中所有层级的数据。<br>:::</p><h3 id="Vue-监测对象数据"><a href="#Vue-监测对象数据" class="headerlink" title="Vue 监测对象数据"></a>Vue 监测对象数据</h3><ul><li>原理：通过 <code>Object.defineProperty()</code> 为属性添加 <code>getter</code>、<code>setter</code> ，对属性的读取、修改进行拦截，即数据劫持</li><li>存在问题：<ul><li>对象新增加的属性，默认不做响应式处理</li><li>对象删除属性，也不是响应式的</li></ul></li><li>解决办法，使用如下 <a href="https://v2.cn.vuejs.org/v2/api/#Vue-set">API</a> ：<ul><li><code>Vue.set(target, propertyName/index, value)</code></li><li><code>vm.$set(target, propertyName/index, value)</code></li><li><code>Vue.delete(target, propertyName/index)</code></li><li><code>vm.$delete(target, propertyName/index)</code></li></ul></li><li><code>Vue.set()</code> 和 <code>vm.$set()</code> 不能给 vm 或 vm 的根数据对象添加属性（即 data）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简单模拟实现对象的数据监测，Vue 更完善</span></span><br><span class="line"><span class="comment">// Vue 通过 vm.name 即可修改</span></span><br><span class="line"><span class="comment">// Vue 实现深层监听</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Vue&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">99</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Observer</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)</span><br><span class="line"></span><br><span class="line">  keys.<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="variable language_">this</span>, key, &#123;</span><br><span class="line">      <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> obj[key]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">set</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据被修改，重新解析模板...&#x27;</span>)</span><br><span class="line">        obj[key] = value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> vm = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> observer = <span class="keyword">new</span> <span class="title class_">Observer</span>(person)</span><br><span class="line">vm.<span class="property">_data</span> = observer</span><br></pre></td></tr></table></figure><h3 id="Vue-监测数组"><a href="#Vue-监测数组" class="headerlink" title="Vue 监测数组"></a>Vue 监测数组</h3><ul><li>原理：通过重写数组的 API 实现拦截：<code>push()、pop()、shift()、unshift()、splice()、sort()、reverse()</code></li><li>7 个 API 之所以是响应式的，是因为 Vue 对这些方法进行了<a href="https://v2.cn.vuejs.org/v2/guide/list.html#%E6%95%B0%E7%BB%84%E6%9B%B4%E6%96%B0%E6%A3%80%E6%B5%8B">包裹</a>，即二次封装。做了两件事：调用对应的原生方法更新数组 &amp; 重新解析模板更新页面</li><li>存在问题：<ul><li>直接通过数组下标修改是<a href="https://v2.cn.vuejs.org/v2/guide/reactivity.html#%E5%AF%B9%E4%BA%8E%E6%95%B0%E7%BB%84">非响应式的</a></li></ul></li><li>解决办法：<ul><li>使用 7 个 API 修改数组</li><li><code>Vue.set()</code>、<code>vm.$set()</code></li><li><code>Vue.delete()</code>、<code>vm.$delete()</code></li></ul></li></ul><p><a href="https://segmentfault.com/a/1190000015783546">思否文章</a>{link&#x3D;card}</p><h2 id="插值语法"><a href="#插值语法" class="headerlink" title="插值语法"></a>插值语法</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：&#123;&#123; username &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>密码&#123;&#123; password &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#123;&#123;&#125;&#125; 支持简 JS 表达式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; flag ? 111 : 000&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;docsify&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="number">55520</span>,</span><br><span class="line">    <span class="attr">flag</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="属性绑定指令-v-bind"><a href="#属性绑定指令-v-bind" class="headerlink" title="属性绑定指令 v-bind"></a>属性绑定指令 v-bind</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-bind:placeholder</span>=<span class="string">&quot;desc&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- v-bind 简写形式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">&quot;url&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;这是一张图片&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- v-bind 支持 JS 表达式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:id</span>=<span class="string">&quot;&#x27;hello&#x27; + 1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">desc</span>: <span class="string">&#x27;请输入用户名&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;www.baidu.com&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="双向绑定指令-v-model"><a href="#双向绑定指令-v-model" class="headerlink" title="双向绑定指令 v-model"></a>双向绑定指令 v-model</h2><p><code>v-model</code> 用于表单元素如 <code>input</code>，<code>textarea</code>，<code>select</code> 。</p><h3 id="v-model-基础用法"><a href="#v-model-基础用法" class="headerlink" title="v-model 基础用法"></a>v-model 基础用法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; username &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model:value</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; province &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">&quot;province&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>请选择<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>广州<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="v-model-指令修饰符"><a href="#v-model-指令修饰符" class="headerlink" title="v-model 指令修饰符"></a>v-model 指令修饰符</h3><table><thead><tr><th>修饰符</th><th>作用</th><th>示例</th></tr></thead><tbody><tr><td>.number</td><td>将用户输入转为数值类型</td><td><code>&lt;input v-model.number=&quot;age&quot; /&gt;</code></td></tr><tr><td>.trim</td><td>删除输入的首尾空白字符</td><td><code>&lt;input v-model.trim=&quot;msg&quot;&gt;</code></td></tr><tr><td>.lazy</td><td>当失去焦点时，才更新数据，类似防抖</td><td><code>&lt;input v-model.lazy=&quot;msg&quot;&gt;</code></td></tr></tbody></table><h3 id="v-model-收集表单数据"><a href="#v-model-收集表单数据" class="headerlink" title="v-model 收集表单数据"></a>v-model 收集表单数据</h3><ul><li><code>&lt;input type=&quot;text&quot;/&gt;</code> ，收集的是 <code>value</code> 值，用户输入的就是 <code>value</code> 值。</li><li><code>&lt;input type=&quot;radio&quot;/&gt;</code> ，收集的是 <code>value</code> 值，且要给标签配置 <code>value</code> 值。</li><li><code>&lt;input type=&quot;checkbox&quot;/&gt;</code><ul><li>没有配置 <code>value</code> 属性，收集的就是 <code>checked</code></li><li>配置了 <code>value</code> 属性:<ul><li><code>v-model</code> 的初始值是非数组，那么收集的就是 <code>checked</code></li><li><code>v-model</code> 的初始值是数组，那么收集的的就是 <code>value</code> 组成的数组</li></ul></li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">    账号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model.trim</span>=<span class="string">&quot;userInfo.account&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.password&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    年龄：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model.number</span>=<span class="string">&quot;userInfo.age&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    性别： 男<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;male&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    女<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;female&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    爱好： 学习<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;study&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    打游戏<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;game&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    吃饭<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;eat&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    所属校区</span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.city&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>请选择校区<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;beijing&quot;</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;shanghai&quot;</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;shenzhen&quot;</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;wuhan&quot;</span>&gt;</span>武汉<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    其他信息：</span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">v-model.lazy</span>=<span class="string">&quot;userInfo.other&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.agree&quot;</span> /&gt;</span>阅读接受协议</span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">userInfo</span>:&#123;</span><br><span class="line">      <span class="attr">account</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      <span class="attr">password</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      <span class="attr">age</span>:<span class="number">18</span>,</span><br><span class="line">      <span class="attr">sex</span>:<span class="string">&#x27;female&#x27;</span>,</span><br><span class="line">      <span class="attr">hobby</span>:[],</span><br><span class="line">      <span class="attr">city</span>:<span class="string">&#x27;beijing&#x27;</span>,</span><br><span class="line">      <span class="attr">other</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      <span class="attr">agree</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">demo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">userInfo</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="事件绑定指令-v-on"><a href="#事件绑定指令-v-on" class="headerlink" title="事件绑定指令 v-on"></a>事件绑定指令 v-on</h2><h3 id="v-on-基础用法"><a href="#v-on-基础用法" class="headerlink" title="v-on 基础用法"></a>v-on 基础用法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>count的值：&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;add&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- v-on 缩写形式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;add&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">add</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="事件参数对象"><a href="#事件参数对象" class="headerlink" title="事件参数对象"></a>事件参数对象</h3><p>如果事件处理函数没有传参，则默认会传一个时间参数对象 <code>$event</code> ，通过它可以获取触发事件的元素，并进行相关操作。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">add</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    e.<span class="property">target</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果事件处理函数传递参数了，则默认的 <code>$event</code> 会被覆盖，需要手动进行传递。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;add(2, $event)&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">add</span>(<span class="params">step, e</span>) &#123;</span><br><span class="line">    e.<span class="property">target</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">count</span> += step</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="事件修饰符"><a href="#事件修饰符" class="headerlink" title="事件修饰符"></a>事件修饰符</h3><table><thead><tr><th>事件修饰符</th><th>说明</th></tr></thead><tbody><tr><td><strong>.prevent</strong></td><td>阻止默认行为，如 a 链接跳转、表单提交</td></tr><tr><td><strong>.stop</strong></td><td>阻止事件冒泡</td></tr><tr><td>.once</td><td>绑定的事件只触发 1 次</td></tr><tr><td>.capture</td><td>以捕获模式触发事件处理函数</td></tr><tr><td>.self</td><td>只有在 <code>event.target</code> 是当前元素自身时触发事件处理函数</td></tr><tr><td>.passive</td><td>事件的默认行为立即执行，无需等待事件回调执行完毕</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;www.baidu.com&quot;</span> @<span class="attr">click.prevent</span>=<span class="string">&quot;fn&quot;</span>&gt;</span>阻止链接跳转<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> @<span class="attr">click.stop</span>=<span class="string">&quot;handleClick&quot;</span>&gt;</span>阻止事件冒泡<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- .passive ：如 `onwheel` 鼠标滚轮事件，是先执行事件的回调再进行滚动。 --&gt;</span></span><br><span class="line"></span><br><span class="line">如果回调比较耗时，那么会等一段时间才发生滚动。 添加 .passive 后，则先进行滚动再执行回调。</span><br></pre></td></tr></table></figure><h3 id="按键修饰符"><a href="#按键修饰符" class="headerlink" title="按键修饰符"></a>按键修饰符</h3><ol><li>Vue 中常用的按键别名：</li></ol><ul><li>回车 &#x3D;&gt; enter</li><li>删除 &#x3D;&gt; delete (捕获“删除”和“退格”键)</li><li>退出 &#x3D;&gt; esc</li><li>空格 &#x3D;&gt; space</li><li>换行 &#x3D;&gt; tab (特殊，必须配合 keydown 去使用)</li><li>上 &#x3D;&gt; up</li><li>下 &#x3D;&gt; down</li><li>左 &#x3D;&gt; left</li><li>右 &#x3D;&gt; right</li></ul><ol start="2"><li><p>Vue 未提供别名的按键，可以使用按键原始的 <code>key</code> 值去绑定，但注意要转为 kebab-case（短横线命名）</p></li><li><p>系统修饰键（用法特殊）：ctrl、alt、shift、meta（即 win 键）</p></li></ol><ul><li>配合 keyup 使用：按下修饰键的同时，再按下其他键，随后释放其他键，事件才被触发。</li><li>配合 keydown 使用：正常触发事件。</li></ul><ol start="4"><li><p>可使用 keyCode 去指定具体的按键，此法不推荐，因为 keyCode 以后可能废除</p></li><li><p><code>Vue.config.keyCodes.自定义键名 = 键码</code> ，可以去定制按键别名</p></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keyup.esc</span>=<span class="string">&quot;back&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keydown.tab</span>=<span class="string">&quot;showInfo&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keyup.caps-lock</span>=<span class="string">&quot;showInfo&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keyup.huiche</span>=<span class="string">&quot;showInfo&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keyup.13</span>=<span class="string">&quot;showInfo&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  Vue.config.keyCodes.huiche = 13</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="条件渲染指令"><a href="#条件渲染指令" class="headerlink" title="条件渲染指令"></a>条件渲染指令</h2><h3 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">&quot;status === 200&quot;</span>&gt;</span>success<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else-if</span>=<span class="string">&quot;status === 201&quot;</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span>&gt;</span>yyy<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-show</span>=<span class="string">&quot;status === 404&quot;</span>&gt;</span>error<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- template 只能和 v-if 搭配使用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;status === 200&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>222<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>333<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="v-if-和-v-show-的区别"><a href="#v-if-和-v-show-的区别" class="headerlink" title="v-if 和 v-show 的区别"></a>v-if 和 v-show 的区别</h3><p>实现原理不同：</p><ul><li><code>v-if</code> 通过创建或删除 DOM 元素来控制元素的显示与隐藏</li><li><code>v-show</code> 通过添加或删除元素的 <code>style=&quot;display: none&quot;</code> 样式来控制元素的显示与隐藏</li></ul><p>性能消耗不同：</p><ul><li><code>v-if</code> 切换开销更高，如果运行时条件很少改变，使用 <code>v-if</code> 更好</li><li><code>v-show</code> 初始渲染开销更高，如果切换频繁，使用 <code>v-show</code> 更好</li></ul><h2 id="列表渲染指令-v-for"><a href="#列表渲染指令-v-for" class="headerlink" title="列表渲染指令 v-for"></a>列表渲染指令 v-for</h2><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 遍历数组 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 遍历对象 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(value, key) in obj&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;key&quot;</span>&gt;</span>&#123;&#123; key &#125;&#125; - &#123;&#123; value &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 遍历字符串 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(char, index) in str&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span>&#123;&#123; index &#125;&#125; - &#123;&#123; char &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 遍历次数 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(number, index) in 5&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span>&#123;&#123; index &#125;&#125; - &#123;&#123; number &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">list</span>: [...],</span><br><span class="line">    <span class="attr">obj</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;Bruce&#x27;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">88</span>,</span><br><span class="line">      <span class="attr">sex</span>: <span class="string">&#x27;unknown&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">str</span>: <span class="string">&#x27;hello vue&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="key-的作用"><a href="#key-的作用" class="headerlink" title="key 的作用"></a><code>key</code> 的作用</h3><p><strong><code>key</code> 的作用：</strong></p><ul><li>当列表的数据变化时，默认情况下，vue 会尽可能的复用已存在的 DOM 元素，从而提升渲染的性能。但这种默认的性能优化策略，会导致有状态的列表无法被正确更新。</li><li>为了给 vue 一个提示，以便它能跟踪每个节点的身份，从而在保证有状态的列表被正确更新的前提下，提升渲染的性能。此时，需要为每项提供一个唯一的 key 属性。</li><li><code>key</code> 是虚拟 DOM 对象的标识，可提高页面更新渲染的效率。当数据变化时，Vue 会根据新数据生成新的虚拟 DOM，随后进行新旧虚拟 DOM 的差异比较</li></ul><p><strong>比较规则</strong></p><ul><li>旧虚拟 DOM 找到和新虚拟 DOM 相同的 key：<ul><li>若内容没变，直接复用真实 DOM</li><li>若内容改变，生成新的真实 DOM，替换旧的真实 DOM</li></ul></li><li>旧虚拟 DOM 未找到和新虚拟 DOM 相同的 key：创建新的真实 DOM，渲染到页面</li></ul><p><strong><code>key</code> 的注意事项：</strong></p><ul><li>key 的值只能是<strong>字符串</strong>或<strong>数字</strong>类型</li><li>key 的值必须具有唯一性（即：key 的值不能重复）</li><li>建议把数据项 id 属性的值作为 key 的值（因为 id 属性的值具有唯一性）</li><li>使用 index 的值当作 key 的值没有意义（因为 index 的值不具有唯一性）</li><li>建议使用 v-for 指令时一定要指定 key 的值（既提升性能、又防止列表状态紊乱）</li></ul><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/key.png" alt="key的作用"></p><h2 id="其它内置指令"><a href="#其它内置指令" class="headerlink" title="其它内置指令"></a>其它内置指令</h2><h3 id="v-text"><a href="#v-text" class="headerlink" title="v-text"></a>v-text</h3><p><code>v-text</code> 指令会覆盖元素默认值。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-text</span>=<span class="string">&quot;username&quot;</span>&gt;</span>这段内容会被覆盖<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> &#123; <span class="attr">username</span>: <span class="string">&quot;Bruce&quot;</span> &#125; &#125;</span><br></pre></td></tr></table></figure><h3 id="v-html"><a href="#v-html" class="headerlink" title="v-html"></a>v-html</h3><p>:::warning 安全问题<br>v-html 存在安全问题，容易导致 XSS 攻击<br>:::</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-html</span>=<span class="string">&quot;desc&quot;</span>&gt;</span>原本内容被覆盖<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">desc</span>: <span class="string">&#x27;&lt;h1 style=&quot;color: red&quot;&gt;红色标题&lt;/h1&gt;&#x27;</span>，</span><br><span class="line">    <span class="attr">str</span>: <span class="string">&#x27;&lt;a href=&quot;http://www.baidu.com?&quot;+document.cookie&gt;兄弟我找到你想要的资源了，快来！&lt;/a&gt;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="v-cloak"><a href="#v-cloak" class="headerlink" title="v-cloak"></a>v-cloak</h3><ul><li>本质是一个特殊属性，Vue 实例创建完毕并接管容器后，会删除 <code>v-cloak</code> 属性</li><li>使用 CSS 配合 <code>v-cloak</code> 可解决网速慢时页面展示  的问题</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[v-cloak]</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-cloak</span>&gt;</span>&#123;&#123; username &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="v-once"><a href="#v-once" class="headerlink" title="v-once"></a>v-once</h3><ul><li><code>v-once</code> 所在节点初次渲染后就成为静态内容</li><li>即数据变化不会引起 <code>v-once</code> 所在节点内容的更新，可用于优化性能</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-once</span>&gt;</span>初次的内容：&#123;&#123; content &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>最新的内容：&#123;&#123; content &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="v-pre"><a href="#v-pre" class="headerlink" title="v-pre"></a>v-pre</h3><ul><li>跳过所在节点的编译过程</li><li>没有使用插值语法等特殊语法的节点，可用其跳过编译过程，加快编译</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-pre</span>&gt;</span>Vue 内置指令<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：&#123;&#123; username &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><ul><li>过滤器常用于文本的格式化，可用在插值表达式和 <code>v-bind</code> 属性绑定。</li><li>过滤器只在 <code>vue 2.x</code> 和 <code>vue 1.x</code> 中支持，<code>vue 3.x</code> 废弃了过滤器，官方建议使用计算属性或方法代替过滤器。</li></ul><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在 JS 表达式尾部通过管道符进行调用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; message | capitalize &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:id</span>=<span class="string">&quot;rawId | formatId&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义私有过滤器</span></span><br><span class="line"><span class="attr">filters</span>: &#123;</span><br><span class="line">  <span class="title function_">capitalize</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> str.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + str.<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 main.js 中定义全局过滤器</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(<span class="string">&#x27;capitalize&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> str.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + str.<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>如果私有过滤器和全局过滤器冲突，按照就近原则调用私有过滤器。</p><h3 id="连续调用多个过滤器"><a href="#连续调用多个过滤器" class="headerlink" title="连续调用多个过滤器"></a>连续调用多个过滤器</h3><p>过滤器从左往右调用，前一个过滤器的结果交给下一个过滤器继续处理。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; text | capitalize | maxLength &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="过滤器传参"><a href="#过滤器传参" class="headerlink" title="过滤器传参"></a>过滤器传参</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; message | myFilter(arg1, arg2) &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个参数永远都是管道符前的值</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(<span class="string">&#x27;myFilter&#x27;</span>, <span class="function">(<span class="params">value, arg1, arg2</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="computed-计算属性"><a href="#computed-计算属性" class="headerlink" title="computed 计算属性"></a>computed 计算属性</h2><ul><li>定义：使用的属性不存在，要通过已有属性计算得到</li><li>原理：底层使用了 <code>Object.defineProperty()</code> 提供的 getter 和 setter</li><li>getter 何时执行：<ul><li>初次读取时执行一次</li><li>依赖的数据发生改变时执行</li></ul></li><li>优点：与 <code>methods</code> 相比，有缓存机制，效率更高</li><li>若计算属性要修改，必须声明 setter 响应修改，且 setter 中要引起依赖的数据发生改变</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; fullName &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 完整写法</span></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  <span class="attr">fullName</span>: &#123;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 计算属性依赖于已有属性得到</span></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">firstName</span> + <span class="string">&#x27;-&#x27;</span> + <span class="variable language_">this</span>.<span class="property">lastName</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">set</span>(<span class="params">value</span>) &#123;</span><br><span class="line">      <span class="comment">// setter 中要引起依赖数据的变化</span></span><br><span class="line">      <span class="keyword">const</span> arr = value.<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">firstName</span> = arr[<span class="number">0</span>]</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">lastName</span> = arr[<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简写形式</span></span><br><span class="line"><span class="comment">// 只有明确计算属性不需要被修改时，才能用简写形式，即没有 setter</span></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  <span class="title function_">fullName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">firstName</span> + <span class="variable language_">this</span>.<span class="property">lastName</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="watch-侦听器"><a href="#watch-侦听器" class="headerlink" title="watch 侦听器"></a>watch 侦听器</h2><p><code>watch</code> 侦听器允许开发者监视数据的变化，针对数据的变化做特定的操作。</p><p>:::tip watch vs computed<br>侦听器可以监听普通属性和计算属性</p><p><code>computed</code> 能完成的功能，<code>watch</code> 也能</p><p><code>watch</code> 能完成的功能，<code>computed</code> 不一定，如异步操作<br>:::</p><ul><li>Vue 管理的函数写成普通函数，使其 <code>this</code> 指向 vue 实例对象</li><li>不被 Vue 管理的函数写成箭头函数（定时器回调、<code>ajax</code> 回调、<code>Promise</code> 回调），这样其 <code>this</code> 才是 vue 实例对象</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// watch 简写形式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="title function_">username</span>(<span class="params">newVal, oldVal</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;新值: &#x27;</span>, newVal)</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;旧值: &#x27;</span>, oldVal)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>默认情况下，组件在初次加载完毕后不会调用 <code>watch</code> 侦听器。如果想让 <code>watch</code> 侦听器立即被调用，需要使用 <code>immediate</code> 选项：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">  <span class="comment">// 对象形式的侦听器</span></span><br><span class="line">  <span class="attr">username</span>: &#123;</span><br><span class="line">    <span class="comment">// handler 属性是固定写法</span></span><br><span class="line">    <span class="title function_">handler</span>(<span class="params">newVal, oldVal</span>) &#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">immediate</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当 <code>watch</code> 侦听的是一个对象，如果对象中的属性值发生了变化，则无法被监听到。此时需要使用 <code>deep</code> 选项进行<strong>深度监听</strong>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">info</span>: &#123; <span class="attr">username</span>: <span class="string">&#x27;admin&#x27;</span> &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="attr">info</span>: &#123;</span><br><span class="line">      <span class="title function_">handler</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(newVal)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">deep</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>若只想监听对象里单个属性的变化，代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">info</span>: &#123; <span class="attr">username</span>: <span class="string">&#x27;admin&#x27;</span> &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="comment">// 记得加引号</span></span><br><span class="line">    <span class="string">&#x27;info.username&#x27;</span>: &#123;</span><br><span class="line">      <span class="title function_">handler</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(newVal)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过 Vue 实例的 <code>$watch</code> 监听：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;...&#125;)</span><br><span class="line"></span><br><span class="line">vm.$watch(<span class="string">&#x27;isHot&#x27;</span>,&#123;</span><br><span class="line">  <span class="attr">immediate</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">deep</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="title function_">handler</span>(<span class="params">newValue,oldValue</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(newValue, oldValue)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">vm.$watch(<span class="string">&#x27;isHot&#x27;</span>,<span class="keyword">function</span>(<span class="params">newValue,oldValue</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(newValue, oldValue)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="动态绑定-class-和-style"><a href="#动态绑定-class-和-style" class="headerlink" title="动态绑定 class 和 style"></a>动态绑定 class 和 style</h2><p>通过动态绑定 <code>class</code> 属性和行内 <code>style</code> 样式，可动态操作元素样式。</p><h3 id="动态绑定-class-类名"><a href="#动态绑定-class-类名" class="headerlink" title="动态绑定 class 类名"></a>动态绑定 class 类名</h3><ul><li>字符串写法：类名不确定，要动态获取</li><li>对象写法：要绑定多个样式，个数不确定，名字也不确定</li><li>数组写法：要绑定多个样式，个数确定，名字也确定，但不确定用不用</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  <span class="selector-class">.happy</span> &#123;</span><br><span class="line">    ...;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.sad</span> &#123;</span><br><span class="line">    ...;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;basic&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;mood&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;changeMood&quot;</span>&gt;</span>字符串写法<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;basic&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;arr&quot;</span>&gt;</span>数组写法<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;basic&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;classObj&quot;</span>&gt;</span>对象写法<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">mood</span>: <span class="string">&#x27;happy&#x27;</span>,</span><br><span class="line">      <span class="attr">arr</span>: [<span class="string">&#x27;happy&#x27;</span>, <span class="string">&#x27;sad&#x27;</span>],</span><br><span class="line">      <span class="attr">classObj</span>: &#123;</span><br><span class="line">        <span class="attr">happy</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">sad</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">changeMood</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">mood</span> = <span class="string">&#x27;sad&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="动态绑定-style-样式"><a href="#动态绑定-style-样式" class="headerlink" title="动态绑定 style 样式"></a>动态绑定 style 样式</h3><p><code>css</code> 属性名既可以用驼峰形式，也能用短横线形式（需要使用引号括起来）。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;color: active, fontSize: fsize + &#x27;px&#x27;, &#x27;background-color&#x27;: bgcolor&#125;&quot;</span>&gt;</span>对象写法<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;styleObj&quot;</span>&gt;</span>对象写法<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;[styleObj, styleObj2]&quot;</span>&gt;</span>数组写法（用得少）<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">active</span>: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">    <span class="attr">fsize</span>: <span class="number">30</span>,</span><br><span class="line">    <span class="attr">bgcolor</span>: <span class="string">&#x27;yellow&#x27;</span>,</span><br><span class="line">    <span class="attr">styleObj</span>: &#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&#x27;active&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;font-size&#x27;</span>: <span class="string">&#x27;20px&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">styleObj2</span>: &#123;</span><br><span class="line">      <span class="attr">backgroundColor</span>: <span class="string">&#x27;yellow&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="vue-生命周期"><a href="#vue-生命周期" class="headerlink" title="vue 生命周期"></a>vue 生命周期</h2><p>vue 生命周期是指一个组件从创建、运行、销毁的整个过程。每个阶段对应着不同的生命周期钩子。</p><p>生命周期钩子也可理解为：Vue 在特定的时刻调用特定的函数。</p><p>除了图中 8 个钩子，还有 <code>nextTick</code>，<code>activated</code>，<code>deactivated</code></p><p>关于销毁过程：</p><ul><li>销毁后借助 Vue 开发者工具看不到任何信息。</li><li>销毁后自定义事件会失效，但原生 DOM 事件依然有效。</li><li>一般不在 <code>beforeDestroy</code> 操作数据，因为即便操作数据，也不会再触发更新流程</li></ul><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/lifecycle2.png" alt="生命周期图2"><br><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/lifecycle.png" alt="生命周期图"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue核心基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS 模块化</title>
      <link href="/2023/09/06/js_modules/"/>
      <url>/2023/09/06/js_modules/</url>
      
        <content type="html"><![CDATA[<h2 id="模块化概念"><a href="#模块化概念" class="headerlink" title="模块化概念"></a>模块化概念</h2><ul><li>模块化是指解决一个复杂问题时，自顶向下逐层把系统划分为若干模块的过程，模块是可组合、分解和更换的单元。</li><li>模块化可提高代码的复用性和可维护性，实现按需加载。</li><li>模块化规范是对代码进行模块化拆分和组合时需要遵守的规则，如使用何种语法格式引用模块和向外暴露成员。</li></ul><h2 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h2><p>每个模块内部都有一个 <code>module</code> 变量代表当前模块，存储相关信息。</p><p>通过 <code>module.exports</code> 对象把模块内部成员共享出去，供外界使用。加载模块得到的就是 <code>module.exports</code> 指向的对象。</p><p>默认情况下，<code>exports</code> 和 <code>module.exports</code> 指向同一个对象。最终导出的结果以 <code>module.exports</code> 指向的对象为准。</p><p>Nodejs 用的是 CommonJS 模块化规范。</p><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// m1.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="string">&#x27;module1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// m2.js</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">name</span> = <span class="string">&#x27;Bruce&#x27;</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">age</span> = <span class="number">11</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// m3.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">car</span>: <span class="string">&#x27;Benz&#x27;</span>,</span><br><span class="line">  <span class="attr">price</span>: <span class="number">50</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Benz&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">50</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> m1 = <span class="built_in">require</span>(<span class="string">&#x27;./src/m1&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> m2 = <span class="built_in">require</span>(<span class="string">&#x27;./src/m2&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> m3 = <span class="built_in">require</span>(<span class="string">&#x27;./src/m3&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(m1) <span class="comment">// &#x27;module1&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(m2) <span class="comment">// &#123;name: &#x27;Bruce&#x27;, age: 11&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(m3) <span class="comment">// &#123;car: &#x27;Benz&#x27;, price: 50&#125;</span></span><br></pre></td></tr></table></figure><h3 id="加载机制"><a href="#加载机制" class="headerlink" title="加载机制"></a>加载机制</h3><h4 id="重复加载"><a href="#重复加载" class="headerlink" title="重复加载"></a>重复加载</h4><p>模块第一次加载后会被缓存，即多次调用 <code>require()</code> 不会导致模块的代码被执行多次，提高模块加载效率，且模块是单例。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// m3.js</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;m3&#x27;</span>)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">car</span>: <span class="string">&#x27;Benz&#x27;</span>,</span><br><span class="line">  <span class="attr">price</span>: <span class="number">50</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="built_in">require</span>(<span class="string">&#x27;./src/m3&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> b = <span class="built_in">require</span>(<span class="string">&#x27;./src/m3&#x27;</span>) <span class="comment">// m3 只会打印一次</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a === b) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>可删除模块缓存：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除指定模块的缓存</span></span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">require</span>.<span class="property">cache</span>[<span class="built_in">require</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;./src/m3&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除所有模块的缓存</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="built_in">require</span>.<span class="property">cache</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">key</span>) &#123;</span><br><span class="line">  <span class="keyword">delete</span> <span class="built_in">require</span>.<span class="property">cache</span>[key]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="内置模块加载"><a href="#内置模块加载" class="headerlink" title="内置模块加载"></a>内置模块加载</h4><p>内置模块加载优先级最高。</p><h4 id="自定义模块加载"><a href="#自定义模块加载" class="headerlink" title="自定义模块加载"></a>自定义模块加载</h4><p>加载自定义模块时，路径要以 <code>./</code> 或 <code>../</code> 开头，否则会作为内置模块或第三方模块加载。</p><p>导入自定义模块时，若省略文件扩展名，则 Node.js 会按顺序尝试加载文件：</p><ul><li>按确切的文件名加载</li><li>补全 <code>.js</code> 扩展名加载</li><li>补全 <code>.json</code> 扩展名加载</li><li>补全 <code>.node</code> 扩展名加载</li><li>报错</li></ul><h4 id="第三方模块加载"><a href="#第三方模块加载" class="headerlink" title="第三方模块加载"></a>第三方模块加载</h4><ul><li>若导入第三方模块， Node.js 会从<strong>当前模块的父目录</strong>开始，尝试从 <code>/node_modules</code> 文件夹中加载第三方模块。</li><li>如果没有找到对应的第三方模块，则移动到再<strong>上一层父目录</strong>中，进行加载，直到<strong>文件系统的根目录</strong>。</li></ul><p>例如，假设在 <code>C:\Users\bruce\project\foo.js</code> 文件里调用了 <code>require(&#39;tools&#39;)</code>，则 Node.js 会按以下顺序查找：</p><ul><li><code>C:\Users\bruce\project\node_modules\tools</code></li><li><code>C:\Users\bruce\node_modules\tools</code></li><li><code>C:\Users\node_modules\tools</code></li><li><code>C:\node_modules\tools</code></li></ul><h4 id="目录作为模块加载"><a href="#目录作为模块加载" class="headerlink" title="目录作为模块加载"></a>目录作为模块加载</h4><p>当把目录作为模块标识符进行加载的时候，有三种加载方式：</p><ul><li>在被加载的目录下查找 <code>package.json</code> 的文件，并寻找 <code>main</code> 属性，作为 <code>require()</code> 加载的入口</li><li>如果没有 <code>package.json</code> 文件，或者 <code>main</code> 入口不存在或无法解析，则 Node.js 将会试图加载目录下的 <code>index.js</code> 文件。</li><li>若失败则报错</li></ul><h3 id="浏览器玩-CommonJS"><a href="#浏览器玩-CommonJS" class="headerlink" title="浏览器玩 CommonJS"></a>浏览器玩 CommonJS</h3><p>构建项目结构：</p><pre><code>├── dist # 打包文件所在目录├── src│   ├── m1.js│   ├── m2.js│   └── m3.js├── app.js├── index.html└── package.json</code></pre><p>安装 <a href="https://browserify.org/">browserify</a>，它把 CommonJS 语法转换成浏览器能执行的代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">先全局安装</span></span><br><span class="line">npm install -g browserify</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">再局部安装</span></span><br><span class="line">npm install browserify --save-dev</span><br></pre></td></tr></table></figure><p>打包代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browserify src/app.js -o dist/bundle.js</span><br></pre></td></tr></table></figure><p>页面引入打包好的代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./dist/bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ES6-模块"><a href="#ES6-模块" class="headerlink" title="ES6 模块"></a>ES6 模块</h2><p>ES6 使用 <code>export</code> 和 <code>import</code> 导出和导入模块。</p><h3 id="导出模块"><a href="#导出模块" class="headerlink" title="导出模块"></a>导出模块</h3><p>一个模块就是一个独立的 JS 文件，该文件内的变量外部无法获取。若希望能让外部获取模块内的变量，则要用 <code>export</code> 关键字暴露变量。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分别暴露（命名行内导出）</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> age = <span class="number">66</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> name = <span class="string">&#x27;Bruce&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello from m1.js&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 统一暴露（命名子句导出）</span></span><br><span class="line"><span class="keyword">let</span> book = <span class="string">&#x27;红宝书&#x27;</span></span><br><span class="line"><span class="keyword">let</span> price = <span class="number">129</span></span><br><span class="line"><span class="keyword">let</span> bookInfo = &#123;</span><br><span class="line">  <span class="attr">author</span>: <span class="string">&#x27;Matt Frisbie&#x27;</span>,</span><br><span class="line">  <span class="attr">translator</span>: <span class="string">&#x27;李松峰&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 可以使用 as 关键字重命名，改名后原来的名字就不能用了</span></span><br><span class="line"><span class="keyword">export</span> &#123; book, price, bookInfo <span class="keyword">as</span> bookMessage &#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认暴露（默认导出）</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">  <span class="attr">edition</span>: <span class="number">4</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一个模块只能有一个默认导出，重复的默认导出会出错。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SyntaxError</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">age</span>: <span class="number">44</span> &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> obj</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Modules&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>默认暴露和统一暴露可以组合到一起。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="string">&#x27;foo&#x27;</span></span><br><span class="line"><span class="keyword">const</span> bar = <span class="string">&#x27;bar&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// foo 是默认暴露，bar 是统一暴露</span></span><br><span class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> <span class="keyword">default</span>, bar &#125;</span><br></pre></td></tr></table></figure><p>本质上默认暴露是导出名为 <code>default</code> 的变量，导入的时候可以任意取名。因此后面不能跟变量声明语句。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 等同</span></span><br><span class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> <span class="keyword">default</span> &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> foo</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同</span></span><br><span class="line"><span class="keyword">import</span> xxx <span class="keyword">from</span> <span class="string">&#x27;module.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="keyword">default</span> <span class="keyword">as</span> xxx&#125; <span class="keyword">from</span> <span class="string">&#x27;module.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">let</span> a = <span class="number">1</span></span><br></pre></td></tr></table></figure><p>三种导出方式可以在同一个模块同时使用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认暴露</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">  <span class="attr">edition</span>: <span class="number">4</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 统一暴露</span></span><br><span class="line"><span class="keyword">let</span> bar = <span class="number">666</span></span><br><span class="line"><span class="keyword">let</span> foo = <span class="string">&#x27;foo&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; bar, foo &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分别暴露</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> msg = <span class="string">&#x27;good&#x27;</span></span><br></pre></td></tr></table></figure><p><code>export</code> 导出的是值的引用，导入值会随导出值的变化而改变，也就是通过接口可得到模块内部实时的值。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// m1.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> name = <span class="string">&#x27;Bruce&#x27;</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  name = <span class="string">&#x27;good&#x27;</span></span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; name &#125; <span class="keyword">from</span> <span class="string">&#x27;./m1.js&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name) <span class="comment">// &#x27;Bruce&#x27;</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name)</span><br><span class="line">&#125;, <span class="number">1500</span>) <span class="comment">// &#x27;good&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="导入模块"><a href="#导入模块" class="headerlink" title="导入模块"></a>导入模块</h3><p>使用 <code>import</code> 关键字导入模块。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入通过分别暴露和统一暴露导出的接口</span></span><br><span class="line"><span class="keyword">import</span> &#123; name, age, sayHello &#125; <span class="keyword">from</span> <span class="string">&#x27;./m1.js&#x27;</span></span><br><span class="line"><span class="comment">// 导入通过默认暴露导出的接口，变量名自取</span></span><br><span class="line"><span class="keyword">import</span> defaultValue <span class="keyword">from</span> <span class="string">&#x27;./m3.js&#x27;</span></span><br><span class="line"><span class="comment">// 混合导出的接口</span></span><br><span class="line"><span class="keyword">import</span> defaultValue, &#123; book, price, bookInfo &#125; <span class="keyword">from</span> <span class="string">&#x27;./m3.js&#x27;</span></span><br></pre></td></tr></table></figure><p>导入模块时可以对变量重命名。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; bookInfo <span class="keyword">as</span> bookMessage &#125; <span class="keyword">from</span> <span class="string">&#x27;./m2.js&#x27;</span></span><br></pre></td></tr></table></figure><p>可以使用 <code>*</code> 进行模块的整体导入，此时必须进行重命名。<code>*</code> 是一个对象，所有导入值都保存在这个对象上。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> person <span class="keyword">from</span> <span class="string">&#x27;./m1.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">age</span>)</span><br><span class="line">person.<span class="title function_">sayHello</span>()</span><br></pre></td></tr></table></figure><p><code>import</code> 命令会提升到模块顶部再执行，它是在编译阶段执行的，在代码运行之前。</p><p>由于它是静态执行，因此无法使用在运行时才能得到结果的结构。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不会报错，正常运行</span></span><br><span class="line"><span class="title function_">sayHello</span>()</span><br><span class="line"><span class="keyword">import</span> &#123; sayHello &#125; <span class="keyword">from</span> <span class="string">&#x27;./m1.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="string">&#x27;say&#x27;</span> + <span class="string">&#x27;Hello&#x27;</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./m1.js&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="浏览器玩-ES6-模块"><a href="#浏览器玩-ES6-模块" class="headerlink" title="浏览器玩 ES6 模块"></a>浏览器玩 ES6 模块</h3><p>构建项目结构：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">├── lib # 转码文件所在目录</span><br><span class="line">├── src</span><br><span class="line">│   ├── m1.js</span><br><span class="line">│   ├── m2.js</span><br><span class="line">│   ├── m3.js</span><br><span class="line">│   └── app.js</span><br><span class="line">├── babel.config.json</span><br><span class="line">├── index.html</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure><p>安装 <a href="https://www.babeljs.cn/">Babel</a> 转码器，它可将 ES6 语法转成 ES5 语法，让浏览器得以执行。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/core @babel/cli @babel/preset-env</span><br></pre></td></tr></table></figure><p>在 <code>babel.config.json</code> 文件配置 <code>Babel</code>。<code>presets</code> 字段设置转码规则。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;@babel/env&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>将 <code>src</code> 的代码编译到 <code>lib</code> 目录。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./node_modules/.bin/babel src --out-dir lib</span><br></pre></td></tr></table></figure><p>编译后的代码还包含 <code>require</code> 等 CommonJS 关键字，浏览器还不能识别，因此还需要安装 <a href="https://browserify.org/">browserify</a> 进行二次转换。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g browserify</span><br></pre></td></tr></table></figure><p>打包代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browserify lib/app.js -o lib/bundle.js</span><br></pre></td></tr></table></figure><p>页面引入打包好的代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./lib/bundle.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以在浏览器自由玩 ES6 模块了！:slightly_smiling_face:</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> JS 模块化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浏览器本地存储 Web Storage</title>
      <link href="/2023/09/06/webstorage/"/>
      <url>/2023/09/06/webstorage/</url>
      
        <content type="html"><![CDATA[<p>:::tip 浏览器本地存储<br>浏览器本地存储包括两个对象：<code>sessionStorage</code> 和 <code>localStorage</code>，它们都是 <code>Storage</code> 的实例对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">localStorage</span> <span class="keyword">instanceof</span> <span class="title class_">Storage</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>:::</p><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><p>访问数据：<code>getItem()</code></p><p>添加、修改数据：<code>setItem()</code></p><p>删除数据：<code>removeItem()</code></p><p>清空数据：<code>clear()</code></p><p>获取给定位置的键名：<code>key()</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以 localStorage 为例，sessionStorage 都一样</span></span><br><span class="line"><span class="comment">// 添加数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;BruceBlog&#x27;</span>)</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;age&#x27;</span>, <span class="number">2333</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;age&#x27;</span>, <span class="number">520</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清空数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">clear</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历所有值，不知道是按什么顺序排列的</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">localStorage</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">let</span> key = <span class="variable language_">localStorage</span>.<span class="title function_">key</span>(i)</span><br><span class="line">  <span class="keyword">let</span> value = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`key: <span class="subst">$&#123;key&#125;</span>, value: <span class="subst">$&#123;value&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>只能够存储字符串，不是字符串的会调用 <code>toString()</code> 方法转成字符串。</p><p>如果想要存储对象，需要使用 <code>JSON.stringify()</code> 转成 JSON 字符串再存储，以后再用 <code>JSON.parse()</code> 还原成对象。</p><p>如果无法转成字符串，则会报错。比如 <code>Symbol</code> 类型的变量无法转成字符串。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">book</span>: <span class="string">&#x27;HTTP&#x27;</span>, <span class="attr">price</span>: <span class="number">46</span> &#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(obj, <span class="string">&#x27;object&#x27;</span>) <span class="comment">// &#x27;[object Object]&#x27;: &#x27;object&#x27;</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;func&#x27;</span>, fn) <span class="comment">// &#x27;func&#x27;: &#x27;function fn() &#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;info&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj)) <span class="comment">// &#x27;info&#x27;: &#x27;&#123;\&quot;book\&quot;:\&quot;HTTP\&quot;,\&quot;price\&quot;:46&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(obj2) <span class="comment">// &#x27;object&#x27;，obj2 会被转成 &#x27;[object Object]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;symbol&#x27;</span>, <span class="title class_">Symbol</span>(<span class="number">666</span>)) <span class="comment">// Uncaught TypeError: Cannot convert a Symbol value to a string</span></span><br></pre></td></tr></table></figure><h2 id="sessionStorage-与-localStorage-对比"><a href="#sessionStorage-与-localStorage-对比" class="headerlink" title="sessionStorage 与 localStorage 对比"></a><code>sessionStorage</code> 与 <code>localStorage</code> 对比</h2><p><code>sessionStorage</code> 是跨会话存储机制，<code>localStorage</code> 是永久存储机制。</p><p>作用时间：<code>sessionStorage</code> 在窗口关闭后就会失效，<code>localStorage</code> 是永久存储，除非手动通过 JS 删除或清除浏览器缓存。</p><p>作用范围：<code>sessionStorage</code> 的数据只能在<strong>同源</strong>（协议域名端口号相同）、<strong>同一个窗口</strong>共享，<code>localStorage</code> 的数据在<strong>同源、不同窗口共享（同一个浏览器）</strong>。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> JS WebStorage </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript 数组</title>
      <link href="/2023/09/06/array/"/>
      <url>/2023/09/06/array/</url>
      
        <content type="html"><![CDATA[<h2 id="数组方法"><a href="#数组方法" class="headerlink" title="数组方法"></a>数组方法</h2><h3 id="数组操作"><a href="#数组操作" class="headerlink" title="数组操作"></a>数组操作</h3><h4 id="push"><a href="#push" class="headerlink" title="push()"></a><code>push()</code></h4><p>向数组末尾添加元素，返回新数组长度</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">520</span>, <span class="number">55520</span>, <span class="number">521</span>]</span><br><span class="line"><span class="comment">// 添加单个元素</span></span><br><span class="line"><span class="keyword">let</span> newLen = arr.<span class="title function_">push</span>(<span class="number">666</span>)</span><br><span class="line"><span class="comment">// 添加多个元素</span></span><br><span class="line">arr.<span class="title function_">push</span>(<span class="number">2333</span>, <span class="string">&#x27;BruceBlog&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="pop"><a href="#pop" class="headerlink" title="pop()"></a><code>pop()</code></h4><p>数组末尾删除一个元素，返回被删除的元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">520</span>, <span class="number">55520</span>, <span class="number">521</span>]</span><br><span class="line"><span class="keyword">let</span> el = arr.<span class="title function_">pop</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组没有元素返回 undefined</span></span><br><span class="line">arr = []</span><br><span class="line">arr.<span class="title function_">pop</span>()</span><br></pre></td></tr></table></figure><h4 id="unshift"><a href="#unshift" class="headerlink" title="unshift()"></a><code>unshift()</code></h4><p>数组头部添加元素，返回新数组长度</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">520</span>, <span class="number">55520</span>, <span class="number">521</span>]</span><br><span class="line"><span class="comment">// 添加单个元素</span></span><br><span class="line"><span class="keyword">let</span> newLen = arr.<span class="title function_">unshift</span>(<span class="number">666</span>)</span><br><span class="line"><span class="comment">// 添加多个元素</span></span><br><span class="line">arr.<span class="title function_">unshift</span>(<span class="number">2333</span>, <span class="string">&#x27;BruceBlog&#x27;</span>) <span class="comment">// [2333, &#x27;BruceBlog&#x27;, 666, 520, 55520, 521]</span></span><br></pre></td></tr></table></figure><h4 id="shift"><a href="#shift" class="headerlink" title="shift()"></a><code>shift()</code></h4><p>数组头部删除一个元素，返回被删除的元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">520</span>, <span class="number">55520</span>, <span class="number">521</span>]</span><br><span class="line"><span class="keyword">let</span> el = arr.<span class="title function_">shift</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组没有元素返回 undefined</span></span><br><span class="line">arr = []</span><br><span class="line">arr.<span class="title function_">shift</span>()</span><br></pre></td></tr></table></figure><h4 id="splice"><a href="#splice" class="headerlink" title="splice()"></a><code>splice()</code></h4><p>可给数组删除、添加、替换元素，改变原数组</p><p>返回被删除元素组成的数组，没有删除元素则为空数组</p><p>参数：操作起始位置、删除的元素个数、添加的元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;JS&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>, <span class="string">&#x27;C++&#x27;</span>, <span class="string">&#x27;PHP&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> res = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除元素</span></span><br><span class="line"><span class="comment">// [&#x27;JS&#x27;, &#x27;PHP&#x27;], [&#x27;Java&#x27;, &#x27;C++&#x27;]</span></span><br><span class="line">res = arr.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加元素</span></span><br><span class="line"><span class="comment">// [&#x27;Python&#x27;, &#x27;TS&#x27;, &#x27;JS&#x27;, &#x27;PHP&#x27;], []</span></span><br><span class="line">res = arr.<span class="title function_">splice</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;TS&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 替换元素（删除元素的同时添加新元素）</span></span><br><span class="line"><span class="comment">// [&#x27;Python&#x27;, &#x27;C&#x27;, &#x27;Go&#x27;]</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;Go&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="数组排序"><a href="#数组排序" class="headerlink" title="数组排序"></a>数组排序</h3><h4 id="sort"><a href="#sort" class="headerlink" title="sort()"></a><code>sort()</code></h4><p>对数组进行排序，修改原数组，返回排序后的数组。</p><p>默认按字符串顺序升序排序。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">0</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">25</span>]</span><br><span class="line"><span class="comment">// [0, 10, 2, 25, 8]</span></span><br><span class="line"><span class="keyword">let</span> res = arr.<span class="title function_">sort</span>()</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">res === arr</span><br></pre></td></tr></table></figure><p><code>sort()</code> 方法可传入一个比较函数，自定义比较规则。</p><p>比较函数传入两个参数：新数和旧数。返回正数则新数排在旧数之后，返回负值则新数排在旧数之前，返回 0 则相等。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compareAsc</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a - b</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compareDes</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> b - a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compareRandom</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0.5</span> - <span class="title class_">Math</span>.<span class="title function_">random</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">0</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">25</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment">// [0, 8, 10, 25, 52]</span></span><br><span class="line">arr.<span class="title function_">sort</span>(compareAsc)</span><br><span class="line"></span><br><span class="line"><span class="comment">// [52, 25, 10, 8, 0]</span></span><br><span class="line">arr.<span class="title function_">sort</span>(compareDes)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 随机排序数组</span></span><br><span class="line">arr.<span class="title function_">sort</span>(compareRandom)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据对象属性排序</span></span><br><span class="line"><span class="keyword">let</span> cars = [</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">&#x27;Benz&#x27;</span>, <span class="attr">year</span>: <span class="number">2021</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">&#x27;Lexus&#x27;</span>, <span class="attr">year</span>: <span class="number">2022</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">&#x27;BMW&#x27;</span>, <span class="attr">year</span>: <span class="number">2023</span> &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">cars.<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> x = a.<span class="property">type</span>.<span class="title function_">toLowerCase</span>()</span><br><span class="line">  <span class="keyword">let</span> y = b.<span class="property">type</span>.<span class="title function_">toLowerCase</span>()</span><br><span class="line">  <span class="keyword">if</span> (x &lt; y) &#123;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (x &gt; y) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="reverse"><a href="#reverse" class="headerlink" title="reverse()"></a><code>reverse()</code></h4><p>反转数组，改变原数组。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>]</span><br><span class="line"><span class="comment">// [&#x27;green&#x27;, &#x27;blue&#x27;, &#x27;red&#x27;]</span></span><br><span class="line">arr.<span class="title function_">reverse</span>()</span><br></pre></td></tr></table></figure><h3 id="数组迭代"><a href="#数组迭代" class="headerlink" title="数组迭代"></a>数组迭代</h3><h4 id="forEach"><a href="#forEach" class="headerlink" title="forEach()"></a><code>forEach()</code></h4><p>遍历数组，对每个元素执行传入的函数。相当于使用 <code>for</code> 循环遍历数组。</p><p><code>forEach()</code> 没有返回值，不会改变原数组。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">44</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line"><span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> res = arr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">  count += item</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// count: 50</span></span><br><span class="line"><span class="comment">// res: undefined</span></span><br></pre></td></tr></table></figure><h4 id="filter"><a href="#filter" class="headerlink" title="filter()"></a><code>filter()</code></h4><p>过滤数组，返回符合条件的元素组成的新数组。不改变原数组。</p><p>传入一个筛选函数，筛选函数 3 个参数：元素、索引、数组。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">5</span>, <span class="number">23</span>, <span class="number">66</span>, <span class="number">520</span>, <span class="number">77</span>]</span><br><span class="line"><span class="keyword">let</span> res = arr.<span class="title function_">filter</span>(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> item &gt; <span class="number">50</span>)</span><br><span class="line"><span class="comment">// [66, 520, 77]</span></span><br></pre></td></tr></table></figure><h4 id="map"><a href="#map" class="headerlink" title="map()"></a><code>map()</code></h4><p>对数组每个元素执行传入的函数，返回每个执行结果组成的数组。不改变原数组。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>]</span><br><span class="line"><span class="keyword">let</span> res = arr.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> item * <span class="number">3</span>)</span><br><span class="line"><span class="comment">// [3, 9, 15, 21]</span></span><br></pre></td></tr></table></figure><h4 id="every"><a href="#every" class="headerlink" title="every()"></a><code>every()</code></h4><p>检查数组每个元素是否都满足条件，若都返回 <code>true</code>，则 <code>every()</code> 方法返回 <code>true</code>。若有一个元素返回 <code>false</code>，则 <code>every()</code> 方法返回 <code>false</code>。</p><p>一旦遇到元素返回 <code>false</code>，则<strong>停止后续遍历</strong>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">arr.<span class="title function_">every</span>(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> item &lt; <span class="number">2</span>) <span class="comment">// false</span></span><br><span class="line">arr.<span class="title function_">every</span>(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> item &gt; <span class="number">0</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h4 id="some"><a href="#some" class="headerlink" title="some()"></a><code>some()</code></h4><p>检查数组是否存在元素满足条件，若有一个元素返回 <code>true</code>，则 <code>some()</code> 方法返回 <code>true</code>。</p><p>一旦遇到元素返回 <code>true</code>，则<strong>停止后续遍历</strong>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line">arr.<span class="title function_">some</span>(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> item === <span class="number">6</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a><code>reduce()</code></h4><p>遍历数组，生成一个最终返回值，可用于条件统计。</p><p><code>reduce()</code> 方法可传入 2 个参数：归并函数、初始值。其中初始值可选，若不传，则默认初始值为数组第一个元素，从数组第二个元素开始遍历。</p><p>归并函数可传入 4 个参数：上一个归并值、元素、索引、数组本身。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组元素累加</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre, cur, index, arr</span>) =&gt;</span> pre + cur) <span class="comment">// 15</span></span><br><span class="line">arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre, cur, index, arr</span>) =&gt;</span> pre + cur, <span class="number">10</span>) <span class="comment">// 25</span></span><br></pre></td></tr></table></figure><h4 id="reduceRight"><a href="#reduceRight" class="headerlink" title="reduceRight()"></a><code>reduceRight()</code></h4><p>效果与 <code>reduce()</code> 方法相同，只是方向相反，从右往左遍历。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> JS array </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>grid 布局</title>
      <link href="/2023/09/06/grid/"/>
      <url>/2023/09/06/grid/</url>
      
        <content type="html"><![CDATA[<h1 id="grid-布局"><a href="#grid-布局" class="headerlink" title="grid 布局"></a>grid 布局</h1><p>:::warning grid 布局<br>最牛逼的 CSS 布局方式<br>:::</p><h2 id="grid-布局概述"><a href="#grid-布局概述" class="headerlink" title="grid 布局概述"></a>grid 布局概述</h2><p><code>flex</code> 弹性布局是一维布局，<code>grid</code> 网格布局是二维布局。</p><p>开启方式：元素添加 <code>display: grid</code> 或 <code>display: inline-grid</code> 。</p><p>开启 <code>grid</code> 布局的元素，称为容器，其子元素变成容器成员，称为 <code>grid</code> 项目。</p><p><code>grid</code> 布局原理：通过设置容器和项目的属性，来控制子盒子的位置和排列方式。</p><h2 id="grid-布局容器盒子常见属性"><a href="#grid-布局容器盒子常见属性" class="headerlink" title="grid 布局容器盒子常见属性"></a>grid 布局容器盒子常见属性</h2><h3 id="display"><a href="#display" class="headerlink" title="display"></a>display</h3><p>创建 <code>grid</code> 布局容器。</p><table><thead><tr><th>属性值</th><th>含义</th></tr></thead><tbody><tr><td>grid</td><td>容器元素为块级元素</td></tr><tr><td>inline-grid</td><td>容器元素为行内元素</td></tr></tbody></table><h3 id="grid-template-columns-grid-template-rows"><a href="#grid-template-columns-grid-template-rows" class="headerlink" title="grid-template-columns &amp; grid-template-rows"></a>grid-template-columns &amp; grid-template-rows</h3><p><code>grid-template-columns</code> 设置列宽，<code>grid-template-rows</code> 设置行高。用法类似，以前者为例进行说明。</p><h4 id="设置固定列宽行高"><a href="#设置固定列宽行高" class="headerlink" title="设置固定列宽行高"></a>设置固定列宽行高</h4><p><code>grid-template-columns: 30px 40px 50px</code> 表示一共三列，列宽分别为 30px 40px 50px。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/*  一共三列，列宽分别为 30px 40px 50px */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">30px</span> <span class="number">40px</span> <span class="number">50px</span>;</span><br><span class="line">  <span class="comment">/*  一共两行，行高分别为 30px 40px 50px  */</span></span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">30px</span> <span class="number">40px</span> <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="repeat"><a href="#repeat" class="headerlink" title="repeat()"></a>repeat()</h4><p>见名知义，重复声明。</p><p>第一个参数为重复个数，第二个参数为宽度或高度。</p><p><code>grid-template-columns: repeat(3, 50px)</code> 表示一共三列，列宽为 50px。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/* grid-template-columns: 50px 50px 50px; */</span></span><br><span class="line">  <span class="comment">/* 一共三列，列宽为 50px */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(<span class="number">3</span>, <span class="number">50px</span>);</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">30px</span> <span class="number">40px</span> <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="auto-fill"><a href="#auto-fill" class="headerlink" title="auto-fill"></a>auto-fill</h4><p>尽可能填满每一行或每一列。只要网格容器够大，尽可能容纳更多单元格。</p><p><code>grid-template-columns: repeat(auto-fill, 50px)</code> 表示每列宽度为 50px，数量不固定，每一行尽量容纳更多列。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/* 每列宽度为 50px，数量不固定，每一行尽量容纳更多列 */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fill, <span class="number">50px</span>);</span><br><span class="line">  <span class="comment">/* 每行高度为 30px，数量不固定，每一列尽量容纳更多行 */</span></span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="built_in">repeat</span>(auto-fill, <span class="number">30px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="fr"><a href="#fr" class="headerlink" title="fr"></a>fr</h4><p><code>fr</code> 指明占容器剩余空间的份数，类似于 <code>flex</code> 布局的 <code>flex-grow</code> 属性。</p><p><code>grid-template-columns: 30px 1fr 2fr</code> 表示第一列宽度为 30px，第二列和第三列分别占剩余宽度的 1&#x2F;3、2&#x2F;3</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/* 第一列宽度为 30px，第二列和第三列分别占剩余宽度的 1/3、2/3 */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">30px</span> <span class="number">1</span>fr <span class="number">2</span>fr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="minmax"><a href="#minmax" class="headerlink" title="minmax()"></a>minmax()</h4><p>设置单元格最小和最大的宽度或高度。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/* 最小 40px，但不能大于第二列宽度的 2 倍 */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">30px</span> <span class="number">1</span>fr <span class="built_in">minmax</span>(<span class="number">40px</span>, <span class="number">2</span>fr);</span><br><span class="line">  <span class="comment">/* 至少 120px，还有空余则一起等分 */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fill, <span class="built_in">minmax</span>(<span class="number">120px</span>, <span class="number">1</span>fr));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="auto"><a href="#auto" class="headerlink" title="auto"></a>auto</h4><p>由浏览器决定具体的宽度或高度。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/* 第二列的宽度由浏览器决定 */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">30px</span> auto <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="row-gap"><a href="#row-gap" class="headerlink" title="row-gap"></a>row-gap</h3><p>设置行间距。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">row-gap</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="column-gap"><a href="#column-gap" class="headerlink" title="column-gap"></a>column-gap</h3><p>设置列间距。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">column-gap</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="gap"><a href="#gap" class="headerlink" title="gap"></a>gap</h3><p><code>row-gap</code> 和 <code>column-gap</code> 的简写形式。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/* 行间距 10px，列间距 20px */</span></span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">10px</span> <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="justify-content"><a href="#justify-content" class="headerlink" title="justify-content"></a>justify-content</h3><p>设置单元格项目在网格容器里的水平排列方式，类似 <code>flex</code> 布局的 <code>justify-content</code> 属性。</p><table><thead><tr><th>属性值</th><th>含义</th></tr></thead><tbody><tr><td>start</td><td>从头开始</td></tr><tr><td>end</td><td>从尾部开始</td></tr><tr><td>center</td><td>水平居中</td></tr><tr><td>space-around</td><td>平分剩余空间</td></tr><tr><td>space-between</td><td>两侧单元格贴边，再平分剩余空间</td></tr><tr><td>space-evenly</td><td>单元格之间等间距，且两侧单元格和容器也是相同的距离</td></tr><tr><td>stretch</td><td>单元格没指定列宽，拉伸占满整行</td></tr></tbody></table><p><code>space-around</code>、<code>space-between</code>、<code>space-evenly</code> 演示案例<a href="https://juejin.cn/post/6854573220306255880">图片</a>：<br><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/7/26/173895927ba770c4~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp" alt="justify-content"></p><h3 id="align-content"><a href="#align-content" class="headerlink" title="align-content"></a>align-content</h3><p>设置单元格项目在网格容器里的竖直方向的排列方式，类似 <code>flex</code> 布局的 <code>align-items</code> 属性。</p><p>属性值和 <code>justify-content</code> 相同。</p><h3 id="grid-auto-rows"><a href="#grid-auto-rows" class="headerlink" title="grid-auto-rows"></a>grid-auto-rows</h3><p>设置除了 <code>grid-template-row</code> 定义的行以外的行的高度。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/* 第一和第二行高度为 30px、40px */</span></span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">30px</span> <span class="number">40px</span>;</span><br><span class="line">  <span class="comment">/* 其他行的高度都为 60px */</span></span><br><span class="line">  <span class="attribute">grid-auto-rows</span>: <span class="number">60px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="grid-auto-columns"><a href="#grid-auto-columns" class="headerlink" title="grid-auto-columns"></a>grid-auto-columns</h3><p>设置除了 <code>grid-template-columns</code> 定义的列以外的列的宽度。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="comment">/* 第一和第二列宽度为 30px、40px */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">30px</span> <span class="number">40px</span>;</span><br><span class="line">  <span class="comment">/* 其他列的宽度都为 60px */</span></span><br><span class="line">  <span class="attribute">grid-auto-columns</span>: <span class="number">60px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="grid-布局兼容性"><a href="#grid-布局兼容性" class="headerlink" title="grid 布局兼容性"></a>grid 布局兼容性</h2><p><img src="https://raw.githubusercontent.com/dont-sleep-so-late/CDN/master/images/grid_compatibility.png" alt="grid 布局兼容性"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> CSS grid </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>吾名 JavaScript</title>
      <link href="/2023/09/06/what_is_js/"/>
      <url>/2023/09/06/what_is_js/</url>
      
        <content type="html"><![CDATA[<h2 id="JavaScript-和-ECMAScript"><a href="#JavaScript-和-ECMAScript" class="headerlink" title="JavaScript 和 ECMAScript"></a>JavaScript 和 ECMAScript</h2><p>ECMAScript 是 JavaScript 语言的<strong>国际标准</strong>，JavaScript 是 ECMAScript 的<strong>一种实现</strong>（Adobe ActionScript 和 JScript 同样实现了 ECMAScript）。</p><p>ECMAScript 是欧洲计算机制造商协会 ECMA（European Computer Manufacturers Association）发布的浏览器脚本语言标准。它是 262 号标准文件，又叫 ECMA-262。</p><p>ECMAScript 定义了语言在语法、类型、语句、关键字、保留字、操作符、全局对象的规范。</p><p>JavaScript 并不仅限于 ECMAScript。在浏览器中，JavaScript 包括 ECMAScript、文档对象模型 DOM、浏览器对象模型 BOM。</p><p>日常工作中认为 JavaScript 和 ECMAScript 是同义词，也懒得做区分了。</p><h2 id="ES5-和-ES6"><a href="#ES5-和-ES6" class="headerlink" title="ES5 和 ES6"></a>ES5 和 ES6</h2><p>这主要是 ECMAScript 版本命名方式的改变。</p><p>一开始 ECMAScript 使用版本号进行命名，ECMAScript 1.0 称为 ES1，ECMAScript 2.0 称为 ES2。</p><p>从 ES6 开始，标准委员会决定于每年 6 月份发布新版本，并且以年份进行命名。2015 年 6 月发布了 ECMAScript 2015（ES2015），若按照版本号即为 ES6。</p><p>现在 ES6 泛指 ECMAScript 5.1 之后的 ECMAScript 标准。ES6 是个分水岭，新增了一大批特性。</p><h2 id="ECMAScript-历史版本"><a href="#ECMAScript-历史版本" class="headerlink" title="ECMAScript 历史版本"></a>ECMAScript 历史版本</h2><p>1997 年发布 ES1，1998 年发布 ES2，1999 年发布 ES3。ES3 定义了 JavaScript 的基本语法，标志着 JavaScript 真正成为一门语言。</p><p>ES4 由于改动太大而没有通过。后 ECMAScript 3.1 改为 ECMAScript 5.0（ES5），于 2009 年 12 月正式发布，现在学的最多的就是这个版本。</p><p>2015 年 6 月发布 ECMAScript 6（ES6、ES2015）。</p><p>2016 年 6 月发布 ECMAScript 7（ES7、ES2016）。</p><p>2017 年 6 月发布 ECMAScript 8（ES8、ES2017）。</p><p>2018 年 6 月发布 ECMAScript 9（ES9、ES2018）。</p><p>2019 年 6 月发布 ECMAScript 10（ES10、ES2019）。</p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello Less</title>
      <link href="/2023/09/06/less/"/>
      <url>/2023/09/06/less/</url>
      
        <content type="html"><![CDATA[<h2 id="tip-Less"><a href="#tip-Less" class="headerlink" title="tip Less"></a>tip Less</h2><p>It’s CSS, with just a little more.</p><p><a href="https://less.bootcss.com/">Learn More</a></p><h2 id="What-is-Less"><a href="#What-is-Less" class="headerlink" title="What is Less"></a>What is Less</h2><p>Less(Leaner Style Sheets 精简样式表) 是一种动态样式语言，属于 css 预处理器的范畴，它扩展了 CSS 语言，增加了变量、Mixin、函数等特性，使 CSS 更易维护和扩展，Less 既可以在 客户端 上运行 ，也可以借助 Node.js 在服务端运行。</p><p>Less 编译工具：</p><ul><li><a href="http://koala-app.com/index.html">Koala</a></li><li>vscode 的 Easy LESS 插件</li></ul><h2 id="注释-Comments"><a href="#注释-Comments" class="headerlink" title="注释(Comments)"></a>注释(Comments)</h2><ul><li>多行注释保留</li><li>单行注释不被保留在编译生成的 CSS 中</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * 一个块注释</span></span><br><span class="line"><span class="comment"> * style comment! </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这一行被注释掉了！</span></span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="变量-Variables"><a href="#变量-Variables" class="headerlink" title="变量(Variables)"></a>变量(Variables)</h2><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><ul><li>@ 声明变量，作为普通属性值使用</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@width:</span> <span class="number">50px</span>;</span><br><span class="line"><span class="variable">@height:</span> <span class="number">100px</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="variable">@width</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">@height</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="变量插值-Variable-Interpolation"><a href="#变量插值-Variable-Interpolation" class="headerlink" title="变量插值(Variable Interpolation)"></a>变量插值(Variable Interpolation)</h3><ul><li>变量用于选择器名、属性名、URL、<code>@import</code>语句</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@my-selector:</span> banner;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要添加 &#123;&#125;</span></span><br><span class="line"><span class="selector-class">.@&#123;my-selector&#125;</span> &#123;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@property:</span> color;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.widget</span> &#123;</span><br><span class="line">  @&#123;property&#125;: <span class="selector-id">#0ee</span>;</span><br><span class="line">  <span class="selector-tag">background-</span><span class="variable">@&#123;property&#125;</span>: <span class="selector-id">#999</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Variables</span></span><br><span class="line"><span class="variable">@images:</span> <span class="string">&#x27;../img&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#444</span>;</span><br><span class="line">  <span class="attribute">background</span>: url(<span class="string">&#x27;@&#123;images&#125;/white-sand.png&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Variables</span></span><br><span class="line"><span class="variable">@themes:</span> <span class="string">&#x27;../../src/themes&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;@&#123;themes&#125;/tidal-wave.less&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="延迟加载-Lazy-Evaluation"><a href="#延迟加载-Lazy-Evaluation" class="headerlink" title="延迟加载(Lazy Evaluation)"></a>延迟加载(Lazy Evaluation)</h3><p>:::tip Lazy Evaluation<br>When defining a variable twice, the last definition of the variable is used, searching from the current scope upwards.<br>:::</p><p>当一个变量被声明多次，会取最后一次的值，并从当前作用域往外寻找变量。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@var:</span> <span class="number">0</span>;</span><br><span class="line"><span class="selector-class">.class</span> &#123;</span><br><span class="line">  <span class="variable">@var:</span> <span class="number">1</span>;</span><br><span class="line">  <span class="selector-class">.brass</span> &#123;</span><br><span class="line">    <span class="variable">@var:</span> <span class="number">2</span>;</span><br><span class="line">    three: @var;</span><br><span class="line">    <span class="variable">@var:</span> <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  one: @var;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.class</span> &#123;</span><br><span class="line">  one: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.class</span> <span class="selector-class">.brass</span> &#123;</span><br><span class="line">  three: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="属性名变量-Properties-as-Variables"><a href="#属性名变量-Properties-as-Variables" class="headerlink" title="属性名变量(Properties as Variables)"></a>属性名变量(Properties as Variables)</h3><p>:::tip Properties as Variables<br>You can easily treat properties like variables using the $prop syntax<br>:::</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.widget</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#efefef</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: $color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.widget</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#efefef</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#efefef</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="嵌套-Nesting"><a href="#嵌套-Nesting" class="headerlink" title="嵌套(Nesting)"></a>嵌套(Nesting)</h2><p>Less 提供了使用嵌套(nesting)代替层叠或与层叠结合使用的能力</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#header</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: black;</span><br><span class="line">  <span class="selector-class">.navigation</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.logo</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#header</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: black;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#header</span> <span class="selector-class">.navigation</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#header</span> <span class="selector-class">.logo</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="父选择器-Parent-Selectors"><a href="#父选择器-Parent-Selectors" class="headerlink" title="父选择器 (Parent Selectors)"></a>父选择器 (Parent Selectors)</h2><p>在嵌套规则中， <code>&amp;</code> 表示父选择器，常用于给现有选择器添加伪类。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: blue;</span><br><span class="line">    <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: green;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.header</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.header</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果没有 <code>&amp;</code>，会被编译成后代选择器 <code>a :hover</code>。</p><p>除此之外，<code>&amp;</code> 还能用于生成重复类名：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.button</span> &#123;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-tag">-ok</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: url(<span class="string">&#x27;ok.png&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-tag">-cancel</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: url(<span class="string">&#x27;cancel.png&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-tag">-custom</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: url(<span class="string">&#x27;custom.png&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.button-ok</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;ok.png&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.button-cancel</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;cancel.png&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.button-custom</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;custom.png&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="混合-Mixins"><a href="#混合-Mixins" class="headerlink" title="混合(Mixins)"></a>混合(Mixins)</h2><p>混合(Mixin)是一种将一组属性从一个规则集包含(或混入)到另一个规则集的方式，可理解为复制粘贴。</p><h3 id="普通混合"><a href="#普通混合" class="headerlink" title="普通混合"></a>普通混合</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.bordered</span> &#123;</span><br><span class="line">  <span class="attribute">border-top</span>: dotted <span class="number">1px</span> black;</span><br><span class="line">  <span class="attribute">border-bottom</span>: solid <span class="number">2px</span> black;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#111</span>;</span><br><span class="line">  <span class="selector-class">.bordered</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.post</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">  <span class="selector-class">.bordered</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.bordered</span> &#123;</span><br><span class="line">  <span class="attribute">border-top</span>: dotted <span class="number">1px</span> black;</span><br><span class="line">  <span class="attribute">border-bottom</span>: solid <span class="number">2px</span> black;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#menu</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#111</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: dotted <span class="number">1px</span> black;</span><br><span class="line">  <span class="attribute">border-bottom</span>: solid <span class="number">2px</span> black;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.post</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">  <span class="attribute">border-top</span>: dotted <span class="number">1px</span> black;</span><br><span class="line">  <span class="attribute">border-bottom</span>: solid <span class="number">2px</span> black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="带参数的混合-Parametric-Mixins"><a href="#带参数的混合-Parametric-Mixins" class="headerlink" title="带参数的混合(Parametric Mixins)"></a>带参数的混合(Parametric Mixins)</h3><ol><li>混合带参数，参数需要按顺序传递</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.border</span>(<span class="variable">@width</span>, <span class="variable">@style</span>, <span class="variable">@color</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">@width</span> <span class="variable">@style</span> <span class="variable">@color</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="selector-class">.border</span>(<span class="number">1px</span>, solid, <span class="number">#ccc</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>混合带参数并有默认值</li></ol><ul><li>需注意的是，就算有默认值，也要按顺序传递</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.border</span>(<span class="variable">@width</span>, <span class="variable">@style</span>, <span class="variable">@color</span>: <span class="number">#ccc</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">@width</span> <span class="variable">@style</span> <span class="variable">@color</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="selector-class">.border</span>(<span class="number">1px</span>, solid);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 会出错</span></span><br><span class="line"><span class="selector-class">.border</span>(<span class="variable">@width</span>: <span class="number">1px</span>, <span class="variable">@style</span>, <span class="variable">@color</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">@width</span> <span class="variable">@style</span> <span class="variable">@color</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="selector-class">.border</span>(solid, <span class="number">#ccc</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="命名参数"><a href="#命名参数" class="headerlink" title="命名参数"></a>命名参数</h3><p>可以在向混合传参是指定参数名称，从而不需要按顺序传入</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.border</span>(<span class="variable">@width</span>, <span class="variable">@style</span>, <span class="variable">@color</span>: <span class="number">#ccc</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">@width</span> <span class="variable">@style</span> <span class="variable">@color</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="selector-class">.border</span>(<span class="variable">@style</span>: solid, <span class="variable">@color</span>: red, <span class="variable">@width</span>: <span class="number">100px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="arguments-变量"><a href="#arguments-变量" class="headerlink" title="@arguments 变量"></a>@arguments 变量</h3><p><code>@arguments</code> 变量包含了传入的所有参数</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box-shadow</span>(<span class="variable">@x</span>: <span class="number">0</span>, <span class="variable">@y</span>: <span class="number">0</span>, <span class="variable">@blur</span>: <span class="number">1px</span>, <span class="variable">@color</span>: <span class="number">#000</span>) &#123;</span><br><span class="line">  -webkit-<span class="attribute">box-shadow</span>: <span class="variable">@arguments</span>;</span><br><span class="line">  -moz-<span class="attribute">box-shadow</span>: <span class="variable">@arguments</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="variable">@arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.big-block</span> &#123;</span><br><span class="line">  <span class="selector-class">.box-shadow</span>(<span class="number">2px</span>, <span class="number">5px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.big-block</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">box-shadow</span>: <span class="number">2px</span> <span class="number">5px</span> <span class="number">1px</span> <span class="number">#000</span>;</span><br><span class="line">  -moz-<span class="attribute">box-shadow</span>: <span class="number">2px</span> <span class="number">5px</span> <span class="number">1px</span> <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">2px</span> <span class="number">5px</span> <span class="number">1px</span> <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="匹配模式-Pattern-matching"><a href="#匹配模式-Pattern-matching" class="headerlink" title="匹配模式(Pattern-matching)"></a>匹配模式(Pattern-matching)</h3><p>在多个相同的混合中(参数个数必须相同)，匹配特定的混合。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.mixin</span>(dark, <span class="variable">@color</span>) &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">darken</span>(<span class="variable">@color</span>, <span class="number">10%</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.mixin</span>(light, <span class="variable">@color</span>) &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">lighten</span>(<span class="variable">@color</span>, <span class="number">10%</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// @_ 表示匹配所有</span></span><br><span class="line"><span class="selector-class">.mixin</span>(<span class="variable">@_</span>, <span class="variable">@color</span>) &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">@switch:</span> light;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.class</span> &#123;</span><br><span class="line">  <span class="selector-class">.mixin</span>(<span class="variable">@switch</span>, <span class="number">#888</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.class</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#a2a2a2</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="运算-Operations"><a href="#运算-Operations" class="headerlink" title="运算(Operations)"></a>运算(Operations)</h2><ul><li>计算结果以操作数最左侧的单位类型为准</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@conversion-1:</span> <span class="number">5cm</span> + <span class="number">10mm</span>; <span class="comment">// 6cm</span></span><br><span class="line"><span class="variable">@conversion-2:</span> <span class="number">2</span> - <span class="number">3cm</span> - <span class="number">5mm</span>; <span class="comment">// -1.5cm</span></span><br><span class="line"><span class="variable">@conversion-3:</span> <span class="number">3.1</span> * <span class="number">2cm</span>; <span class="comment">// 6.2cm</span></span><br><span class="line"><span class="variable">@conversion-4:</span> <span class="number">4px</span> / <span class="number">2</span>; <span class="comment">// 4px / 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// conversion is impossible</span></span><br><span class="line"><span class="variable">@incompatible-units:</span> <span class="number">1cm</span> - <span class="number">1px</span>; <span class="comment">// 0.97354167cm</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// example with variables</span></span><br><span class="line"><span class="variable">@base:</span> <span class="number">5%</span>;</span><br><span class="line"><span class="variable">@filler:</span> <span class="variable">@base</span> * <span class="number">2</span>; <span class="comment">// 10%</span></span><br><span class="line"><span class="variable">@other:</span> <span class="variable">@base</span> + <span class="variable">@filler</span>; <span class="comment">// 15%</span></span><br><span class="line"></span><br><span class="line"><span class="variable">@color:</span> <span class="number">#224488</span> / <span class="number">2</span>; <span class="comment">// #112244</span></span><br><span class="line"><span class="attribute">background-color</span>: <span class="number">#112244</span> + <span class="number">#111</span>; <span class="comment">// #223355</span></span><br></pre></td></tr></table></figure><h2 id="继承-Extend"><a href="#继承-Extend" class="headerlink" title="继承(Extend)"></a>继承(Extend)</h2><h3 id="Extend-Syntax"><a href="#Extend-Syntax" class="headerlink" title="Extend Syntax"></a>Extend Syntax</h3><ul><li>继承可让多个选择器应用同一组属性，最终编译为并集选择器</li><li>其性能比混合高，但灵活性比混合低</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="selector-tag">&amp;</span>:<span class="selector-tag">extend</span>(.inline);</span><br><span class="line">  <span class="attribute">background</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.inline</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.inline</span>,</span><br><span class="line"><span class="selector-tag">nav</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Extend-“all”"><a href="#Extend-“all”" class="headerlink" title="Extend “all”"></a>Extend “all”</h3><p>:::tip Extend “all”<br>When you specify the all keyword last in an extend argument it tells Less to match that selector as part of another selector. The selector will be copied and the matched part of the selector only will then be replaced with the extend, making a new selector.</p><p>You can think of this mode of operation as essentially doing a non-destructive search and replace<br>:::</p><ul><li>可理解为把 <code>all</code> 前的选择器出现的地方全都替换为 <code>extend</code> 前的选择器</li><li>即把 <code>.test</code> 替换为 <code>.replacement</code> 生成一个新的选择器应用样式，且不破坏原有的选择器</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.a</span><span class="selector-class">.b</span><span class="selector-class">.test</span>,</span><br><span class="line"><span class="selector-class">.test</span><span class="selector-class">.c</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: orange;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.test</span> &#123;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: green;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.replacement</span>:<span class="selector-tag">extend</span>(.test all) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.a</span><span class="selector-class">.b</span><span class="selector-class">.test</span>,</span><br><span class="line"><span class="selector-class">.test</span><span class="selector-class">.c</span>,</span><br><span class="line"><span class="selector-class">.a</span><span class="selector-class">.b</span><span class="selector-class">.replacement</span>,</span><br><span class="line"><span class="selector-class">.replacement</span><span class="selector-class">.c</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: orange;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.test</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.replacement</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="避免编译"><a href="#避免编译" class="headerlink" title="避免编译"></a>避免编译</h2><p>通过加引号可以避免 Less 编译，直接把内容输出到 CSS 中</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.banner</span> <span class="selector-class">.inline</span> <span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="string">&#x27;100px + 100px&#x27;</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span> + <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.banner</span> <span class="selector-class">.inline</span> <span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="string">&#x27;100px + 100px&#x27;</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> CSS Less </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flex 布局</title>
      <link href="/2023/09/06/flex/"/>
      <url>/2023/09/06/flex/</url>
      
        <content type="html"><![CDATA[<h2 id="flex-布局原理"><a href="#flex-布局原理" class="headerlink" title="flex 布局原理"></a>flex 布局原理</h2><p>全称 flexible box，弹性布局。</p><p>如何开启：为元素添加 <code>display: flex</code>。</p><p>开启 flex 布局的元素，称为 flex 容器（flex container），其子元素成为容器成员，称为 flex 项目。</p><p>flex 布局原理：通过给父盒子添加 <code>display: flex</code>，来控制盒子的位置和排列方式。</p><h2 id="flex-布局父盒子常见属性"><a href="#flex-布局父盒子常见属性" class="headerlink" title="flex 布局父盒子常见属性"></a>flex 布局父盒子常见属性</h2><h3 id="flex-direction"><a href="#flex-direction" class="headerlink" title="flex-direction"></a><code>flex-direction</code></h3><p>设置主轴方向</p><table><thead><tr><th>属性值</th><th>含义</th></tr></thead><tbody><tr><td>row</td><td>默认值，从左到右</td></tr><tr><td>row-reverse</td><td>从右到左</td></tr><tr><td>column</td><td>从上到下</td></tr><tr><td>column-reverse</td><td>从下到上</td></tr></tbody></table><h3 id="justify-content"><a href="#justify-content" class="headerlink" title="justify-content"></a><code>justify-content</code></h3><p>设置主轴子元素排列方式</p><table><thead><tr><th>属性值</th><th>含义</th></tr></thead><tbody><tr><td>flex-start</td><td>默认值，从头开始</td></tr><tr><td>flex-end</td><td>从尾部开始</td></tr><tr><td>center</td><td>居中</td></tr><tr><td>space-around</td><td>平分剩余空间</td></tr><tr><td>space-between</td><td>两侧子元素贴边，再平分剩余空间</td></tr></tbody></table><h3 id="flex-wrap"><a href="#flex-wrap" class="headerlink" title="flex-wrap"></a><code>flex-wrap</code></h3><p>设置子元素是否换行</p><p>默认不换行，若子盒子宽度和大于父盒子，则会收缩！</p><table><thead><tr><th>属性值</th><th>含义</th></tr></thead><tbody><tr><td>wrap</td><td>换行</td></tr><tr><td>nowrap</td><td>默认值，不换行</td></tr></tbody></table><h3 id="align-items"><a href="#align-items" class="headerlink" title="align-items"></a><code>align-items</code></h3><p>设置子元素在侧轴上的排列方式（子元素单行）</p><table><thead><tr><th>属性值</th><th>含义</th></tr></thead><tbody><tr><td>flex-start</td><td>侧轴头部开始</td></tr><tr><td>flex-end</td><td>侧轴尾部开始</td></tr><tr><td>center</td><td>侧轴居中</td></tr><tr><td>stretch</td><td>默认值，拉伸（拉满整个侧轴），若子元素设置了高度则失效</td></tr></tbody></table><h3 id="align-content"><a href="#align-content" class="headerlink" title="align-content"></a><code>align-content</code></h3><p>设置子元素在侧轴上的排列方式（子元素多行）</p><table><thead><tr><th>属性值</th><th>含义</th></tr></thead><tbody><tr><td>flex-start</td><td>默认值，侧轴头部开始</td></tr><tr><td>flex-end</td><td>侧轴尾部开始</td></tr><tr><td>center</td><td>侧轴居中</td></tr><tr><td>stretch</td><td>子元素高度平分父元素高度（需要子元素没有设置高度）</td></tr><tr><td>space-around</td><td>平分侧轴空间</td></tr><tr><td>space-between</td><td>侧轴两侧贴边再平分剩余空间</td></tr></tbody></table><h3 id="flex-flow"><a href="#flex-flow" class="headerlink" title="flex-flow"></a><code>flex-flow</code></h3><p><code>flex-direction</code> 与 <code>flex-wrap</code> 属性的复合写法</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">son &#123;</span><br><span class="line">  <span class="attribute">flex-flow</span>: row wrap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="flex-布局子盒子常见属性"><a href="#flex-布局子盒子常见属性" class="headerlink" title="flex 布局子盒子常见属性"></a>flex 布局子盒子常见属性</h2><h3 id="flex"><a href="#flex" class="headerlink" title="flex"></a><code>flex</code></h3><p><code>flex</code> 属性其实是 <code>flex-grow</code>、<code>flex-shrink</code>、<code>flex-basis</code> 三个属性的简写。</p><p><code>flex-grow</code> 属性值为一个数字，用于设置弹性盒子的扩展比例，即盒子占剩余空间的份数，默认为 0。常见的 <code>flex: 1</code> 是 <code>flex-grow</code> 为 1。</p><p><code>flex-shrink</code> 属性值为一个数字，用于设置盒子的收缩比例，当子盒子的宽度之和大于父盒子时才会收缩。</p><p><code>flex-basis</code> 用于设置子盒子的初始长度。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.son</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">33.33%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="align-self"><a href="#align-self" class="headerlink" title="align-self"></a><code>align-self</code></h3><p>单独设置某个子盒子在侧轴的排列方式，它会覆盖 <code>align-items</code> 属性。默认值为 <code>auto</code>，表示继承父盒子的 <code>align-items</code> 属性，其余属性值与 <code>align-items</code> 相同。</p><h3 id="order"><a href="#order" class="headerlink" title="order"></a><code>order</code></h3><p>定义子盒子在<strong>主轴</strong>上的排列顺序。默认值为 0，值越小越靠前，可以为负数。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.son</span> &#123;</span><br><span class="line">  <span class="attribute">order</span>: -<span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> CSS flex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS 那些事儿</title>
      <link href="/2023/09/06/css/"/>
      <url>/2023/09/06/css/</url>
      
        <content type="html"><![CDATA[<h2 id="CSS-选择器"><a href="#CSS-选择器" class="headerlink" title="CSS 选择器"></a>CSS 选择器</h2><h3 id="标签选择器"><a href="#标签选择器" class="headerlink" title="标签选择器"></a>标签选择器</h3><ul><li>通过标签名选择元素</li><li>优点：可快速为同类型标签统一设置样式</li><li>缺点：不能涉及差异化样式，只能选择全部标签</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="类选择器"><a href="#类选择器" class="headerlink" title="类选择器"></a>类选择器</h3><ul><li>通过类名选择元素</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="id-选择器"><a href="#id-选择器" class="headerlink" title="id 选择器"></a>id 选择器</h3><ul><li>通过元素 id 属性选择元素</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#md</span> &#123;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="通配符选择器"><a href="#通配符选择器" class="headerlink" title="通配符选择器"></a>通配符选择器</h3><ul><li>选择页面所有元素</li><li>用于清除内外边距</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="相邻选择器"><a href="#相邻选择器" class="headerlink" title="相邻选择器"></a>相邻选择器</h3><ul><li>选择所有指定元素的相邻后一个兄弟节点</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>h1-2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>p0 被选中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;good&quot;</span>&gt;</span>h1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>p1 被选中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>p2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> + <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">text-decoration</span>: underline;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="后代选择器"><a href="#后代选择器" class="headerlink" title="后代选择器"></a>后代选择器</h3><ul><li>在所有后代节点中选</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="子选择器"><a href="#子选择器" class="headerlink" title="子选择器"></a>子选择器</h3><ul><li>只在亲儿子中选</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &gt; <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="并集选择器"><a href="#并集选择器" class="headerlink" title="并集选择器"></a>并集选择器</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span>,</span><br><span class="line"><span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-tag">h3</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="交集选择器"><a href="#交集选择器" class="headerlink" title="交集选择器"></a>交集选择器</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* good类的p元素 */</span></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.good</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="伪类选择器"><a href="#伪类选择器" class="headerlink" title="伪类选择器"></a>伪类选择器</h3><ul><li>根据元素状态或所处 DOM 结构选择元素</li></ul><h4 id="动态伪类选择器"><a href="#动态伪类选择器" class="headerlink" title="动态伪类选择器"></a>动态伪类选择器</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">按这个顺序声明</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:link</span> 链接一开始的样式</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:visited</span> 链接访问后的样式</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> 光标经过链接的样式</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:active</span> 链接被按下时的样式</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">:focus</span> 用于选择获取焦点的表单元素，一般针对表单元素而言</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:focus</span></span><br><span class="line"><span class="selector-tag">textarea</span><span class="selector-pseudo">:focus</span></span><br></pre></td></tr></table></figure><h4 id="结构伪类选择器-C3"><a href="#结构伪类选择器-C3" class="headerlink" title="结构伪类选择器(C3)"></a>结构伪类选择器(C3)</h4><table><thead><tr><th>选择符</th><th>含义</th></tr></thead><tbody><tr><td>E:first-child</td><td>第一个子元素 E</td></tr><tr><td>E:last-child</td><td>最后一个子元素 E</td></tr><tr><td>E:nth-child(n)</td><td>第 n 个子元素 E</td></tr><tr><td>E:first-of-type</td><td>指定元素 E 的第一个</td></tr><tr><td>E:last-of-type</td><td>指定元素 E 的最后一个</td></tr><tr><td>E:nth-of-type(n)</td><td>指定元素 E 的第 n 个</td></tr></tbody></table><ul><li>n 可以是数字、关键字（even，odd）、公式（n 从 0 开始）</li><li>nth-child 先找父亲的第 n 个孩子，再看是否为元素 E，是成功，否失败</li><li>nth-of-type 是直接找第 n 个 E，忽略其他非 E 的元素</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>span<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>4<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 啥都选不到 */</span></span><br><span class="line"><span class="selector-tag">div</span> &gt; <span class="selector-tag">p</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 选到2号p标签 */</span></span><br><span class="line"><span class="selector-tag">div</span> &gt; <span class="selector-tag">p</span><span class="selector-pseudo">:nth-of-type</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="属性选择器-C3"><a href="#属性选择器-C3" class="headerlink" title="属性选择器(C3)"></a>属性选择器(C3)</h3><table><thead><tr><th>选择符</th><th>含义</th></tr></thead><tbody><tr><td>E[att]</td><td>选择具有 att 属性的 E 元素</td></tr><tr><td>E[att&#x3D;”val”]</td><td>选择具有 att 属性且属性值等于 val 的 E 元素</td></tr><tr><td>E[att^&#x3D;”val”]</td><td>选择具有 att 属性且属性值以 val 开头的 E 元素</td></tr><tr><td>E[att$&#x3D;”val”]</td><td>选择具有 att 属性且属性值以 val 结尾的 E 元素</td></tr><tr><td>E[att*&#x3D;”val”]</td><td>选择具有 att 属性且属性值含有 val 的 E 元素</td></tr></tbody></table><h3 id="伪元素选择器-C3"><a href="#伪元素选择器-C3" class="headerlink" title="伪元素选择器(C3)"></a>伪元素选择器(C3)</h3><ul><li>伪元素选择器利用 CSS 创建新标签元素，而不需要 HTML 标签，从而简化 HTML 结构</li><li>before 和 after 创建了一个行内元素，在 DOM 树中无法找到，故为伪元素</li><li>必须有 content 属性</li></ul><table><thead><tr><th>选择器</th><th>含义</th></tr></thead><tbody><tr><td>::before</td><td>在元素内部前面插入内容</td></tr><tr><td>::after</td><td>在元素内部后面插入内容</td></tr></tbody></table><p>伪元素字体图标</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;\e91e&#x27;</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>伪元素清除浮动</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、额外标签法（隔墙法）</span><br><span class="line">在浮动元素后面添加一个块级标签（如<span class="selector-tag">div</span>），并设置 <span class="attribute">clear</span>: both</span><br><span class="line"></span><br><span class="line">&lt;div style=<span class="string">&quot;clear:both&quot;</span> &gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、父级元素添加overflow，将其属性值设置为 hidden、 auto 或 scroll</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、父级添加after伪元素</span><br><span class="line">.clearfix:after &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>; 必须要有<span class="attribute">content</span>属性</span><br><span class="line">  <span class="attribute">display</span>: block; 块级元素</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>; 不要看见该元素</span><br><span class="line">  <span class="attribute">clear</span>: both; 核心代码清除浮动</span><br><span class="line">  <span class="attribute">visibility</span>: hidden; 不要看见该元素</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span> &#123; <span class="comment">/* IE6、 7 专有 */</span></span><br><span class="line">  *zoom: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、父级元素添加双伪元素</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:before</span>,<span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>:<span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">display</span>:table; 转换为块级元素并一行显示</span><br><span class="line">&#125; .</span><br><span class="line">clearfix<span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">clear</span>:both;</span><br><span class="line">&#125; .</span><br><span class="line">clearfix &#123;</span><br><span class="line">  *zoom:<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://juejin.cn/post/6976646049456717838">相关链接</a></p><h2 id="CSS-Modules"><a href="#CSS-Modules" class="headerlink" title="CSS Modules"></a>CSS Modules</h2><p>CSS 不是编程语言，是一种网页样式描述的手段。</p><p>但程序员希望将其改造得像编程语言，于是 scss、less 出现了。</p><p>而 CSS Modules 为 CSS 增加了<strong>局部作用域</strong>和<strong>模块依赖</strong>两个功能。</p><h3 id="局部作用域"><a href="#局部作用域" class="headerlink" title="局部作用域"></a>局部作用域</h3><p>我们都知道，CSS 是全局生效的，每个组件的样式都会对全局起作用。</p><p>要产生局部作用域，即避免样式冲突，就是使用唯一的类名。</p><p>但我们无法保证自己的类名不会与别人重复。</p><p>此时，CSS Modules 就有用武之地了。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">&#x27;./App.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&#123;style.title&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      Hello World</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>style.title</code> 会被构建工具编译成哈希字符串</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;_3zyde4l1yATCOkgn-DBWEL&quot;</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">._3zyde4l1yATCOkgn-DBWEL &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样，类名就是唯一的了。</p><h4 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h4><p><a href="http://www.ruanyifeng.com/blog/2016/06/css_modules.html">CSS Modules 用法教程</a></p><h2 id="CSS-隐藏元素-see-no-evil"><a href="#CSS-隐藏元素-see-no-evil" class="headerlink" title="CSS 隐藏元素 :see_no_evil"></a>CSS 隐藏元素 :see_no_evil</h2><h4 id="1、设置-display-none"><a href="#1、设置-display-none" class="headerlink" title="1、设置 display: none"></a>1、设置 <code>display: none</code></h4><ul><li>隐藏元素不再占有原来位置，因此会导致页面布局改变，引起重排</li><li>子元素无法通过设置 <code>display: block</code> 实现反隐藏</li><li>隐藏元素绑定的事件不会触发</li></ul><h4 id="2、设置-visibility-hidden"><a href="#2、设置-visibility-hidden" class="headerlink" title="2、设置 visibility: hidden"></a>2、设置 <code>visibility: hidden</code></h4><ul><li>隐藏元素占有原来位置，实现的是视觉上的隐藏</li><li>子元素可通过设置 <code>visibility: visible</code> 显示自己</li><li>隐藏元素绑定的事件不会触发，如点击事件</li></ul><h4 id="3、设置-opacity-0"><a href="#3、设置-opacity-0" class="headerlink" title="3、设置 opacity: 0"></a>3、设置 <code>opacity: 0</code></h4><ul><li>通过设置透明度为 0 来隐藏元素，因此占有原来位置</li><li>子元素无法通过设置 <code>opacity: 1</code> 显示自己</li><li><code>opacity: 0</code> 的元素仍然能触发已绑定的事件</li></ul><h4 id="4、利用绝对定位-position-absolute"><a href="#4、利用绝对定位-position-absolute" class="headerlink" title="4、利用绝对定位 position: absolute"></a>4、利用绝对定位 <code>position: absolute</code></h4><ul><li>将 <code>top</code> 和 <code>left</code> 设置为足够大的负数，使其离开屏幕，即可实现隐藏效果</li><li>只要我跑得够远，你就看不到我 :stuck_out_tongue_winking_eye:</li><li>绝对定位的元素是脱标的，不会影响页面布局</li></ul><h4 id="相关链接-1"><a href="#相关链接-1" class="headerlink" title="相关链接"></a>相关链接</h4><p><a href="https://www.html.cn/qa/css3/14720.html">css 隐藏元素的几种方法是什么？</a></p><h2 id="CSS-定位"><a href="#CSS-定位" class="headerlink" title="CSS 定位"></a>CSS 定位</h2><h3 id="静态定位-static"><a href="#静态定位-static" class="headerlink" title="静态定位 static"></a>静态定位 static</h3><p>默认定位，相当于没有定位。</p><h3 id="相对定位-relative"><a href="#相对定位-relative" class="headerlink" title="相对定位 relative"></a>相对定位 relative</h3><ul><li>相对于元素原本的位置进行偏移</li><li>元素会浮起来，脱离标准流，但仍然占据原本的位置</li></ul><h3 id="绝对定位-absolute"><a href="#绝对定位-absolute" class="headerlink" title="绝对定位 absolute"></a>绝对定位 absolute</h3><ul><li>相对于最近的具有定位属性的父元素进行偏移，若没有，则相对于 <code>body</code> 进行偏移</li><li>元素脱离标准流，且不占据原本的位置</li><li>通常是“子绝父相”</li></ul><h3 id="固定定位-fixed"><a href="#固定定位-fixed" class="headerlink" title="固定定位 fixed"></a>固定定位 fixed</h3><ul><li>相对于浏览器窗口进行偏移</li><li>不会随着浏览器窗口的滚动而滚动</li><li>可用于创建固定头部、底部</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 创建全屏遮罩</span><br><span class="line"><span class="selector-class">.mask</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.25</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="相关链接-2"><a href="#相关链接-2" class="headerlink" title="相关链接"></a>相关链接</h4><p><a href="https://blog.csdn.net/weixin_38055381/article/details/81558288">CSS 的几种定位详解</a></p><h2 id="CSS-global"><a href="#CSS-global" class="headerlink" title="CSS :global"></a>CSS <code>:global</code></h2><p>在 CSS 局部作用域覆盖默认样式。</p><p>如覆盖 Ant Design 组件的默认样式。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// index<span class="selector-class">.module</span><span class="selector-class">.scss</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:global &#123;</span><br><span class="line">  // antd 的默认样式被覆盖</span><br><span class="line">  <span class="selector-class">.ant-form-head</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Form</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">&#x27;./index.module.scss&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">const</span> <span class="title function_">Hello</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;styles.father&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="相关链接-3"><a href="#相关链接-3" class="headerlink" title="相关链接"></a>相关链接</h4><p><a href="https://blog.csdn.net/qq_36209248/article/details/90603474">CSS 中的 global</a></p><h2 id="CSS-属性浏览器私有前缀"><a href="#CSS-属性浏览器私有前缀" class="headerlink" title="CSS 属性浏览器私有前缀"></a>CSS 属性浏览器私有前缀</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Google Chrome、Safari：-webkit-</span><br><span class="line">Firefox：-moz-</span><br><span class="line">IE：-ms-</span><br><span class="line">Opera：-o-</span><br></pre></td></tr></table></figure><p>私有前缀是为了兼容老版本的浏览器。</p><p>什么是兼容？可以简单理解为一段代码在新的浏览器能正常运行，在老版本的浏览器也能正常运行。</p><p>对于一些新的 CSS 属性，老浏览器可能运行异常，通过添加私有前缀，让这个属性只在指定内核的浏览器生效，老浏览器就忽略这个属性。</p><p>等到该属性成熟、所有浏览器都支持后，就可以去掉私有前缀。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">color</span>: black;</span><br><span class="line">  -webkit-text-stroke: <span class="number">2px</span> red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="相关链接-4"><a href="#相关链接-4" class="headerlink" title="相关链接"></a>相关链接</h4><p><a href="https://blog.csdn.net/Dreammin/article/details/104663120">浏览器的私有前缀理解</a></p><p><a href="https://blog.csdn.net/wyx100/article/details/50450728">-moz、-ms、-webkit 浏览器私有前缀详解，作用、出处</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML</title>
      <link href="/2023/09/06/html/"/>
      <url>/2023/09/06/html/</url>
      
        <content type="html"><![CDATA[<h1 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h1><hr><h3 id="常用的语义化标签"><a href="#常用的语义化标签" class="headerlink" title="常用的语义化标签"></a>常用的语义化标签</h3><ul><li><code>&lt;article&gt;</code>：表示文章主体部分</li><li><code>&lt;aside&gt;</code>：表示跟文章主体不那么相关的部分，一般包含导航、广告等工具性质的内容</li><li><code>&lt;details&gt; 和 &lt;summary&gt;</code>：表示可以查看或隐藏的其他详细信息</li><li><code>&lt;figure&gt; 和 &lt;figcaption&gt;</code>：表示与文章相关的图像、照片等流内容</li><li><code>&lt;footer&gt;</code>：通常出现在尾部，包含作者信息、相关链接、版权信息等</li><li><code>&lt;header&gt;</code>：表示导航或者介绍性的内容</li><li><code>&lt;h1&gt; ~ &lt;h6&gt;</code>：表示文章中不同层级的标题</li><li><code>&lt;main&gt;</code>：表示文章的主要内容</li><li><code>&lt;nav&gt;</code>：表示导航<ul><li>在 <code>header</code> 中大多表示文章目录</li><li>在 <code>aside</code> 中大多是关联页面或者是整站地图</li></ul></li><li><code>&lt;section&gt;</code>：表示文章中的“节”或“段”</li><li><code>&lt;time&gt;</code>：表示日期或时间</li></ul><hr><h2 id="noscript-标签"><a href="#noscript-标签" class="headerlink" title="noscript 标签"></a><code>noscript</code> 标签</h2><p><code>noscript</code> 标签是一个古老的标签，当初被引入的目的是帮助老旧的浏览器平滑升级更替，早期的浏览器不支持 JavaScript，因此使用 <code>noscript</code> 标签显示替代的内容</p><p><code>noscript</code> 标签在下面两种情况下起作用：</p><ul><li>浏览器不支持 JavaScript</li><li>浏览器支持 JavaScript，但被禁用</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">noscript</span>&gt;</span> 老铁，这个页面需要 JavaScript 支持啊 <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br></pre></td></tr></table></figure><p>网站不能强制开启 JavaScript，但增加提示还是比较用户友好的。</p><h2 id="获取-html-head-body-标签"><a href="#获取-html-head-body-标签" class="headerlink" title="获取 html head body 标签"></a>获取 <code>html head body</code> 标签</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">documentElement</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">head</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span></span><br></pre></td></tr></table></figure><h2 id="DOCTYPE-的作用"><a href="#DOCTYPE-的作用" class="headerlink" title="!DOCTYPE 的作用"></a><code>!DOCTYPE</code> 的作用</h2><p>DOCTYPE 是文档类型 document type 的缩写，指明浏览器使用哪种 HTML 规范来解析页面。</p><p>若不添加，则采用混杂模式，每种浏览器都采用自身的方式解析渲染页面，导致页面效果可能不同。</p><p>添加之后，采用标准模式，每种浏览器都按照统一的 HTML 标准解析渲染页面。</p><h4 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h4><p><a href="https://blog.csdn.net/qq_38128179/article/details/80758192">深入理解 DOCTYPE 的作用</a></p><h2 id="em-和-rem-的区别"><a href="#em-和-rem-的区别" class="headerlink" title="em 和 rem 的区别"></a><code>em</code> 和 <code>rem</code> 的区别</h2><p>区别：参照物不同。</p><p><code>em</code>：</p><ul><li>元素的字体大小 <code>font-size</code> 相对于父元素的 <code>font-size</code></li><li>元素的 <code>width heigth border margin padding</code> 相对于自身的 <code>font-size</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  父元素div</span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    子元素p</span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>孙元素span<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2em</span>; <span class="comment">/* 40px */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.5em</span>; <span class="comment">/* 10px */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2em</span>; <span class="comment">/* 20px */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.5em</span>; <span class="comment">/* 5px */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2em</span>; <span class="comment">/* 10px */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>rem</code>：</p><ul><li>统一相对于根元素 <code>&lt;html&gt;</code> 的字体大小 <code>font-size</code></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">2rem</span>; <span class="comment">/* 32px */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">10rem</span>; <span class="comment">/* 160px */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这两种都可做响应式，但 <code>rem</code> 更方便。</p><h4 id="相关链接-1"><a href="#相关链接-1" class="headerlink" title="相关链接"></a>相关链接</h4><p><a href="https://www.cnblogs.com/wind-lanyan/p/6978084.html">css 中单位 em 和 rem 的区别</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端文章</title>
      <link href="/2023/09/05/%E5%89%8D%E7%AB%AF%E6%96%87%E7%AB%A0/"/>
      <url>/2023/09/05/%E5%89%8D%E7%AB%AF%E6%96%87%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="前端体系梳理"><a href="#前端体系梳理" class="headerlink" title="前端体系梳理"></a>前端体系梳理</h2><p><a href="https://segmentfault.com/a/1190000013662126">从输入 URL 到页面加载的过程？如何由一道题完善自己的前端知识体系！</a></p><h2 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h2><p><a href="https://www.cnblogs.com/chenyoumei/p/9156849.html">浏览器渲染页面的原理和流程</a></p><p><a href="https://segmentfault.com/a/1190000014383214">V8 引擎垃圾回收</a></p><h2 id="HTML-CSS"><a href="#HTML-CSS" class="headerlink" title="HTML &amp;&amp; CSS"></a>HTML &amp;&amp; CSS</h2><p><a href="https://www.jianshu.com/p/f5ffd5e014a9">script 标签 async 和 defer 区别</a><br><a href="https://www.jianshu.com/p/9a463d50e441">CSS 绘制三角形</a></p><h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><p><a href="https://www.cnblogs.com/wangfupeng1988/p/3977924.html">深入理解 javascript 原型和闭包</a><br><a href="https://zhuanlan.zhihu.com/p/26229293">深入浅出 Javascript 事件循环机制(上)</a><br><a href="https://zhuanlan.zhihu.com/p/46068171">深入理解 JavaScript 的事件循环</a><br><a href="https://zhuanlan.zhihu.com/p/72507900">如何解释 Event Loop 面试官才满意？</a><br><a href="https://www.cnblogs.com/lhb25/archive/2011/09/06/javascript-scope-chain.html">理解作用域和作用域链</a></p><h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2><p><a href="https://www.cnblogs.com/canfoo/p/6891868.html">Vue 双向绑定原理及实现</a><br><a href="https://blog.csdn.net/w993263495/article/details/85030839">Vuejs 如何实现双向绑定</a><br><a href="https://segmentfault.com/a/1190000006599500">剖析 Vue 原理&amp;实现双向绑定 MVVM</a><br><a href="https://www.cnblogs.com/lgt-hello-world/p/12620073.html">vue 生命周期</a><br><a href="https://www.jianshu.com/p/7af8554d8f08">v-if 与 v-show 的区别</a></p><h2 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h2><p><a href="https://www.pianshen.com/article/68431265749/">TCP 三次握手最后一次失败怎么办</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 前端开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>其他文章</title>
      <link href="/2023/09/05/%E5%85%B6%E4%BB%96%E6%96%87%E7%AB%A0/"/>
      <url>/2023/09/05/%E5%85%B6%E4%BB%96%E6%96%87%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/97ba64888894">Postman 教程</a></p><h2 id="我爱-GTA"><a href="#我爱-GTA" class="headerlink" title="我爱 GTA"></a>我爱 GTA</h2><p><a href="https://zhidao.baidu.com/question/1900115355228272460.html">GTA 圣安地列斯秘籍</a></p><h2 id="阿里云部署-Node"><a href="#阿里云部署-Node" class="headerlink" title="阿里云部署 Node"></a>阿里云部署 Node</h2><p><a href="https://developer.aliyun.com/article/80217">如何快速部署 Node.js 项目</a><br><a href="https://blog.csdn.net/weixin_43503511/article/details/86670345">为阿里云服务器 ECS 实例安装 Nodejs</a></p><h2 id="我爱-MATLAB"><a href="#我爱-MATLAB" class="headerlink" title="我爱 MATLAB"></a>我爱 MATLAB</h2><p><a href="https://www.ilovematlab.cn/">MATLAB 中文论坛</a><br><a href="https://blog.csdn.net/qq_44868807/article/details/106628113">MATLAB—GUI 新手入门教程</a><br><a href="https://www.bilibili.com/video/BV1o5411W7dF">MATLAB GUI 界面设计 数字图像处理</a></p><h2 id="Python-Keras-深度学习"><a href="#Python-Keras-深度学习" class="headerlink" title="Python &amp; Keras 深度学习"></a>Python &amp; Keras 深度学习</h2><p>多标签分类器：</p><p><a href="https://www.pyimagesearch.com/2018/05/07/multi-label-classification-with-keras/">Multi-label classification with Keras</a><br><a href="https://www.pyimagesearch.com/2018/04/16/keras-and-convolutional-neural-networks-cnns/">Keras and Convolutional Neural Networks (CNNs)</a><br><a href="https://www.pyimagesearch.com/2018/04/09/how-to-quickly-build-a-deep-learning-image-dataset/">How to (quickly) build a deep learning image dataset</a><br><a href="https://blog.csdn.net/lc013/article/details/100033158">基于 Keras 的多标签图像分类器</a><br><a href="https://blog.csdn.net/tMb8Z9Vdm66wH68VX1/article/details/81090757">手把手教你用 Keras 进行多标签分类</a><br><a href="https://blog.csdn.net/qq_37764129/article/details/100853805">多标签分类（基于 Keras）</a><br><a href="https://blog.csdn.net/lly1122334/article/details/88806913">使用 Keras 进行单模型多标签分类</a><br><a href="https://blog.csdn.net/tMb8Z9Vdm66wH68VX1/article/details/81713585">教你用 Keras 和 CNN 建立模型识别神奇宝贝</a></p><p>深度学习：</p><p><a href="https://blog.csdn.net/qq_15192373/article/details/89552498">One-Hot 独热编码</a><br><a href="https://blog.csdn.net/zziahgf/article/details/79614822">VGGNet 阅读理解</a><br><a href="https://blog.csdn.net/u013181595/article/details/80974210">VGGNet 介绍</a></p><p>Keras 深度学习框架：</p><p><a href="https://keras-zh.readthedocs.io/">Keras 中文文档</a><br><a href="https://www.bilibili.com/video/BV1gE411R7jd">Keras 深度学习简明教程</a><br><a href="https://www.jianshu.com/p/c98a24cfa821/">Keras 深度学习数据集</a><br><a href="https://blog.csdn.net/weixin_43935696/article/details/112214007">keras.layers.BatchNormalization 解析</a><br><a href="https://www.jianshu.com/p/a3f3033a7379">Keras 中的 Embedding 简单理解</a><br><a href="https://blog.csdn.net/moyu123456789/article/details/83444140">Keras 中 to_categorical 函数解析</a><br><a href="https://blog.csdn.net/qq_29676179/article/details/118001025">Keras 用 fit 训练模型时,batch_size，steps_per_epoch 的含义</a><br><a href="https://blog.csdn.net/weixin_40244676/article/details/105091539">model.fit()详解</a><br><a href="https://blog.csdn.net/qq_27825451/article/details/90056896">Keras 图像预处理-ImageDataGenerator 类</a><br><a href="https://www.pythonheidong.com/blog/article/430947/349baf46280172a88c55/">Keras.preprocessing.image 中的 img_to_array</a><br><a href="https://www.cnblogs.com/zhibei/p/12070046.html">sigmoid 和 softmax 的应用意义区别</a><br><a href="https://www.yisu.com/zixun/231984.html">如何理解 K.image_data_format() &#x3D;&#x3D; ‘channels_first’</a><br><a href="https://blog.csdn.net/lovebyz/article/details/77712003">Keras-text.Tokenizer：文本与序列预处理</a><br><a href="https://blog.csdn.net/wcy23580/article/details/84957471">序列预处理 pad_sequences()序列填充</a></p><p>Python 模块：</p><p><a href="http://www.weixueyuan.net/a/633.html">Python pickle 模块的用法</a><br><a href="https://www.cnblogs.com/Yanjy-OnlyOne/p/11288098.html">sklearn 的 train_test_split()函数参数含义</a><br><a href="https://blog.csdn.net/Einstellung/article/details/90634159">imutils 用法</a><br><a href="https://zhuanlan.zhihu.com/p/56922793">argparse 模块用法实例详解</a><br><a href="https://blog.csdn.net/u012052268/article/details/77720645/">标签二值化 LabelBinarizer</a><br><a href="https://blog.csdn.net/qq_41185868/article/details/79675875">CV2 库</a></p><p>实际操作：</p><p><a href="https://www.cnblogs.com/thewaytotheway/p/12847260.html">使用 pip 安装 Opencv</a><br><a href="https://www.cnblogs.com/Qi77/p/12514730.html">Python 安装 gensim</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>网站推荐</title>
      <link href="/2023/09/05/%E7%BD%91%E7%AB%99%E6%8E%A8%E8%8D%90/"/>
      <url>/2023/09/05/%E7%BD%91%E7%AB%99%E6%8E%A8%E8%8D%90/</url>
      
        <content type="html"><![CDATA[<div class="flink"><div class="flink-name">推荐博客</div> <div class="flink-list"><div class="flexcard-flink-list">              <a href="https://blog.anheyu.com/" title="安知鱼" target="_blank" class="flink-list-card cf-friends-link">                <div class="wrapper cover">                    <img class="no-lightbox cover fadeIn" src="https://npm.elemecdn.com/anzhiyu-theme-static@1.1.6/img/blog.anheyu.com.jpg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="安知鱼" />                </div>                <div class="info">                  <img class="no-lightbox cf-friends-avatar flink-avatar" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="安知鱼"/>                  <span class="flink-sitename cf-friends-name">安知鱼</span>                </div>              </a>              <a href="https://brucecqm.github.io/bruceblogpages/" title="BruceBlog" target="_blank" class="flink-list-card cf-friends-link">                <div class="wrapper cover">                    <img class="no-lightbox cover fadeIn" src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20230925195944.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="BruceBlog" />                </div>                <div class="info">                  <img class="no-lightbox cf-friends-avatar flink-avatar" src="https://brucecqm.github.io/bruceblogpages/logo.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="BruceBlog"/>                  <span class="flink-sitename cf-friends-name">BruceBlog</span>                </div>              </a>              <a href="https://notes.fe-mm.com/" title="茂茂物语" target="_blank" class="flink-list-card cf-friends-link">                <div class="wrapper cover">                    <img class="no-lightbox cover fadeIn" src="https://cdn.jsdelivr.net/gh/dont-sleep-so-late/CDN/images/20230925200137.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="茂茂物语" />                </div>                <div class="info">                  <img class="no-lightbox cf-friends-avatar flink-avatar" src="https://notes.fe-mm.com/logo.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="茂茂物语"/>                  <span class="flink-sitename cf-friends-name">茂茂物语</span>                </div>              </a></div></div><div class="flink-name">推荐项目</div> <div class="flink-list"><div class="flexcard-flink-list">              <a href="https://www.bilibili.com/video/BV1go4y1M7Fa" title="校园课表微信小程序" target="_blank" class="flink-list-card cf-friends-link">                <div class="wrapper cover">                    <img class="no-lightbox cover fadeIn" src="https://i0.hdslb.com/bfs/archive/4918a74b55f5f45274a6ae5d481d01b27f516a07.jpg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="校园课表微信小程序" />                </div>                <div class="info">                  <img class="no-lightbox cf-friends-avatar flink-avatar" src="undefined" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="校园课表微信小程序"/>                  <span class="flink-sitename cf-friends-name">校园课表微信小程序</span>                </div>              </a></div></div><div class="flink-name">PPT</div><div class="flink-desc">值得推荐的网站</div> <div class="flink-list"><div class="anzhiyu-flink-list">            <div class="flink-list-item">              <a href="https://ishare.iask.sina.com.cn/" title="爱问文库" class="cf-friends-link" target="_blank">                <div class="flink-item-icon">                  <img class="no-lightbox cf-friends-avatar" src="https://ishare.iask.sina.com.cn/images/index/logo.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="爱问文库" />                </div>                <div class="flink-item-info">                  <div class="flink-item-name">爱问文库</div>                  <div class="flink-item-desc" title="视频网站">视频网站</div>                </div>              </a>            </div>            <div class="flink-list-item">              <a href="https://gamma.app/" title="Gamma" class="cf-friends-link" target="_blank">                <div class="flink-item-icon">                  <img class="no-lightbox cf-friends-avatar" src="https://assets.website-files.com/62e823626cd4fdd0e5dc1527/62e823626cd4fdc26bdc1576_Gamma.svg" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Gamma" />                </div>                <div class="flink-item-info">                  <div class="flink-item-name">Gamma</div>                  <div class="flink-item-desc" title="这是一个关于AI生成PPT的网站">这是一个关于AI生成PPT的网站</div>                </div>              </a>            </div>            <div class="flink-list-item">              <a href="https://www.woodo.cn/" title="吾爱幻灯片" class="cf-friends-link" target="_blank">                <div class="flink-item-icon">                  <img class="no-lightbox cf-friends-avatar" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDhweCIgaGVpZ2h0PSI0OHB4IiB2aWV3Qm94PSIwIDAgNDggNDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+MTwvdGl0bGU+CiAgICA8ZyBpZD0i5o6n5Lu2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0i5a+86Iiq5qCPIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjQwLjAwMDAwMCwgLTIwLjAwMDAwMCkiIGZpbGwtcnVsZT0ibm9uemVybyI+CiAgICAgICAgICAgIDxnIGlkPSIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNDAuMDAwMDAwLCAyMC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zMy42LDAgQzQxLjU1MjkwMDQsMCA0OCw2LjQ0NzA5OTYgNDgsMTQuNCBMNDgsMzMuNiBDNDgsNDEuNTUyOTAwNCA0MS41NTI5MDA0LDQ4IDMzLjYsNDggTDE0LjQsNDggQzYuNDQ3MDk5Niw0OCAwLDQxLjU1MjkwMDQgMCwzMy42IEwwLDE0LjQgQzAsNi40NDcwOTk2IDYuNDQ3MDk5NiwwIDE0LjQsMCBMMzMuNiwwIFoiIGlkPSLlvaLnirbnu5PlkIgtcGF0aCIgZmlsbD0iIzBEN0JGNiI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTMwLjc0OTQ1NzEsMTUuODQgTDI4LjI2MjQwMzMsMTUuODQgQzI4LjEyMTE5NDIsMTUuODQgMjcuOTgzMDE4LDE1Ljg2MTEwNjQgMjcuODUwODY4MywxNS45MDAyNzU3IEwyNy44NTA4NjgzLDE1LjkwMDI3NTcgTDI3LjgxMTgzMzgsMTUuOTEyMzMwOCBDMjcuMjk1MTMwNCwxNi4wMzI4ODIxIDI2Ljg2ODYyNzYsMTYuMzUyNDAyNCAyNi42MDcyODIzLDE2LjgxMzU0MDcgTDI2LjYwNzI4MjMsMTYuODEzNTQwNyBMMTguOTc3ODUxOCwzMC4wNzU2NDY3IEMxOC43MjI0OTM2LDMwLjUxNTcxODIgMTguNjUzNTYzMSwzMS4wMzExMjQ1IDE4Ljc4NTU1NTIsMzEuNTI1NDYzOSBDMTguOTE3ODYyNSwzMi4wMTk3MjQyIDE5LjIzMzE3MDUsMzIuNDMyNzIxMSAxOS42NzQ3OTg4LDMyLjY4ODg0MzMgQzIwLjU4NDgzOTYsMzMuMjEzMzQwMiAyMS43NTMzNTA0LDMyLjg5OTg2NzMgMjIuMjc4OTk1LDMxLjk4NjYwMjMgTDIyLjI3ODk5NSwzMS45ODY2MDIzIEwyOS42OTUxNzQxLDE5LjEwNzI5NjEgQzI5Ljc3NjMxNTIsMTguOTY1NjM4NCAyOS45Mjk0MTk4LDE4Ljg3ODIwOTEgMzAuMDkxNjIzMywxOC44OTAzMDM4IEMzMy4wMjAyNjU4LDE5LjA2ODEyNjggMzUuMzE1MTgwNSwyMS41MDk1NDc2IDM1LjMxNTE4MDUsMjQuNDUxMzE1NyBDMzUuMzE1MTgwNSwyNy40NzQ0NjU3IDMyLjkwMzA4MzksMjkuOTQzMDQwMyAyOS45MDg0NjQ5LDMwLjAyMTQxODQgTDI5LjkwODQ2NDksMzAuMDIxNDE4NCBMMjkuOTA4NDY0OSwzMC4wNDg0OTMgTDI5LjczNDIwODUsMzAuMDMwNDMwMSBMMjkuNjUzMTA2OCwzMC4wMzA0MzAxIEMyOS4wNTIzNDc1LDMwLjAzMDQzMDEgMjguNTU5NzEwNywzMC4zMDc3Mzc2IDI4LjMyODU3NjYsMzAuNzYyOTA3NyBDMjguMDUyMTA2LDMxLjMxNDQ3OTMgMjguMDYxMjA0OSwzMS45MDIyMTYzIDI4LjM1NTU1ODEsMzIuMzgxNDE3NyBDMjguNjQwOTY5OSwzMi44NDg2MDM0IDI5LjEzNjUyMTUsMzMuMTI1OTUwNCAyOS42ODYwNzUyLDMzLjEyMDA5MzggQzI5LjcwMTIwMDYsMzMuMTIwMDkzOCAyOS43MTYxNjg0LDMzLjEyMDA5MzggMjkuNzM0MjA4NSwzMy4xMTY4NTk3IEwyOS43MzQyMDg1LDMzLjExNjg1OTcgTDI5LjkwODQ2NDksMzMuMDg5Nzg1MSBMMjkuOTA4NDY0OSwzMy4xMjAwOTM4IEMzNC42MDMyMjY0LDMzLjAzODUyMTEgMzguNCwyOS4xODA0NDQ1IDM4LjQsMjQuNDUxMzE1NyBDMzguNCwyMi4zODM2NDM0IDM3LjY1ODAzMTYsMjAuMzc5MjUwNyAzNi4zMDkzOTU0LDE4LjgwNTg3ODMgQzM1LjU5NDU2NTksMTcuOTcwOTUxOCAzNC43NDE0MDI2LDE3LjI5Mjc4MTYgMzMuNzk4MzUzOSwxNi43ODk0MzA0IEMzMi44NTgwNjI0LDE2LjI4NjA3OTQgMzEuODI3ODg1NCwxNS45NjM1NTUyIDMwLjc0OTQ1NzEsMTUuODQgTDMwLjc0OTQ1NzEsMTUuODQgWiIgaWQ9IuW9oueKtue7k+WQiC1wYXRoIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjAuMjQyOTY4LDE0Ljg4IEMxOS42MDgzOTM4LDE0Ljg4IDE4Ljk4ODI1OSwxNS4yMjc0NTQ2IDE4LjY0OTIzNjksMTUuODQ5MTQ4MSBMMTguNjQ5MjM2OSwxNS44NDkxNDgxIEwxMS4yODYxMjQ4LDI5LjI1ODg0MDQgQzEwLjc3OTAzNTQsMzAuMTgyMjY4NiAxMS4wODA0MDExLDMxLjM2Nzc4NjUgMTEuOTYxMzE5MiwzMS45MDExMTc3IEMxMi44MzkzODc1LDMyLjQzNDQ4ODkgMTMuOTY2NDk3NiwzMi4xMTc0ODc1IDE0LjQ3MzYyNDksMzEuMTkxMDYxOSBMMTQuNDczNjI0OSwzMS4xOTEwNjE5IEwyMS44MzM3MzUxLDE3Ljc4MTM2OTYgQzIyLjM0MDgyNDUsMTYuODU3OTQxMyAyMi4wMzk2MTA4LDE1LjY3MjM4MzUgMjEuMTYxNTQyNSwxNS4xMzkwNTIzIEMyMC44NzE3NjYzLDE0Ljk2NTM2NSAyMC41NTU5NjEyLDE0Ljg4IDIwLjI0Mjk2OCwxNC44OCBaIiBpZD0i5b2i54q257uT5ZCILXBhdGgiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi41NTYxODU2LDE1LjM2MTU2MTggQzExLjkyMTIxNzUsMTUuMzM4NDM1NiAxMS4zMDM2NjM0LDE1LjU3Mjk2MzMgMTAuODM2NzUyNywxNi4wMTAyMzQ0IEMxMC4zNjk5NTYxLDE2LjQ1MDM5MTYgMTAuMTAwMjY1NywxNy4wNDQwNzc4IDEwLjA4LDE3LjY4NDA1NDQgQzEwLjA4MzAwMzcsMTcuNzI0NjEwNiAxMC4wODU4MTc0LDE3Ljc0MTk2NDggMTAuMDg1ODE3NCwxNy43NTkzNTY5IEwxMC4wODU4MTc0LDE3Ljc1OTM1NjkgTDEwLjA4LDIwLjEzOTcyMTkgTDEyLjI4NjQ5NTIsMjAuMTM5NzIxOSBDMTIuMzIxMzIzNCwyMC4xNDI2MDc5IDEyLjM0MTcwMzMsMjAuMTQ1NDkzOSAxMi4zNjE5NjksMjAuMTUxMzAzOSBMMTIuMzYxOTY5LDIwLjE1MTMwMzkgTDEyLjQwNTQyODIsMjAuMTU3MTE0IEMxMi40MzcyOTA3LDIwLjE1NzExNCAxMi40NjkyNjcyLDIwLjE2IDEyLjUwMTEyOTcsMjAuMTYgQzEzLjEwNDIzNTMsMjAuMTYgMTMuNjc4MzMwMiwxOS45MjI1MTAzIDE0LjEyNDg2MTEsMTkuNTA4NDQxMyBDMTQuNTkxNjU3NywxOS4wNjgyNDYyIDE0Ljg1ODM4MjMsMTguNDc0NTk4IDE0Ljg3ODc2MjEsMTcuODM0NjIxNCBDMTQuODk5MDI3OSwxNy4xOTQ2NDQ5IDE0LjY2OTk0NTEsMTYuNTgzNjA0NSAxNC4yMjkyMzE2LDE2LjExNzQzNTIgQzEzLjc5MTQ0NTgsMTUuNjUxMTUxOSAxMy4xOTY5NzExLDE1LjM4MTg3NzkgMTIuNTU2MTg1NiwxNS4zNjE1NjE4IFoiIGlkPSLlvaLnirbnu5PlkIgtcGF0aCIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="吾爱幻灯片" />                </div>                <div class="flink-item-info">                  <div class="flink-item-name">吾爱幻灯片</div>                  <div class="flink-item-desc" title="幻灯片">幻灯片</div>                </div>              </a>            </div>            <div class="flink-list-item">              <a href="https://www.51pptmoban.com/" title="51PPT模板" class="cf-friends-link" target="_blank">                <div class="flink-item-icon">                  <img class="no-lightbox cf-friends-avatar" src="https://www.51pptmoban.com/images/logo.gif" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="51PPT模板" />                </div>                <div class="flink-item-info">                  <div class="flink-item-name">51PPT模板</div>                  <div class="flink-item-desc" title="这是一个关于PPT的网站">这是一个关于PPT的网站</div>                </div>              </a>            </div></div></div></div><h2 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h2><ul><li><a href="https://panjiachen.github.io/awesome-bookmarks/">panjiachen (opens new window)</a>by 花裤衩</li><li><a href="https://www.code-nav.cn/">编程导航 (opens new window)</a>by 程序员鱼皮</li><li><a href="https://r2coding.com/">编程自学之路 (opens new window)</a>by 程序羊</li><li><a href="https://gitee.com/jishupang/web_atlas">前端知识图谱+B站资源整合 (opens new window)</a>by 技术胖</li><li><a href="https://shengxinjing.cn/">大圣编程自学网 (opens new window)</a>by 大圣</li><li><a href="https://devtool.tech/">开发者武器库(opens new window)</a></li><li><a href="https://www.fly63.com/tool/home.html">工具大全(opens new window)</a></li></ul><h2 id="在线绘图"><a href="#在线绘图" class="headerlink" title="在线绘图"></a>在线绘图</h2><ul><li><a href="https://www.iodraw.com/">https://www.iodraw.com(opens new window)open in new window</a></li><li><a href="https://excalidraw.com/">https://excalidraw.com(opens new window)open in new window</a></li><li><a href="https://www.processon.com/">https://www.processon.com(opens new window)open in new window</a></li><li><a href="https://naotu.baidu.com/">https://naotu.baidu.com/(opens new window)open in new window</a></li></ul><p><code>iodraw</code> 全免费在线画图，无需注册，无文件限制，支持流程图、思维导图、甘特图、拓扑图、时序图、原型图、UML、平面设计图、电路图等。</p><h2 id="图片背景消除"><a href="#图片背景消除" class="headerlink" title="图片背景消除"></a>图片背景消除</h2><p>链接：<a href="https://www.remove.bg/zh">https://www.remove.bg/zh(opens new window)open in new window</a></p><p>在线抠图，<code>100%</code> 全自动消除图片背景且免费。</p><h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web">MDN (opens new window)</a>| <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects">MDN-JS标准内置对象 (opens new window)</a>Web技术权威文档</li><li><a href="https://devdocs.io/">DevDocs (opens new window)</a>Web 开发技术文档，非常不错的学习手册！</li><li><a href="https://zh.javascript.info/">现代JavaScript教程 (opens new window)</a>以最新标准为基准的JS教程</li><li><a href="https://wangdoc.com/javascript/">ES5教程 (opens new window)</a>阮一峰的JS教程</li><li><a href="http://es6.ruanyifeng.com/">ES6教程 (opens new window)</a>阮一峰的ES6教程</li><li><a href="https://wangdoc.com/bash/">Bash 脚本教程 (opens new window)</a>阮一峰编写</li><li><a href="https://www.ecma-international.org/">ECMA (opens new window)</a>ECMA官网</li><li><a href="https://www.runoob.com/">菜鸟教程 (opens new window)</a>涵盖多种语言的初级教程</li><li><a href="https://cloud.tencent.com/developer/devdocs">腾讯云开发者手册(opens new window)</a></li></ul><h2 id="社区"><a href="#社区" class="headerlink" title="社区"></a>社区</h2><ul><li><a href="https://github.com/">Github (opens new window)</a>程序员同性交友社区</li><li><a href="https://juejin.im/">掘金 (opens new window)</a>一个帮助开发者成长的社区</li><li><a href="https://www.jianshu.com/">简书 (opens new window)</a>有很多频道的创作社区</li><li><a href="https://segmentfault.com/">思否 (opens new window)</a>解决技术问题的社区</li><li><a href="https://stackoverflow.com/">stack overflow (opens new window)</a>同上，外网的</li><li><a href="https://www.infoq.cn/topic/Front-end">InfoQ (opens new window)</a>促进软件开发及相关领域知识与创新的传播</li><li><a href="https://www.v2ex.com/">V2EX (opens new window)</a>创意工作者们的社区</li><li><a href="https://mo.fish/">鱼塘热榜 (opens new window)</a>划水网站，收集了很多网站，当天热门文章</li><li><a href="https://maliquankai.com/designnav/">码力全开资源库 (opens new window)</a>很全很强大，独立开发者&#x2F;设计干货&#x2F;优质利器&#x2F;工具资源…</li></ul><h3 id="社区互动"><a href="#社区互动" class="headerlink" title="社区互动"></a>社区互动</h3><ul><li><a href="https://gitter.im/home/explore">gitter(opens new window)</a></li><li><a href="https://txc.qq.com/">兔小巢(opens new window)</a></li></ul><h2 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h2><ul><li><a href="https://trends.google.com/trends">Google 趋势 (opens new window)</a>查看某项技术或关键字的热度趋势，可用于分析某项技术的发展前景，或对比某两项技术的热度。</li><li><a href="https://index.baidu.com/v2/index.html#/">百度指数 (opens new window)</a>同上，但百度的数据仅限国内。</li></ul><h2 id="博客"><a href="#博客" class="headerlink" title="博客"></a>博客</h2><ul><li><a href="http://www.ruanyifeng.com/blog/">阮一峰的网络日志(opens new window)</a></li><li><a href="https://www.samanthaming.com/">samanthaming (opens new window)</a>对前端小知识点的总结，并为每个知识点制作精美的小卡片。</li></ul><h2 id="电子书"><a href="#电子书" class="headerlink" title="电子书"></a>电子书</h2><ul><li><a href="https://ebook.hep.com.cn/ebooks/h5/index.html">高教书苑 (opens new window)</a>高等教育出版社的书籍，包含多种学科。</li><li><a href="https://sobooks.cc/">SoBooks (opens new window)</a>免费的电子书资源网站</li><li><a href="https://www.shidianguji.com/">识典古籍 (opens new window)</a>古籍数字化平台</li></ul><h2 id="优秀文章"><a href="#优秀文章" class="headerlink" title="优秀文章"></a>优秀文章</h2><ul><li><a href="https://coolshell.cn/articles/21672.html">我做系统架构的一些原则 (opens new window)</a>作者对系统架构的方法论总结</li><li><a href="https://juejin.im/post/5d4d0ec651882549594e7293">灵活运用CSS开发技巧(opens new window)</a></li><li><a href="https://ishadeed.com/article/defensive-css/">防御性CSS(opens new window)</a></li></ul><h2 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h2><ul><li><a href="https://www.bilibili.com/">bilibili (opens new window)</a>B站，上面很多免费教学视频</li><li><a href="https://www.imooc.com/">慕课网 (opens new window)</a>实战视频教程</li><li><a href="https://www.miaov.com/">妙味课堂 (opens new window)</a>比较系统的前端入门视频教程</li><li><a href="https://www.icourse163.org/">中国大学MOOC (opens new window)</a>涵盖计算机、外语、心理学等专业免费课程</li><li><a href="http://le.ouchn.cn/">终身教育平台 (opens new window)</a>涵盖生活、兴趣、职场、技能、老年、学历等免费课程</li><li><a href="http://egghead.io/">egghead (opens new window)</a>质量还不错的短视频教程，外网</li></ul><h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><ul><li><p><a href="https://repobeats.axiom.co/">Repobeats (opens new window)</a>生成仓库的动态数据统计图</p></li><li><p><a href="https://git.io/">github 短域名服务(opens new window)</a></p></li><li><p><a href="https://shields.io/">shields (opens new window)</a>徽章图标</p></li><li><p><a href="https://wangchujiang.com/github-rank/index.html">followers 全球排名(opens new window)</a></p></li><li><p><a href="https://star-history.t9t.io/">star-history (opens new window)</a>展示一个项目 Stars 增长曲线</p></li></ul><h2 id="评论系统"><a href="#评论系统" class="headerlink" title="评论系统"></a>评论系统</h2><ul><li><a href="https://giscus.app/zh-CN">giscus (opens new window)</a>由 <a href="https://docs.github.com/en/discussions">GitHub Discussions (opens new window)</a>驱动的评论系统</li></ul><h2 id="前端小工具"><a href="#前端小工具" class="headerlink" title="前端小工具"></a>前端小工具</h2><ul><li><a href="https://caniuse.com/">Can I use (opens new window)</a>查看属性和方法的兼容性</li><li><a href="https://30secondsofcode.org/">30 seconds of code (opens new window)</a>收集了许多有用的代码小片段</li></ul><h2 id="代码编辑"><a href="#代码编辑" class="headerlink" title="代码编辑"></a>代码编辑</h2><ul><li><a href="https://codepen.io/">codepen (opens new window)</a>在线代码编辑与演示</li><li><a href="https://codesandbox.io/">codesandbox (opens new window)</a>内嵌VSCode的在线IDE</li></ul><h2 id="Emoji表情"><a href="#Emoji表情" class="headerlink" title="Emoji表情"></a>Emoji表情</h2><ul><li><a href="https://emojipedia.org/">emoji表情(opens new window)</a></li><li><a href="https://www.webfx.com/tools/emoji-cheat-sheet">emoji表情备忘录(opens new window)</a></li><li><a href="https://translate.yandex.com/?lang=zh-emj">根据文本匹配emoji(opens new window)</a></li><li><a href="https://github.com/carloscuesta/gitmoji">gitmoji (opens new window)</a>通过 emoji 表达 git 的操作内容</li></ul><blockquote><p>在任意输入框快速打开emoji表情方法：<br>Windows系统下按Win + .<br>Mac系统下按Control + Command + 空格</p></blockquote><h2 id="图片工具"><a href="#图片工具" class="headerlink" title="图片工具"></a>图片工具</h2><ul><li><a href="https://tinypng.com/">tinypng图片压缩 (opens new window)</a>压缩png很有用</li><li><a href="https://devtool.tech/tiny-image">微图 (opens new window)</a>浏览器端图片压缩，不会上传图片到服务器</li><li><a href="https://squoosh.app/">Squoosh (opens new window)</a>谷歌出品在线免费图片压缩工具（jpg、png等,压缩效果比tinypng稍好）</li><li><a href="http://waifu2x.udp.jp/">waifu2x (opens new window)</a>通过卷积网络放大图片</li><li><a href="https://vectormagic.com/">vectormagic (opens new window)</a>转换矢量图</li><li><a href="https://www.vectorizer.io/">vectorizer (opens new window)</a>真正的 png 转 svg 神器</li><li><a href="https://photo.opencool.cn/">在线AI图片处理 (opens new window)</a>黑白修复、无损放大、动漫化、铅笔画等。</li><li><a href="https://www.remove.bg/zh">remove (opens new window)</a>AI抠图（抠背景）</li><li><a href="https://www.magiceraser.io/">magic eraser (opens new window)</a>AI抠图（抠前景）</li><li><a href="https://github.com/nadermx/backgroundremover">backgroundremover (opens new window)</a>又一个抠图的</li></ul><h2 id="背景渐变色"><a href="#背景渐变色" class="headerlink" title="背景渐变色"></a>背景渐变色</h2><p>链接：</p><ul><li><a href="http://color.oulu.me/">http://color.oulu.me(opens new window)open in new window</a></li><li><a href="https://uigradients.com/">https://uigradients.com(opens new window)open in new window</a></li><li><a href="https://webgradients.com/">https://webgradients.com(opens new window)open in new window</a></li><li><a href="http://zhongguose.com/">http://zhongguose.com(opens new window)open in new window</a></li></ul><p>免费的线性渐变网站，可在任何网站使用您不仅可以复制渐变的原生<code>CSS</code>颜色代码，还可以查看下载每个优质的渐变图片。</p><h2 id="SVG"><a href="#SVG" class="headerlink" title="SVG"></a>SVG</h2><ul><li><a href="https://e2.cool/">svg编辑器-E2.Cool(opens new window)</a></li><li><a href="https://x.ipaiban.com/login">svg编辑器-i排版(opens new window)</a></li></ul><h2 id="音视频工具"><a href="#音视频工具" class="headerlink" title="音视频工具"></a>音视频工具</h2><ul><li><a href="https://app.xunjieshipin.com/video-converter/">迅捷视频转换器 (opens new window)</a>在线转换各种视频格式</li><li><a href="https://app.xunjieshipin.com/video-converter/">迅捷音频转换器 (opens new window)</a>在线转换各种音频格式</li><li><a href="https://mp3cut.net/cn/">修剪音频 (opens new window)</a>在线修剪或剪切任何音频文件</li></ul><h2 id="思维导图"><a href="#思维导图" class="headerlink" title="思维导图"></a>思维导图</h2><ul><li><a href="https://www.processon.com/">processon在线作图 (opens new window)</a>流程图、思维导图、原型图等</li><li><a href="https://naotu.baidu.com/">百度脑图 (opens new window)</a>思维导图</li><li><a href="https://docs.wmhello.cn/pages/beb6c0bd8a66cea6/plectica.com">plectica</a> 绘制知识图谱</li></ul><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><ul><li><p><a href="https://juejin.cn/post/7030572979868139551?utm_source=gold_browser_extension">各种CSS生成器和JS代码片段(opens new window)</a></p></li><li><p><a href="http://css-tricks.neatbang.com/">CSS Tricks (opens new window)</a>CSS技巧收集与演示</p></li><li><p><a href="https://neumorphism.io/">CSS生成器(opens new window)</a></p></li><li><p><a href="https://www.colorzilla.com/gradient-editor/">CSS渐变生成器(opens new window)</a></p></li><li><p><a href="https://www.html.cn/tool/css3Preview/Box-Shadow.html">CSS3-Box Shadow(阴影)(opens new window)</a></p></li><li><p><a href="https://cubic-bezier.com/">贝塞尔曲线生成器 (opens new window)</a></p></li><li><p><a href="http://www.heropatterns.com/">花纹背景生成器(opens new window)</a></p></li><li><p><a href="https://github.com/bansal-io/pattern.css">花纹背景-pattern.css(opens new window)</a></p></li><li><p><a href="https://bennettfeely.com/ztext/">3D字体(opens new window)</a></p></li><li><p><a href="https://css-tricks.com/">css-tricks (opens new window)</a>css技巧文章</p></li><li><p><a href="https://lhammer.cn/You-need-to-know-css/#/zh-cn/">You-need-to-know-css (opens new window)</a>CSS的各种DEMO，很全</p></li><li><p><a href="https://animista.net/">animista (opens new window)</a>CSS动画可视化工具，复制代码就能用</p></li><li><p><a href="http://navnav.co/">navnav (opens new window)</a>各种炫酷的CSS动画组件</p></li></ul><h2 id="CDN加速"><a href="#CDN加速" class="headerlink" title="CDN加速"></a>CDN加速</h2><ul><li><a href="http://www.jsdelivr.com/">jsDelivr (opens new window)</a>国外的一家优秀的公共 CDN 服务提供商</li><li><a href="https://unpkg.com/">unpkg (opens new window)</a>cdn 服务</li></ul><h2 id="在线的文本比较"><a href="#在线的文本比较" class="headerlink" title="在线的文本比较"></a>在线的文本比较</h2><p>链接：<a href="https://www.jq22.com/textDifference">https://www.jq22.com/textDifference(opens new window)open in new window</a></p><p>其他文件对比工具：<code>WinMerge</code>、<code>Diffuse</code>、<code>Beyond Compare</code>、<code>Altova DiffDog</code>、<code>AptDiff</code>、<code>Code Compare</code>等。</p><h2 id="NB-Map"><a href="#NB-Map" class="headerlink" title="NB Map"></a>NB Map</h2><p>链接：<a href="https://nbcharts.com/map/map.php">https://nbcharts.com/map/map.php(opens new window)open in new window</a></p><p>NB Map 是灰色执照开发的一款三维地图的工具，可以随意调节地图颜色、板块高度、旋转不同的角度调整成你需要的地图后，可以下载透明背景的 PNG 格式。</p><h2 id="开发者藏经阁"><a href="#开发者藏经阁" class="headerlink" title="开发者藏经阁"></a>开发者藏经阁</h2><p>链接：<a href="https://developer.aliyun.com/ebook/">https://developer.aliyun.com/ebook/(opens new window)open in new window</a></p><p>阿里巴巴技术实践精华，涵盖云原生、物联网、大数据、AI 等技术领域。</p><h2 id="Chrome-插件下载"><a href="#Chrome-插件下载" class="headerlink" title="Chrome 插件下载"></a>Chrome 插件下载</h2><p><a href="https://crxdl.com/">插件</a></p><h2 id="pdf文件转为md文件"><a href="#pdf文件转为md文件" class="headerlink" title="pdf文件转为md文件"></a>pdf文件转为md文件</h2><p>将PDF文件拖到页面即可</p><p><a href="https://pdf2md.morethan.io/">PDF To MarkDown Converter Toolopen in new window</a></p><p><a href="https://smallpdf.com/cn/pdf-to-word">PDF 转 Word，Excel，PPT，JPG 的网址open in new window</a></p><p><a href="https://pdf2md.morethan.io/">PDF 转 Markdown 的网址open in new window</a></p><p><a href="https://www.pdftohtml.net/">PDF 转 HTML 的网址open in new window</a></p><p><a href="https://www.cleverpdf.com/cn/downToWord">Word，Excel，PPT，JPG 转 PDF 的网址open in new window</a></p><p><a href="http://open.rongcard.com/md2pdf">Markdown 转 PDF 的网址open in new window</a></p><p><a href="https://www.htm2pdf.co.uk/">HTML 转 PDF 的网址：open in new window</a></p><p><a href="http://coolaf.com/tool/md">Markdown 与 HTML，PDF，Doc 互转 的网址：open in new window</a></p><p><a href="http://www.bejson.com/convert/html2markdown/">HTML 与 Markdown 互转 的网址</a></p><h2 id="网站托管"><a href="#网站托管" class="headerlink" title="网站托管"></a>网站托管</h2><ul><li><a href="https://vercel.com/">vercel (opens new window)</a>好用的网站托管服务</li></ul><h2 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h2><ul><li><a href="https://regex101.com/">正则可视化(opens new window)</a></li><li><a href="https://ihateregex.io/">iHateRegex (opens new window)</a>正则搜索，细节做得很好</li><li><a href="https://github.com/qdlaoyao/js-regex-mini-book">正则迷你书 (opens new window)</a>学习正则的小手册</li></ul><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul><li><a href="https://ipcmen.com/">Linux命令手册(opens new window)</a></li><li><a href="https://carbon.now.sh/">carbon代码图片生成器 (opens new window)</a>生成好看的代码图片</li></ul><h2 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h2><ul><li><a href="http://chuangzaoshi.com/">创造师导航(opens new window)</a></li><li><a href="http://hao.uisdc.com/">设计师网址导航(opens new window)</a></li><li><a href="https://www.remove.bg/zh">remove (opens new window)</a>AI抠图，抠图算法很厉害</li><li><a href="https://www.manypixels.co/gallery/">Manypixels (opens new window)</a>插画</li><li><a href="https://undraw.co/illustrations">Undraw (opens new window)</a>插画</li><li><a href="https://storytale.io/">storytale (opens new window)</a>插画，种类丰富，包含3D插画</li><li><a href="https://uimovement.com/">uimovement (opens new window)</a>能从这个网站找到不少动画交互的灵感</li><li><a href="https://www.awwwards.com/">awwwards (opens new window)</a>是一个一个专门为设计精美的网站以及富有创意的网站颁奖的网站</li><li><a href="https://dribbble.com/">dribbble (opens new window)</a>经常能在上面找到很多有创意好看的 gif 或者图片</li><li><a href="https://www.behance.net/">Bēhance (opens new window)</a>dribbble 是设计师的微博，Bēhance 是设计师的博客</li><li><a href="https://logojoy.com/">Logojoy (opens new window)</a>使用 ai 做 logo 的网站，做出来的 logo 质量还不错。</li><li><a href="http://brandmark.io/">brandmark (opens new window)</a>另一个在线制作 logo 网站</li><li><a href="https://instantlogodesign.com/">instant (opens new window)</a>又一个 logo 制作网站</li><li><a href="https://www.namecheap.com/logo-maker/app/">namecheap (opens new window)</a>又一个 logo 制作网站</li><li><a href="https://www.designevo.com/logo-maker/">logo-maker (opens new window)</a>又一个 logo 制作网站 这个更简单点 就是选模板之后微调</li><li><a href="https://coolors.co/">coolors (opens new window)</a>帮你在线配色的网站 你能找到不少配色灵感</li><li><a href="http://colorhunt.co/">colorhunt (opens new window)</a>另一个配色网站</li><li><a href="https://uigradients.com/#SummerDog">uigradients (opens new window)</a>渐变色网站</li><li><a href="https://www.designcap.com/">designcap (opens new window)</a>在线海报设计</li><li><a href="https://flatuicolors.com/">Flat UI 色表 (opens new window)</a>Flat UI 色表</li><li><a href="https://www.0to255.com/">0to255 (opens new window)</a>颜色梯度</li><li><a href="https://github.com/mikolajdobrucki/ikonate">Ikonate (opens new window)</a>提供免费的图标 icons</li><li><a href="https://remixicon.com/">remixicon (opens new window)</a>又一个提供免费图标 icons</li><li><a href="https://github.com/feathericons/feather">feather (opens new window)</a>免费的 icons</li><li><a href="https://github.com/arcticicestudio/nord">nord (opens new window)</a>北欧性冷淡风主题配色</li><li><a href="https://unsplash.com/">Unsplash (opens new window)</a>提供免费的高清图片</li><li><a href="https://www.pexels.com/zh-cn/">Pexels (opens new window)</a>提供免费的高清图片</li><li><a href="https://colorkitty.com/">colorkitty (opens new window)</a>从你的图片中提取配色</li><li><a href="http://design.youzan.com/">design.youzan (opens new window)</a>有赞设计原则</li><li><a href="https://www.iconfont.cn/">iconfont (opens new window)</a>阿里巴巴矢量图标库</li><li><a href="https://undraw.co/illustrations">undraw (opens new window)</a>免费的矢量插画</li><li><a href="https://icomoon.io/">icomoon (opens new window)</a>矢量图标库</li><li><a href="http://cssicon.space/#/">cssicon (opens new window)</a>所有的 icon 都是纯 css 画的 缺点：icon 不够多</li><li><a href="http://apps.eky.hk/css-triangle-generator/">CSS triangle generator (opens new window)</a>帮你快速用 css 做出三角形</li><li><a href="http://bennettfeely.com/clippy/">clippy (opens new window)</a>在线帮你使用 css clip-path 做出各种形状的图形</li><li><a href="https://picsum.photos/">Lorem Picsum (opens new window)</a>提供免费的占位图</li><li><a href="https://www.canva.cn/">Canva 可画 (opens new window)</a>生成插画、封面、海报、头像等</li><li><a href="https://error404.fun/">404页 (opens new window)</a>404页素材</li><li><a href="https://collectui.com/">collectui (opens new window)</a>按功能组件分类的设计图</li><li><a href="https://smartmockups.com/zh">smartmockups (opens new window)</a>产品模板生成工具</li></ul><h2 id="图库"><a href="#图库" class="headerlink" title="图库"></a>图库</h2><ul><li><a href="https://uigradients.com/">uigradients (opens new window)</a>渐变色生成工具</li><li><a href="https://www.freepik.com/">freepik (opens new window)</a>banner 图库</li><li><a href="http://www.51yuansu.com/">觅元素 (opens new window)</a>一天免费下载十张 psd（免抠元素）</li><li><a href="https://www.gaoding.com/">搞定设计 (opens new window)</a>可以抠图</li><li><a href="https://www.vectorizer.io/">vectorizer (opens new window)</a>真正的 png 转 svg 神器</li><li><a href="https://www.zcool.com.cn/">站酷 (opens new window)</a>国内优秀的设计作品展示</li><li><a href="https://huaban.com/">花瓣(opens new window)</a></li><li><a href="https://huke88.com/">虎克 (opens new window)</a>ps 学习教程</li><li><a href="https://themes.muffingroup.com/be/splash/">beTheme(opens new window)</a></li><li><a href="https://www.ui.cn/">UI 中国(opens new window)</a></li><li><a href="https://alpha.wallhaven.cc/">wallhaven (opens new window)</a>壁纸网站-</li></ul><h2 id="3D"><a href="#3D" class="headerlink" title="3D"></a>3D</h2><ul><li><a href="https://sketchfab.com/">sketchfab (opens new window)</a>3D模型</li></ul><h2 id="交互"><a href="#交互" class="headerlink" title="交互"></a>交互</h2><ul><li><a href="http://aliscued.lofter.com/">微交互 (opens new window)</a>里面收集了市面上很多很好的微交互例子 值得学习</li><li><a href="http://littlebigdetails.com/">Little Big Details (opens new window)</a>同上，一个国外微交互汇集网站</li><li><a href="https://cruip.com/">cruip (opens new window)</a>登录页的各种页面设计，可以免费下载模板</li><li><a href="https://comixify.ii.pw.edu.pl/">Comixify (opens new window)</a>一个波兰团队做了非常好玩的工具，可以把视频自动转成漫画，上图是他们提供的 demo，效果很棒。</li><li><a href="https://github.com/bui/taiko-web">taiko-web (opens new window)</a>太鼓达人网页版 只能说很 6</li></ul><h2 id="有趣"><a href="#有趣" class="headerlink" title="有趣"></a>有趣</h2><ul><li><a href="https://pranx.com/">电脑恶搞 (opens new window)</a>收集了一些恶搞小网页，比如xp系统蓝屏、黑客界面等</li><li><a href="https://neocities.org/browse">neocities (opens new window)</a>上面托管了很多有趣的网站</li><li><a href="https://fuun.fun/">奇趣网站收藏家 (opens new window)</a>收藏了很多有趣的网站</li><li><a href="https://game.xugaoyi.com/">FC在线模拟器(小霸王游戏机) (opens new window)</a>童年回忆</li><li><a href="http://www.baidu-x.com/">帮你百度一下 (opens new window)</a>可以 <a href="http://www.baidu-x.com/?q=%E5%92%8C%E8%B0%90%E6%9C%89%E7%88%B1%E5%AF%8C%E5%BC%BA">点我测试一下 (opens new window)</a>-</li><li><a href="http://lmgtfy.com/">国际版 (opens new window)</a>同<code>帮我百度一下</code>-<a href="http://lmgtfy.com/?q=a">点我测试一下 (opens new window)</a>-</li><li><a href="http://matthewrayfield.com/articles/animating-urls-with-javascript-and-emojis/#%F0%9F%8C%96">URL 地址播放 Emojis 动画 (opens new window)</a>在地址栏里面播放 emoji</li><li><a href="https://cantunsee.space/">Can’t Unsee (opens new window)</a>强烈建议前端、客户端、UI 开发的同学玩下，检查一下自己对设计稿的敏感度怎么样</li><li><a href="https://talk.swift.gg/">ggtalk (opens new window)</a>平时一直在听的一个技术博客</li><li><a href="https://github.com/Blankj/awesome-comment">awesome-comment (opens new window)</a>里面收集了很多有趣的代码注释</li><li><a href="https://www.text-image.com/index.html">text-img (opens new window)</a>都将图片转化为 ascii 用来写注释</li><li><a href="https://pessimistress.github.io/ascii/">ascii video (opens new window)</a>使用ascii编码生成视频动画</li><li><a href="https://github.com/beizhedenglong/weird-fonts">weird-fonts (opens new window)</a>将普通字母转化为 特殊 unicode</li><li><a href="https://github.com/epidemian/snake">snake (opens new window)</a>在地址栏里面玩贪吃蛇</li><li><a href="https://github.com/yuanfux/zero-width-lib">zero-width-lib (opens new window)</a>利用零宽度字符实现 隐形水印、加密信息分享、逃脱词匹配，很有创意</li><li><a href="https://www.abbreviations.com/">abbreviations (opens new window)</a>查看一个简写是什么意思的网站</li><li><a href="https://magi.com/">magi (opens new window)</a>ai 搜索神器，超屌</li><li><a href="https://www.qmsjmfb.com/">在线取名 (opens new window)</a>解决取名难问题，超多名字生成</li><li><a href="https://collet66.web.fc2.com/nijisanji/index.html">像素画GIF(opens new window)</a></li><li><a href="https://uchinoko-maker.jp/">猫咪生成器(opens new window)</a></li></ul><h2 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h2><ul><li><a href="https://toonme.com/">卡通头像生成器 (opens new window)</a>上传真人头像生成卡通头像</li><li><a href="https://www.artbreeder.com/">artbreeder (opens new window)</a>动漫图生成真人图像</li><li><a href="https://neal.fun/ambient-chaos/">声音生成器 (opens new window)</a>生成下雨、咖啡厅、海浪、火车等声音，可几种声音合成</li><li><a href="https://zzkia.noddl.me:8020/">诺基亚短信图片生成器(opens new window)</a></li><li><a href="https://zfb.xugaoyi.com/">到账语音生成器 (opens new window)</a>支付宝到账1亿元</li></ul><h2 id="元宇宙"><a href="#元宇宙" class="headerlink" title="元宇宙"></a>元宇宙</h2><p>符合元宇宙特征的几个网站，允许用户拥有虚拟土地，在上面构建自己的世界：</p><ul><li><a href="https://www.sandbox.game/cn/">沙盒(opens new window)</a></li><li><a href="https://somniumspace.com/">梦境空间(opens new window)</a></li><li><a href="https://market.decentraland.org/">Decentraland(opens new window)</a></li></ul><h2 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h2><ul><li><a href="https://egghead.io/courses/execute-npm-package-binaries-with-the-npx-package-runner">npx (opens new window)</a>教你怎么合理的使用 npx</li><li><a href="https://www.hacksplaining.com/lessons">hacksplaining (opens new window)</a>网络安全学习网站</li><li><a href="https://github.com/mcuking/mobile-web-best-practice">mobile-web-best-practice (opens new window)</a>移动 web 最佳实践</li></ul><h2 id="产品"><a href="#产品" class="headerlink" title="产品"></a>产品</h2><ul><li><a href="https://www.producthunt.com/">Product Hunt (opens new window)</a>好产品推荐</li><li><a href="http://www.pmdaniu.com/">产品大牛 (opens new window)</a>什么有很多完整的产品原型可以借鉴</li><li><a href="https://modao.cc/pricing">磨刀 (opens new window)</a>快速出 ui 原型</li></ul><h2 id="实用"><a href="#实用" class="headerlink" title="实用"></a>实用</h2><ul><li><a href="https://webden.dev/">webden (opens new window)</a>在线网页编辑器，轻便快捷</li><li><a href="https://browser-update.org/">browser-update (opens new window)</a>浏览器版本更新提示插件</li><li><a href="https://admin.typeform.com/signup">typeform (opens new window)</a>一个国外的在线调查问卷网站</li><li><a href="https://www.videofk.com/">VideoFk (opens new window)</a>VideoFk 视频在线解析下载</li><li><a href="https://www.allhistory.com/">全历史 (opens new window)</a>历史内容聚合网站</li><li><a href="https://www.uzer.me/">UzerMe (opens new window)</a>云端办公工具</li><li><a href="https://sobooks.cc/">SoBooks (opens new window)</a>强大的电子书资源网站</li><li><a href="https://www.gaoding.com/">稿定设计 (opens new window)</a>键式设计工具+智能抠图</li><li><a href="https://dalipan.com/">大力盘 (opens new window)</a>百度网盘搜索</li><li><a href="https://www.macbl.com/app/internet/enfi">ENFI 下载器 (opens new window)</a>不限速下载器</li><li><a href="https://www.laihua.com/">来画视频 (opens new window)</a>像做 PPT 一样做短视频</li><li><a href="https://www.arkie.cn/">Arkie 海报制作工具(opens new window)</a></li><li><a href="http://www.ypppt.com/">优品 PPT(opens new window)</a></li><li><a href="http://www.tretars.com/">比格 PPT(opens new window)</a></li><li><a href="https://www.pexels.com/">高清免费图片(opens new window)</a></li><li><a href="https://unsplash.com/">高清免费图片 2(opens new window)</a></li><li><a href="https://www.shapedivider.app/">shapedivider (opens new window)</a>生成波浪分隔线</li><li><a href="https://www.notion.so/">Notion (opens new window)</a>知识库、快速笔记、TaskList、日记、读书清单，各种类型，应有尽有</li></ul><h2 id="Talk"><a href="#Talk" class="headerlink" title="Talk"></a>Talk</h2><ul><li><a href="https://github.com/peerigon/talks">peerigon-talks (opens new window)</a>收集了不少有意思的 talks</li></ul><h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h2><ul><li><a href="https://github.com/azl397985856/leetcode">leetcode (opens new window)</a>用 js 刷 leetcode</li></ul><h2 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h2><ul><li><a href="https://www.digitalocean.com/community/tools/nginx?global.app.lang=zhCN">nginx 可视化配置工具(opens new window)</a></li></ul><h2 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h2><ul><li><a href="https://www.ventusky.com/">Ventusky (opens new window)</a>风雨气温图</li></ul>]]></content>
      
      
      <categories>
          
          <category> 网站推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网站 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我的第一篇博客</title>
      <link href="/2023/09/05/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2023/09/05/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/09/05/hello-world/"/>
      <url>/2023/09/05/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
